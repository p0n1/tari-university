<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Tari Labs University</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="A collection of learning resources for cryptocurrency">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <!-- Twitter tags -->
        <meta name="twitter:title" content="Tari Labs University" />
        <meta name="twitter:site" content="Tari Labs University"/>
        <meta name="twitter:description" content="A collection of learning resources for cryptocurrency" />
        <meta name="twitter:image" content="https://tlu.tarilabs.com/theme/images/tari-labs.png" />
        <meta name="twitter:card" content="summary"/>

        <!-- Facebook tags -->
        <meta property="og:title" content="Tari Labs University" />
        <meta property="og:site_name" content="Tari Labs University"/>
        <meta property="og:image" content="https://tlu.tarilabs.com/theme/images/tari-labs.png" />
        <meta property="og:description" content="A collection of learning resources for cryptocurrency" />

        <!-- Generic tags -->
        <meta itemprop="thumbnailUrl" content="https://tlu.tarilabs.com/theme/images/tari-labs.png"/>
        <meta itemprop="image" content="https://tlu.tarilabs.com/theme/images/tari-labs.png"/>
        <link rel="image_src" href="https://tlu.tarilabs.com/theme/images/tari-labs.png"/>

        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
        <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">
          MathJax.Hub.Config({
            tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true
            }
          });
        </script>
        

        <style>
        div.wrap_beg {
            width: 95%; 
            word-wrap: break-word;
            background: #FFE599;
            font-size: 1.0em;
            padding: 0.5em;
            color: #000000;
            }
        </style>
        <style>
        div.wrap_int {
            width: 95%; 
            word-wrap: break-word;
            background: #B6D7A8;
            font-size: 1.0em;
            padding: 0.5em;
            color: #000000;
            }
        </style>
        <style>
            div.wrap_adv {
            width: 95%; 
            word-wrap: break-word;
            background: #A2C4C9;
            font-size: 1.0em;
            padding: 0.5em;
            color: #000000;
            }
        </style>

    </head>
    <body class="light">
        <!-- Provide site root to javascript -->
        <script type="text/javascript">var path_to_root = "";</script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { } 
            if (theme === null || theme === undefined) { theme = 'light'; }
            document.body.className = theme;
            document.querySelector('html').className = theme + ' js';
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <img src="theme/images/tlu.png" class="tlu">

            <ol class="chapter"><li class="expanded affix "><a href="preface/introduction.html">Introduction</a></li><li class="expanded "><a href="preface/learning/introduction-to-learning.html"><strong aria-hidden="true">1.</strong> Learning Paths</a></li><li><ol class="section"><li class="expanded "><a href="preface/learning/blockchain-basics.html"><strong aria-hidden="true">1.1.</strong> Learning about Blockchain Basics</a></li><li class="expanded "><a href="preface/learning/mimblewimble.html"><strong aria-hidden="true">1.2.</strong> Learning about Mimblewimble Implementation</a></li><li class="expanded "><a href="preface/learning/bulletproofs.html"><strong aria-hidden="true">1.3.</strong> Learning about Bulletproofs</a></li></ol></li><li class="expanded "><a href="cryptography/cryptography.html"><strong aria-hidden="true">2.</strong> Cryptography</a></li><li><ol class="section"><li class="expanded "><a href="cryptography/crypto-1/sources/PITCHME.link.html"><strong aria-hidden="true">2.1.</strong> Elliptic Curves 101</a></li><li class="expanded "><a href="cryptography/digital_signatures/introduction_schnorr_signatures.html"><strong aria-hidden="true">2.2.</strong> Introduction to Schnorr Signatures</a></li><li class="expanded "><a href="cryptography/scriptless-scripts/introduction-to-scriptless-scripts.html"><strong aria-hidden="true">2.3.</strong> Introduction to Scriptless Scripts</a></li><li class="expanded "><a href="cryptography/musig-schnorr-sig-scheme/The_MuSig_Schnorr_Signature_Scheme.html"><strong aria-hidden="true">2.4.</strong> The MuSig Schnorr Signature Scheme</a></li><li class="expanded "><a href="cryptography/fraud-proofs-1/MainReport.html"><strong aria-hidden="true">2.5.</strong> Fraud Proofs</a></li><li class="expanded "><a href="cryptography/bulletproofs-and-mimblewimble/MainReport.html"><strong aria-hidden="true">2.6.</strong> Bulletproofs and Mimblewimble</a></li><li class="expanded "><a href="cryptography/building-on-bulletproofs/link.html"><strong aria-hidden="true">2.7.</strong> Building on Bulletproofs</a></li><li class="expanded "><a href="cryptography/bulletproofs-protocols/MainReport.html"><strong aria-hidden="true">2.8.</strong> The Bulletproof Protocols</a></li><li class="expanded "><a href="cryptography/pure-rust-ecc/pure-rust-ecc.html"><strong aria-hidden="true">2.9.</strong> Pure-Rust Elliptic Curve Cryptography</a></li><li class="expanded "><a href="cryptography/zksnarks/mainreport.html"><strong aria-hidden="true">2.10.</strong> zk-SNARKs</a></li><li class="expanded "><a href="cryptography/r1cs-bulletproofs/mainreport.html"><strong aria-hidden="true">2.11.</strong> Rank-1 Constraint System with Application to Bulletproofs</a></li></ol></li><li class="expanded "><a href="consensus-mechanisms/consensus-mechanisms.html"><strong aria-hidden="true">3.</strong> Consensus Mechanisms</a></li><li><ol class="section"><li class="expanded "><a href="consensus-mechanisms/BFT/understanding_bft_consensus.html"><strong aria-hidden="true">3.1.</strong> Understanding BFT Consensus</a></li><li class="expanded "><a href="consensus-mechanisms/BFT-consensusmechanisms/sources/PITCHME.link.html"><strong aria-hidden="true">3.2.</strong> BFT Consensus Mechanisms</a></li><li class="expanded "><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html"><strong aria-hidden="true">3.3.</strong> Introduction to Applications of Byzantine Consensus Mechanisms</a></li></ol></li><li class="expanded "><a href="scaling/scaling.html"><strong aria-hidden="true">4.</strong> Scaling</a></li><li><ol class="section"><li class="expanded "><a href="scaling/layer2scaling-landscape/layer2scaling-survey.html"><strong aria-hidden="true">4.1.</strong> Layer 2 Scaling Survey</a></li><li class="expanded "><a href="scaling/executive-summary/sources/PITCHME.link.html"><strong aria-hidden="true">4.2.</strong> Layer 2 Scaling Survey Executive Summary</a></li><li class="expanded "><a href="scaling/directed-acyclic-graphs/DAGs.html"><strong aria-hidden="true">4.3.</strong> Directed Acyclic Graphs</a></li><li class="expanded "><a href="scaling/laser-beam/MainReport.html"><strong aria-hidden="true">4.4.</strong> Laser Beam</a></li></ol></li><li class="expanded "><a href="merged-mining/merged-mining.html"><strong aria-hidden="true">5.</strong> Merged Mining</a></li><li><ol class="section"><li class="expanded "><a href="merged-mining/merged-mining-scene/MergedMiningIntroduction.html"><strong aria-hidden="true">5.1.</strong> Merged Mining Introduction</a></li></ol></li><li class="expanded "><a href="digital-assets/digital-assets.html"><strong aria-hidden="true">6.</strong> Digital Assets</a></li><li><ol class="section"><li class="expanded "><a href="digital-assets/howey-application-to-blockchain/MainReport.html"><strong aria-hidden="true">6.1.</strong> Application of Howey to Blockchain Network Token Sales</a></li><li class="expanded "><a href="digital-assets/nft-landscape-1/sources/PITCHME.link.html"><strong aria-hidden="true">6.2.</strong> Non-fungible Tokens Survey</a></li><li class="expanded "><a href="digital-assets/confidential-assets/MainReport.html"><strong aria-hidden="true">6.3.</strong> Confidential Assets</a></li></ol></li><li class="expanded "><a href="protocols/protocols.html"><strong aria-hidden="true">7.</strong> Protocols</a></li><li><ol class="section"><li class="expanded "><a href="protocols/mimblewimble-1/sources/PITCHME.link.html"><strong aria-hidden="true">7.1.</strong> Mimblewimble A High-Level Overview</a></li><li class="expanded "><a href="protocols/mimblewimble-1/MainReport.html"><strong aria-hidden="true">7.2.</strong> Mimblewimble Transactions Explained</a></li><li class="expanded "><a href="protocols/grin-protocol-overview/MainReport.html"><strong aria-hidden="true">7.3.</strong> Mimblewimble-Grin Block Chain Protocol Overview</a></li><li class="expanded "><a href="protocols/grin-beam-comparison/MainReport.html"><strong aria-hidden="true">7.4.</strong> Grin vs. BEAM; a Comparison</a></li><li class="expanded "><a href="protocols/grin-design-choice-criticisms/MainReport.html"><strong aria-hidden="true">7.5.</strong> Grin Design Choice Criticisms - Truth or Fiction</a></li><li class="expanded "><a href="protocols/atomic-swaps/AtomicSwaps.html"><strong aria-hidden="true">7.6.</strong> Atomic Swaps</a></li><li class="expanded "><a href="protocols/lightning-network-for-dummies/sources/PITCHME.link.html"><strong aria-hidden="true">7.7.</strong> Lightning Network for Dummies</a></li><li class="expanded "><a href="protocols/merkle-trees-and-spv-1/sources/PITCHME.link.html"><strong aria-hidden="true">7.8.</strong> Introduction to SPV, Merkle Trees and Bloom Filters</a></li><li class="expanded "><a href="protocols/rgb-introduction/sources/PITCHME.link.html"><strong aria-hidden="true">7.9.</strong> The RGB Protocol - An Introduction</a></li><li class="expanded "><a href="protocols/intro-to-tor-i2P/MainReport.html"><strong aria-hidden="true">7.10.</strong> Introduction to Tor and I2P</a></li><li class="expanded "><a href="protocols/dht/MainReport.html"><strong aria-hidden="true">7.11.</strong> Distributed Hash Tables</a></li><li class="expanded "><a href="protocols/mimblewimble-mp-bp-utxo/MainReport.html"><strong aria-hidden="true">7.12.</strong> Mimblewimble Multiparty Bulletproof UTXO</a></li></ol></li><li class="expanded "><a href="network-analysis/network-analysis.html"><strong aria-hidden="true">8.</strong> Network Analysis</a></li><li><ol class="section"><li class="expanded "><a href="network-analysis/probabilistic-attack/building_blocks.html"><strong aria-hidden="true">8.1.</strong> Probabilistic Attack Vector Analysis Building Blocks</a></li><li class="expanded "><a href="network-analysis/probabilistic-attack/byzantine_takeover_of_the_DAN.html"><strong aria-hidden="true">8.2.</strong> Probability of a Byzantine Takeover of the Digital Assets Network</a></li></ol></li><li class="expanded "><a href="labs/introduction.html"><strong aria-hidden="true">9.</strong> Labs</a></li><li><ol class="section"><li class="expanded "><a href="labs/mermaid-demo.html"><strong aria-hidden="true">9.1.</strong> Mermaid Demonstration</a></li><li class="expanded "><a href="labs/notes.html"><strong aria-hidden="true">9.2.</strong> Notes and info boxes</a></li></ol></li><li class="expanded "><a href="preface/style-guide.html"><strong aria-hidden="true">10.</strong> Style Guide</a></li></ol>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar" class="menu-bar">
                    <div id="menu-bar-sticky-container">
                        <div class="left-buttons">
                            <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                                <i class="fa fa-bars"></i>
                            </button>
                            <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                                <i class="fa fa-paint-brush"></i>
                            </button>
                            <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                                <li role="none"><button role="menuitem" class="theme" id="light">Light <span class="default">(default)</span></button></li>
                                <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                            </ul>
                            
                            <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                                <i class="fa fa-search"></i>
                            </button>
                            
                        </div>

                        <h1 class="menu-title">
<svg width="23px" height="23px" viewBox="0 0 23 23 version="1.1" class="gem" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <path d="M0,6.12859037 L0,12.5315952 L9.50941704,23 L23,12.5722492 L23,6.12859037 L9.56098655,0 L0,6.12859037 Z M8.37488789,18.3349536 L2.3103139,11.6575342 L2.3103139,8.02916483 L8.37488789,9.56385329 L8.37488789,18.3349536 Z M10.6748879,19.2090146 L10.6748879,10.1533363 L19.4932735,12.3893062 L10.6748879,19.2090146 Z M20.7,7.57180734 L20.7,10.3464428 L4.17713004,6.15908087 L9.74663677,2.58152894 L20.7,7.57180734 Z" id="Shape" fill="#000000" fill-rule="nonzero"></path>
    </g>
</svg></h1> 

                        <div class="right-buttons">
                            <a href="print.html" title="Print this book" aria-label="Print this book">
                                <i id="print-button" class="fa fa-print"></i>
                            </a>
                        </div>
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1><a class="header" href="#introduction" id="introduction">Introduction</a></h1>
<p>Welcome to Tari Labs University (TLU). Our mission is to be the premier destination for balanced and accessible learning material for blockchain, digital currency 
and digital assets learning material.</p>
<p>We hope to make this a learning experience for us at TLU: as a means to grow our knowledge base and internal 
expertise or as a refresher. We think this will also be an excellent resource for anyone interested in the myriad 
disciplines required to understand blockchain technology.</p>
<p>We would like this platform to be a place of learning accessible to anyone, irrespective of their degree of expertise. 
Our aim is to cover a wide range of topics that are relevant to the TLU space, starting at a beginner level and 
extending down a path of deeper complexity. </p>
<p>You are welcome to contribute to our online content. To help you get started, we've compiled a 
<a href="preface/../preface/style-guide.html">Style Guide</a> for TLU reports. Using this Style Guide, you can help us to 
ensure consistency in the content and layout of TLU reports.</p>
<h2><a class="header" href="#errors-comments-and-contributions" id="errors-comments-and-contributions">Errors, Comments and Contributions</a></h2>
<p>We would like this collection of educational presentations and videos to be a collaborative affair. This extends to our presentations. We are learning along with you. Our content may not be perfect first time around, so 
we invite you to alert us to errors and issues or, better yet, if you know how to make a pull request, to contribute a 
fix, write the correction and make a pull request.</p>
<p>As much as this learning platform is called Tari Labs University and will see input from many internal contributors and 
external experts, we would like you to contribute to new material, be it in the form of a suggestion of topics, varying 
the skill levels of presentations, or posting presentations that you may feel will benefit us as a growing community. 
In the words of Yoda, “Always pass on what you have learned.”</p>
<h2><a class="header" href="#guiding-principles" id="guiding-principles">Guiding Principles</a></h2>
<p>If you are considering contributing content to TLU, please be aware of our guiding principles:</p>
<ol>
<li>The topic researched should be potentially relevant to the Tari protocol; chat to us on #tari-research on IRC if 
you're not sure.</li>
<li>The topic should be thoroughly researched.</li>
<li>A critical approach should be taken (in the academic sense), with critiques and commentaries sought out and 
presented alongside the main topic. Remember that every white paper promises the world, so go and look for counterclaims.</li>
<li>A recommendation/conclusion section should be included, providing a critical analysis on whether or not the technology/
proposal would be useful to the Tari protocol.</li>
<li>The work presented should be easy to read and understand, distilling complex topics into a form that is accessible to 
a technical but non-expert audience. Use your own voice.</li>
</ol>
<h2><a class="header" href="#submission-process" id="submission-process">Submission Process</a></h2>
<p>This is the basic submission process we follow within TLU. We would appreciate it if you, as an external contributor, follow the 
same process.</p>
<ol>
<li>Get some agreement from the community that the topic is of interest.</li>
<li>Write up your report.</li>
<li>Push a first draft of your report as a pull request.</li>
<li>The community will peer-review the report, much the same as we would with a code pull request. </li>
<li>The report is merged into the master. </li>
<li>Receive the fame and acclaim that is due.</li>
</ol>
<h1><a class="header" href="#learning-paths" id="learning-paths">Learning Paths</a></h1>
<p>With a field that is rapidly developing it is very important to stay updated with the latest trends, protocols and products that have incorporated this technology. </p>
<p>List of resources available to garner your knowledge in the Blockchain and cryptocurrency Domains is presented in the following paths:</p>
<table><thead><tr><th></th><th>Learning Path</th><th>Description</th></tr></thead><tbody>
<tr><td>1</td><td><a href="preface/learning/./blockchain-basics.html">Blockchain Basics</a></td><td>Blockchain Basics provides a broad and easily understood explanation of blockchain technology, as well as the history of value itself. Having an understanding of the value is especially important in grasping how blockchain and cryptocurrencies have the potential to reshape the financial industry.</td></tr>
<tr><td>2</td><td><a href="preface/learning/./mimblewimble.html">Mimblewimble Implementation</a></td><td>Mimblewimble is a blockchain protocol that focuses on privacy through the implementation of confidential transactions. <br/>It enables a greatly simplified blockchain in which all spent transactions can be pruned, resulting in a much smaller <br/>blockchain footprint and efficient base node validation. The blockchain consists only of block-headers, remaining Unspent <br/>Transaction Outputs (UTXO) with their range proofs and an unprunable transaction kernel per transaction.</td></tr>
<tr><td>3</td><td><a href="preface/learning/./bulletproofs.html">Bulletproofs</a></td><td>Bulletproofs are short non-interactive zero-knowledge proofs that require no trusted setup. A bulletproof can be used to convince a verifier that an encrypted plaintext is well formed. For example, prove that an encrypted number is in a given range, without revealing anything else about the number.</td></tr>
</tbody></table>
<h2><a class="header" href="#key" id="key">Key</a></h2>
<table><thead><tr><th>Level</th><th>Description</th></tr></thead><tbody>
<tr><td><div class="wrap_beg">Beginner</div></td><td>These are easy to digest articles,  reports and presentations</td></tr>
<tr><td><div class="wrap_int">Intermediate</div></td><td>Requires the foundational knowledge and basic understanding of the content</td></tr>
<tr><td><div class="wrap_adv">Advanced</div></td><td>Prior knowledge and/or mathematics skills are essential to understand these information sources</td></tr>
</tbody></table>
<h1><a class="header" href="#blockchain-basics" id="blockchain-basics">Blockchain Basics</a></h1>
<ul>
<li><a href="preface/learning/blockchain-basics.html#background">Background</a></li>
<li><a href="preface/learning/blockchain-basics.html#learning-path-matrix">Learning Path Matrix</a></li>
</ul>
<h2><a class="header" href="#background" id="background">Background</a></h2>
<p>Blockchain Basics provides a broad and easily understood explanation of blockchain technology, as well as the history of value itself. Having an understanding of the value is especially important in grasping how blockchain and cryptocurrencies have the potential to reshape the financial industry.</p>
<h2><a class="header" href="#learning-path-matrix" id="learning-path-matrix">Learning Path Matrix</a></h2>
<p>For learning purposes, we have arranged report, presentation and video topics in a matrix, in categories of difficulty, interest and format.</p>
<table><thead><tr><th>Topics</th><th align="center">Type</th></tr></thead><tbody>
<tr><td>So you think you need a blockchain? Part I</td><td align="center"><div class="wrap_beg"><a href="https://medium.com/@cayle/so-you-think-you-need-a-blockchain-part-i-a75389808c00">article</a></div></td></tr>
<tr><td>So you think you need a Blockchain, Part II?</td><td align="center"><div class="wrap_beg"><a href="https://medium.com/@cayle/so-you-think-you-need-a-blockchain-part-ii-71a62c5f1a1a">article</a></div></td></tr>
<tr><td>BFT Consensus Mechanisms</td><td align="center"><div class="wrap_beg"><a href="preface/learning//consensus-mechanisms/BFT-consensusmechanisms/sources/PITCHME.link.html">presentation</a></div></td></tr>
<tr><td>Lightning Network for Dummies</td><td align="center"><div class="wrap_beg"><a href="preface/learning//protocols/lightning-network-for-dummies/sources/PITCHME.link.html">presentation</a></div></td></tr>
<tr><td>Atomic Swaps</td><td align="center"><div class="wrap_beg"><a href="preface/learning//protocols/atomic-swaps/AtomicSwaps.html">presentation</a></div></td></tr>
<tr><td>Layer 2 Scaling Survey</td><td align="center"><div class="wrap_beg"><a href="preface/learning//scaling/layer2scaling-landscape/layer2scaling-survey.html">report</a></div></td></tr>
<tr><td>Merged Mining Introduction</td><td align="center"><div class="wrap_beg"><a href="preface/learning//merged-mining/merged-mining-scene/MergedMiningIntroduction.html">report</a></div></td></tr>
<tr><td>Introduction to SPV, Merkle Trees and Bloom Filters</td><td align="center"><div class="wrap_int"><a href="preface/learning//protocols/merkle-trees-and-spv-1/sources/PITCHME.link.html">presentation</a></div></td></tr>
<tr><td>Elliptic Curves 101</td><td align="center"><div class="wrap_int"><a href="preface/learning//cryptography/crypto-1/sources/PITCHME.link.html">presentation</a></div></td></tr>
</tbody></table>
<h1><a class="header" href="#mimblewimble-implementation" id="mimblewimble-implementation">Mimblewimble Implementation</a></h1>
<ul>
<li><a href="preface/learning/mimblewimble.html#background">Background</a></li>
<li><a href="preface/learning/mimblewimble.html#learning-path-matrix">Learning Path Matrix</a></li>
</ul>
<h2><a class="header" href="#background-1" id="background-1">Background</a></h2>
<p>Mimblewimble is a blockchain protocol that focuses on privacy through the implementation of confidential transactions. 
It enables a greatly simplified blockchain in which all spent transactions can be pruned, resulting in a much smaller 
blockchain footprint and efficient base node validation. The blockchain consists only of block-headers, remaining Unspent 
Transaction Outputs (UTXO) with their range proofs and an unprunable transaction kernel per transaction.</p>
<h2><a class="header" href="#learning-path-matrix-1" id="learning-path-matrix-1">Learning Path Matrix</a></h2>
<table><thead><tr><th>Topics</th><th align="center">Type</th></tr></thead><tbody>
<tr><td>Mimblewimble</td><td align="center"><div class="wrap_beg"><a href="preface/learning//protocols/mimblewimble-1/sources/PITCHME.link.html">presentation</a></div></td></tr>
<tr><td>Introduction to Schnorr Signatures</td><td align="center"><div class="wrap_int"><a href="preface/learning//cryptography/digital_signatures/introduction_schnorr_signatures.html">report</a></div></td></tr>
<tr><td>Introduction to Scriptless Scripts</td><td align="center"><div class="wrap_int"><a href="preface/learning//cryptography/scriptless-scripts/introduction-to-scriptless-scripts.html">report</a></div></td></tr>
<tr><td>Mimblewimble-Grin Block Chain Protocol Overview</td><td align="center"><div class="wrap_int"><a href="preface/learning//protocols/grin-protocol-overview/MainReport.html">report</a></div></td></tr>
<tr><td>Grin vs. BEAM; a Comparison</td><td align="center"><div class="wrap_int"><a href="preface/learning//protocols/grin-beam-comparison/MainReport.html">report</a></div></td></tr>
<tr><td>Grin Design Choice Criticisms - Truth or Fiction</td><td align="center"><div class="wrap_int"><a href="preface/learning//protocols/grin-design-choice-criticisms/MainReport.html">report</a></div></td></tr>
<tr><td>Mimblewimble Transactions Explained</td><td align="center"><div class="wrap_int"><a href="preface/learning//protocols/mimblewimble-1/MainReport.html">report</a></div></td></tr>
<tr><td>Mimblewimble Multiparty Bulletproof UTXO</td><td align="center"><div class="wrap_adv"><a href="preface/learning//protocols/mimblewimble-mp-bp-utxo/MainReport.html">report</a></div></td></tr>
</tbody></table>
<h1><a class="header" href="#bulletproofs" id="bulletproofs">Bulletproofs</a></h1>
<ul>
<li><a href="preface/learning/bulletproofs.html#background">Background</a></li>
<li><a href="preface/learning/bulletproofs.html#learning-path-matrix">Learning Path Matrix</a></li>
</ul>
<h2><a class="header" href="#background-2" id="background-2">Background</a></h2>
<p>Bulletproofs are short non-interactive zero-knowledge proofs that require no trusted setup. A bulletproof can be used to convince a verifier that an encrypted plaintext is well formed. For example, prove that an encrypted number is in a given range, without revealing anything else about the number.</p>
<h2><a class="header" href="#learning-path-matrix-2" id="learning-path-matrix-2">Learning Path Matrix</a></h2>
<table><thead><tr><th>Topics</th><th align="center">Type</th></tr></thead><tbody>
<tr><td>Bulletproofs and Mimblewimble</td><td align="center"><div class="wrap_int"><a href="preface/learning//cryptography/bulletproofs-and-mimblewimble/MainReport.html">report</a></div></td></tr>
<tr><td>Building on Bulletproofs</td><td align="center"><div class="wrap_int"><a href="preface/learning//cryptography/building-on-bulletproofs/link.html">report</a></div></td></tr>
<tr><td>The Bulletproof Protocols</td><td align="center"><div class="wrap_adv"><a href="preface/learning//cryptography/bulletproofs-protocols/MainReport.html">report</a></div></td></tr>
<tr><td>Mimblewimble Multiparty Bulletproof UTXO</td><td align="center"><div class="wrap_adv"><a href="preface/learning//protocols/mimblewimble-mp-bp-utxo/MainReport.html">report</a></div></td></tr>
</tbody></table>
<h1><a class="header" href="#cryptography" id="cryptography">Cryptography</a></h1>
<h2><a class="header" href="#purpose" id="purpose">Purpose</a></h2>
<p>&quot;The purpose of cryptography is to protect data transmitted in the likely presence of an
adversary&quot; [<a href="http://www.informit.com/articles/article.aspx?p=170808" title="The Theory of Cryptography">1</a>].</p>
<h2><a class="header" href="#definitions" id="definitions">Definitions</a></h2>
<ul>
<li>
<p>From <strong>Wikipedia</strong>: Cryptography or cryptology (from Ancient 
Greek - κρυπτός, kryptós &quot;hidden, secret&quot;; and γράφειν graphein, &quot;to write&quot;, or -λογία -logia, &quot;study&quot;, respectively) is 
the practice and study of techniques for secure communication in the presence of third parties called adversaries. More 
generally, cryptography is about constructing and analyzing protocols that prevent third parties or the public from 
reading private messages; various aspects in information security such as data confidentiality, data integrity, 
authentication, and non-repudiation are central to modern cryptography [<a href="https://en.wikipedia.org/wiki/Cryptography" title="Cryptography">2</a>].</p>
</li>
<li>
<p>From <strong>SearchSecurity</strong>: Cryptography is a 
method of protecting information and communications through the use of codes so that only those for whom the information 
is intended can read and process it. The prefix &quot;crypt&quot; means &quot;hidden&quot; or &quot;vault&quot; and the suffix &quot;graphy&quot; stands for 
&quot;writing&quot; [<a href="https://searchsecurity.techtarget.com/definition/cryptography" title="Cryptography">3</a>].</p>
</li>
</ul>
<h2><a class="header" href="#references" id="references">References</a></h2>
<p>[<a href="http://www.informit.com/articles/article.aspx?p=170808" title="The Theory of Cryptography">1</a>] L. Koved, A. Nadalin, ‎N. Nagaratnam and M. Pistoia, &quot;The Theory of Cryptography&quot; [online], <em>informIT</em>. 
Available: <a href="http://www.informit.com/articles/article.aspx?p=170808">http://www.informit.com/articles/article.aspx?p=170808</a>. Date accessed: 2019‑06‑07.</p>
<p>[<a href="https://en.wikipedia.org/wiki/Cryptography" title="Cryptography">2</a>] Wikipedia: &quot;Cryptography&quot; [online]. Available: <a href="https://en.wikipedia.org/wiki/Cryptography">https://en.wikipedia.org/wiki/Cryptography</a>. Date accessed: 
2019‑06‑07.</p>
<p>[<a href="https://searchsecurity.techtarget.com/definition/cryptography" title="Cryptography">3</a>] SearchSecurity: &quot;Cryptography&quot;. Available: <a href="https://searchsecurity.techtarget.com/definition/cryptography">https://searchsecurity.techtarget.com/definition/cryptography</a>. 
Date accessed: 2019‑06‑07.</p>
<h1><a class="header" href="#elliptic-curves-101" id="elliptic-curves-101">Elliptic curves 101</a></h1>
<iframe width=750 height=600 src="https://gitpitch.com/tari-labs/tari-university/master?p=/src/cryptography/crypto-1#/"></iframe>
<h3><a class="header" href="#having-trouble-viewing-this-presentation" id="having-trouble-viewing-this-presentation">Having trouble viewing this presentation?</a></h3>
<p>View it in a <a href="https://gitpitch.com/tari-labs/tari-university/master?p=/src/cryptography/crypto-1#/">separate window</a>.</p>
<h1><a class="header" href="#introduction-to-schnorr-signatures" id="introduction-to-schnorr-signatures">Introduction to Schnorr Signatures</a></h1>
<ul>
<li><a href="cryptography/digital_signatures/introduction_schnorr_signatures.html#overview">Overview</a></li>
<li><a href="cryptography/digital_signatures/introduction_schnorr_signatures.html#lets-get-started">Let's get Started</a></li>
<li><a href="cryptography/digital_signatures/introduction_schnorr_signatures.html#basics-of-schnorr-signatures">Basics of Schnorr Signatures</a>
<ul>
<li><a href="cryptography/digital_signatures/introduction_schnorr_signatures.html#public-and-private-keys">Public and Private Keys</a></li>
<li><a href="cryptography/digital_signatures/introduction_schnorr_signatures.html#creating-a-signature">Creating a Signature</a>
<ul>
<li><a href="cryptography/digital_signatures/introduction_schnorr_signatures.html#approach-taken">Approach Taken</a></li>
<li><a href="cryptography/digital_signatures/introduction_schnorr_signatures.html#why-do-we-need-the-nonce">Why do we Need the Nonce?</a></li>
<li><a href="cryptography/digital_signatures/introduction_schnorr_signatures.html#ecdh">ECDH</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="cryptography/digital_signatures/introduction_schnorr_signatures.html#schnorr-signatures">Schnorr Signatures</a>
<ul>
<li><a href="cryptography/digital_signatures/introduction_schnorr_signatures.html#so-why-all-the-fuss">So why all the Fuss?</a></li>
<li><a href="cryptography/digital_signatures/introduction_schnorr_signatures.html#na%C3%AFve-signature-aggregation">(Naïve) Signature Aggregation</a></li>
<li><a href="cryptography/digital_signatures/introduction_schnorr_signatures.html#key-cancellation-attack">Key Cancellation Attack</a></li>
<li><a href="cryptography/digital_signatures/introduction_schnorr_signatures.html#better-approaches-to-aggregation">Better Approaches to Aggregation</a></li>
</ul>
</li>
<li><a href="cryptography/digital_signatures/introduction_schnorr_signatures.html#musig">MuSig</a>
<ul>
<li><a href="cryptography/digital_signatures/introduction_schnorr_signatures.html#musig-demonstration">MuSig Demonstration</a></li>
<li><a href="cryptography/digital_signatures/introduction_schnorr_signatures.html#security-demonstration">Security Demonstration</a></li>
<li><a href="cryptography/digital_signatures/introduction_schnorr_signatures.html#replay-attacks">Replay Attacks!</a></li>
</ul>
</li>
<li><a href="cryptography/digital_signatures/introduction_schnorr_signatures.html#references">References</a></li>
<li><a href="cryptography/digital_signatures/introduction_schnorr_signatures.html#contributors">Contributors</a></li>
</ul>
<h2><a class="header" href="#overview" id="overview">Overview</a></h2>
<p>Private-public key pairs are the cornerstone of much of the
cryptographic security underlying everything from secure web browsing to banking to cryptocurrencies. Private-public key pairs
are <em>asymmetric</em>. This means that given one of the numbers (the private key), it's possible to derive the other one 
(the public key). However, doing the reverse is not feasible. 
It's this asymmetry that allows one to share the public key, uh, publicly and be confident that no one can
figure out our private key (which we keep very secret and secure).</p>
<p>Asymmetric key pairs are employed in two main applications:</p>
<ul>
<li>in <em>authentication</em>, where you prove that you have knowledge of the private
key; and</li>
<li>in <em>encryption</em>, where messages can be encoded and only the person possessing the private key can decrypt and read the message.</li>
</ul>
<p>In this introduction to digital signatures, we'll be talking about a particular class of keys: those derived from 
elliptic curves. There are other asymmetric schemes, not least of which are those based on products of prime numbers, 
including RSA keys [<a href="https://en.wikipedia.org/wiki/RSA_(cryptosystem)" title="Wikipedia RSA Cryptography">1</a>].</p>
<p>We're going to assume you know the basics of elliptic curve cryptography (ECC). If not, don't stress, there's a
<a href="cryptography/digital_signatures/../crypto-1/sources/PITCHME.link.html">gentle introduction</a> in a previous chapter.</p>
<h2><a class="header" href="#lets-get-started" id="lets-get-started">Let's get Started</a></h2>
<p>This is an interactive introduction to digital signatures. It uses Rust code to demonstrate some of 
the ideas presented here, so you can see them at work. The code for this introduction uses the 
<a href="https://github.com/tari-labs/libsecp256k1">libsecp256k-rs</a> library. </p>
<p>That's a mouthful, but secp256k1 is the name of the elliptic curve that secures a <em>lot</em> of things in many
cryptocurrencies' transactions, including Bitcoin. </p>
<p>This particular library has some nice features. We've overridden the <code>+</code> (addition) and <code>*</code> (multiplication)
operators so that the Rust code looks a lot more like mathematical formulae. This makes it much easier
to play with the ideas we'll be exploring.</p>
<p><strong>WARNING!</strong> <em>Don't use this library in production code</em>. It hasn't been battle-hardened, so <a href="https://github.com/rust-bitcoin/rust-secp256k1">use this one in
production instead</a>.</p>
<h2><a class="header" href="#basics-of-schnorr-signatures" id="basics-of-schnorr-signatures">Basics of Schnorr Signatures</a></h2>
<h3><a class="header" href="#public-and-private-keys" id="public-and-private-keys">Public and Private Keys</a></h3>
<p>The first thing we'll do is create a public and private key from an elliptic curve.</p>
<p>On secp256k1, a private key is simply a scalar integer value between 0 and ~2<sup>256</sup>. That's roughly how many
atoms there are in the universe, so we have a big sandbox to play in.</p>
<p>We have a special point on the secp256k1 curve called <em>G</em>, which acts as the &quot;origin&quot;. A public key is calculated by 
adding <em>G</em> on the curve to itself, \( k_a \) times. This is the definition of multiplication by a scalar, and is
written as:
$$
P_a = k_a G
$$
Let's take an example from <a href="https://chuckbatson.wordpress.com/2014/11/26/secp256k1-test-vectors/">this post</a>, where
it is known that the public key for <code>1</code>, when written in uncompressed format, is <code>0479BE667...C47D08FFB10D4B8</code>.
The following code snippet demonstrates this:</p>
<pre><pre class="playpen"><code class="language-rust">extern crate libsecp256k1_rs;

use libsecp256k1_rs::{ SecretKey, PublicKey };

#[allow(non_snake_case)]
fn main() {
    // Create the secret key &quot;1&quot;
    let k = SecretKey::from_hex(&quot;0000000000000000000000000000000000000000000000000000000000000001&quot;).unwrap();
    // Generate the public key, P = k.G
    let pub_from_k = PublicKey::from_secret_key(&amp;k);
    let known_pub = PublicKey::from_hex(&quot;0479BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8&quot;).unwrap();
    // Compare it to the known value
    assert_eq!(pub_from_k, known_pub);
    println!(&quot;Ok&quot;)
}

</code></pre></pre>
<h3><a class="header" href="#creating-a-signature" id="creating-a-signature">Creating a Signature</a></h3>
<h4><a class="header" href="#approach-taken" id="approach-taken">Approach Taken</a></h4>
<p>Reversing ECC math multiplication (i.e. division) is pretty much infeasible when using properly chosen random values for your scalars ([<a href="https://stackoverflow.com/questions/2449594/how-does-a-cryptographically-secure-random-number-generator-work" title="StackOverflow: How does a Cryptographically Secure Random Number Generator Work?">5</a>],[<a href="https://en.wikipedia.org/wiki/Cryptographically_secure_pseudorandom_number_generator" title="Cryptographically Secure Pseudorandom Number Generator">6</a>]).
This property is called the <em>Discrete Log Problem</em>, and is used as the principle behind many cryptography and digital signatures. 
A valid digital signature is evidence that the person providing the signature knows the private key corresponding to the public key with which the message
is associated, or that they have solved the Discrete Log Problem. </p>
<p>The approach to creating signatures always follows this recipe:</p>
<ol>
<li>Generate a secret once-off number (called a <em>nonce</em>), $r$.</li>
<li>Create a public key, $R$ from $r$ (where $R = r.G$).</li>
<li>Send the following to Bob, your recipient - your message ($m$), $R$, and your public key ($P = k.G$).</li>
</ol>
<p>The actual signature is created by hashing the combination of all the public information above to create a <em>challenge</em>, $e$:
$$
e = H(R || P || m)
$$
The hashing function is chosen so that <em>e</em> has the same range as your private keys. In our case, we want something that
returns a 256-bit number, so SHA256 is a good choice.</p>
<p>Now the signature is constructed using your private information:
$$
s = r + ke 
$$
Bob can now also calculate $e$, since he already knows $m, R, P$. But he doesn't know your private key, or nonce.</p>
<p><strong>Note:</strong> When you construct the signature like this, it's known as a <a href="cryptography/digital_signatures/introduction_schnorr_signatures.html#schnorr-signatures">Schnorr signature</a>, which is discussed in 
a following section. There are other ways of constructing $s$, such as ECDSA [<a href="https://en.wikipedia.org/wiki/Elliptic_Curve_Digital_Signature_Algorithm" title="Wikipedia: ECDSA">2</a>], which is used in Bitcoin.</p>
<p>But see this:</p>
<p>$$ sG = (r + ke)G $$</p>
<p>Multiply out the right-hand side:</p>
<p>$$ sG = rG + (kG)e ​$$</p>
<p>Substitute \(R = rG \) and \(P = kG \) and we have:
$$ sG = R + Pe ​$$</p>
<p>So Bob must just calculate the public key corresponding to the signature $\text{(}s.G\text{)}$ and check that it equals the right-hand side of the last
equation above $\text{(}R + P.e\text{)}$, all of which Bob already knows.</p>
<h4><a class="header" href="#why-do-we-need-the-nonce" id="why-do-we-need-the-nonce">Why do we Need the Nonce?</a></h4>
<p>Why do we need a nonce in the standard signature?</p>
<p>Let's say we naïvely sign a message $m$ with
$$
e = H(P || m)
$$
and then the signature would be \(s = ek \). </p>
<p>Now as before, we can check that the signature is valid:
$$
\begin{align}
sG &amp;= ekG \\
&amp;= e(kG) = eP
\end{align}
$$
So far so good. But anyone can read your private key now because $s$ is a scalar, so \(k = {s}/{e} \)
is not hard to do.
With the nonce you have to solve \( k = (s - r)/e \), but $r$ is unknown, so this is not a feasible calculation as long
as $r$ has been chosen randomly.</p>
<p>We can show that leaving off the nonce is indeed highly insecure:</p>
<pre><pre class="playpen"><code class="language-rust">extern crate libsecp256k1_rs as secp256k1;

use secp256k1::{SecretKey, PublicKey, thread_rng, Message};
use secp256k1::schnorr::{ Challenge};

#[allow(non_snake_case)]
fn main() {
    // Create a random private key
    let mut rng = thread_rng();
    let k = SecretKey::random(&amp;mut rng);
    println!(&quot;My private key: {}&quot;, k);
    let P = PublicKey::from_secret_key(&amp;k);
    let m = Message::hash(b&quot;Meet me at 12&quot;).unwrap();
    // Challenge, e = H(P || m)
    let e = Challenge::new(&amp;[&amp;P, &amp;m]).as_scalar().unwrap();

    // Signature
    let s = e * k;

    // Verify the signature
    assert_eq!(PublicKey::from_secret_key(&amp;s), e*P);
    println!(&quot;Signature is valid!&quot;);
    // But let's try calculate the private key from known information
    let hacked = s * e.inv();
    assert_eq!(k, hacked);
    println!(&quot;Hacked key:     {}&quot;, k)
}

</code></pre></pre>
<h4><a class="header" href="#ecdh" id="ecdh">ECDH</a></h4>
<p>How do parties that want to communicate securely generate a shared secret for encrypting messages? One way is called
the Elliptic Curve Diffie-Hellman exchange (ECDH), which is a simple method for doing just this.</p>
<p>ECDH is used in many places, including the Lightning Network during channel negotiation [<a href="https://github.com/lightningnetwork/lightning-rfc/blob/master/08-transport.md" title="BOLT #8: Encrypted and Authenticated Transport">3</a>].</p>
<p>Here's how it works. Alice and Bob want to communicate securely. A simple way to do this is to use each other's public keys and
calculate
$$
\begin{align}
S_a &amp;= k_a P_b \tag{Alice} \\
S_b &amp;= k_b P_a \tag{Bob} \\
\implies S_a = k_a k_b G &amp;\equiv S_b = k_b k_a G
\end{align}
$$</p>
<pre><pre class="playpen"><code class="language-rust">extern crate libsecp256k1_rs as secp256k1;

use secp256k1::{ SecretKey, PublicKey, thread_rng, Message };

#[allow(non_snake_case)]
fn main() {
    let mut rng = thread_rng();
    // Alice creates a public-private keypair
    let k_a = SecretKey::random(&amp;mut rng);
    let P_a = PublicKey::from_secret_key(&amp;k_a);
    // Bob creates a public-private keypair
    let k_b = SecretKey::random(&amp;mut rng);
    let P_b = PublicKey::from_secret_key(&amp;k_b);
    // They each calculate the shared secret based only on the other party's public information
    // Alice's version:
    let S_a = k_a * P_b;
    // Bob's version:
    let S_b = k_b * P_a;

    assert_eq!(S_a, S_b, &quot;The shared secret is not the same!&quot;);
    println!(&quot;The shared secret is identical&quot;)
}

</code></pre></pre>
<p>For security reasons, the private keys are usually chosen at random for each session (you'll see the term
<em>ephemeral</em> keys being used), but then we have the problem of not being sure the other party is who they say they
are (perhaps due to a man-in-the-middle attack [<a href="https://en.wikipedia.org/wiki/Man-in-the-middle_attack" title="Wikipedia: Man in the Middle Attack">4</a>]).</p>
<p>Various additional authentication steps can be employed to resolve this problem, which we won't get into here. </p>
<h2><a class="header" href="#schnorr-signatures" id="schnorr-signatures">Schnorr Signatures</a></h2>
<p>If you follow the crypto news, you'll know that that the new hotness in Bitcoin is Schnorr Signatures.</p>
<p align="center"><img src="cryptography/digital_signatures/./img/schnorr-meme.jpg" width="600" /></p>
<p>But in fact, they're old news! The Schnorr signature is considered the simplest digital signature scheme 
to be provably secure in a random oracle model. It is efficient and generates short signatures. 
It was covered by U.S. Patent 4,995,082, which expired in February 2008 [<a href="https://en.wikipedia.org/wiki/Schnorr_signature" title="Wikipedia: Schnorr Signature">7</a>].</p>
<h3><a class="header" href="#so-why-all-the-fuss" id="so-why-all-the-fuss">So why all the Fuss?</a></h3>
<p>What makes Schnorr signatures so interesting and <a href="cryptography/digital_signatures/introduction_schnorr_signatures.html#key-cancellation-attack">potentially dangerous</a>, is their simplicity. 
Schnorr signatures are <em>linear</em>, so you have some nice properties.</p>
<p>Elliptic curves have the multiplicative property. So if you have two scalars $x, y$ with corresponding points $X, Y$, 
the following holds:
$$
(x + y)G = xG + yG = X + Y 
$$
Schnorr signatures are of the form \( s = r + e.k \). This construction is linear too, so it fits nicely with
the linearity of elliptic curve math.</p>
<p>You saw this property in a <a href="cryptography/digital_signatures/introduction_schnorr_signatures.html#creating-a-signature">previous section</a>, when we were verifying the signature. Schnorr signatures' linearity 
makes it very attractive for, among others:</p>
<ul>
<li>signature aggregation;</li>
<li><a href="cryptography/digital_signatures/../../protocols/atomic-swaps/AtomicSwaps.html">atomic swaps</a>;</li>
<li><a href="cryptography/digital_signatures/../scriptless-scripts/introduction-to-scriptless-scripts.html">&quot;scriptless&quot; scripts</a>.</li>
</ul>
<h3><a class="header" href="#naïve-signature-aggregation" id="naïve-signature-aggregation">Naïve Signature Aggregation</a></h3>
<p>Let's see how the linearity property of Schnorr signatures can be used to construct a two-of-two multi-signature.</p>
<p>Alice and Bob want to cosign something (a Tari transaction, say) without having to trust each other; 
i.e. they need to be able to prove ownership of their respective keys, and the aggregate signature is
only valid if <em>both</em> Alice and Bob provide their part of the signature. </p>
<p>Assuming private keys are denoted \( k_i \) and public keys \( P_i \). If we ask Alice and Bob to each 
supply a nonce, we can try:
$$
\begin{align}
P_{agg} &amp;= P_a + P_b \\
e &amp;= H(R_a || R_b || P_a || P_b || m) \\
s_{agg} &amp;= r_a + r_b + (k_a + k_b)e \\
&amp;= (r_a + k_ae) + (r_b + k_ae) \\
&amp;= s_a + s_b
\end{align}
$$
So it looks like Alice and Bob can supply their own $R$, and anyone can construct the two-of-two signature 
from the sum of the $Rs$ and public keys. This does work:</p>
<pre><pre class="playpen"><code class="language-rust">extern crate libsecp256k1_rs as secp256k1;

use secp256k1::{SecretKey, PublicKey, thread_rng, Message};
use secp256k1::schnorr::{Schnorr, Challenge};

#[allow(non_snake_case)]
fn main() {
    // Alice generates some keys
    let (ka, Pa, ra, Ra) = get_keyset();
    // Bob generates some keys
    let (kb, Pb, rb, Rb) = get_keyset();
    let m = Message::hash(b&quot;a multisig transaction&quot;).unwrap();
    // The challenge uses both nonce public keys and private keys
    // e = H(Ra || Rb || Pa || Pb || H(m))
    let e = Challenge::new(&amp;[&amp;Ra, &amp;Rb, &amp;Pa, &amp;Pb, &amp;m]).as_scalar().unwrap();
    // Alice calculates her signature
    let sa = ra + ka * e;
    // Bob calculates his signature
    let sb = rb + kb * e;
    // Calculate the aggregate signature
    let s_agg = sa + sb;
    // S = s_agg.G
    let S = PublicKey::from_secret_key(&amp;s_agg);
    // This should equal Ra + Rb + e(Pa + Pb)
    assert_eq!(S, Ra + Rb + e*(Pa + Pb));
    println!(&quot;The aggregate signature is valid!&quot;)
}

#[allow(non_snake_case)]
fn get_keyset() -&gt; (SecretKey, PublicKey, SecretKey, PublicKey) {
    let mut rng = thread_rng();
    let k = SecretKey::random(&amp;mut rng);
    let P = PublicKey::from_secret_key(&amp;k);
    let r = SecretKey::random(&amp;mut rng);
    let R = PublicKey::from_secret_key(&amp;r);
    (k, P, r, R)
}

</code></pre></pre>
<p>But this scheme is not secure!</p>
<h3><a class="header" href="#key-cancellation-attack" id="key-cancellation-attack">Key Cancellation Attack</a></h3>
<p>Let's take the previous scenario again, but this time, Bob knows Alice's public key and nonce ahead of time, by
waiting until she reveals them. </p>
<p>Now Bob lies and says that his public key is \( P_b' = P_b - P_a \) and public nonce is \( R_b' = R_b - R_a \).</p>
<p>Note that Bob doesn't know the private keys for these faked values, but that doesn't matter.</p>
<p>Everyone assumes that \(s_{agg} = R_a + R_b' + e(P_a + P_b') \) as per the aggregation scheme.</p>
<p>But Bob can create this signature himself: 
$$
\begin{align}
s_{agg}G &amp;= R_a + R_b' + e(P_a + P_b') \\
&amp;= R_a + (R_b - R_a) + e(P_a + P_b - P_a) \\
&amp;= R_b + eP_b \\
&amp;= r_bG + ek_bG \\
\therefore s_{agg} &amp;= r_b + ek_b = s_b
\end{align}
$$</p>
<pre><pre class="playpen"><code class="language-rust">extern crate libsecp256k1_rs as secp256k1;

use secp256k1::{SecretKey, PublicKey, thread_rng, Message};
use secp256k1::schnorr::{Schnorr, Challenge};

#[allow(non_snake_case)]
fn main() {
    // Alice generates some keys
    let (ka, Pa, ra, Ra) = get_keyset();
    // Bob generates some keys as before
    let (kb, Pb, rb, Rb) = get_keyset();
    // ..and then publishes his forged keys
    let Pf = Pb - Pa;
    let Rf = Rb - Ra;

    let m = Message::hash(b&quot;a multisig transaction&quot;).unwrap();
    // The challenge uses both nonce public keys and private keys
    // e = H(Ra || Rb' || Pa || Pb' || H(m))
    let e = Challenge::new(&amp;[&amp;Ra, &amp;Rf, &amp;Pa, &amp;Pf, &amp;m]).as_scalar().unwrap();

    // Bob creates a forged signature
    let s_f = rb + e * kb;
    // Check if it's valid
    let sG = Ra + Rf + e*(Pa + Pf);
    assert_eq!(sG, PublicKey::from_secret_key(&amp;s_f));
    println!(&quot;Bob successfully forged the aggregate signature!&quot;)
}

#[allow(non_snake_case)]
fn get_keyset() -&gt; (SecretKey, PublicKey, SecretKey, PublicKey) {
    let mut rng = thread_rng();
    let k = SecretKey::random(&amp;mut rng);
    let P = PublicKey::from_secret_key(&amp;k);
    let r = SecretKey::random(&amp;mut rng);
    let R = PublicKey::from_secret_key(&amp;r);
    (k, P, r, R)
}

</code></pre></pre>
<h3><a class="header" href="#better-approaches-to-aggregation" id="better-approaches-to-aggregation">Better Approaches to Aggregation</a></h3>
<p>In the <a href="cryptography/digital_signatures/introduction_schnorr_signatures.html#key-cancellation-attack">Key Cancellation Attack</a>, Bob didn't know the private keys for his published $R$ and $P$ values. We could defeat Bob
by asking him to sign a message proving that he <em>does</em> know the private keys.</p>
<p>This works, but it requires another round of messaging between parties, which is not conducive to a great user experience.</p>
<p>A better approach would be one that incorporates one or more of the following features:</p>
<ul>
<li>It must be provably secure in the plain public-key model, without having to prove knowledge of secret keys, as we might have asked Bob to do in the <a href="cryptography/digital_signatures/introduction_schnorr_signatures.html#na%C3%AFve-signature-aggregation">naïve</a> approach.</li>
<li>It should satisfy the normal Schnorr equation, i.e. the resulting signature can be verified with an expression of the form \( R + e X \).</li>
<li>It allows for Interactive Aggregate Signatures (IAS), where the signers are required to cooperate.</li>
<li>It allows for Non-interactive Aggregate Signatures (NAS), where the aggregation can be done by anyone.</li>
<li>It allows each signer to sign the same message, $m$.</li>
<li>It allows each signer to sign their own message, \( m_i \).</li>
</ul>
<h2><a class="header" href="#musig" id="musig">MuSig</a></h2>
<p>MuSig is a recently proposed ([<a href="https://blockstream.com/2018/01/23/musig-key-aggregation-schnorr-signatures.html" title="Blockstream: Key Aggregation for Schnorr Signatures">8</a>],[<a href="https://eprint.iacr.org/2018/068.pdf" title="Simple Schnorr Multi-signatures with Applications to Bitcoin">9</a>]) simple signature aggregation scheme that satisfies all of the properties in the preceding section.</p>
<h3><a class="header" href="#musig-demonstration" id="musig-demonstration">MuSig Demonstration</a></h3>
<p>We'll demonstrate the interactive MuSig scheme here, where each signatory signs the same message. 
The scheme works as follows:</p>
<ol>
<li>Each signer has a public-private key pair, as before.</li>
<li>Each signer shares a commitment to their public nonce (we'll skip this step in this demonstration). This step is
necessary to prevent certain kinds of rogue key attacks [<a href="https://eprint.iacr.org/2018/417.pdf" title="On the Security of Two-round Multi-signatures">10</a>].</li>
<li>Each signer publishes the public key of their nonce, \( R_i \).</li>
<li>Everyone calculates the same &quot;shared public key&quot;, $X$ as follows: </li>
</ol>
<p>$$
\begin{align}
\ell &amp;= H(X_1 || \dots || X_n) \\
a_i &amp;= H(\ell || X_i) \\
X &amp;= \sum a_i X_i \\
\end{align}
$$</p>
<p>Note that in the preceding ordering of public keys, some deterministic convention should be used, such as the lexicographical
order of the serialized keys.</p>
<ol>
<li>Everyone also calculates the shared nonce, \( R = \sum R_i \).</li>
<li>The challenge, $e$ is \( H(R || X || m) \).</li>
<li>Each signer provides their contribution to the signature as:</li>
</ol>
<p>$$
s_i = r_i + k_i a_i e
$$</p>
<p>Notice that the only departure here from a standard Schnorr signature is the inclusion of the factor \( a_i \).</p>
<p>The aggregate signature is the usual summation, \( s = \sum s_i \).</p>
<p>Verification is done by confirming that as usual:
$$
sG \equiv R + e X \
$$
Proof:
$$
\begin{align}
sG &amp;= \sum s_i G \\
&amp;= \sum (r_i + k_i a_i e)G \\
&amp;= \sum r_iG + k_iG a_i e \\
&amp;= \sum R_i + X_i a_i e \\
&amp;= \sum R_i + e \sum a_i X_i \\
&amp;= R + e X \\
\blacksquare
\end{align}
$$
Let's demonstrate this using a three-of-three multisig:</p>
<pre><pre class="playpen"><code class="language-rust">extern crate libsecp256k1_rs as secp256k1;

use secp256k1::{ SecretKey, PublicKey, thread_rng, Message };
use secp256k1::schnorr::{ Challenge };

#[allow(non_snake_case)]
fn main() {
    let (k1, X1, r1, R1) = get_keys();
    let (k2, X2, r2, R2) = get_keys();
    let (k3, X3, r3, R3) = get_keys();

    // I'm setting the order here. In general, they'll be sorted
    let l = Challenge::new(&amp;[&amp;X1, &amp;X2, &amp;X3]);
    // ai = H(l || p)
    let a1 = Challenge::new(&amp;[ &amp;l, &amp;X1 ]).as_scalar().unwrap();
    let a2 = Challenge::new(&amp;[ &amp;l, &amp;X2 ]).as_scalar().unwrap();
    let a3 = Challenge::new(&amp;[ &amp;l, &amp;X3 ]).as_scalar().unwrap();
    // X = sum( a_i X_i)
    let X = a1 * X1 + a2 * X2 + a3 * X3;

    let m = Message::hash(b&quot;SomeSharedMultiSigTx&quot;).unwrap();

    // Calc shared nonce
    let R = R1 + R2 + R3;

    // e = H(R || X || m)
    let e = Challenge::new(&amp;[&amp;R, &amp;X, &amp;m]).as_scalar().unwrap();


    // Signatures
    let s1 = r1 + k1 * a1 * e;
    let s2 = r2 + k2 * a2 * e;
    let s3 = r3 + k3 * a3 * e;
    let s = s1 + s2 + s3;

    //Verify
    let sg = PublicKey::from_secret_key(&amp;s);
    let check = R + e * X;
    assert_eq!(sg, check, &quot;The signature is INVALID&quot;);
    println!(&quot;The signature is correct!&quot;)
}

#[allow(non_snake_case)]
fn get_keys() -&gt; (SecretKey, PublicKey, SecretKey, PublicKey) {
    let mut rng = thread_rng();
    let k = SecretKey::random(&amp;mut rng);
    let P = PublicKey::from_secret_key(&amp;k);
    let r = SecretKey::random(&amp;mut rng);
    let R = PublicKey::from_secret_key(&amp;r);
    (k, P, r, R)
}
</code></pre></pre>
<h3><a class="header" href="#security-demonstration" id="security-demonstration">Security Demonstration</a></h3>
<p>As a final demonstration, let's show how MuSig defeats the cancellation attack from the <a href="cryptography/digital_signatures/introduction_schnorr_signatures.html#na%C3%AFve-signature-aggregation">naïve</a> signature scheme. 
Using the same idea as in the <a href="cryptography/digital_signatures/introduction_schnorr_signatures.html#key-cancellation-attack">Key Cancellation Attack</a> section, Bob has provided fake values for his
nonce and public keys:
$$
\begin{align}
R_f &amp;= R_b - R_a \\
X_f &amp;= X_b - X_a \\
\end{align}
$$
This leads to both Alice and Bob calculating the following &quot;shared&quot; values:
$$
\begin{align}
\ell &amp;= H(X_a || X_f) \\
a_a &amp;= H(\ell || X_a) \\
a_f &amp;= H(\ell || X_f) \\
X &amp;= a_a X_a + a_f X_f \\
R &amp;= R_a + R_f (= R_b) \\
e &amp;= H(R || X || m)
\end{align}
$$
Bob then tries to construct a unilateral signature following MuSig:
$$
s_b = r_b + k_s e
$$
Let's assume for now that \( k_s \) doesn't need to be Bob's private key, but that he can derive it using information
he knows. For this to be a valid signature, it must verify to \( R + eX \). So therefore:
$$
\begin{align}
s_b G          &amp;= R + eX \\
(r_b + k_s e)G &amp;= R_b + e(a_a X_a + a_f X_f) &amp; \text{The first term looks good so far}\\
&amp;= R_b + e(a_a X_a + a_f X_b - a_f X_a) \\
&amp;= (r_b + e a_a k_a + e a_f k_b - e a_f k_a)G &amp; \text{The r terms cancel as before} \\
k_s e &amp;=  e a_a k_a + e a_f k_b - e a_f k_a &amp; \text{But nothing else is going away}\\
k_s &amp;= a_a k_a + a_f k_b - a_f k_a \\<br />
\end{align}
$$
In the previous attack, Bob had all the information he needed on the right-hand side of the analogous calculation. In MuSig,
Bob must somehow know Alice's private key and the faked private key (the terms don't cancel anymore) in order to create a unilateral signature,
and so his cancellation attack is defeated.</p>
<h3><a class="header" href="#replay-attacks" id="replay-attacks">Replay Attacks!</a></h3>
<p>It's critical that a new nonce be chosen for every signing ceremony. The best way to do this is to make use of a
cryptographically secure (pseudo-)random number generator (CSPRNG).</p>
<p>But even if this is the case, let's say an attacker can trick us into signing a new message by &quot;rewinding&quot; the signing
ceremony to the point where partial signatures are generated. At this point, the attacker provides a different message,
\( e' = H(...||m') \) to sign. Not suspecting any foul play, each party calculates their partial signature:</p>
<p>$$ s'_i = r_i + a_i k_i e' $$
However, the attacker still has access to the first set of signatures: \( s_i = r_i + a_i k_i e \). He now simply
subtracts them:
$$
\begin{align}
s'_i - s_i &amp;= (r_i + a_i k_i e') - (r_i + a_i k_i e) \\
&amp;= a_i k_i (e' - e) \\
\therefore k_i &amp;= \frac{s'_i - s_i}{a_i(e' - e)}
\end{align}
$$
Everything on the right-hand side of the final equation is known by the attacker and thus he can trivially extract everybody's private key.
It's difficult to protect against this kind of attack. One way to is make it difficult (or impossible) to stop and
restart signing ceremonies. If a multi-sig ceremony gets interrupted, then you need to start from step one again. This
is fairly unergonomic, but until a more robust solution comes along, it may be the best we have!</p>
<h2><a class="header" href="#references-1" id="references-1">References</a></h2>
<p>[<a href="https://en.wikipedia.org/wiki/RSA_(cryptosystem)" title="Wikipedia RSA Cryptography">1</a>] Wikipedia: &quot;RSA (Cryptosystem)&quot; [online]. Available: <a href="https://en.wikipedia.org/wiki/RSA_(cryptosystem)">https://en.wikipedia.org/wiki/RSA_(cryptosystem)</a>. Date accessed: 
2018‑10‑11.</p>
<p>[<a href="https://en.wikipedia.org/wiki/Elliptic_Curve_Digital_Signature_Algorithm" title="Wikipedia: ECDSA">2</a>] Wikipedia: &quot;Elliptic Curve Digital Signature Algorithm&quot; [online]. Available: 
<a href="https://en.wikipedia.org/wiki/Elliptic_Curve_Digital_Signature_Algorithm">https://en.wikipedia.org/wiki/Elliptic_Curve_Digital_Signature_Algorithm</a>. Date accessed: 2018‑10‑11.</p>
<p>[<a href="https://github.com/lightningnetwork/lightning-rfc/blob/master/08-transport.md" title="BOLT #8: Encrypted and Authenticated Transport">3</a>] Github: &quot;BOLT #8: Encrypted and Authenticated Transport, Lightning RFC&quot; [online].<br />
Available: <a href="https://github.com/lightningnetwork/lightning-rfc/blob/master/08-transport.md">https://github.com/lightningnetwork/lightning-rfc/blob/master/08-transport.md</a>. Date accessed: 2018‑10‑11.</p>
<p>[<a href="https://en.wikipedia.org/wiki/Man-in-the-middle_attack" title="Wikipedia: Man in the Middle Attack">4</a>] Wikipedia: &quot;Man in the Middle Attack&quot; [online].
Available: <a href="https://en.wikipedia.org/wiki/Man-in-the-middle_attack">https://en.wikipedia.org/wiki/Man-in-the-middle_attack</a>. Date accessed: 2018‑10‑11.</p>
<p>[<a href="https://stackoverflow.com/questions/2449594/how-does-a-cryptographically-secure-random-number-generator-work" title="StackOverflow: How does a Cryptographically Secure Random Number Generator Work?">5</a>] StackOverflow: &quot;How does a Cryptographically Secure Random Number Generator Work?&quot; [online]. Available: 
<a href="https://stackoverflow.com/questions/2449594/how-does-a-cryptographically-secure-random-number-generator-work">https://stackoverflow.com/questions/2449594/how-does-a-cryptographically-secure-random-number-generator-work</a>. 
Date accessed: 2018‑10‑11.</p>
<p>[<a href="https://en.wikipedia.org/wiki/Cryptographically_secure_pseudorandom_number_generator" title="Cryptographically Secure Pseudorandom Number Generator">6</a>] Wikipedia: &quot;Cryptographically Secure Pseudorandom Number Generator&quot; [online]. Available: 
<a href="https://en.wikipedia.org/wiki/Cryptographically_secure_pseudorandom_number_generator">https://en.wikipedia.org/wiki/Cryptographically_secure_pseudorandom_number_generator</a>. Date accessed: 2018‑10‑11.</p>
<p>[<a href="https://en.wikipedia.org/wiki/Schnorr_signature" title="Wikipedia: Schnorr Signature">7</a>] Wikipedia: &quot;Schnorr Signature&quot; [online]. Available: <a href="https://en.wikipedia.org/wiki/Schnorr_signature">https://en.wikipedia.org/wiki/Schnorr_signature</a>.
Date accessed: 2018‑09‑19.</p>
<p>[<a href="https://blockstream.com/2018/01/23/musig-key-aggregation-schnorr-signatures.html" title="Blockstream: Key Aggregation for Schnorr Signatures">8</a>] Blockstream: &quot;Key Aggregation for Schnorr Signatures&quot; [online]. Available: 
<a href="https://blockstream.com/2018/01/23/musig-key-aggregation-schnorr-signatures.html">https://blockstream.com/2018/01/23/musig-key-aggregation-schnorr-signatures.html</a>. Date accessed: 2018‑09‑19.</p>
<p>[<a href="https://eprint.iacr.org/2018/068.pdf" title="Simple Schnorr Multi-signatures with Applications to Bitcoin">9</a>] G. Maxwell, A. Poelstra, Y. Seurin and P. Wuille, &quot;Simple Schnorr Multi-signatures with Applications to Bitcoin&quot; [online]. Available: <a href="https://eprint.iacr.org/2018/068.pdf">https://eprint.iacr.org/2018/068.pdf</a>. Date accessed: 2018‑09‑19.</p>
<p>[<a href="https://eprint.iacr.org/2018/417.pdf" title="On the Security of Two-round Multi-signatures">10</a>] M. Drijvers, K. Edalatnejad, B. Ford, E. Kiltz, J. Loss, G. Neven and I. Stepanovs, 
&quot;On the Security of Two-round Multi-signatures&quot;, Cryptology ePrint Archive, Report 2018/417 [online]. 
Available: <a href="https://eprint.iacr.org/2018/417.pdf">https://eprint.iacr.org/2018/417.pdf</a>. Date accessed: 2019‑02‑21.</p>
<h2><a class="header" href="#contributors" id="contributors">Contributors</a></h2>
<ul>
<li><a href="https://github.com/CjS77">https://github.com/CjS77</a></li>
<li><a href="https://github.com/SWvHeerden">https://github.com/SWvHeerden</a></li>
<li><a href="https://github.com/hansieodendaal">https://github.com/hansieodendaal</a></li>
<li><a href="https://github.com/neonknight64">https://github.com/neonknight64</a></li>
<li><a href="https://github.com/anselld">https://github.com/anselld</a></li>
</ul>
<h1><a class="header" href="#introduction-to-scriptless-scripts" id="introduction-to-scriptless-scripts">Introduction to Scriptless Scripts</a></h1>
<ul>
<li><a href="cryptography/scriptless-scripts/introduction-to-scriptless-scripts.html#definition-of-scriptless-scripts">Definition of Scriptless Scripts</a> </li>
<li><a href="cryptography/scriptless-scripts/introduction-to-scriptless-scripts.html#benefits-of-scriptless-scripts">Benefits of Scriptless Scripts</a></li>
<li><a href="cryptography/scriptless-scripts/introduction-to-scriptless-scripts.html#list-of-scriptless-scripts">List of Scriptless Scripts</a></li>
<li><a href="cryptography/scriptless-scripts/introduction-to-scriptless-scripts.html#role-of-schnorr-signatures">Role of Schnorr Signatures</a></li>
<li><a href="cryptography/scriptless-scripts/introduction-to-scriptless-scripts.html#schnorr-multi-signatures">Schnorr Multi-signatures</a></li>
<li><a href="cryptography/scriptless-scripts/introduction-to-scriptless-scripts.html#adaptor-signatures">Adaptor Signatures</a></li>
<li><a href="cryptography/scriptless-scripts/introduction-to-scriptless-scripts.html#simultaneous-scriptless-scripts">Simultaneous Scriptless Scripts</a>
<ul>
<li><a href="cryptography/scriptless-scripts/introduction-to-scriptless-scripts.html#preimages">Preimages</a></li>
<li><a href="cryptography/scriptless-scripts/introduction-to-scriptless-scripts.html#difference-of-two-schnorr-signatures">Difference of Two Schnorr Signatures</a></li>
</ul>
</li>
<li><a href="cryptography/scriptless-scripts/introduction-to-scriptless-scripts.html#atomic-cross-chain-swaps-example-with-adaptor-signatures">Atomic (Cross-chain Swaps) Example with Adaptor Signatures</a></li>
<li><a href="cryptography/scriptless-scripts/introduction-to-scriptless-scripts.html#zero-knowledge-contingent-payments">Zero Knowledge Contingent Payments</a></li>
<li><a href="cryptography/scriptless-scripts/introduction-to-scriptless-scripts.html#mimblewimbles-core-scriptless-script">Mimblewimble's Core Scriptless Script</a></li>
<li><a href="cryptography/scriptless-scripts/introduction-to-scriptless-scripts.html#references">References</a></li>
<li><a href="cryptography/scriptless-scripts/introduction-to-scriptless-scripts.html#contributors">Contributors</a></li>
</ul>
<h2><a class="header" href="#definition-of-scriptless-scripts" id="definition-of-scriptless-scripts">Definition of Scriptless Scripts</a></h2>
<p>Scriptless Scripts are a means to execute smart contracts off-chain, through the use of Schnorr signatures [<a href="https://medium.com/blockchain-capital/crypto-innovation-spotlight-2-scriptless-scripts-306c4eb6b3a8" title="Crypto Innovation Spotlight 2: Scriptless Scripts">1</a>].</p>
<p>The concept of Scriptless Scripts was born from Mimblewimble, which is a blockchain design that with the exception of 
kernels and their signatures, does not store permanent data. Fundamental properties of Mimblewimble 
include both privacy and scaling, both of which require the implementation of Scriptless Scripts [<a href="https://www.youtube.com/watch?v=ovCBT1gyk9c&amp;t=0s" title="Mimblewimble and Scriptless Scripts">2</a>].</p>
<p>A brief introduction is also given in 
<a href="cryptography/scriptless-scripts/../../scaling/layer2scaling-landscape/layer2scaling-survey.html#a5-scriptless-scripts">Scriptless Scripts, Layer 2 Scaling Survey</a>. </p>
<h2><a class="header" href="#benefits-of-scriptless-scripts" id="benefits-of-scriptless-scripts">Benefits of Scriptless Scripts</a></h2>
<p>The benefits of Scriptless Scripts are functionality, privacy and efficiency. </p>
<h3><a class="header" href="#functionality" id="functionality">Functionality</a></h3>
<p>With regard to functionality, Scriptless Scripts are said to increase the range and complexity of smart contracts. 
Currently, as within Bitcoin Script, limitations stem from the number of <code>OP_CODES</code> that have been enabled by the 
network. Scriptless Scripts move the specification and execution of smart contracts from the network to a discussion
that only involves the participants of the smart contract. </p>
<h3><a class="header" href="#privacy" id="privacy">Privacy</a></h3>
<p>With regard to privacy, moving the specification and execution of smart contracts from on-chain to off-chain increases 
privacy. When on-chain, many details of the smart contract are shared to the entire network. These details include the 
number and addresses of participants, and the amounts transferred. By moving smart contracts off-chain, the network only 
knows that the participants agree that the terms of their contract have been satisfied and that the transaction in 
question is valid. </p>
<h3><a class="header" href="#efficiency" id="efficiency">Efficiency</a></h3>
<p>With regard to efficiency, Scriptless Scripts minimize the amount of data that requires verification and storage 
on-chain. By moving smart contracts off-chain, there are fewer overheads for full nodes and lower transaction fees for 
users [<a href="https://medium.com/blockchain-capital/crypto-innovation-spotlight-2-scriptless-scripts-306c4eb6b3a8" title="Crypto Innovation Spotlight 2: Scriptless Scripts">1</a>].</p>
<h2><a class="header" href="#list-of-scriptless-scripts" id="list-of-scriptless-scripts">List of Scriptless Scripts</a></h2>
<p>In this report, various forms of scripts will be covered, including [<a href="https://www.youtube.com/watch?v=jzoS0tPUAiQ&amp;t=3h36m" title="Scriptless Scripts">3</a>]: </p>
<ul>
<li>Simultaneous Scriptless Scripts</li>
<li>Adaptor Signatures </li>
<li>Zero Knowledge Contingent Payments</li>
</ul>
<h2><a class="header" href="#role-of-schnorr-signatures" id="role-of-schnorr-signatures">Role of Schnorr Signatures</a></h2>
<p>To begin with, the fundamentals of Schnorr signatures must be defined. The signer has a private key $x$ and random private 
nonce $r$. $G$ is the generator of a discrete log hard group, $R=rG$ is the public nonce and $P=xG$ is the public key [<a href="https://www.youtube.com/watch?v=0mVOq1jaR1U&amp;feature=youtu.be&amp;t=39m20" title="Mimblewimble and Scriptless Scripts">4</a>].</p>
<p>The signature, $s$, for message $m$,  can then be computed as a simple linear transaction</p>
<p>$$
s = r + e \cdot x
$$</p>
<p>where</p>
<p>$$
e=H(P||R||m) \text{, } P=xG
$$</p>
<p>The position on the line chosen is taken as the hash of all the data that one needs to commit to, the digital signature. 
The verification equation involves the multiplication of each of the terms in the equation by $G$ and takes into account 
the cryptographic assumption (discrete log) where $G$ can be multiplied in but not divided out, thus preventing 
deciphering. </p>
<p>$$
sG = rG + e \cdot xG
$$</p>
<p>Elliptic Curve Digital Signature Algorithm (ECDSA) signatures (used in Bitcoin) are not linear in $x$ and $r$, and are 
thus less useful [<a href="https://www.youtube.com/watch?v=ovCBT1gyk9c&amp;t=0s" title="Mimblewimble and Scriptless Scripts">2</a>]. </p>
<h2><a class="header" href="#schnorr-multi-signatures" id="schnorr-multi-signatures">Schnorr Multi-signatures</a></h2>
<p>A multi-signature (multisig) has multiple participants that produce a signature. Every participant might produce a 
separate signature and concatenate them, forming a multisig.</p>
<p>With Schnorr Signatures, one can have a single public key, which is the sum of many different people's public keys. The 
resulting key is one against which signatures will be verifiable [<a href="https://joinmarket.me/blog/blog/flipping-the-scriptless-script-on-schnorr/" title="Flipping the Scriptless Script on Schnorr">5</a>].</p>
<p>The formulation of a multisig involves taking the sum of all components; thus all nonces and $s$ values result in the 
formulation of a multisig [<a href="https://www.youtube.com/watch?v=0mVOq1jaR1U&amp;feature=youtu.be&amp;t=39m20" title="Mimblewimble and Scriptless Scripts">4</a>]:
$$
s=\sum s(i)
$$
It can therefore be seen that these signatures are essentially Scriptless Scripts. Independent public keys of several 
participants are joint to form a single key and signature, which, when published, do not divulge details of the 
number of participants involved or the original public keys. </p>
<h2><a class="header" href="#adaptor-signatures" id="adaptor-signatures">Adaptor Signatures</a></h2>
<p>This multisig protocol can be modified to produce an adaptor signature, which serves as the building block for all
Scriptless Script functions [<a href="https://joinmarket.me/blog/blog/flipping-the-scriptless-script-on-schnorr/" title="Flipping the Scriptless Script on Schnorr">5</a>]. </p>
<p>Instead of functioning as a full valid signature on a message with a key, an adaptor signature is a promise that a 
signature agreed to be published, will reveal a secret. </p>
<p>This concept is similar to that of atomic swaps. However, no scripts are implemented. Since this is elliptic curve 
cryptography, there is only scalar multiplication of elliptic curve points. Fortunately, similar to a hash function, 
elliptic curves function in one way, so an elliptic curve point ($T$), can simply be shared and the secret will be its 
corresponding private key.</p>
<p>If two parties are considered, rather than providing their nonce $R$ in the multisig protocol, a blinding factor, taken 
as an elliptic curve point $T$, is conceived and sent in addition to $R$ (i.e. $R+T$). It can therefore be seen that 
$R$ is not 
blinded; it has instead been offset by the secret value $T$. </p>
<p>Here, the Schnorr multisig construction is modified such that the first party generates
$$
T=tG, R=rG
$$
where $t$ is the shared secret, $G$ is the generator of discrete log hard group and $r$ is the random nonce. </p>
<p>Using this information, the second party generates 
$$
H(P||R+T||m)x
$$
where the coins to be swapped are contained within message $m$. The first party can now calculate the complete 
signature $s$ such that<br />
$$
s=r+t+H(P||R+T||m)x
$$
The first party then calculates and publishes the adaptor signature $s'$ to the second party (and anyone else listening)
$$
s'=s-t
$$
The second party can verify the adaptor signature $s'$ by asserting $s'G$
$$
s'G \overset{?}{=} R+H(P||R+T||m)P
$$
However, this is not a valid signature, as the hashed nonce point is $R+T$ and not $R$.</p>
<p>The second party cannot retrieve a valid signature from this and requires ECDLP solving to recover $s'+t$, which is 
virtually impossible. </p>
<p>After the first party broadcasts $s$ to claim the coins within message $m$, the second party can calculate the 
secret $t$ from 
$$
t=s-s'
$$
The above is very general. However, by attaching auxiliary proofs too, an adaptor signature can be derived that will 
allow the translation of correct movement of the auxiliary protocol into a valid signature. </p>
<h2><a class="header" href="#simultaneous-scriptless-scripts" id="simultaneous-scriptless-scripts">Simultaneous Scriptless Scripts</a></h2>
<h3><a class="header" href="#preimages" id="preimages">Preimages</a></h3>
<p>The execution of separate transactions in an atomic fashion is achieved through preimages. If two transactions require 
the preimage to the same hash, once one is executed, the preimage is exposed so that the other one can be as well. 
Atomic swaps and Lightning channels use this construction [<a href="https://www.youtube.com/watch?v=0mVOq1jaR1U&amp;feature=youtu.be&amp;t=39m20" title="Mimblewimble and Scriptless Scripts">4</a>].</p>
<h3><a class="header" href="#difference-of-two-schnorr-signatures" id="difference-of-two-schnorr-signatures">Difference of Two Schnorr Signatures</a></h3>
<p>If we consider the difference of two Schnorr signatures: 
$$
d=s-s'=k-k'+e \cdot x-e' \cdot x'
$$
The above equation can be verified in a similar manner to that of a single Schnorr signature, by multiplying each term 
by $G$ and confirming algebraic correctness: 
$$
dG=kG-k'G+e \cdot xG-e' \cdot x'G
$$
It must be noted that the difference $d$ is being verified, and not the Schnorr signature itself. $d$ functions as the 
translating key between two separate independent Schnorr signatures. Given $d$ and either $s$ or $s'$, the other can be 
computed. So possession of $d$ makes these two signatures atomic. This scheme does not link the two signatures or 
compromise their security. </p>
<p>For an atomic transaction, during the setup stage, someone provides the opposing party with the value $d$, and asserts 
it as the correct value. Once the transaction is signed, it can be adjusted to complete the other transaction. Atomicity 
is achieved, but can only be used by the person who possesses this $d$ value. Generally, the party that stands to lose 
money requires the $d$ value. </p>
<p>The $d$ value provides an interesting property with regard to atomicity. It is shared before signatures are public, 
which in turn allows the two transactions to be atomic once the transactions are published. By taking the difference of 
any two Schnorr signatures, one is able to construct transcripts, such as an atomic swap multisig contract. </p>
<p>This is a critical feature for Mimblewimble, which was previously thought to be unable to support atomic swaps or 
Lightning channels [<a href="https://www.youtube.com/watch?v=0mVOq1jaR1U&amp;feature=youtu.be&amp;t=39m20" title="Mimblewimble and Scriptless Scripts">4</a>].</p>
<h2><a class="header" href="#atomic-cross-chain-swaps-example-with-adaptor-signatures" id="atomic-cross-chain-swaps-example-with-adaptor-signatures">Atomic (Cross-chain Swaps) Example with Adaptor Signatures</a></h2>
<p>Alice has a certain number of coins on a particular blockchain; Bob also has a certain number of coins on another 
blockchain. Alice and Bob want to engage in an atomic exchange. However, neither blockchain is aware of the other, nor 
are they able to verify each other's transactions. </p>
<p>The  classical way of achieving this involves the use of the blockchain's script system to put a hash preimage challenge 
and then reveal the same preimage on both sides. Once Alice knows the preimage, she reveals it to take her coins. Bob 
then copies it off one chain to the other chain to take his coins. </p>
<p>Using adaptor signatures, the same result can be achieved through simpler means. In this case, both Alice and Bob put 
up their coins on two of two outputs on each blockchain. They sign the multisig protocols in parallel, where Bob then
gives Alice the adaptor signatures for each side using the same value $T$ . This means that for Bob to take his coins, 
he needs to reveal $t$; and for Alice to take her coins, she needs to reveal $T$. Bob then replaces one of the 
signatures and publishes $t$, taking his coins. Alice computes $t$  from the final signature, visible on the blockchain, 
and uses that to reveal another signature, giving Alice her coins. </p>
<p>Thus it can be seen that atomicity is achieved. One is still able to exchange information, but now there are no explicit 
hashes or preimages on the blockchain. No script properties are necessary and privacy is achieved [<a href="https://www.youtube.com/watch?v=0mVOq1jaR1U&amp;feature=youtu.be&amp;t=39m20" title="Mimblewimble and Scriptless Scripts">4</a>].</p>
<h2><a class="header" href="#zero-knowledge-contingent-payments" id="zero-knowledge-contingent-payments">Zero Knowledge Contingent Payments</a></h2>
<p>Zero Knowledge Contingent Payments (ZKCP) is a transaction protocol. This protocol allows a buyer to purchase 
information from a seller using coins in a manner that is private, scalable, secure and, importantly, in a trustless 
environment. The expected information is transferred only when  payment is made. The buyer and seller do not need to 
trust each other or depend on arbitration by a third party [<a href="https://bitcoincore.org/en/2016/02/26/zero-knowledge-contingent-payments-announcement/" title="The First Successful Zero-knowledge Contingent Payment, 26 Feb 2016">6</a>].</p>
<h2><a class="header" href="#mimblewimbles-core-scriptless-script" id="mimblewimbles-core-scriptless-script">Mimblewimble's Core Scriptless Script</a></h2>
<p>As previously stated, Mimblewimble is a blockchain design. Built similarly to Bitcoin, every transaction has inputs and 
outputs. Each input and output has a confidential transaction commitment. Confidential commitments have an interesting 
property where, in a valid balanced transaction, one can subtract the input from the output commitments, ensuring that 
all of the values of the Pedersen values balance out. Taking the difference of these inputs and outputs results in the 
multisig key of the owners of every output and every input in the transaction. This is referred to as the kernel.</p>
<p>Mimblewimble blocks will only have a list of new inputs, new outputs and signatures that are created 
from the aforementioned excess value [<a href="https://www.cryptocompare.com/coins/guides/what-is-mimblewimble/" title="What is Mimblewimble?">7</a>].</p>
<p>Since the values are homomorphically encrypted, nodes can verify that no coins are being created or destroyed. </p>
<h2><a class="header" href="#references-2" id="references-2">References</a></h2>
<p>[<a href="https://medium.com/blockchain-capital/crypto-innovation-spotlight-2-scriptless-scripts-306c4eb6b3a8" title="Crypto Innovation Spotlight 2: Scriptless Scripts">1</a>] &quot;Crypto Innovation Spotlight 2: Scriptless Scripts&quot; [online]. 
Available: <a href="https://medium.com/blockchain-capital/crypto-innovation-spotlight-2-scriptless-scripts-306c4eb6b3a8">https://medium.com/blockchain-capital/crypto-innovation-spotlight-2-scriptless-scripts-306c4eb6b3a8</a>. 
Date accessed: 2018‑02‑27. </p>
<p>[<a href="https://www.youtube.com/watch?v=ovCBT1gyk9c&amp;t=0s" title="Mimblewimble and Scriptless Scripts">2</a>] A. Poelstra, &quot;Mimblewimble and Scriptless Scripts&quot;. Presented at Real World Crypto, 2018 [online]. 
Available: <a href="https://www.youtube.com/watch?v=ovCBT1gyk9c&amp;t=0s">https://www.youtube.com/watch?v=ovCBT1gyk9c&amp;t=0s</a>. Date accessed: 2018‑01‑11. </p>
<p>[<a href="https://www.youtube.com/watch?v=jzoS0tPUAiQ&amp;t=3h36m" title="Scriptless Scripts">3</a>] A. Poelstra, &quot;Scriptless Scripts&quot;. Presented at Layer 2 Summit Hosted by MIT DCI and Fidelity Labs on 
18 May 2018 [online]. Available: <a href="https://www.youtube.com/watch?v=jzoS0tPUAiQ&amp;t=3h36m">https://www.youtube.com/watch?v=jzoS0tPUAiQ&amp;t=3h36m</a>. Date Accessed: 2018‑05‑25.</p>
<p>[<a href="https://www.youtube.com/watch?v=0mVOq1jaR1U&amp;feature=youtu.be&amp;t=39m20" title="Mimblewimble and Scriptless Scripts">4</a>] A. Poelstra, &quot;Mimblewimble and Scriptless Scripts&quot;. Presented at MIT Bitcoin Expo 2017 Day 1 [online]. 
Available: <a href="https://www.youtube.com/watch?v=0mVOq1jaR1U&amp;feature=youtu.be&amp;t=39m20">https://www.youtube.com/watch?v=0mVOq1jaR1U&amp;feature=youtu.be&amp;t=39m20</a>. Date accessed: 2017‑03‑04.</p>
<p>[<a href="https://joinmarket.me/blog/blog/flipping-the-scriptless-script-on-schnorr/" title="Flipping the Scriptless Script on Schnorr">5</a>] &quot;Flipping the Scriptless Script on Schnorr&quot; [online]. 
Available: <a href="https://joinmarket.me/blog/blog/flipping-the-scriptless-script-on-schnorr/">https://joinmarket.me/blog/blog/flipping-the-scriptless-script-on-schnorr/</a>. Date accessed: November 2017.</p>
<p>[<a href="https://bitcoincore.org/en/2016/02/26/zero-knowledge-contingent-payments-announcement/" title="The First Successful Zero-knowledge Contingent Payment, 26 Feb 2016">6</a>] &quot;The First Successful Zero-knowledge Contingent Payment&quot; [online]. 
Available: <a href="https://bitcoincore.org/en/2016/02/26/zero-knowledge-contingent-payments-announcement/">https://bitcoincore.org/en/2016/02/26/zero-knowledge-contingent-payments-announcement/</a>. Date accessed: 
2016‑02‑26.</p>
<p>[<a href="https://www.cryptocompare.com/coins/guides/what-is-mimblewimble/" title="What is Mimblewimble?">7</a>] &quot;What is Mimblewimble?&quot; [Online.]
Available: <a href="https://www.cryptocompare.com/coins/guides/what-is-mimblewimble/">https://www.cryptocompare.com/coins/guides/what-is-mimblewimble/</a>. Date accessed: 2018‑06‑30.</p>
<h2><a class="header" href="#contributors-1" id="contributors-1">Contributors</a></h2>
<ul>
<li><a href="https://github.com/kevoulee">https://github.com/kevoulee</a></li>
<li><a href="https://github.com/hansieodendaal">https://github.com/hansieodendaal</a></li>
<li><a href="https://github.com/anselld">https://github.com/anselld</a></li>
</ul>
<h1><a class="header" href="#the-musig-schnorr-signature-scheme" id="the-musig-schnorr-signature-scheme">The MuSig Schnorr Signature Scheme</a></h1>
<ul>
<li><a href="cryptography/musig-schnorr-sig-scheme/The_MuSig_Schnorr_Signature_Scheme.html#introduction">Introduction</a>
<ul>
<li><a href="cryptography/musig-schnorr-sig-scheme/The_MuSig_Schnorr_Signature_Scheme.html#schnorr-signatures-and-their-attack-vectors">Schnorr Signatures and their Attack Vectors</a></li>
<li><a href="cryptography/musig-schnorr-sig-scheme/The_MuSig_Schnorr_Signature_Scheme.html#musig">MuSig</a></li>
<li><a href="cryptography/musig-schnorr-sig-scheme/The_MuSig_Schnorr_Signature_Scheme.html#key-aggregation">Key Aggregation</a> </li>
</ul>
</li>
<li><a href="cryptography/musig-schnorr-sig-scheme/The_MuSig_Schnorr_Signature_Scheme.html#overview-of-multi-signatures">Overview of Multi-signatures</a>
<ul>
<li><a href="cryptography/musig-schnorr-sig-scheme/The_MuSig_Schnorr_Signature_Scheme.html#bitcoin--m-of-n--multi-signatures">Bitcoin $m-of-n$ Multi-signatures</a>
<ul>
<li><a href="cryptography/musig-schnorr-sig-scheme/The_MuSig_Schnorr_Signature_Scheme.html#what-are--m-of-n--transactions">What are $m-of-n$ Transactions?</a></li>
<li><a href="cryptography/musig-schnorr-sig-scheme/The_MuSig_Schnorr_Signature_Scheme.html#use-cases-for--m-of-n--multi-signatures">Use Cases for $m-of-n $ Multi-signatures</a></li>
</ul>
</li>
<li><a href="cryptography/musig-schnorr-sig-scheme/The_MuSig_Schnorr_Signature_Scheme.html#rogue-attacks">Rogue Attacks</a></li>
<li><a href="cryptography/musig-schnorr-sig-scheme/The_MuSig_Schnorr_Signature_Scheme.html#interactive-aggregate-signatures">Interactive Aggregate Signatures</a>
<ul>
<li><a href="cryptography/musig-schnorr-sig-scheme/The_MuSig_Schnorr_Signature_Scheme.html#applications-of-interactive-aggregate-signatures">Applications of Interactive Aggregate Signatures</a></li>
<li><a href="cryptography/musig-schnorr-sig-scheme/The_MuSig_Schnorr_Signature_Scheme.html#native-multi-signature-support">Native Multi-signature Support</a></li>
<li><a href="cryptography/musig-schnorr-sig-scheme/The_MuSig_Schnorr_Signature_Scheme.html#cross-input-multi-signatures">Cross-input Multi-signatures</a></li>
<li><a href="cryptography/musig-schnorr-sig-scheme/The_MuSig_Schnorr_Signature_Scheme.html#protection-against-rogue-key-attacks">Protection against Rogue-key Attacks</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="cryptography/musig-schnorr-sig-scheme/The_MuSig_Schnorr_Signature_Scheme.html#formation-of-musig">Formation of MuSig</a>
<ul>
<li><a href="cryptography/musig-schnorr-sig-scheme/The_MuSig_Schnorr_Signature_Scheme.html#notation-used">Notation Used</a></li>
<li><a href="cryptography/musig-schnorr-sig-scheme/The_MuSig_Schnorr_Signature_Scheme.html#recap-on-schnorr-signature-scheme">Recap on Schnorr Signature Scheme</a></li>
<li><a href="cryptography/musig-schnorr-sig-scheme/The_MuSig_Schnorr_Signature_Scheme.html#design-of-schnorr-multi-signature-scheme">Design of Schnorr Multi-signature Scheme</a></li>
<li><a href="cryptography/musig-schnorr-sig-scheme/The_MuSig_Schnorr_Signature_Scheme.html#bellare-and-neven-signature-scheme">Bellare and Neven Signature Scheme</a></li>
<li><a href="cryptography/musig-schnorr-sig-scheme/The_MuSig_Schnorr_Signature_Scheme.html#musig-signature-scheme">MuSig Signature Scheme</a></li>
<li><a href="cryptography/musig-schnorr-sig-scheme/The_MuSig_Schnorr_Signature_Scheme.html#revisions">Revisions</a> </li>
<li><a href="cryptography/musig-schnorr-sig-scheme/The_MuSig_Schnorr_Signature_Scheme.html#turning-bellare-and-nevens-scheme-into-an-ias-scheme">Turning Bellare and Neven's Scheme into an IAS Scheme</a></li>
</ul>
</li>
<li><a href="cryptography/musig-schnorr-sig-scheme/The_MuSig_Schnorr_Signature_Scheme.html#conclusions-observations-and-recommendations">Conclusions, Observations and Recommendations</a></li>
<li><a href="cryptography/musig-schnorr-sig-scheme/The_MuSig_Schnorr_Signature_Scheme.html#references">References</a></li>
<li><a href="cryptography/musig-schnorr-sig-scheme/The_MuSig_Schnorr_Signature_Scheme.html#contributors">Contributors</a></li>
</ul>
<h2><a class="header" href="#introduction-1" id="introduction-1">Introduction</a></h2>
<p>This report investigates Schnorr Multi-Signature Schemes (MuSig), which make use of key aggregation and are provably 
secure in the <em>plain public-key model</em>.</p>
<p>Signature aggregation involves mathematically combining several signatures into a single signature, without having to 
prove Knowledge of Secret Keys (KOSK). This is known as the <em>plain public-key model,</em> where the only requirement is that 
each potential signer has a public key. The KOSK scheme requires that users prove knowledge (or possession) of the 
secret key during public key registration with a certification authority. It is one way to generically prevent rogue-key 
attacks.</p>
<p>Multi-signatures are a form of technology used to add multiple participants to cryptocurrency transactions. A 
traditional multi-signature protocol allows a group of signers to produce a joint multi-signature on a common message.</p>
<h3><a class="header" href="#schnorr-signatures-and-their-attack-vectors" id="schnorr-signatures-and-their-attack-vectors">Schnorr Signatures and their Attack Vectors</a></h3>
<p>Schnorr signatures produce a smaller on-chain size, support faster validation and have better privacy. They natively 
allow for combining multiple signatures into one through aggregation, and they permit more complex spending policies.</p>
<p>Signature aggregation also has its challenges. This includes the rogue-key attack, where a participant steals funds 
using a specifically constructed key. Although this is easily solved for simple multi-signatures through an enrollment 
procedure that involves the keys signing themselves, supporting it across multiple inputs of a transaction requires 
<em>plain public-key security</em>, meaning there is no setup.</p>
<p>There is an additional attack, named the Russel attack, after Russel O'Connor, who discovered that for multiparty 
schemes, a party could claim ownership of someone else's private key and so spend the other outputs.</p>
<p>P. Wuille [<a href="https://blockstream.com/2018/01/23/musig-key-aggregation-schnorr-signatures/" title="Key Aggregation for Schnorr Signatures">1</a>] addressed some of these issues and provided a solution that refines the Bellare-Neven (BN) 
scheme. He also discussed the performance improvements that were implemented for the scaler multiplication of the BN 
scheme and how they enable batch validation on the blockchain [<a href="https://blockstream.com/2018/02/15/schnorr-signatures-bpase/" title="Schnorr Signatures for Bitcoin - BPASE '18">2</a>].</p>
<h3><a class="header" href="#musig-1" id="musig-1">MuSig</a></h3>
<p>Multi-signature protocols, introduced by [<a href="https://scinapse.io/papers/200023587/" title="A Public-key Cryptosystem Suitable for 
Digital Multisignatures">3</a>], allow a group of signers (that individually possess their own private/
public key pair) to produce a single signature $ \sigma $ on a message $ m $. Verification of the given signature 
$ \sigma $ can be publicly performed, given the message and the set of public keys of all signers.</p>
<p>A simple way to change a standard signature scheme into a multi-signature scheme is to have each signer produce a 
stand-alone signature for $ m $ with their private key, and to then concatenate all individual signatures.</p>
<p>The transformation of a standard signature scheme into a multi-signature scheme needs to be useful and practical. The 
newly calculated multi-signature scheme must therefore produce signatures where the size is independent of the number 
of signers and similar to that of the original signature scheme [<a href="https://eprint.iacr.org/2018/068.pdf" title="Simple Schnorr Multi-signatures 
with Applications to Bitcoin">4</a>].</p>
<p>A traditional multi-signature scheme is a combination of a signing and verification algorithm, where multiple signers 
(each with their own private/public key) jointly sign a single message, resulting in a combined signature. This can then 
be verified by anyone knowing the message and the public keys of the signers, where a trusted setup with KOSK is a 
requirement.</p>
<p>MuSig is a multi-signature scheme that is novel in combining:</p>
<ul>
<li>support for key aggregation; and</li>
<li>security in the <em>plain public-key model</em>.</li>
</ul>
<p>There are two versions of MuSig that are provably secure, and which differ based on the number of communication rounds:</p>
<ol>
<li>Three-round MuSig, which only relies on the Discrete Logarithm (DL) assumption, on which Elliptic Curve Digital 
Signature Algorithm (ECDSA) also relies.</li>
<li>Two-round MuSig, which instead relies on the slightly stronger One-More Discrete Logarithm (OMDL) assumption.</li>
</ol>
<h3><a class="header" href="#key-aggregation" id="key-aggregation">Key Aggregation</a></h3>
<p>The term <em>key aggregation</em> refers to multi-signatures that look like a single-key signature, but with respect to an 
aggregated public key that is a function of only the participants' public keys. Thus, verifiers do not require the 
knowledge of the original participants' public keys. They can just be given the aggregated key. In some use cases, this 
leads to better privacy and performance. Thus, MuSig is effectively a key aggregation scheme for Schnorr signatures.</p>
<p>To make the traditional approach more effective and without needing a trusted setup, a multi-signature scheme must 
provide sublinear signature aggregation, along with the following properties:</p>
<ul>
<li>It must be provably secure in the <em>plain public-key model</em>.</li>
<li>It must satisfy the normal Schnorr equation, whereby the resulting signature can be written as a function of a 
combination of the public keys.</li>
<li>It must allow for Interactive Aggregate Signatures (IAS), where the signers are required to cooperate.</li>
<li>It must allow for Non-interactive Aggregate Signatures (NAS). where the aggregation can be done by anyone.</li>
<li>It must allow each signer to sign the same message.</li>
<li>It must allow each signer to sign their own message.</li>
</ul>
<p>This is different to a normal multi-signature scheme, where one message is signed by all. MuSig potentially provides all 
of these properties.</p>
<p>Other multi-signature schemes that already exist, provide key aggregation for Schnorr signatures. However, they come 
with some limitations, such as needing to verify that participants actually have the private key corresponding to the 
pubic keys that they claim to have. <em>Security in the plain public-key model</em> means that no limitations exist. All that 
is needed from the participants is their public keys [<a href="https://blockstream.com/2018/01/23/musig-key-aggregation-schnorr-signatures/" title="Key Aggregation for Schnorr Signatures">1</a>].</p>
<h2><a class="header" href="#overview-of-multi-signatures" id="overview-of-multi-signatures">Overview of Multi-signatures</a></h2>
<p>Recently, the most obvious use case for multi-signatures is with regard to Bitcoin, where it can function as a more 
efficient replacement of $ n-of-n $ multisig scripts (where the signatures required to spend and the signatures possible 
are equal in quantity) and other policies that permit a number of possible combinations of keys.</p>
<p>A key aggregation scheme also lets one reduce the number of public keys per input to one, as a user can send coins to 
the aggregate of all involved keys rather than including them all in the script. This leads to a smaller on-chain 
footprint, faster validation and better privacy.</p>
<p>Instead of creating restrictions with one signature per input, one signature can be used for the entire transaction. 
Traditionally, key aggregation cannot be used across multiple inputs, as the public keys are committed to by the 
outputs, and those can be spent independently. MuSig can be used here, with key aggregation done by the verifier.</p>
<p>No non-interactive aggregation scheme is known that only relies on the DL assumption, but interactive schemes are 
trivial to construct where a multi-signature scheme has every participant sign the concatenation of all messages. 
Reference [<a href="https://eprint.iacr.org/2018/068.pdf" title="Simple Schnorr Multi-signatures 
with Applications to Bitcoin">4</a>], focused on key aggregation for Schnorr Signatures, showed that this is not always a desirable 
construction, and gave an IAS variant of BN with better properties instead [<a href="https://blockstream.com/2018/01/23/musig-key-aggregation-schnorr-signatures/" title="Key Aggregation for Schnorr Signatures">1</a>].</p>
<h3><a class="header" href="#bitcoin--m-of-n--multi-signatures" id="bitcoin--m-of-n--multi-signatures">Bitcoin $ m-of-n $ Multi-signatures</a></h3>
<h4><a class="header" href="#what-are--m-of-n--transactions" id="what-are--m-of-n--transactions">What are $ m-of-n $ Transactions?</a></h4>
<p>Currently, standard transactions on the Bitcoin network can be referred to as single-signature transactions, as they 
require only one signature, from the owner of the private key associated with the Bitcoin address. However, the Bitcoin 
network supports far more complicated transactions, which can require the signatures of multiple people before the 
funds can be transferred. These are often referred to as $ m-of-n $ transactions, where m represents the number of 
signatures required to spend, while n represents the number of signatures possible [<a href="https://wiki.bitcoin.com/w/Multisignature" title="Multisignature">5</a>].</p>
<h4><a class="header" href="#use-cases-for--m-of-n--multi-signatures" id="use-cases-for--m-of-n--multi-signatures">Use Cases for $ m-of-n $ Multi-signatures</a></h4>
<p>The use cases for $ m-of-n $ multi-signatures are as follows:</p>
<ul>
<li>
<p>When $ m=1 $ and $ n&gt;1 ​$, it is considered a <strong>shared wallet</strong>, which could be used for small group funds that do not 
require much security. This is the least secure multi-signature option, because it is not multifactor. Any compromised 
individual would jeopardize the entire group. Examples of use cases include funds for a weekend or evening event, or a 
shared wallet for some kind of game. Besides being convenient to spend from, the only benefit of this setup is that 
all   but one of the backup/password pairs could be lost and all of the funds would be recoverable.</p>
</li>
<li>
<p>When $ m=n $, it is considered a <strong>partner wallet</strong>, which brings with it some nervousness, as no keys can be lost. As 
the number of signatures required increases, the risk also increases. This type of multi-signature can be considered to 
be a hard multifactor authentication.</p>
</li>
<li>
<p>When $ m&lt;0.5n $, it is considered a <strong>buddy account</strong>, which could be used for spending from corporate group funds. The 
consequence for the colluding minority needs to be greater than possible benefits. It is considered less convenient 
than a shared wallet, but much more secure.</p>
</li>
<li>
<p>When $ m&gt;0.5n $, it is referred to as a <strong>consensus account</strong>. The classic multi-signature wallet is a two of three, 
and is a special case of a consensus account. A two of three scheme has the best characteristics for creating new 
Bitcoin addresses, and for secure storing and spending. One compromised signatory does not compromise the funds. A 
single secret key can be lost and the funds can still be recovered. If done correctly, off-site backups are created 
during wallet setup. The way to recover funds is known by more than one party. The balance of power with a 
multi-signature wallet can be shifted by having one party control more keys than the other parties. If one party 
controls multiple keys, there is a greater risk of those keys not remaining as multiple factors.</p>
</li>
<li>
<p>When $ m=0.5n $, it is referred to as a <strong>split account</strong>. This is an interesting use case, as there would be three of 
six, where one person holds three keys and three people hold one key. In this way, one person could control their own 
money, but the funds could still be recoverable, even if the primary key holder were to disappear with all of their keys. 
As $ n $ increases, the level of trust in the secondary parties can decrease. A good use case might be a family savings 
account that would automatically become an inheritance account if the primary account holder were to die [<a href="https://wiki.bitcoin.com/w/Multisignature" title="Multisignature">5</a>].</p>
</li>
</ul>
<h3><a class="header" href="#rogue-attacks" id="rogue-attacks">Rogue Attacks</a></h3>
<p>Refer to <a href="cryptography/musig-schnorr-sig-scheme/../digital_signatures/schnorr_signatures.html#key-cancellation-attack">Key cancellation attack</a> demonstration in 
<a href="cryptography/musig-schnorr-sig-scheme/../digital_signatures/introduction.html">Introduction to Schnorr Signatures</a>.</p>
<p>Rogue attacks are a significant concern when implementing multi-signature schemes. Here, a subset of corrupted signers 
manipulate the public keys computed as functions of the public keys of honest users, allowing them to easily produce 
forgeries for the set of public keys (despite them not knowing the associated secret keys).</p>
<p>Initial proposals from [<a href="https://link.springer.com/content/pdf/10.1007%2FBFb0053435.pdf" title="Threshold-multisignature Schemes 
where Suspected Forgery Implies 
Traceability of Adversarial Shareholders">10</a>], [<a href="https://ieeexplore.ieee.org/abstract/document/326780" title="Group-oriented (t, n) Threshold Digital Signature Scheme and Digital Multisignature">11</a>], [<a href="https://link.springer.com/content/pdf/10.1007%2F978-0-387-34873-5_11.pdf" title="Meta-Multisignature Schemes 
Based on the Discrete Logarithm Problem">12</a>], [<a href="https://link.springer.com/chapter/10.1007/3-540-57332-1_11" title="A Digital Multisignature Scheme 
Based on the Fiat-Shamir Scheme">13</a>], [<a href="https://link.springer.com/content/pdf/10.1007%2F3-540-68697-5_6.pdf" title="Weaknesses in Some Threshold Cryptosystem">14</a>], [<a href="https://pdfs.semanticscholar.org/d412/e5ab35fd397931cef0f8202324308f44e545.pdf" title="On the Risk of Disruption in 
Several Multiparty Signature Schemes">15</a>] and [<a href="http://search.ieice.org/bin/summary.php?id=e82-a_1_21&amp;category=A&amp;year=1999&amp;lang=E&amp;abst=" title="Multi-signature Schemes Secure 
Against Active Insider Attacks">16</a>] were thus undone before a formal model 
was put forward along with a provably secure scheme from [<a href="https://pdfs.semanticscholar.org/6bf4/f9450e7a8e31c106a8670b961de4735589cf.pdf" title="Accountable-subgroup Multisignatures">17</a>]. Unfortunately, despite being provably secure, their 
scheme is costly and an impractical interactive key generation protocol [<a href="https://eprint.iacr.org/2018/068.pdf" title="Simple Schnorr Multi-signatures 
with Applications to Bitcoin">4</a>].</p>
<p>A means of generically preventing rogue-key attacks is to make it mandatory for users to prove knowledge (or possession) 
of the secret key during public key registration with a certification authority [<a href="https://link.springer.com/content/pdf/10.1007%2F978-3-540-72540-4_13.pdf" title="The Power of Proofs-of-possession: 
Securing Multiparty Signatures 
Against Rogue-key Attacks">18</a>]. Certification authority is a 
setting known as the KOSK assumption. The pairing-based multi-signature schemes described in [<a href="https://www.iacr.org/archive/pkc2003/25670031/25670031.pdf" title="Threshold Signatures, Multisignatures 
and Blind Signatures Based on the 
Gap-Diffie-Hellman-Group Signature Scheme">19</a>] and 
[<a href="https://eprint.iacr.org/2006/096.pdf" title="Sequential Aggregate Signatures and 
Multisignatures without Random Oracles">20</a>] rely on the KOSK assumption in order to maintain security. However, according to [<a href="https://link.springer.com/content/pdf/10.1007%2F978-3-540-72540-4_13.pdf" title="The Power of Proofs-of-possession: 
Securing Multiparty Signatures 
Against Rogue-key Attacks">18</a>] and [<a href="https://cseweb.ucsd.edu/%7Emihir/papers/multisignatures-ccs.pdf" title="Multi-Signatures in the Plain 
Public-Key Modeland a General 
Forking Lemma">21</a>], 
the cost of complexity and expense of the scheme, and the unrealistic and burdensome assumptions on the Public-key 
Infrastructure (PKI), have made this solution problematic.</p>
<p>As it stands, [<a href="https://cseweb.ucsd.edu/%7Emihir/papers/multisignatures-ccs.pdf" title="Multi-Signatures in the Plain 
Public-Key Modeland a General 
Forking Lemma">21</a>] provides one of the most practical multi-signature schemes, based on the 
Schnorr signature scheme, which is provably secure and that does not contain any assumption on the key setup. Since the 
only requirement of this scheme is that each potential signer has a public key, this setting is referred to as the 
<em>plain-key model.</em></p>
<p>Reference [<a href="https://pdfs.semanticscholar.org/6bf4/f9450e7a8e31c106a8670b961de4735589cf.pdf" title="Accountable-subgroup Multisignatures">17</a>] solves the rogue-key attack using a sophisticated interactive key 
generation protocol.</p>
<p>In [<a href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.544.2947&amp;rep=rep1&amp;type=pdf" title="Multisignatures Secure under the Discrete Logarithm Assumption and a Generalized Forking Lemma">22</a>], the number of rounds was reduced from three to two, using a homomorphic commitment scheme. 
Unfortunately, this increases the signature size and the computational cost of signing and verification.</p>
<p>Reference [<a href="https://link.springer.com/article/10.1007/s10623-009-9313-z" title="Efficient Discrete Logarithm 
Based Multi-signature Scheme in the 
Plain Public Key Model">23</a>] proposed a signature scheme that involved the &quot;double hashing&quot; technique, which sees the reduction of 
the signature size compared to [<a href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.544.2947&amp;rep=rep1&amp;type=pdf" title="Multisignatures Secure under the Discrete Logarithm Assumption and a Generalized Forking Lemma">22</a>], while using only two rounds.</p>
<p>However, neither of these two variants allows for key aggregation.</p>
<p>Multi-signature schemes supporting key aggregation are easier to come by in the KOSK model. In particular, 
[<a href="https://arxiv.org/pdf/1503.08768.pdf" title="Keeping Authorities 'Honest or Bust' with Decentralized Witness Cosigning">24</a>] proposed the CoSi scheme, which can be seen as the naive Schnorr multi-signature scheme, where the 
cosigners are organized in a tree structure for fast signature generation.</p>
<h3><a class="header" href="#interactive-aggregate-signatures" id="interactive-aggregate-signatures">Interactive Aggregate Signatures</a></h3>
<p>In some situations, it may be useful to allow each participant to sign a different message rather than a single common 
one. An IAS is one where each signer has their own message $ m_{i} $ to sign, and the joint signature proves that the 
$ i $ -th signer has signed $ m_{i} ​$. These schemes are considered to be more general than multi-signature schemes. 
However, they are not as flexible as non-interactive aggregate signatures ([<a href="http://crypto.stanford.edu/%7Edabo/papers/aggreg.pdf" title="Aggregate and Verifiably Encrypted 
Signatures from Bilinear Maps">25</a>], [<a href="https://cseweb.ucsd.edu/%7Emihir/papers/agg.pdf" title="Unrestricted Aggregate Signatures">26</a>]) and sequential aggregate 
signatures [<a href="https://hovav.net/ucsd/dist/rsaagg.pdf" title="Sequential Aggregate Signatures 
from Trapdoor Permutations">27</a>].</p>
<p>According to [<a href="https://cseweb.ucsd.edu/%7Emihir/papers/multisignatures-ccs.pdf" title="Multi-Signatures in the Plain 
Public-Key Modeland a General 
Forking Lemma">21</a>], a generic way of turning any multi-signature scheme into an IAS scheme, is for the 
signer running the multi-signature protocol to use the tuple of all public keys/message pairs involved in the IAS protocol, 
as the message.</p>
<p>For BN's scheme and Schnorr multi-signatures, this does not increase the number of communication rounds, as messages can 
be sent together with shares $ R_{i} $.</p>
<h4><a class="header" href="#applications-of-interactive-aggregate-signatures" id="applications-of-interactive-aggregate-signatures">Applications of Interactive Aggregate Signatures</a></h4>
<p>With regard to digital currency schemes, where all participants have the ability to validate transactions, these 
transactions consist of outputs (which have a verification key and amount) and inputs (which are references to outputs 
of earlier transactions). Each input contains a signature of a modified version of the transaction to be validated with 
its referenced output's key. Some outputs may require multiple signatures to be spent. Transactions spending such an 
output are referred to as <em>m</em>-of-<em>n</em> multi-signature transactions [<a href="https://bitcoin.org/en/glossary/multisig" title="M-of-N Standard Transactions">28</a>], and the current implementation corresponds to 
the trivial way of building a multi-signature scheme by concatenating individual signatures. Additionally, a threshold 
policy can be enforced where only $ m $ valid signatures out of the $ n $ possible ones are needed to redeem the 
transaction. (Again, this is the most straightforward way to turn a multi-signature scheme into some kind of basic 
threshold signature scheme.)</p>
<p>While several multi-signature schemes could offer an improvement over the currently available method, two properties 
increase the possible impact:</p>
<ul>
<li>The availability of key aggregation removes the need for verifiers to see all the involved keys, improving bandwidth, 
privacy and validation cost.</li>
<li>Security under the <em>plain public-key model</em> enables multi-signatures across multiple inputs of a transaction, where 
the choice of signers cannot be committed to in advance. This greatly increases the number of situations in which 
multi-signatures are beneficial.</li>
</ul>
<h4><a class="header" href="#native-multi-signature-support" id="native-multi-signature-support">Native Multi-signature Support</a></h4>
<p>An improvement is to replace the need for implementing $ n-of-n $ multi-signatures with a constant-size, multi-signature 
primitive such as BN. While this is an improvement in terms of size, it still needs to contain all of the 
signers' public keys. Key aggregation improves upon this further, as a single-key predicate can be used instead. This 
is smaller and has lower computational cost for verification. Predicate encryption is an encryption paradigm that 
gives a master secret key owner fine-grained control over access to encrypted data [<a href="https://www.iacr.org/archive/tcc2009/54440456/54440456.pdf" title="Predicate Privacy in Encryption Systems">29</a>]. It also improves privacy, as 
the participant keys and their count remain private to the signers.</p>
<p>When generalizing to the $ m-of-n $ scenario, several options exist. One is to forego key aggregation, and still include 
all potential signer keys in the predicates, while still only producing a single signature for the chosen combination of 
keys. Alternatively, a Merkle tree [<a href="https://people.eecs.berkeley.edu/%7Eraluca/cs261-f15/readings/merkle.pdf" title="A Digital Signature Based on 
a Conventional Encryption Function">30</a>] where the leaves are permitted combinations of public keys (in aggregated 
form), can be employed. The predicate in this case would take as input an aggregated public key, a signature and a 
proof. Its validity would depend on the signature being valid with the provided key, and the proof establishing that the 
key is in fact one of the leaves of the Merkle tree, identified by its root hash. This approach is very generic, as it 
works for any subset of combinations of keys, and as a result has good privacy, as the exact policy is not visible from 
the proof.</p>
<p>Some key aggregation schemes that do not protect against rogue-key attacks can be used instead in the above cases, 
under the assumption that the sender is given a proof of knowledge/possession for the receivers' private keys. However, 
these schemes are difficult to prove secure, except by using very large proofs of knowledge. As those proofs of 
knowledge/possession do not need to be seen by verifiers, they are effectively certified by the sender's validation. 
However, passing them around to senders is inconvenient, and easy to get wrong. Using a scheme that is secure in the 
<em>plain public-key model</em> categorically avoids these concerns.</p>
<p>Another alternative is to use an algorithm whose key generation requires a trusted setup, e.g. in the KOSK model. 
While many of these schemes have been proven secure, they rely on mechanisms that are usually not implemented by 
certification authorities ([<a href="https://link.springer.com/content/pdf/10.1007%2F978-3-540-72540-4_13.pdf" title="The Power of Proofs-of-possession: 
Securing Multiparty Signatures 
Against Rogue-key Attacks">18</a>], [<a href="https://www.iacr.org/archive/pkc2003/25670031/25670031.pdf" title="Threshold Signatures, Multisignatures 
and Blind Signatures Based on the 
Gap-Diffie-Hellman-Group Signature Scheme">19</a>], [<a href="https://eprint.iacr.org/2006/096.pdf" title="Sequential Aggregate Signatures and 
Multisignatures without Random Oracles">20</a>]), [<a href="https://cseweb.ucsd.edu/%7Emihir/papers/multisignatures-ccs.pdf" title="Multi-Signatures in the Plain 
Public-Key Modeland a General 
Forking Lemma">21</a>]).</p>
<h4><a class="header" href="#cross-input-multi-signatures" id="cross-input-multi-signatures">Cross-input Multi-signatures</a></h4>
<p>The previous sections explained how the numbers of signatures per input can generally by reduced to one. However, it is 
possible to go further and replace this with a single signature per transaction. Doing so requires a fundamental change 
in validation semantics, as the validity of separate inputs is no longer independent. As a result, the outputs can no 
longer be modeled as predicates, where the secret key owner is given access to encrypted data. Instead, they are modeled 
as functions that return a Boolean (data type with only two possible values) plus a set of zero or more public keys.</p>
<p>Overall validity requires all returned Booleans to be <code>True</code> and a multi-signature of the transaction with $ L $ the 
union of all returned keys.</p>
<p>With regard to Bitcoin, this can be implemented by providing an alternative to the signature checking opcode 
OP_CHECKSIG and related opcodes in the Script language. Instead of returning the result of an actual ECDSA verification, 
they always return <code>True</code>, but additionally add the public key with which the verification would have taken place to a 
transaction-wide multi-set of keys. Finally, after all inputs are verified, a multi-signature present in the transaction 
is verified against that multi-set. In case the transaction spends inputs from multiple owners, they will need to 
collaborate to produce the multi-signature, or choose to only use the original opcodes. Adding these new opcodes is 
possible in a backward-compatible way [<a href="https://eprint.iacr.org/2018/068.pdf" title="Simple Schnorr Multi-signatures 
with Applications to Bitcoin">4</a>].</p>
<h4><a class="header" href="#protection-against-rogue-key-attacks" id="protection-against-rogue-key-attacks">Protection against Rogue-key Attacks</a></h4>
<p>In Bitcoin, when taking cross-input signatures into account, there is no published commitment to the set of signers, as 
each transaction input can independently spend an output that requires authorization from distinct participants. This 
functionality was not restricted, as it would then interfere with fungibility improvements such as CoinJoin [<a href="https://bitcointalk.org/index.php?topic=279249.0" title="CoinJoin: Bitcoin Privacy for the Real World">31</a>]. Due 
to the lack of certification, security against rogue-key attacks is of great importance.</p>
<p>If it is assumed that transactions used a single multi-signature that was vulnerable to rogue-attacks, an attacker could 
identify an arbitrary number of outputs they want to steal, with the public keys $ X_{1},...,X_{n-t} $ and then use the 
rogue-key attack to determine $ X_{n-t+1},...,X_{n} $ such that they can sign for the aggregated key $ \tilde{X} $. They 
would then send a small amount of their own money to outputs with predicates corresponding to the keys 
$ X_{n-t+1},...,X_{n} $. Finally, they can create a transaction that spends all of the victims' coins together with the 
ones they have just created by forging a multi-signature for the whole transaction.</p>
<p>It can be seen that in the case of multi-signatures across inputs, theft can occur through the ability to forge a 
signature over a set of keys that includes at least one key which is not controlled by the attacker. According to the 
<em>plain public-key model</em>, this is considered a win for the attacker. This is in contrast to the single-input 
multi-signature case, where theft is only possible by forging a signature for the exact (aggregated) keys contained in an 
existing output. As a result, it is no longer possible to rely on proofs of knowledge/possession that are private to the 
signers.</p>
<h2><a class="header" href="#formation-of-musig" id="formation-of-musig">Formation of MuSig</a></h2>
<h3><a class="header" href="#notation-used" id="notation-used">Notation Used</a></h3>
<p>This section gives the  general notation of mathematical expressions when specifically referenced. This information 
is important pre-knowledge for the remainder of the report. </p>
<ul>
<li>Let  $ p $  be a large prime number.</li>
<li>Let $ \mathbb{G} $ denote cyclic group of the prime order $ p $. </li>
<li>Let $ \mathbb Z_p $ denote the ring of integer $ modulo \mspace{4mu} p ​$. </li>
<li>Let a generator of  $ \mathbb{G} $ be denoted by $ g $. Thus, there exists a number $ g \in\mathbb{G}  $ such that 
$ \mathbb{G} =  \lbrace 1, \mspace{3mu}g,  \mspace{3mu}g^2,\mspace{3mu}g^3, ..., \mspace{3mu}g^{p-1} \rbrace   ​$. </li>
<li>Let $ \textrm{H} $ denote the hash function. </li>
<li>Let $ S= \lbrace (X_{1}, m_{1}),..., (X_{n}, m_{n}) \rbrace  ​$ be the multi-set of all public key/message pairs of all 
participants, where $  X_{1}=g^{x_{1}}  ​$.</li>
<li>Let $ \langle S \rangle $ denote a lexicographically encoding of the multi-set of public key/message pairs in $ S $. </li>
<li>Let $ L= \lbrace X_{1}=g^{x_{1}},...,X_{n}=g^{x_{n}} \rbrace  ​$ be the multi-set of all public keys. </li>
<li>Let $ \langle L \rangle ​$ denote a lexicographically encoding of the multi-set of public keys 
$ L= \lbrace X_{1}...X_{n} \rbrace  ​$. </li>
<li>Let $ \textrm{H}_{com} $ denote the hash function in the commitment phase.</li>
<li>Let $ \textrm{H}_{agg} $ denote the hash function used to compute the aggregated key.</li>
<li>Let $ \textrm{H}_{sig} ​$ denote the hash function used to compute the signature.</li>
<li>Let $ X_{1} $ and $ x_{1} $ be the public and private key of a specific signer.</li>
<li>Let $ m $ be the message that will be signed.</li>
<li>Let $ X_{2},...,X_{n} $ be the public keys of other cosigners.</li>
</ul>
<h3><a class="header" href="#recap-on-schnorr-signature-scheme" id="recap-on-schnorr-signature-scheme">Recap on Schnorr Signature Scheme</a></h3>
<p>The Schnorr signature scheme [<a href="https://link.springer.com/article/10.1007/BF00196725" title="Efficient Signature Generation by Smart Cards">6</a>] uses group parameters $(\mathbb{G\mathrm{,p,g)}}$ and a hash function $ \textrm{H} $.</p>
<p>A private/public key pair is a pair </p>
<p>$$
(x,X) \in  \lbrace 0,...,p-1 \rbrace  \mspace{6mu} \mathsf{x} \mspace{6mu} \mathbb{G}
$$</p>
<p>where $  X=g^{x} $ </p>
<p>To sign a message $ m $, the signer draws a random integer $ r \in Z_{p} $ and computes</p>
<p>$$
\begin{aligned} 
R &amp;= g^{r} \\
c &amp;= \textrm{H}(X,R,m) \\
s &amp;= r+cx 
\end{aligned}
$$</p>
<p>The signature is the pair $ (R,s) $, and its validity can be checked by verifying whether 
$$
g^{s} = RX^{c}
$$</p>
<p>This scheme is referred to as the &quot;key-prefixed&quot; variant of the scheme, which sees the public key hashed together with 
$ R ​$ and $ m ​$ [<a href="https://ed25519.cr.yp.to/ed25519-20110705.pdf" title="High-speed High-security Signatures">7</a>]. This variant was thought to have a better multi-user security bound than the classic 
variant [<a href="https://eprint.iacr.org/2015/996.pdf" title="Multi-user Schnorr Security, Revisited">8</a>]. However, in [<a href="https://eprint.iacr.org/2016/191.pdf" title="Optimal Security Proofs for Signatures 
from Identification Schemes">9</a>], the key-prefixing was seen as unnecessary to enable good multi-user security for 
Schnorr signatures.</p>
<p>For the development of the MuSig Schnorr-based multi-signature scheme [<a href="https://eprint.iacr.org/2018/068.pdf" title="Simple Schnorr Multi-signatures 
with Applications to Bitcoin">4</a>], key-prefixing is a requirement for the 
security proof, despite not knowing the form of an attack. The rationale also follows the process in reality, as 
messages signed in Bitcoin always indirectly commit to the public key.</p>
<h3><a class="header" href="#design-of-schnorr-multi-signature-scheme" id="design-of-schnorr-multi-signature-scheme">Design of Schnorr Multi-signature Scheme</a></h3>
<p>The naive way to design a Schnorr multi-signature scheme would be as follows:</p>
<p>A group of $ n $ signers want to cosign a message $ m $. 
Each cosigner randomly generates and communicates to others a share </p>
<p>$$
R_i = g^{r_{i}}
$$</p>
<p>Each of the cosigners then computes:</p>
<p>$$
R = \prod _{i=1}^{n} R_{i} \mspace{30mu} \mathrm{and} \mspace{30mu} c = \textrm{H} (\tilde{X},R,m)
$$</p>
<p>where $$ \tilde{X} = \prod_{i=1}^{n}X_{i} $$</p>
<p>is the product of individual public. The partial signature is then given by</p>
<p>$$
s_{i} = r_{i}+cx_{i}
$$</p>
<p>All partial signatures are then combined into a single signature $(R,s)​$ where </p>
<p>$$
s = \displaystyle\sum_{i=1}^{n}s_i \mod p ​
$$</p>
<p>The validity of a signature $ (R,s) $ on message $ m $ for public keys $  \lbrace X_{1},...X_{n} \rbrace  $ is 
equivalent to </p>
<p>$$
g^{s} = R\tilde{X}^{c}
$$</p>
<p>where </p>
<p>$$
\tilde{X} = \prod_{i=1}^{n} X_{i} \mspace{30mu} \mathrm{and} \mspace{30mu}  c = \textrm{H}(\tilde{X},R,m)
$$</p>
<p>Note that this is exactly the verification equation for a traditional key-prefixed Schnorr signature with respect to 
public key $ \tilde{X} $, a property termed <em>key aggregation</em>. 
However, these protocols are vulnerable to a rogue-key attack ([<a href="https://link.springer.com/content/pdf/10.1007%2F978-0-387-34873-5_11.pdf" title="Meta-Multisignature Schemes 
Based on the Discrete Logarithm Problem">12</a>], [<a href="https://link.springer.com/content/pdf/10.1007%2F3-540-68697-5_6.pdf" title="Weaknesses in Some Threshold Cryptosystem">14</a>], [<a href="https://pdfs.semanticscholar.org/d412/e5ab35fd397931cef0f8202324308f44e545.pdf" title="On the Risk of Disruption in 
Several Multiparty Signature Schemes">15</a>] and [<a href="https://pdfs.semanticscholar.org/6bf4/f9450e7a8e31c106a8670b961de4735589cf.pdf" title="Accountable-subgroup Multisignatures">17</a>]) where a corrupted 
signer sets its public key to </p>
<p>$$
X_{1}=g^{x_{1}} (\prod_{i=2}^{n} X_{i})^{-1} 
$$</p>
<p>allowing the signer to produce signatures for public keys $  \lbrace X_{1},...X_{n} \rbrace  ​$ by themselves. </p>
<h3><a class="header" href="#bellare-and-neven-signature-scheme" id="bellare-and-neven-signature-scheme">Bellare and Neven Signature Scheme</a></h3>
<p>Bellare and Neven [<a href="https://cseweb.ucsd.edu/%7Emihir/papers/multisignatures-ccs.pdf" title="Multi-Signatures in the Plain 
Public-Key Modeland a General 
Forking Lemma">21</a>] proceeded differently in order to avoid any key setup. A group of $ n $ signers want to 
cosign a message $ m $. Their main idea is to have each cosigner use a distinct &quot;challenge&quot; when computing their 
partial signature </p>
<p>$$
s_{i} = r_{i}+c_{i}x_{i} 
$$</p>
<p>defined as </p>
<p>$$
c_{i} = \textrm{H}( \langle L \rangle , X_{i},R,m) 
$$</p>
<p>where </p>
<p>$$
R = \prod_{i=1}^{n}R_{i}
$$</p>
<p>The equation to verify signature $ (R,s) $ on message $ m $ for the public keys $ L $ is </p>
<p>$$
g^s = R\prod_{i=1}^{n}X_{i}^{c_{i}}
$$</p>
<p>A preliminary round is also added to the signature protocol, where each signer commits to its share $ R_i $ by sending 
$ t_i = \textrm{H}^\prime(R_i) $ to other cosigners first. </p>
<p>This stops any cosigner from setting $ R = \prod_{i=1}^{n}R_{i}  ​$ to some maliciously chosen value, and also allows the 
reduction to simulate the signature oracle in the security proof. </p>
<p>Bellare and Neven [<a href="https://cseweb.ucsd.edu/%7Emihir/papers/multisignatures-ccs.pdf" title="Multi-Signatures in the Plain 
Public-Key Modeland a General 
Forking Lemma">21</a>] showed that this yields a multi-signature scheme provably secure in the <em>plain public-key</em> 
model under the Discrete Logarithm assumptions, modeling $ \textrm{H} $ and $ \textrm{H}^\prime $ as random oracles. 
However, this scheme does not allow key aggregation anymore, since the entire list of public keys is required for 
verification.</p>
<h3><a class="header" href="#musig-signature-scheme" id="musig-signature-scheme">MuSig Signature Scheme</a></h3>
<p>MuSig is paramaterized by group parameters $(\mathbb{G\mathrm{,p,g)}}$ and three hash functions 
$ ( \textrm{H}_{com}  ,  \textrm{H}_{agg} ,  \textrm{H}_{sig} ) $ from $  \lbrace 0,1 \rbrace ^{*} $ to 
$  \lbrace 0,1 \rbrace ^{l} $ (constructed from a single hash, using proper domain separation).</p>
<h4><a class="header" href="#round-1" id="round-1">Round 1</a></h4>
<p>A group of $ n $ signers want to cosign a message $ m $. Let $ X_1 $ and $ x_1 $ be the public and private key of a 
specific signer, let $ X_2 , . . . , X_n $ be the public keys of other cosigners and let $ \langle L \rangle $ be the 
multi-set of all public keys involved in the signing process.</p>
<p>For $ i\in  \lbrace 1,...,n \rbrace  ​$ , the signer computes the following</p>
<p>$$
a_{i} = \textrm{H}_{agg}(\langle L \rangle,X_{i})
$$</p>
<p>as well as the &quot;aggregated&quot; public key </p>
<p>$$
\tilde{X} = \prod_{i=1}^{n}X_{i}^{a_{i}} ​
$$</p>
<h4><a class="header" href="#round-2" id="round-2">Round 2</a></h4>
<p>The signer generates a random private nonce $ r_{1}\leftarrow\mathbb{Z_{\mathrm{p}}} $, computes $ R_{1} = g^{r_{1}} $ 
(the public nonce) and commitment $ t_{1} = \textrm{H}_{com}(R_{1}) $ and sends $t_{1}​$ to all other cosigners.</p>
<p>When receiving the commitments $t_{2},...,t_{n}$ from the other cosigners, the signer sends $R_{1}$ to all other 
cosigners. This ensures that the public nonce is not exposed until all commitments have been received. </p>
<p>Upon receiving $R_{2},...,R_{n}​$ from other cosigners, the signer verifies that $t_{i}=\textrm{H}_{com}(R_{i})​$ 
for all $ i\in  \lbrace 2,...,n \rbrace  ​$.</p>
<p>The protocol is aborted if this is not the case. </p>
<h4><a class="header" href="#round-3" id="round-3">Round 3</a></h4>
<p>If all commitment and random challenge pairs can be verified with $ \textrm{H}_{agg} $, the following is computed:</p>
<p>$$
\begin{aligned} 
R &amp;= \prod^{n}_{i=1}R_{i} \\
c &amp;= \textrm{H}_{sig} (\tilde{X},R,m) \\
s_{1} &amp;= r_{1} + ca_{1} x_{1} \mod p
\end{aligned}
$$</p>
<p>Signature $s_{1}​$ is sent to all other cosigners.
When receiving $ s_{2},...s_{n} ​$ from other cosigners, the signer can compute $ s = \sum_{i=1}^{n}s_{i} \mod p​$. The 
signature is $ \sigma = (R,s) ​$.</p>
<p>In order to verify the aggregated signature $ \sigma = (R,s) ​$, given a lexicographically encoded multi-set of public 
keys $ \langle L \rangle ​$ and message $ m ​$, the verifier computes:</p>
<p>$$
\begin{aligned} 
a_{i} &amp;= \textrm{H}_{agg}(\langle L \rangle,X_{i}) \mspace{9mu} \textrm {for} \mspace{9mu}  i \in  \lbrace 1,...,n \rbrace  \\
\tilde{X} &amp;= \prod_{i=1}^{n}X_{i}^{a_{i}} \\
c &amp;=  \textrm{H}_{sig} (\tilde{X},R,m) 
\end{aligned}
$$</p>
<p>then accepts the signature if </p>
<p>$$
g^{s} = R\prod_{i=1}^{n}X_{i}^{a_{i}c}=R\tilde{X^{c}.}
$$</p>
<h3><a class="header" href="#revisions" id="revisions">Revisions</a></h3>
<p>In a previous version of [<a href="https://eprint.iacr.org/2018/068.pdf" title="Simple Schnorr Multi-signatures 
with Applications to Bitcoin">4</a>], published on 15 January 2018, a two-round variant of MuSig was proposed, where the 
initial commitment round is omitted, claiming a security proof under the One More Discrete 
Logarithm (OMDL) assumptions ([<a href="https://cseweb.ucsd.edu/%7Emihir/papers/gq.pdf" title="GQ and Schnorr Identification Schemes: 
Proofs of Security Against Impersonation 
Under Active and Concurrent Attacks">32</a>], [<a href="https://eprint.iacr.org/2001/002.pdf" title="The One-More-RSA-Inversion Problems and the Security of Chaum’s Blind Signature Scheme*">33</a>]). The authors of [<a href="https://www.semanticscholar.org/paper/Okamoto-Beats-Schnorr%3A-On-the-Provable-Security-of-Drijvers-Edalatnejad/154938a12885ff30301129597ebe11dd153385bb" title="Okamoto Beats Schnorr: On the 
Provable Security of Multi-signatures">34</a>] then discovered a flaw in the security proof and 
showed that through a meta-reduction, the initial multi-signature scheme cannot be proved secure using an algebraic black 
box reduction under the DL or OMDL assumption.</p>
<p>In more detail, it was observed that in the two-round variant of MuSig, an adversary (controlling public keys 
$ X_{2},...,X_{n} $) can impose the value of $ R=\Pi_{i=1}^{n}R_{i} $ used in signature protocols since they can choose 
$ R_{2},...,R_{n} $ after having received $ R_{1} $ from the honest signer (controlling public key $ X_{1}=g^{x_{1}} $ ). 
This prevents one from using the initial method of simulating the honest signer in the Random Oracle model without knowing 
$ x_{1} $ by randomly drawing $ s_{1} $ and $ c $, computing $ R_1=g^{s_1}(X_1)^{-a_1c}$, and later programming 
$ \textrm{H}_{sig}(\tilde{X}, R, m) \mspace{2mu} : = c_1 $ since the adversary might have made the random oracle query 
$ \textrm{H}_{sig}(\tilde{X}, R, m) $ <em>before</em> engaging the corresponding signature protocol.</p>
<p>Despite this, there is no attack currently known against the two-round variant of MuSig and it might be secure, 
although this is not provable under standard assumptions from existing techniques [<a href="https://eprint.iacr.org/2018/068.pdf" title="Simple Schnorr Multi-signatures 
with Applications to Bitcoin">4</a>].</p>
<h3><a class="header" href="#turning-bellare-and-nevens-scheme-into-an-ias-scheme" id="turning-bellare-and-nevens-scheme-into-an-ias-scheme">Turning Bellare and Neven’s Scheme into an IAS Scheme</a></h3>
<p>In order to change the BN multi-signature scheme into an IAS scheme, [<a href="https://eprint.iacr.org/2018/068.pdf" title="Simple Schnorr Multi-signatures 
with Applications to Bitcoin">4</a>] proposed the following scheme, which includes 
a fix to make the execution of the signing algorithm dependent on the message index. </p>
<p>If $ X = g^{x_i} $ is the public key of a specific signer and $ m $ the message they want to sign, and </p>
<p>$$
S^\prime =  \lbrace (X^\prime_{1}, m^\prime_{1}),..., (X^\prime_{n-1}, m^\prime_{n-1}) \rbrace 
$$</p>
<p>is the set of the public key/message pairs of other signers, this specific signer merges $ (X, m) $ and $ S^\prime $ 
into the ordered set </p>
<p>$$
\langle S \rangle \mspace{6mu} \mathrm{of} \mspace{6mu}  S =  \lbrace (X_{1}, m_{1}),..., (X_{n}, m_{n}) \rbrace 
$$</p>
<p>and retrieves the resulting message index $ i ​$ such that </p>
<p>$$
(X_{1}, m_{i}) = (X, m)
$$</p>
<p>Each signer then draws $ r_{1}\leftarrow\mathbb{Z_{\mathrm{p}}} ​$, computes $  R_{i} = g^{r_{i}} ​$ and subsequently 
sends commitment $  t_{i} = H^\prime(R_{i}) ​$ in a first round and then $ R_{i} ​$ in a second round, and then computes</p>
<p>$$
R = \prod_{i=1}^{n}R_{i}
$$</p>
<p>The signer with message index $ i ​$ then computes:</p>
<p>$$
c_{i} = H(R,  \langle S \rangle, i) \mspace{30mu} \\
s_{i} = r_{i} + c_{i}x_{i} \mod p
$$</p>
<p>and then sends $ s_{i} ​$ to other signers. All signers can compute </p>
<p>$$
s = \displaystyle\sum_{i=1}^{n}s_{i} \mod p
$$</p>
<p>The signature is $ \sigma = (R, s) ​$. </p>
<p>Given an ordered set 
$ \langle S \rangle \mspace{6mu} \mathrm{of} \mspace{6mu} S =  \lbrace (X_{1}, m_{1}),...,(X_{n}, m_{n}) \rbrace  $ 
and a signature $ \sigma = (R, s) $  then $ \sigma $ is valid for $ S ​$ when </p>
<p>$$
g^s = R\prod_{i=1}^{n}X_{i} ^{H(R, \langle S \rangle, i)}
$$</p>
<p>There is no need to include $ \langle L \rangle $ in the hash computation nor the public key 
$ X_i $ of the local signer, since they are already &quot;accounted for&quot; through ordered set $ \langle S \rangle $ and the 
message index $ i $. </p>
<p><strong>Note:</strong> As of writing of this report, the secure IAS scheme presented here still needs to undergo a complete security 
analysis.</p>
<h2><a class="header" href="#conclusions-observations-and-recommendations" id="conclusions-observations-and-recommendations">Conclusions, Observations and Recommendations</a></h2>
<ul>
<li>MuSig leads to both native and private multi-signature transactions with signature aggregation.</li>
<li>Signature data for multi-signatures can be large and cumbersome. MuSig will allow users to create more complex 
transactions without burdening the network and revealing compromising information.</li>
<li>The IAS case where each signer signs their own message must still be proven by a complete security analysis.</li>
</ul>
<h2><a class="header" href="#references-3" id="references-3">References</a></h2>
<p>[<a href="https://blockstream.com/2018/01/23/musig-key-aggregation-schnorr-signatures/" title="Key Aggregation for Schnorr Signatures">1</a>] P. Wuille, “Key Aggregation for Schnorr Signatures”, 2018. Available: 
<a href="https://blockstream.com/2018/01/23/musig-key-aggregation-schnorr-signatures/">https://blockstream.com/2018/01/23/musig-key-aggregation-schnorr-signatures/</a>. Date accessed: 2019‑01‑20. </p>
<p>[<a href="https://blockstream.com/2018/02/15/schnorr-signatures-bpase/" title="Schnorr Signatures for Bitcoin - BPASE '18">2</a>] Blockstream, “Schnorr Signatures for Bitcoin - BPASE ’18”, 2018. Available: 
<a href="https://blockstream.com/2018/02/15/schnorr-signatures-bpase/">https://blockstream.com/2018/02/15/schnorr-signatures-bpase/</a>. Date accessed: 2019‑01‑20. </p>
<p>[<a href="https://scinapse.io/papers/200023587/" title="A Public-key Cryptosystem Suitable for 
Digital Multisignatures">3</a>] K. Itakura, “A Public-key Cryptosystem Suitable for Digital Multisignatures”, NEC J. Res. Dev., Vol. 71, 1983. 
Available: <a href="https://scinapse.io/papers/200023587/">https://scinapse.io/papers/200023587/</a>. Date accessed: 2019‑01‑20. </p>
<p>[<a href="https://eprint.iacr.org/2018/068.pdf" title="Simple Schnorr Multi-signatures 
with Applications to Bitcoin">4</a>] G. Maxwell, A. Poelstra, Y. Seurin and P. Wuille, “Simple Schnorr Multi-signatures with Applications to Bitcoin”, 
pp. 1–34, 2018. Available: <a href="https://eprint.iacr.org/2018/068.pdf">https://eprint.iacr.org/2018/068.pdf</a>. Date accessed: 2019‑01‑20. </p>
<p>[<a href="https://wiki.bitcoin.com/w/Multisignature" title="Multisignature">5</a>] B. W. Contributors, “Multisignature”, 2017. Available: <a href="https://wiki.bitcoin.com/w/Multisignature">https://wiki.bitcoin.com/w/Multisignature</a>. 
Date accessed: 2019‑01‑20. </p>
<p>[<a href="https://link.springer.com/article/10.1007/BF00196725" title="Efficient Signature Generation by Smart Cards">6</a>] C. P. Schnorr, “Efficient Signature Generation by Smart Cards”, <em>Journal of Cryptology</em>, Vol. 4, No. 3, 
pp. 161‑174, 1991. Available: <a href="https://link.springer.com/article/10.1007/BF00196725">https://link.springer.com/article/10.1007/BF00196725</a>. Date accessed: 
2019‑01‑20.</p>
<p>[<a href="https://ed25519.cr.yp.to/ed25519-20110705.pdf" title="High-speed High-security Signatures">7</a>] D. J. Bernstein, N. Duif, T. Lange, P. Schwabe and B. Yang, “High-speed High-security Signatures”, <em>Journal of 
Cryptographic Engineering</em>, Vol. 2, No. 2, pp. 77‑89, 2012. Available: 
<a href="https://ed25519.cr.yp.to/ed25519-20110705.pdf">https://ed25519.cr.yp.to/ed25519-20110705.pdf</a>. Date accessed: 2019‑01‑20.</p>
<p>[<a href="https://eprint.iacr.org/2015/996.pdf" title="Multi-user Schnorr Security, Revisited">8</a>] D. J. Bernstein, “Multi-user Schnorr Security, Revisited”, <em>IACR Cryptology ePrint Archive</em>, Vol. 2015, 
p. 996, 2015. 
Available: <a href="https://eprint.iacr.org/2015/996.pdf">https://eprint.iacr.org/2015/996.pdf</a>. Date accessed: 2019‑01‑20.</p>
<p>[<a href="https://eprint.iacr.org/2016/191.pdf" title="Optimal Security Proofs for Signatures 
from Identification Schemes">9</a>] E. Kiltz, D. Masny and J. Pan,  “Optimal Security Proofs for Signatures from Identification Schemes”, <em>Annual 
Cryptology Conference</em>, pp. 33‑61, Springer, 2016. Available: <a href="https://eprint.iacr.org/2016/191.pdf">https://eprint.iacr.org/2016/191.pdf</a>. Date 
accessed: 
2019‑01‑20.</p>
<p>[<a href="https://link.springer.com/content/pdf/10.1007%2FBFb0053435.pdf" title="Threshold-multisignature Schemes 
where Suspected Forgery Implies 
Traceability of Adversarial Shareholders">10</a>] C. M. Li, T. Hwang and N. Y. Lee, “Threshold-multisignature Schemes where Suspected Forgery Implies Traceability 
of Adversarial Shareholders”, <em>Workshop on the Theory and Application of Cryptographic Techniques</em>, 
pp. 194‑204, Springer, 1994. Available: <a href="https://link.springer.com/content/pdf/10.1007%2FBFb0053435.pdf">https://link.springer.com/content/pdf/10.1007%2FBFb0053435.pdf</a>. 
Date accessed: 2019‑01‑20.</p>
<p>[<a href="https://ieeexplore.ieee.org/abstract/document/326780" title="Group-oriented (t, n) Threshold Digital Signature Scheme and Digital Multisignature">11</a>] L. Harn, “Group-oriented (t, n) Threshold Digital Signature Scheme and Digital Multisignature”, <em>IEEE</em> 
<em>Proceedings-Computers and Digital Techniques</em>, Vol. 141, No. 5, pp. 307‑313, 1994. 
Available: <a href="https://ieeexplore.ieee.org/abstract/document/326780">https://ieeexplore.ieee.org/abstract/document/326780</a>. Date accessed: 2019‑01‑20.</p>
<p>[<a href="https://link.springer.com/content/pdf/10.1007%2F978-0-387-34873-5_11.pdf" title="Meta-Multisignature Schemes 
Based on the Discrete Logarithm Problem">12</a>] P. Horster, M. Michels and H. Petersen, “Meta-Multisignature Schemes Based on the Discrete Logarithm Problem”, <em>Information Security-the Next Decade</em>, pp. 128‑142, Springer, 1995. 
Available: <a href="https://link.springer.com/content/pdf/10.1007%2F978-0-387-34873-5_11.pdf">https://link.springer.com/content/pdf/10.1007%2F978-0-387-34873-5_11.pdf</a>. Date accessed: 2019‑01‑20.</p>
<p>[<a href="https://link.springer.com/chapter/10.1007/3-540-57332-1_11" title="A Digital Multisignature Scheme 
Based on the Fiat-Shamir Scheme">13</a>] K. Ohta and T. Okamoto, “A Digital Multisignature Scheme Based on the Fiat-Shamir Scheme,” <em>International 
Conference on the Theory and Application of Cryptology</em>, pp. 139‑148, Springer, 1991. 
Available: <a href="https://link.springer.com/chapter/10.1007/3-540-57332-1_11">https://link.springer.com/chapter/10.1007/3-540-57332-1_11</a>. Date accessed: 2019‑01‑20.</p>
<p>[<a href="https://link.springer.com/content/pdf/10.1007%2F3-540-68697-5_6.pdf" title="Weaknesses in Some Threshold Cryptosystem">14</a>] S. K. Langford, “Weaknesses in Some Threshold Cryptosystems”, <em>Annual International Cryptology Conference</em>, 
pp. 74‑82, Springer, 1996. Available: <a href="https://link.springer.com/content/pdf/10.1007%2F3-540-68697-5_6.pdf">https://link.springer.com/content/pdf/10.1007%2F3-540-68697-5_6.pdf</a>. 
Date accessed: 2019‑01‑20.</p>
<p>[<a href="https://pdfs.semanticscholar.org/d412/e5ab35fd397931cef0f8202324308f44e545.pdf" title="On the Risk of Disruption in 
Several Multiparty Signature Schemes">15</a>] M. Michels and P. Horster, “On the Risk of Disruption in Several Multiparty Signature Schemes”, <em>International 
Conference on the Theory and Application of Cryptology and Information Security</em>, pp. 334‑345, Springer, 1996. 
Available: <a href="https://pdfs.semanticscholar.org/d412/e5ab35fd397931cef0f8202324308f44e545.pdf">https://pdfs.semanticscholar.org/d412/e5ab35fd397931cef0f8202324308f44e545.pdf</a>. Date accessed: 
2019‑01‑20.</p>
<p>[<a href="http://search.ieice.org/bin/summary.php?id=e82-a_1_21&amp;category=A&amp;year=1999&amp;lang=E&amp;abst=" title="Multi-signature Schemes Secure 
Against Active Insider Attacks">16</a>] K. Ohta and T. Okamoto, “Multi-signature Schemes Secure Against Active Insider Attacks”, <em>IEICE Transactions on</em> 
<em>Fundamentals of Electronics, Communications and Computer Sciences</em>, Vol. 82, No. 1, pp. 21‑31, 1999. 
Available: <a href="http://search.ieice.org/bin/summary.php?id=e82-a_1_21&amp;category=A&amp;year=1999&amp;lang=E&amp;abst=">http://search.ieice.org/bin/summary.php?id=e82-a_1_21&amp;category=A&amp;year=1999&amp;lang=E&amp;abst=</a>. 
Date accessed: 2019‑01‑20.</p>
<p>[<a href="https://pdfs.semanticscholar.org/6bf4/f9450e7a8e31c106a8670b961de4735589cf.pdf" title="Accountable-subgroup Multisignatures">17</a>] S. Micali, K. Ohtaz and L. Reyzin, “Accountable-subgroup Multisignatures”, <em>Proceedings of the 8th ACM C
onference on Computer and Communications Security</em>, pp. 245#8209;254, ACM, 2001. 
Available: <a href="https://pdfs.semanticscholar.org/6bf4/f9450e7a8e31c106a8670b961de4735589cf.pdf">https://pdfs.semanticscholar.org/6bf4/f9450e7a8e31c106a8670b961de4735589cf.pdf</a>. Date accessed: 
2019‑01‑20.</p>
<p>[<a href="https://link.springer.com/content/pdf/10.1007%2F978-3-540-72540-4_13.pdf" title="The Power of Proofs-of-possession: 
Securing Multiparty Signatures 
Against Rogue-key Attacks">18</a>] T. Ristenpart and S. Yilek, “The Power of Proofs-of-possession: Securing Multiparty Signatures Against Rogue-key 
Attacks”, <em>Annual International Conference on the Theory and Applications of Cryptographic Techniques</em>, 
pp. 228‑245, 
Springer, 2007. Available: <a href="https://link.springer.com/content/pdf/10.1007%2F978-3-540-72540-4_13.pdf">https://link.springer.com/content/pdf/10.1007%2F978-3-540-72540-4_13.pdf</a>. 
Date accessed: 2019‑01‑20.</p>
<p>[<a href="https://www.iacr.org/archive/pkc2003/25670031/25670031.pdf" title="Threshold Signatures, Multisignatures 
and Blind Signatures Based on the 
Gap-Diffie-Hellman-Group Signature Scheme">19</a>] A. Boldyreva, “Threshold Signatures, Multisignatures and Blind Signatures Based on the Gap-Diffie-Hellman-group 
Signature Scheme”, <em>International Workshop on Public Key Cryptography</em>, pp. 31‑46, Springer, 2003. 
Available: <a href="https://www.iacr.org/archive/pkc2003/25670031/25670031.pdf">https://www.iacr.org/archive/pkc2003/25670031/25670031.pdf</a>. Date accessed: 2019‑01‑20.</p>
<p>[<a href="https://eprint.iacr.org/2006/096.pdf" title="Sequential Aggregate Signatures and 
Multisignatures without Random Oracles">20</a>] S. Lu, R. Ostrovsky, A. Sahai, H. Shacham and B. Waters, “Sequential Aggregate Signatures and Multisignatures 
without Random Oracles,” <em>Annual International Conference on the Theory and Applications of Cryptographic Techniques</em>, 
pp. 465‑485, Springer, 2006. Available: <a href="https://eprint.iacr.org/2006/096.pdf">https://eprint.iacr.org/2006/096.pdf</a>. Date accessed: 
2019‑01‑20.</p>
<p>[<a href="https://cseweb.ucsd.edu/%7Emihir/papers/multisignatures-ccs.pdf" title="Multi-Signatures in the Plain 
Public-Key Modeland a General 
Forking Lemma">21</a>] M. Bellare and G. Neven, “Multi-Signatures in the Plain Public-Key Model and a General Forking Lemma”, <em>Acm 
Ccs</em>, pp. 390‑399, 2006. Available: <a href="https://cseweb.ucsd.edu/%7Emihir/papers/multisignatures-ccs.pdf">https://cseweb.ucsd.edu/~mihir/papers/multisignatures-ccs.pdf</a>. 
Date accessed: 2019‑01‑20.</p>
<p>[<a href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.544.2947&amp;rep=rep1&amp;type=pdf" title="Multisignatures Secure under the Discrete Logarithm Assumption and a Generalized Forking Lemma">22</a>] A. Bagherzandi, J. H. Cheon and S. Jarecki, “Multisignatures Secure under the Discrete Logarithm Assumption and a 
Generalized Forking Lemma”, <em>Proceedings of the 15th ACM Conference on Computer and Communications Security - CCS '08</em>, 
p. 449, 2008. Available: <a href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.544.2947&amp;rep=rep1&amp;type=pdf">http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.544.2947&amp;rep=rep1&amp;type=pdf</a>. 
Date accessed: 2019‑01‑20.</p>
<p>[<a href="https://link.springer.com/article/10.1007/s10623-009-9313-z" title="Efficient Discrete Logarithm 
Based Multi-signature Scheme in the 
Plain Public Key Model">23</a>] C. Ma, J. Weng, Y. Li and R. Deng, “Efficient Discrete Logarithm Based Multi-signature Scheme in the Plain Public 
Key Model”, <em>Designs, Codes and Cryptography</em>, Vol. 54, No. 2, pp. 121‑133, 2010. 
Available: <a href="https://link.springer.com/article/10.1007/s10623-009-9313-z">https://link.springer.com/article/10.1007/s10623-009-9313-z</a>. Date accessed: 2019‑01‑20.</p>
<p>[<a href="https://arxiv.org/pdf/1503.08768.pdf" title="Keeping Authorities 'Honest or Bust' with Decentralized Witness Cosigning">24</a>] E. Syta, I. Tamas, D. Visher, D. I. Wolinsky, P. Jovanovic, L. Gasser, N. Gailly, I. Khoffi and B. Ford, “Keeping 
Authorities 'Honest or Bust' with Decentralized Witness Cosigning”, <em>Security and Privacy (SP), 2016 IEEE Symposium</em> 
on pp. 526‑545, IEEE, 2016. Available: <a href="https://arxiv.org/pdf/1503.08768.pdf">https://arxiv.org/pdf/1503.08768.pdf</a>. 
Date accessed: 2019‑01‑20.</p>
<p>[<a href="http://crypto.stanford.edu/%7Edabo/papers/aggreg.pdf" title="Aggregate and Verifiably Encrypted 
Signatures from Bilinear Maps">25</a>] D. Boneh, C. Gentry, B. Lynn and H. Shacham, “Aggregate and Verifiably Encrypted Signatures from Bilinear Maps”, 
in <em>International Conference on the Theory and Applications of Cryptographic Techniques</em>, pp. 416‑432, 
Springer, 2003. 
Available: <a href="http://crypto.stanford.edu/%7Edabo/papers/aggreg.pdf">http://crypto.stanford.edu/~dabo/papers/aggreg.pdf</a>. Date accessed: 2019‑01‑20.</p>
<p>[<a href="https://cseweb.ucsd.edu/%7Emihir/papers/agg.pdf" title="Unrestricted Aggregate Signatures">26</a>] M. Bellare, C. Namprempre and G. Neven,  “Unrestricted Aggregate Signatures”, <em>International Colloquium on 
Automata, Languages, and Programming</em>, pp. 411‑422, Springer, 2007. Available: 
<a href="https://cseweb.ucsd.edu/%7Emihir/papers/agg.pdf">https://cseweb.ucsd.edu/~mihir/papers/agg.pdf</a>. 
Date accessed: 2019‑01‑20.</p>
<p>[<a href="https://hovav.net/ucsd/dist/rsaagg.pdf" title="Sequential Aggregate Signatures 
from Trapdoor Permutations">27</a>] A. Lysyanskaya, S. Micali, L. Reyzin and H. Shacham, “Sequential Aggregate Signatures from Trapdoor Permutations”, 
in <em>International Conference on the Theory and Applications of Cryptographic Techniques</em>, pp. 74‑90, 
Springer, 2004. Available: <a href="https://hovav.net/ucsd/dist/rsaagg.pdf">https://hovav.net/ucsd/dist/rsaagg.pdf</a>. Date accessed: 2019‑01‑20.</p>
<p>[<a href="https://bitcoin.org/en/glossary/multisig" title="M-of-N Standard Transactions">28</a>] G. Andersen, “M-of-N Standard Transactions”, 2011. Available: <a href="https://bitcoin.org/en/glossary/multisig">https://bitcoin.org/en/glossary/multisig</a>. 
Date accessed: 2019‑01‑20.</p>
<p>[<a href="https://www.iacr.org/archive/tcc2009/54440456/54440456.pdf" title="Predicate Privacy in Encryption Systems">29</a>] E. Shen, E. Shi and B. Waters, “Predicate Privacy in Encryption Systems”, <em>Theory of Cryptography Conference</em>, 
pp. 457‑473, Springer, 2009. Available: <a href="https://www.iacr.org/archive/tcc2009/54440456/54440456.pdf">https://www.iacr.org/archive/tcc2009/54440456/54440456.pdf</a>. Date 
accessed: 2019‑01‑20.</p>
<p>[<a href="https://people.eecs.berkeley.edu/%7Eraluca/cs261-f15/readings/merkle.pdf" title="A Digital Signature Based on 
a Conventional Encryption Function">30</a>] R. C. Merkle, “A Digital Signature Based on a Conventional Encryption Function”, <em>Conference on the Theory and 
Application of Cryptographic Techniques</em>, pp. 369‑378, Springer, 1987. 
Available: <a href="https://people.eecs.berkeley.edu/%7Eraluca/cs261-f15/readings/merkle.pdf">https://people.eecs.berkeley.edu/~raluca/cs261-f15/readings/merkle.pdf</a>. Date accessed: 2019‑01‑20.</p>
<p>[<a href="https://bitcointalk.org/index.php?topic=279249.0" title="CoinJoin: Bitcoin Privacy for the Real World">31</a>] G. Maxwell, “CoinJoin: Bitcoin Privacy for the Real World”, 2013. 
Available: <a href="https://bitcointalk.org/index.php?topic=279249.0">https://bitcointalk.org/index.php?topic=279249.0</a>. Date accessed: 2019‑01‑20.</p>
<p>[<a href="https://cseweb.ucsd.edu/%7Emihir/papers/gq.pdf" title="GQ and Schnorr Identification Schemes: 
Proofs of Security Against Impersonation 
Under Active and Concurrent Attacks">32</a>] M. Bellare and A. Palacio, “GQ and Schnorr Identification Schemes: Proofs of Security against Impersonation under 
Active and Concurrent Attacks”, <em>Annual International Cryptology Conference</em>, pp. 162–177, Springer, 2002. 
Available: <a href="https://cseweb.ucsd.edu/%7Emihir/papers/gq.pdf">https://cseweb.ucsd.edu/~mihir/papers/gq.pdf</a>. Date accessed: 2019-01-20.</p>
<p>[<a href="https://eprint.iacr.org/2001/002.pdf" title="The One-More-RSA-Inversion Problems and the Security of Chaum’s Blind Signature Scheme*">33</a>] M. Bellare, C. Namprempre,  D. Pointcheval and M. Semanko, “The One-More-RSA Inversion Problems and the Security 
of Chaum’s Blind Signature Scheme”, <em>Journal of Cryptology</em>, Vol. 16, No. 3, 2003. Available: 
<a href="https://eprint.iacr.org/2001/002.pdf">https://eprint.iacr.org/2001/002.pdf</a>. Date accessed: 2019‑01‑20.</p>
<p>[<a href="https://www.semanticscholar.org/paper/Okamoto-Beats-Schnorr%3A-On-the-Provable-Security-of-Drijvers-Edalatnejad/154938a12885ff30301129597ebe11dd153385bb" title="Okamoto Beats Schnorr: On the 
Provable Security of Multi-signatures">34</a>] M. Drijvers, K. Edalatnejad, B. Ford, and G. Neven, “Okamoto Beats Schnorr: On the Provable Security of 
Multi-signatures”, Tech. Rep., 2018. Available: 
<a href="https://www.semanticscholar.org/paper/Okamoto-Beats-Schnorr%3A-On-the-Provable-Security-of-Drijvers-Edalatnejad/154938a12885ff30301129597ebe11dd153385bb">https://www.semanticscholar.org/paper/Okamoto-Beats-Schnorr%3A-On-the-Provable-Security-of-Drijvers-Edalatnejad/154938a12885ff30301129597ebe11dd153385bb</a>. 
Date accessed: 2019‑01‑20.</p>
<h2><a class="header" href="#contributors-2" id="contributors-2">Contributors</a></h2>
<ul>
<li><a href="https://github.com/kevoulee">https://github.com/kevoulee</a></li>
<li><a href="https://github.com/hansieodendaal">https://github.com/hansieodendaal</a></li>
<li><a href="https://github.com/CjS77">https://github.com/CjS77</a></li>
<li><a href="https://github.com/anselld">https://github.com/anselld</a></li>
</ul>
<h1><a class="header" href="#fraud-proofs-and-spv-lightweight-clients---easier-said-than-done" id="fraud-proofs-and-spv-lightweight-clients---easier-said-than-done">Fraud Proofs and SPV (Lightweight) Clients - Easier Said than Done?</a></h1>
<ul>
<li><a href="cryptography/fraud-proofs-1/MainReport.html#background">Background</a></li>
<li><a href="cryptography/fraud-proofs-1/MainReport.html#introduction">Introduction</a></li>
<li><a href="cryptography/fraud-proofs-1/MainReport.html#full-node-vs-spv-client">Full Node vs. SPV Client</a></li>
<li><a href="cryptography/fraud-proofs-1/MainReport.html#what-are-fraud-proofs">What are Fraud Proofs?</a></li>
<li><a href="cryptography/fraud-proofs-1/MainReport.html#fraud-proofs-possible-within-existing-bitcoin-protocol">Fraud Proofs Possible within Existing Bitcoin Protocol</a>
<ul>
<li><a href="cryptography/fraud-proofs-1/MainReport.html#invalid-transaction-due-to-stateless-criteria-violation-correct-syntax-input-scripts-conditions-satisfied-etc">Invalid Transaction due to Stateless Criteria Violation</a></li>
<li><a href="cryptography/fraud-proofs-1/MainReport.html#invalid-transaction-due-to-input-already-spent">Invalid Transaction due to Input Already Spent</a></li>
<li><a href="cryptography/fraud-proofs-1/MainReport.html#invalid-transaction-due-to-incorrect-generation-output-value">Invalid Transaction due to Incorrect Generation Output Value</a></li>
<li><a href="cryptography/fraud-proofs-1/MainReport.html#invalid-transaction-if-input-does-not-exist">Invalid Transaction if Input does not Exist</a></li>
</ul>
</li>
<li><a href="cryptography/fraud-proofs-1/MainReport.html#fraud-proofs-requiring-changes-to-bitcoin-protocol">Fraud Proofs Requiring Changes to Bitcoin Protocol</a>
<ul>
<li><a href="cryptography/fraud-proofs-1/MainReport.html#invalid-transaction-if-input-does-not-exist-in-old-blocks">Invalid Transaction if Input does not Exist in Old Blocks</a></li>
<li><a href="cryptography/fraud-proofs-1/MainReport.html#missing-proof-tree-item">Missing Proof Tree Item</a></li>
</ul>
</li>
<li><a href="cryptography/fraud-proofs-1/MainReport.html#universal-fraud-proofs-suggested-improvement">Universal Fraud Proofs (Suggested Improvement)</a></li>
<li><a href="cryptography/fraud-proofs-1/MainReport.html#how-spv-clients-work">How SPV Clients Work</a></li>
<li><a href="cryptography/fraud-proofs-1/MainReport.html#security-and-privacy-issues-with-spv-clients">Security and Privacy Issues with SPV Clients</a>
<ul>
<li><a href="cryptography/fraud-proofs-1/MainReport.html#weak-bloom-filters-and-merkle-tree-designs">Weak Bloom Filters and Merkle Tree Designs</a></li>
<li><a href="cryptography/fraud-proofs-1/MainReport.html#improvements">Improvements</a></li>
</ul>
</li>
<li><a href="cryptography/fraud-proofs-1/MainReport.html#examples-of-spv-implementations">Examples of SPV Implementations</a></li>
<li><a href="cryptography/fraud-proofs-1/MainReport.html#other-suggested-fraud-proof-improvements">Other Suggested Fraud-proof Improvements</a>
<ul>
<li><a href="cryptography/fraud-proofs-1/MainReport.html#erasure-codes">Erasure Codes</a></li>
<li><a href="cryptography/fraud-proofs-1/MainReport.html#merklix-trees">Merklix Trees</a></li>
<li><a href="cryptography/fraud-proofs-1/MainReport.html#payment-channels">Payment Channels</a></li>
</ul>
</li>
<li><a href="cryptography/fraud-proofs-1/MainReport.html#conclusions-observations-and-recommendations">Conclusions, Observations and Recommendations</a></li>
<li><a href="cryptography/fraud-proofs-1/MainReport.html#references">References</a></li>
<li><a href="cryptography/fraud-proofs-1/MainReport.html#contributors">Contributors</a></li>
</ul>
<h2><a class="header" href="#background-3" id="background-3">Background</a></h2>
<p>The bitcoin blockchain was, as of June 2018, approximately 173 GB in size [<a href="https://www.statista.com/statistics/647523/worldwide-bitcoin-blockchain-size/" title="Size of the Bitcoin Blockchain from 2010 to 2018, by Quarter (in Megabytes)">1</a>]. This makes it nearly impossible 
for everyone to run a full bitcoin node. Lightweight/Simplified Payment Verification (SPV) clients will have to be used 
by users, since not everyone can run full nodes due to the computational power, bandwidth and cost needed to run a full 
bitcoin node. </p>
<p>SPV clients will believe everything miners or nodes tell them, as evidenced by Peter Todd in the following screenshot 
of an Android client showing millions of bitcoins. The wallet was sent a transaction of 2.1 million BTC outputs [<a href="https://www.linkedin.com/pulse/peter-todds-fraud-proofs-talk-mit-bitcoin-expo-2016-mark-morris/" title="Fraud Proofs">17</a>]. 
Peter Todd modified the code for his node in order to deceive the bitcoin wallet, since the wallets cannot verify coin 
amounts [<a href="https://github.com/petertodd/bitcoin/tree/2016-02-lie-to-spv" title="Bitcoin Integration/Staging Tree">27</a>] (code can be found in the &quot;Quick-n-dirty hack to lie to SPV wallets&quot; branch on his GitHub repository).</p>
<p align="center"><img src="cryptography/fraud-proofs-1/sources/todd-btc-spv.jpg" width="301" /></p>
<div align="center"><i>Courtesy: MIT Bitcoin Expo 2016 Day 1</i></div>
<h2><a class="header" href="#introduction-2" id="introduction-2">Introduction</a></h2>
<p>In the original bitcoin whitepaper [<a href="https://www.bitcoin.com/bitcoin.pdf" title="Bitcoin: A Peer-to-Peer Electronic Cash System">2</a>], Satoshi recognized the limitations described in <a href="cryptography/fraud-proofs-1/MainReport.html#background">Background</a>,
and introduced the concept of a Simplified Payment Verification (SPV). This concept allows verification of payments 
using a lightweight client that does not need to download the entire bitcoin blockchain. It only downloads block 
headers with the longest proof-of-work chain, which are achieved by obtaining the Merkle branch linking a transaction 
to a block [<a href="http://docs.electrum.org/en/latest/spv.html" title="Simple Payment Verification">3</a>]. The existence of the Merkle root in the chain, along with blocks added after the block containing 
the Merkle root, provides confirmation of the legitimacy of that chain.</p>
<p align="center"><img src="cryptography/fraud-proofs-1/sources/proofofworkchain.png" width="700" /></p>
<div align="center"><i>Courtesy: Bitcoin: A Peer-to-Peer Electronic Cash System</i></div>
<p>In this system, the full nodes would need to provide an alert (known as a fraud proof) to SPV clients when an invalid 
block is detected. The SPV clients would then be prompted to download the full block and alerted transactions to 
confirm the inconsistency [<a href="https://www.bitcoin.com/bitcoin.pdf" title="Bitcoin: A Peer-to-Peer Electronic Cash System">2</a>]. An invalid block need not be of malicious intent, but could be as a result of other 
accounting errors (whether by accident or by malicious intent).</p>
<h2><a class="header" href="#full-node-vs-spv-client" id="full-node-vs-spv-client">Full Node vs. SPV Client</a></h2>
<p>A full bitcoin node contains the following details:</p>
<ul>
<li>every block;</li>
<li>every transaction that has ever been sent;</li>
<li>all the unspent transaction outputs (UTXOs) [<a href="https://multibit.org/hd0.4/how-spv-works.html" title="SPV, Bloom Filters and Checkpoints">4</a>].</li>
</ul>
<p>An SPV client, however, contains:</p>
<ul>
<li>a block header with transaction data relative to the client, including other transactions required to compute the 
Merkle root; or</li>
<li>just a block header with no transactions.</li>
</ul>
<h2><a class="header" href="#what-are-fraud-proofs" id="what-are-fraud-proofs">What are Fraud Proofs?</a></h2>
<p>Fraud proofs are a way to improve the security of SPV clients [<a href="https://gist.github.com/justusranvier/451616fa4697b5f25f60" title="Improving the Ability of SPV Clients to Detect Invalid Chains">5</a>] by providing a mechanism for full nodes to prove 
that a chain is invalid, irrespective of the amount of proof of work it has [<a href="https://gist.github.com/justusranvier/451616fa4697b5f25f60" title="Improving the Ability of SPV Clients to Detect Invalid Chains">5</a>]. Fraud proofs could also help with 
the bitcoin scaling debate, as SPV clients are easier to run and could thus help with bitcoin scalability issues
([<a href="http://www.truthcoin.info/blog/fraud-proofs/" title="Meditations on Fraud Proofs">6</a>], [<a href="https://www.trustnodes.com/2017/08/12/new-satoshi-nakamoto-e-mails-revealed" title="New Satoshi Nakamoto E-mails Revealed">18</a>]).</p>
<h2><a class="header" href="#fraud-proofs-possible-within-existing-bitcoin-protocol" id="fraud-proofs-possible-within-existing-bitcoin-protocol">Fraud Proofs Possible within Existing Bitcoin Protocol</a></h2>
<p>At the time of writing (February 2019), various proofs are needed to prove fraud in the bitcoin blockchain based on 
various actions. The following are the types of proofs needed to prove fraud based on specific fraud cases within the 
existing bitcoin protocol [<a href="https://gist.github.com/justusranvier/451616fa4697b5f25f60" title="Improving the Ability of SPV Clients to Detect Invalid Chains">5</a>]:</p>
<h3><a class="header" href="#invalid-transaction-due-to-stateless-criteria-violation-correct-syntax-input-scripts-conditions-satisfied-etc" id="invalid-transaction-due-to-stateless-criteria-violation-correct-syntax-input-scripts-conditions-satisfied-etc">Invalid Transaction due to Stateless Criteria Violation (Correct Syntax, Input Scripts Conditions Satisfied, etc.)</a></h3>
<p>In the case of an invalid transaction, the fraud proofs consist of:</p>
<ul>
<li>the header of invalid block;</li>
<li>the invalid transaction;</li>
<li>an invalid block's Merkle tree containing the minimum number of nodes needed to prove the existence of the invalid 
transaction in the tree.</li>
</ul>
<h3><a class="header" href="#invalid-transaction-due-to-input-already-spent" id="invalid-transaction-due-to-input-already-spent">Invalid Transaction due to Input Already Spent</a></h3>
<p>In this case, the fraud proof would consist of:</p>
<ul>
<li>the header of the invalid block;</li>
<li>the invalid transaction;</li>
<li>proof that the invalid transaction is within the invalid block;</li>
<li>the header of the block containing the original spend transaction;</li>
<li>the original spending transaction;</li>
<li>proof showing that the spend transaction is within the header block of the spend transaction.</li>
</ul>
<h3><a class="header" href="#invalid-transaction-due-to-incorrect-generation-output-value" id="invalid-transaction-due-to-incorrect-generation-output-value">Invalid Transaction due to Incorrect Generation Output Value</a></h3>
<p>In this case, the fraud proof consists of the block itself.</p>
<h3><a class="header" href="#invalid-transaction-if-input-does-not-exist" id="invalid-transaction-if-input-does-not-exist">Invalid Transaction if Input does not Exist</a></h3>
<p>In this case, the fraud proof consists of the entire blockchain.</p>
<h2><a class="header" href="#fraud-proofs-requiring-changes-to-bitcoin-protocol" id="fraud-proofs-requiring-changes-to-bitcoin-protocol">Fraud Proofs Requiring Changes to Bitcoin Protocol</a></h2>
<p>The following fraud proofs would require changes to the bitcoin protocol itself [<a href="https://gist.github.com/justusranvier/451616fa4697b5f25f60" title="Improving the Ability of SPV Clients to Detect Invalid Chains">5</a>]:</p>
<h3><a class="header" href="#invalid-transaction-if-input-does-not-exist-in-old-blocks" id="invalid-transaction-if-input-does-not-exist-in-old-blocks">Invalid Transaction if Input does not Exist in Old Blocks</a></h3>
<p>In this case, the fraud proof consists of:</p>
<ul>
<li>the header of the invalid block;</li>
<li>the invalid transaction;</li>
<li>proof that the header of the invalid block contains the invalid transaction;</li>
<li>proof that the header of the invalid block contains the leaf node corresponding to the non-existent input;</li>
<li>the block referenced by the leaf node, if it exists.</li>
</ul>
<h3><a class="header" href="#missing-proof-tree-item" id="missing-proof-tree-item">Missing Proof Tree Item</a></h3>
<p>In this case, the fraud proof consists of:</p>
<ul>
<li>the header of the invalid block;</li>
<li>the transaction of the missing proof tree node;</li>
<li>an indication as to which input from the transaction of the missing proof tree node is missing;</li>
<li>proof that the header of the invalid block contains the transition of the missing proof tree node;</li>
<li>proof that the proof tree contains two adjacent leaf nodes.</li>
</ul>
<h2><a class="header" href="#universal-fraud-proofs-suggested-improvement" id="universal-fraud-proofs-suggested-improvement">Universal Fraud Proofs (Suggested Improvement)</a></h2>
<p>As can be seen, requiring different fraud proof constructions for different fraud proofs can get cumbersome.
Al-Bassam, et al. [<a href="https://arxiv.org/pdf/1809.09044.pdf" title="Fraud Proofs: Maximising Light Client Security and Scaling Blockchains with Dishonest Majorities">26</a>] proposed a general, universal fraud-proof construction for most cases. Their proposition is to
generalize the entire blockchain as a state transition system and represent the entire state as a Merkle root using a
Sparse Merkle tree, with each transaction changing the state root of the blockchain. This can be simplified by this 
function: </p>
<ul>
<li><code>transaction(state,tx) = State or Error</code></li>
</ul>
<p align="center"><img src="cryptography/fraud-proofs-1/sources/stateroot.png" width="500" /></p>
<div align="center"><i>Courtesy: Fraud Proofs: Maximising Light Client Security and Scaling Blockchains with 
Dishonest Majorities</i></div>
<p>In the case of the bitcoin blockchain, representing the entire blockchain as a key-value store Sparse Merkle tree would
mean:</p>
<ul>
<li><code>Key = UTXO ID</code></li>
<li><code>Value = 1 if unspent or 0 if spent</code></li>
</ul>
<p>Each transaction will change the state root of the blockchain and can be represented with this function: </p>
<ul>
<li><code>TransitionRoot(stateRoot,tx,Witnesses) = stateRoot or Error</code></li>
</ul>
<p>In this proposition, a valid fraud proof construction will consist of:</p>
<ul>
<li>the transaction;</li>
<li>the pre-state root;</li>
<li>the post-state root;</li>
<li>witnesses (Merkle proofs of all the parts of the state the transaction accesses/modifies).</li>
</ul>
<p>Also expressed as this function:</p>
<ul>
<li><code>rootTransition(stateRoot, tx, witnesses) != stateRoot</code></li>
</ul>
<p>So a full node would send a light client/SPV this data to prove a valid fraud proof. The SPV would compute this
function and, if the transition root of the state root is different to the state root in the block, then the block
is rejected.</p>
<p align="center"><img src="cryptography/fraud-proofs-1/sources/fraudproof.png" width="500" /></p>
<div align="center"><i>Courtesy: Fraud Proofs: Maximising Light Client Security and Scaling Blockchains with 
Dishonest Majorities</i></div>
<p>The post-state root can be excluded in order to save block space. However, this does increase the fraud proof size.
This works with the assumption that the SPV client is connected to a minimum of one honest node.</p>
<h2><a class="header" href="#how-spv-clients-work" id="how-spv-clients-work">How SPV Clients Work</a></h2>
<p>SPV clients make use of Bloom filters to receive transactions that are relevant to the user [<a href="https://eprint.iacr.org/2014/763.pdf" title="On the Privacy Provisions of Bloom Filters in Lightweight Bitcoin Clients">7</a>]. Bloom filters are
probabilistic data structures used to check the existence of an element in a set quicker by responding with a Boolean
answer [<a href="https://medium.com/blockchain-musings/a-case-of-false-positives-in-bloom-filters-da09ec487ff0" title="A Case of False Positives in Bloom Filters,">9</a>].</p>
<p align="center"><img src="cryptography/fraud-proofs-1/sources/spv.png" width="600" /></p>
<div align="center"><i>Courtesy: On the Privacy Provisions of Bloom Filters in Lightweight Bitcoin Clients</i></div>
<p>In addition to Bloom filters, SPV clients rely on Merkle trees [<a href="https://arxiv.org/pdf/1809.09044.pdf" title="Fraud Proofs: Maximising Light Client Security and Scaling Blockchains with Dishonest Majorities">26</a>] - binary structures that have a list of all the
hashes between the block (apex) and the transaction (leaf). With Merkle trees, one only needs to check a small part of
the block, called a Merkle root, to prove that the transaction has been accepted in the network [<a href="https://multibit.org/hd0.4/how-spv-works.html" title="SPV, Bloom Filters and Checkpoints">8</a>].</p>
<p align="center"><img src="cryptography/fraud-proofs-1/sources/merkle-tree.png" width="1000" /></p>
<p>Fraud proofs are integral to the security of SPV clients. However, the other components in SPV clients are not without
issues. </p>
<h2><a class="header" href="#security-and-privacy-issues-with-spv-clients" id="security-and-privacy-issues-with-spv-clients">Security and Privacy Issues with SPV Clients</a></h2>
<h3><a class="header" href="#weak-bloom-filters-and-merkle-tree-designs" id="weak-bloom-filters-and-merkle-tree-designs">Weak Bloom Filters and Merkle Tree Designs</a></h3>
<p>In August 2017, a weakness in the bitcoin Merkle tree design was found to reduce the security of SPV clients. This
weakness could allow an attacker to simulate a payment of an arbitrary amount to a victim using an SPV wallet, and
trick the victim into accepting it as valid [<a href="https://media.rsk.co/the-design-of-bitcoin-merkle-trees-reduces-the-security-of-spv-clients/" title="The Design of Bitcoin Merkle Trees Reduces the Security of SPV Clients">10</a>]. The bitcoin Merkle tree makes no distinction between inner and leaf
nodes, and could thus be manipulated by an attack that could reinterpret transactions as nodes and nodes as
transactions [<a href="https://bitslog.wordpress.com/2018/06/09/leaf-node-weakness-in-bitcoin-merkle-tree-design/" title="Leaf-node Weakness in Bitcoin Merkle Tree Design">11</a>]. This weakness is due to inner nodes having no format and only requiring the length to be 64 bytes.</p>
<p>A brute-force attack particularly affects systems that automatically accept SPV proofs and could be carried out with an
investment of approximately USD3 million. One proposed solution is to ensure that no internal, 64-bit node is ever
accepted as a valid transaction by SPV wallets/clients [<a href="https://bitslog.wordpress.com/2018/06/09/leaf-node-weakness-in-bitcoin-merkle-tree-design/" title="Leaf-node Weakness in Bitcoin Merkle Tree Design">11</a>].</p>
<p>The BIP37 SPV [<a href="https://github.com/bitcoin/bips/blob/master/bip-0037.mediawiki" title="bip-0037.mediawiki">13</a>] Bloom filters do not have relevant privacy features [<a href="https://eprint.iacr.org/2014/763.pdf" title="On the Privacy Provisions of Bloom Filters in Lightweight Bitcoin Clients">7</a>]. They leak information such as IP
addresses of the user, and whether multiple addresses belong to a single owner [<a href="https://bisq.network/blog/privacy-in-bitsquare/" title="Privacy in Bitsquare">12</a>] (if Tor or Virtual Private
Networks (VPNs) are not used).</p>
<p>Furthermore, SPV clients face the risk of a denial of service attack against full nodes due to processing load
(80 GB disk reads) when SPV clients sync and full nodes themselves can cause a denial of service for SPV clients
by returning NULL filter responses to requests [<a href="https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2016-May/012636.html" title="Committed Bloom Filters for Improved Wallet Performance and SPV Security">14</a>]. Peter Todd [<a href="https://github.com/petertodd/bloom-io-attack" title="Bloom-io-attack">15</a>] aptly demonstrates the risk of SPV denial of
service.</p>
<h3><a class="header" href="#improvements" id="improvements">Improvements</a></h3>
<p>To address these issues, a new concept called committed Bloom filters was introduced to improve the performance and
security of SPV clients. In this concept, which can be used in lieu of BIP37 [<a href="https://www.newsbtc.com/2016/05/10/developers-introduce-bloom-filters-improve-bitcoin-wallet-security/" title="Committed Bloom Filters versus BIP37 SPV">16</a>], a Bloom filter digest (BFD) of
every block's inputs, outputs and transactions is created with a filter that consists of a small size of the overall
block size [<a href="https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2016-May/012636.html" title="Committed Bloom Filters for Improved Wallet Performance and SPV Security">14</a>].</p>
<p>A second Bloom filter is created with all transactions and a binary comparison is made to determine matching
transactions. This BFD allows the caching of filters by SPV clients without the need to recompute [<a href="https://www.newsbtc.com/2016/05/10/developers-introduce-bloom-filters-improve-bitcoin-wallet-security/" title="Committed Bloom Filters versus BIP37 SPV">16</a>]. It also
introduces semi-trusted oracles to improve the security and privacy of SPV clients by allowing SPV clients to download
block data via any out of band method [<a href="https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2016-May/012636.html" title="Committed Bloom Filters for Improved Wallet Performance and SPV Security">14</a>].</p>
<h2><a class="header" href="#examples-of-spv-implementations" id="examples-of-spv-implementations">Examples of SPV Implementations</a></h2>
<p>There are two well-known SPV implementations for bitcoin: bitcoinj and electrum. The latter does SPV-level validation,
comparing multiple electrum servers against each other. It has very similar security to bitcoinj, but potentially better 
privacy [<a href="https://www.reddit.com/r/Bitcoin/comments/3c3zn4/whats_the_difference_between_an_api_wallet_and_a/" title="Whats the Difference between an API Wallet and a SPV Wallet?">25</a>] due to bitcoinj's implementation of Bloom filters [<a href="https://eprint.iacr.org/2014/763.pdf" title="On the Privacy Provisions of Bloom Filters in Lightweight Bitcoin Clients">7</a>].</p>
<h2><a class="header" href="#other-suggested-fraud-proof-improvements" id="other-suggested-fraud-proof-improvements">Other Suggested Fraud-proof Improvements</a></h2>
<h3><a class="header" href="#erasure-codes" id="erasure-codes">Erasure Codes</a></h3>
<p>Along with the proposed universal fraud-proof solution, another data availability issue with fraud proofs is erasure
coding. Erasure coding allows a piece of data M chunks long to be expanded into a piece of data N chunks long (“chunks”
can be of arbitrary size), such that any M of the N chunks can be used to recover the original data. Blocks are then
required to commit the Merkle root of this extended data and have light clients probabilistically check that the
majority of the extended data is available [<a href="https://www.trustnodes.com/2017/08/14/vitalik-buterin-peter-todd-go-head-head-crypto-culture-wars" title="Vitalik Buterin and Peter Todd Go Head to Head in the Crypto Culture Wars">21</a>].</p>
<p>According to the proposed solution,
one of three conditions will be true for the SPV client when using erasure codes [<a href="https://github.com/ethereum/research/wiki/A-note-on-data-availability-and-erasure-coding" title="A Note on Data Availability and Erasure Coding">20</a>]:</p>
<ol>
<li>The entire extended data is available, the erasure code is constructed correctly and the block is valid.</li>
<li>The entire extended data is available, the erasure code is constructed correctly, but the block is invalid.</li>
<li>The entire extended data is available, but the erasure code is constructed incorrectly.</li>
</ol>
<p>In case (1), the block is valid and the light client can accept it. In case (2), it is expected that some other node
will quickly construct and relay a fraud proof. In case (3), it is also expected that some other node will quickly
construct and relay a specialized kind of fraud proof that shows that the erasure code is constructed incorrectly.</p>
<h3><a class="header" href="#merklix-trees" id="merklix-trees">Merklix Trees</a></h3>
<p>Another suggested fraud proof improvement for the bitcoin blockchain is by means of block sharding and validation using
Merklix trees. Merklix trees are essentially Merkle trees that use unordered set [<a href="https://www.deadalnix.me/2016/09/24/introducing-merklix-tree-as-an-unordered-merkle-tree-on-steroid/" title="Introducing Merklix Tree as an Unordered Merkle Tree on Steroid">22</a>]. This also assumes that there
is at least one honest node per shard. Using Merklix proofs, the following can be proven [<a href="https://www.deadalnix.me/2016/11/06/using-merklix-tree-to-shard-block-validation/" title="Using Merklix Tree to Shard Block Validation">23</a>]:</p>
<ol>
<li>A transaction is in the block.</li>
<li>The transaction's inputs and outputs are or are not in the UTXO set.</li>
</ol>
<p>In this scenario, SPV clients can be made aware of any invalidity in blocks and cannot be lied to about the UTXO set.</p>
<h3><a class="header" href="#payment-channels" id="payment-channels">Payment Channels</a></h3>
<p>Bitcoin is made to be resilient to denial of service (DoS) attacks. However, the same cannot be said for SPV clients.
This could be an issue if malicious alerting nodes spam with false fraud proofs. A proposed solution to this is payment
channels [<a href="http://www.truthcoin.info/blog/fraud-proofs/" title="Meditations on Fraud Proofs">6</a>], due to them:</p>
<ol>
<li>operating at near instant speeds, thus allowing quick alerting of fraud proofs;</li>
<li>facilitating micro-transactions;</li>
<li>being robust to temporary mining failures (as they use long “custodial periods”).</li>
</ol>
<p>In this way, the use of payment channels can help with incentivizing full nodes to issue fraud proofs.</p>
<h2><a class="header" href="#conclusions-observations-and-recommendations-1" id="conclusions-observations-and-recommendations-1">Conclusions, Observations and Recommendations</a></h2>
<p>Fraud proofs can be complex [<a href="http://www.truthcoin.info/blog/fraud-proofs/" title="Meditations on Fraud Proofs">6</a>] and hard to implement. However, they appear to be necessary for scalability of
blockchains and the security and privacy for SPV clients, since not everyone can or should want to run a full node to
participate in the network. The current SPV implementations are working on improving the security and privacy of these
SPV clients. Furthermore, for current blockchains, a hard or soft fork would need to be done in order to accommodate
the data in the block headers.</p>
<p>Based on the <a href="cryptography/fraud-proofs-1/MainReport.html#payment-channels">payment channels</a> fraud proof proposal that suggests some sort of incentive for nodes
that issue alert/fraud proofs, it seems likely that some sort of fraud proof provider and consumer marketplace will
have to emerge.</p>
<p>Where Tari is concerned, it would appear that the universal fraud proof proposals or something similar would need to be
looked into, as undoubtedly end-users of the protocol/network will mostly be using light clients. However, since these
fraud proofs work on the assumption of a minimum of one honest node, in the case of a digital issuer (which may be one
or more), a fraud proof will not be viable on this assumption, as the digital issuer could be the sole node.</p>
<h2><a class="header" href="#references-4" id="references-4">References</a></h2>
<p>[<a href="https://www.statista.com/statistics/647523/worldwide-bitcoin-blockchain-size/" title="Size of the Bitcoin Blockchain from 2010 to 2018, by Quarter (in Megabytes)">1</a>] &quot;Size of the Bitcoin Blockchain from 2010 to 2018, by Quarter (in Megabytes)&quot; [online].<br />
Available:  <a href="https://www.statista.com/statistics/647523/worldwide-bitcoin-blockchain-size/">https://www.statista.com/statistics/647523/worldwide-bitcoin-blockchain-size/</a>. Date accessed: 2018‑09‑10.</p>
<p>[<a href="https://www.bitcoin.com/bitcoin.pdf" title="Bitcoin: A Peer-to-Peer Electronic Cash System">2</a>] S. Nakamoto, &quot;Bitcoin: A Peer-to-Peer Electronic Cash System&quot; [online]. Available: <a href="https://www.bitcoin.com/bitcoin.pdf">https://www.bitcoin.com/bitcoin.pdf</a>.<br />
Date accessed: 2018‑09‑10.</p>
<p>[<a href="http://docs.electrum.org/en/latest/spv.html" title="Simple Payment Verification">3</a>] &quot;Simple Payment Verification&quot; [online]. Available: <a href="http://docs.electrum.org/en/latest/spv.html">http://docs.electrum.org/en/latest/spv.html</a>. Date accessed: 
2018‑09‑10.</p>
<p>[<a href="https://multibit.org/hd0.4/how-spv-works.html" title="SPV, Bloom Filters and Checkpoints">4</a>] &quot;SPV, Bloom Filters and Checkpoints&quot; [online]. Available: <a href="https://multibit.org/hd0.4/how-spv-works.html">https://multibit.org/hd0.4/how-spv-works.html</a>. 
Date accessed: 2018‑09‑10.</p>
<p>[<a href="https://gist.github.com/justusranvier/451616fa4697b5f25f60" title="Improving the Ability of SPV Clients to Detect Invalid Chains">5</a>] &quot;Improving the Ability of SPV Clients to Detect Invalid Chains&quot; [online].<br />
Available: <a href="https://gist.github.com/justusranvier/451616fa4697b5f25f60">https://gist.github.com/justusranvier/451616fa4697b5f25f60</a>. Date accessed: 2018‑09‑10.</p>
<p>[<a href="http://www.truthcoin.info/blog/fraud-proofs/" title="Meditations on Fraud Proofs">6</a>] &quot;Meditations on Fraud Proofs&quot; [online]. Available: <a href="http://www.truthcoin.info/blog/fraud-proofs/">http://www.truthcoin.info/blog/fraud-proofs/</a>. Dated accessed: 
2018‑09‑10.</p>
<p>[<a href="https://eprint.iacr.org/2014/763.pdf" title="On the Privacy Provisions of Bloom Filters in Lightweight Bitcoin Clients">7</a>] A. Gervais, G. O. Karame, D. Gruber and S. Capkun, &quot;On the Privacy Provisions of Bloom Filters in Lightweight 
Bitcoin Clients&quot; [online]. Available: <a href="https://eprint.iacr.org/2014/763.pdf">https://eprint.iacr.org/2014/763.pdf</a>. Date accessed: 2018‑09‑10.</p>
<p>[<a href="https://multibit.org/hd0.4/how-spv-works.html" title="SPV, Bloom Filters and Checkpoints">8</a>] &quot;SPV, Bloom Filters and Checkpoints&quot; [online]. Available: <a href="https://multibit.org/hd0.4/how-spv-works.html">https://multibit.org/hd0.4/how-spv-works.html</a>. 
Date accessed: 2018‑09‑10.</p>
<p>[<a href="https://medium.com/blockchain-musings/a-case-of-false-positives-in-bloom-filters-da09ec487ff0" title="A Case of False Positives in Bloom Filters,">9</a>] &quot;A Case of False Positives in Bloom Filters&quot; [online].<br />
Available: https://medium.com/blockchain-musings/a-case-of-false-positives-in-bloom-filters-da09ec487ff0. Date 
accessed: 2018‑09‑11.</p>
<p>[<a href="https://media.rsk.co/the-design-of-bitcoin-merkle-trees-reduces-the-security-of-spv-clients/" title="The Design of Bitcoin Merkle Trees Reduces the Security of SPV Clients">10</a>] &quot;The Design of Bitcoin Merkle Trees Reduces the Security of SPV Clients&quot; [online].<br />
Available: <a href="https://media.rsk.co/the-design-of-bitcoin-merkle-trees-reduces-the-security-of-spv-clients/">https://media.rsk.co/the-design-of-bitcoin-merkle-trees-reduces-the-security-of-spv-clients/</a>. 
Date accessed: 2018‑09‑11.</p>
<p>[<a href="https://bitslog.wordpress.com/2018/06/09/leaf-node-weakness-in-bitcoin-merkle-tree-design/" title="Leaf-node Weakness in Bitcoin Merkle Tree Design">11</a>] &quot;Leaf-node Weakness in Bitcoin Merkle Tree Design&quot; [online].<br />
Available: <a href="https://bitslog.wordpress.com/2018/06/09/leaf-node-weakness-in-bitcoin-merkle-tree-design/">https://bitslog.wordpress.com/2018/06/09/leaf-node-weakness-in-bitcoin-merkle-tree-design/</a>. 
Date accessed: 2018‑09‑11.</p>
<p>[<a href="https://bisq.network/blog/privacy-in-bitsquare/" title="Privacy in Bitsquare">12</a>] &quot;Privacy in Bitsquare&quot; [online]. Available: <a href="https://bisq.network/blog/privacy-in-bitsquare/">https://bisq.network/blog/privacy-in-bitsquare/</a>. 
Date accessed: 2018‑09‑11.</p>
<p>[<a href="https://github.com/bitcoin/bips/blob/master/bip-0037.mediawiki" title="bip-0037.mediawiki">13</a>] &quot;bip-0037.mediawiki&quot; [online]. Available: <a href="https://github.com/bitcoin/bips/blob/master/bip-0037.mediawiki">https://github.com/bitcoin/bips/blob/master/bip-0037.mediawiki</a>. 
Date accessed: 2018‑09‑11.</p>
<p>[<a href="https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2016-May/012636.html" title="Committed Bloom Filters for Improved Wallet Performance and SPV Security">14</a>] &quot;Committed Bloom Filters for Improved Wallet Performance and SPV Security&quot; [online].<br />
Available: <a href="https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2016-May/012636.html">https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2016-May/012636.html</a>. Date accessed: 2018‑09‑11.</p>
<p>[<a href="https://github.com/petertodd/bloom-io-attack" title="Bloom-io-attack">15</a>] &quot;Bloom-io-attack&quot; [online]. Available: <a href="https://github.com/petertodd/bloom-io-attack">https://github.com/petertodd/bloom-io-attack</a>. Date accessed: 2018‑09‑11.</p>
<p>[<a href="https://www.newsbtc.com/2016/05/10/developers-introduce-bloom-filters-improve-bitcoin-wallet-security/" title="Committed Bloom Filters versus BIP37 SPV">16</a>] &quot;Committed Bloom Filters versus BIP37 SPV&quot; [online].<br />
Available: <a href="https://www.newsbtc.com/2016/05/10/developers-introduce-bloom-filters-improve-bitcoin-wallet-security/">https://www.newsbtc.com/2016/05/10/developers-introduce-bloom-filters-improve-bitcoin-wallet-security/</a>. 
Date accessed: 2018‑09‑12.</p>
<p>[<a href="https://www.linkedin.com/pulse/peter-todds-fraud-proofs-talk-mit-bitcoin-expo-2016-mark-morris/" title="Fraud Proofs">17</a>] &quot;Fraud Proofs&quot; [online]. Available: <a href="https://www.linkedin.com/pulse/peter-todds-fraud-proofs-talk-mit-bitcoin-expo-2016-mark-morris/">https://www.linkedin.com/pulse/peter-todds-fraud-proofs-talk-mit-bitcoin-expo-2016-mark-morris/</a>.<br />
Date accessed: 2018‑09‑12.</p>
<p>[<a href="https://www.trustnodes.com/2017/08/12/new-satoshi-nakamoto-e-mails-revealed" title="New Satoshi Nakamoto E-mails Revealed">18</a>] &quot;New Satoshi Nakamoto E-mails Revealed&quot; [online]. Available: <a href="https://www.trustnodes.com/2017/08/12/new-satoshi-nakamoto-e-mails-revealed">https://www.trustnodes.com/2017/08/12/new-satoshi-nakamoto-e-mails-revealed</a>.
Date accessed: 2018‑09‑12.</p>
<p>[<a href="https://plasma.io/plasma.pdf" title="Plasma: Scalable Autonomous Smart Contracts">19</a>] J. Poon and V. Buterin, &quot;Plasma: Scalable Autonomous Smart Contracts&quot; [online]. Available: <a href="https://plasma.io/plasma.pdf">https://plasma.io/plasma.pdf</a>.<br />
Date accessed: 2018‑09‑13.</p>
<p>[<a href="https://github.com/ethereum/research/wiki/A-note-on-data-availability-and-erasure-coding" title="A Note on Data Availability and Erasure Coding">20</a>] &quot;A Note on Data Availability and Erasure Coding&quot; [online].<br />
Available: <a href="https://github.com/ethereum/research/wiki/A-note-on-data-availability-and-erasure-coding">https://github.com/ethereum/research/wiki/A-note-on-data-availability-and-erasure-coding</a>. 
Date accessed: 2018‑09‑13.</p>
<p>[<a href="https://www.trustnodes.com/2017/08/14/vitalik-buterin-peter-todd-go-head-head-crypto-culture-wars" title="Vitalik Buterin and Peter Todd Go Head to Head in the Crypto Culture Wars">21</a>] &quot;Vitalik Buterin and Peter Todd Go Head to Head in the Crypto Culture Wars&quot; [online].<br />
Available: <a href="https://www.trustnodes.com/2017/08/14/vitalik-buterin-peter-todd-go-head-head-crypto-culture-wars">https://www.trustnodes.com/2017/08/14/vitalik-buterin-peter-todd-go-head-head-crypto-culture-wars</a>.
Date accessed: 2018‑09‑14.</p>
<p>[<a href="https://www.deadalnix.me/2016/09/24/introducing-merklix-tree-as-an-unordered-merkle-tree-on-steroid/" title="Introducing Merklix Tree as an Unordered Merkle Tree on Steroid">22</a>] &quot;Introducing Merklix Tree as an Unordered Merkle Tree on Steroid&quot; [online].<br />
Available: <a href="https://www.deadalnix.me/2016/09/24/introducing-merklix-tree-as-an-unordered-merkle-tree-on-steroid/">https://www.deadalnix.me/2016/09/24/introducing-merklix-tree-as-an-unordered-merkle-tree-on-steroid/</a>. 
Date accessed 2018‑09‑14.</p>
<p>[<a href="https://www.deadalnix.me/2016/11/06/using-merklix-tree-to-shard-block-validation/" title="Using Merklix Tree to Shard Block Validation">23</a>] &quot;Using Merklix Tree to Shard Block Validation&quot; [online].<br />
Available: <a href="https://www.deadalnix.me/2016/11/06/using-merklix-tree-to-shard-block-validation/">https://www.deadalnix.me/2016/11/06/using-merklix-tree-to-shard-block-validation/</a>. Date accessed: 2018‑09‑14.</p>
<p>[<a href="https://bitco.in/forum/threads/fraud-proofs.1617/" title="Fraud Proofs">24</a>] &quot;Fraud Proofs&quot; [online]. Available: <a href="https://bitco.in/forum/threads/fraud-proofs.1617/">https://bitco.in/forum/threads/fraud-proofs.1617/</a>. Date accessed: 2018‑09‑18.</p>
<p>[<a href="https://www.reddit.com/r/Bitcoin/comments/3c3zn4/whats_the_difference_between_an_api_wallet_and_a/" title="Whats the Difference between an API Wallet and a SPV Wallet?">25</a>] &quot;Whats the Difference between an API Wallet and a SPV Wallet?&quot; [Online.]<br />
Available: <a href="https://www.reddit.com/r/Bitcoin/comments/3c3zn4/whats_the_difference_between_an_api_wallet_and_a/">https://www.reddit.com/r/Bitcoin/comments/3c3zn4/whats_the_difference_between_an_api_wallet_and_a/</a>.
Date accessed: 2018‑09‑21.</p>
<p>[<a href="https://arxiv.org/pdf/1809.09044.pdf" title="Fraud Proofs: Maximising Light Client Security and Scaling Blockchains with Dishonest Majorities">26</a>] M. Al-Bassam, A. Sinnino and V. Butterin, &quot;Fraud Proofs: Maximising Light Client Security and Scaling Blockchains 
with Dishonest Majorities&quot; [online]. Available: <a href="https://arxiv.org/pdf/1809.09044.pdf">https://arxiv.org/pdf/1809.09044.pdf</a>. Date accessed: 2018‑10‑08.</p>
<p>[<a href="https://github.com/petertodd/bitcoin/tree/2016-02-lie-to-spv" title="Bitcoin Integration/Staging Tree">27</a>] &quot;Bitcoin Integration/Staging Tree&quot; [online]. Available: <a href="https://github.com/petertodd/bitcoin/tree/2016-02-lie-to-spv">https://github.com/petertodd/bitcoin/tree/2016-02-lie-to-spv</a>.<br />
Date accessed: 2018‑10‑12.</p>
<h2><a class="header" href="#contributors-3" id="contributors-3">Contributors</a></h2>
<ul>
<li><a href="https://github.com/ksloven">https://github.com/ksloven</a></li>
<li><a href="https://github.com/CjS77">https://github.com/CjS77</a></li>
<li><a href="https://github.com/hansieodendaal">https://github.com/hansieodendaal</a></li>
<li><a href="https://github.com/anselld">https://github.com/anselld</a></li>
</ul>
<h1><a class="header" href="#bulletproofs-and-mimblewimble" id="bulletproofs-and-mimblewimble">Bulletproofs and Mimblewimble</a></h1>
<ul>
<li><a href="cryptography/bulletproofs-and-mimblewimble/MainReport.html#introduction">Introduction</a>
<ul>
<li><a href="cryptography/bulletproofs-and-mimblewimble/MainReport.html#bulletproofs">Bulletproofs</a></li>
<li><a href="cryptography/bulletproofs-and-mimblewimble/MainReport.html#mimblewimble">Mimblewimble</a></li>
</ul>
</li>
<li><a href="cryptography/bulletproofs-and-mimblewimble/MainReport.html#how-do-bulletproofs-work">How do Bulletproofs Work?</a></li>
<li><a href="cryptography/bulletproofs-and-mimblewimble/MainReport.html#applications-for-bulletproofs">Applications for Bulletproofs</a></li>
<li><a href="cryptography/bulletproofs-and-mimblewimble/MainReport.html#comparison-to-other-zero-knowledge-proof-systems">Comparison to other Zero-knowledge Proof Systems</a></li>
<li><a href="cryptography/bulletproofs-and-mimblewimble/MainReport.html#interesting-bulletproofs-implementation-snippets">Interesting Bulletproofs Implementation Snippets</a>
<ul>
<li><a href="cryptography/bulletproofs-and-mimblewimble/MainReport.html#current-and-past-efforts">Current and Past Efforts</a></li>
<li><a href="cryptography/bulletproofs-and-mimblewimble/MainReport.html#security-considerations">Security Considerations</a></li>
<li><a href="cryptography/bulletproofs-and-mimblewimble/MainReport.html#wallet-reconstruction-and-switch-commitment---grin">Wallet Reconstruction and Switch Commitment - Grin</a>
<ul>
<li><a href="cryptography/bulletproofs-and-mimblewimble/MainReport.html#initial-implementation">Initial Implementation</a></li>
<li><a href="cryptography/bulletproofs-and-mimblewimble/MainReport.html#improved-implementation">Improved Implementation</a></li>
<li><a href="cryptography/bulletproofs-and-mimblewimble/MainReport.html#github-extracts">GitHub Extracts</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="cryptography/bulletproofs-and-mimblewimble/MainReport.html#conclusions-observations-and-recommendations">Conclusions, Observations and Recommendations</a></li>
<li><a href="cryptography/bulletproofs-and-mimblewimble/MainReport.html#references">References</a></li>
<li><a href="cryptography/bulletproofs-and-mimblewimble/MainReport.html#appendices">Appendices</a>
<ul>
<li><a href="cryptography/bulletproofs-and-mimblewimble/MainReport.html#appendix-a-definition-of-terms">Appendix A: Definition of Terms</a></li>
<li><a href="cryptography/bulletproofs-and-mimblewimble/MainReport.html#appendix-b-notation-used">Appendix B: Notation Used</a></li>
</ul>
</li>
<li><a href="cryptography/bulletproofs-and-mimblewimble/MainReport.html#contributors">Contributors</a></li>
</ul>
<h2><a class="header" href="#introduction-3" id="introduction-3">Introduction</a></h2>
<h3><a class="header" href="#bulletproofs-1" id="bulletproofs-1">Bulletproofs</a></h3>
<p>Bulletproofs form part of the family of distinct <em>Zero-knowledge Proof</em><sup><a href="cryptography/bulletproofs-and-mimblewimble/MainReport.html#zk" title="In cryptography, a zero-knowledge 
proof/protocol is a method by which 
one party (the prover) can convince ...">def</a></sup> systems, such as Zero-Knowledge 
Succinct Non-Interactive ARguments of Knowledge (zk-SNARK); Succinct Transparent ARgument of Knowledge (STARK); and Zero 
Knowledge Prover and Verifier for Boolean Circuits (ZKBoo). Zero-knowledge proofs are designed so that a <em>prover</em> is 
able to indirectly verify that a statement is true without having to provide any information beyond the verification of 
the statement, e.g. to prove that a number is found that solves a cryptographic puzzle and fits the hash value 
without having to reveal the <em>Nonce</em><sup><a href="cryptography/bulletproofs-and-mimblewimble/MainReport.html#nonce" title="In security engineering, nonce is an 
abbreviation of number used once. 
In cryptography, a nonce is an arbitrary 
number ...">def</a></sup> ([<a href="https://diyhpl.us/wiki/transcripts/2018-02-02-andrew-poelstra-bulletproofs" title="Bulletproofs (Transcript)">2</a>], [<a href="https://medium.com/wolverineblockchain/decoding-zk-snarks-85e73886a040" title="Decoding zk-SNARKs">4</a>]).</p>
<p>The Bulletproofs technology is a Non-interactive Zero-knowledge (NIZK) proof protocol for general <em>Arithmetic 
Circuits</em><sup><a href="cryptography/bulletproofs-and-mimblewimble/MainReport.html#ac" title="An arithmetic circuit C over a 
field F and variables (x_1, ..., x_n) 
is a directed acyclic graph ...">def</a></sup> with very short proofs (<em>Arguments of Knowledge Systems</em><sup><a href="cryptography/bulletproofs-and-mimblewimble/MainReport.html#afs" title="Proof systems with computational 
soundness like Bulletproofs are 
sometimes called argument systems.">def</a></sup>) and without 
requiring a trusted setup. They rely on the <em>Discrete Logarithm</em><sup><a href="cryptography/bulletproofs-and-mimblewimble/MainReport.html#dlp" title="In the mathematics of the real 
numbers, the logarithm log_b(a) 
is a number x such that ...">def</a></sup> (DL) assumption and are made 
non-interactive using the <em>Fiat-Shamir Heuristic</em><sup><a href="cryptography/bulletproofs-and-mimblewimble/MainReport.html#fsh" title="The Fiat‑Shamir heuristic is a 
technique in cryptography to 
convert an interactive ...">def</a></sup>. The name &quot;Bulletproof&quot; originated from a 
non-technical summary from one of the original authors of the scheme's properties: &quot;<i>Short like a bullet with 
bulletproof security assumptions</i>&quot; ([<a href="http://web.stanford.edu/%7Ebuenz/pubs/bulletproofs.pdf" title="Bulletproofs: Short Proofs for Confidential Transactions and 
More">1</a>], [<a href="https://github.com/adjoint-io/bulletproofs" title="GitHub: adjoint-io/Bulletproofs, Bulletproofs are Short 
Non-interactive Zero-knowledge Proofs that Require no Trusted Setup">29</a>]).</p>
<p>Bulletproofs also implement a Multi-party Computation (MPC) protocol, whereby distributed proofs of multiple <em>provers</em> 
with secret committed values are aggregated into a single proof before the Fiat-Shamir challenge is calculated and sent 
to the <em>verifier</em>, thereby minimizing rounds of communication. Secret committed values will stay secret ([<a href="http://web.stanford.edu/%7Ebuenz/pubs/bulletproofs.pdf" title="Bulletproofs: Short Proofs for Confidential Transactions and 
More">1</a>], [<a href="http://diyhpl.us/wiki/transcripts/blockchain-protocol-analysis-security-engineering/2018/bulletproofs" title="Bulletproofs: Short Proofs for Confidential Transactions and More (Transcripts)">6</a>]).</p>
<p>The essence of Bulletproofs is its inner-product algorithm originally presented by Groth [<a href="https://link.springer.com/content/pdf/10.1007%2F978-3-642-03356-8_12.pdf" title="Linear Algebra with Sub-linear 
Zero-knowledge Arguments">13</a>] and then further refined 
by Bootle et al. [<a href="https://eprint.iacr.org/2016/263.pdf" title="Efficient Zero-knowledge Arguments for Arithmetic Circuits in the Discrete 
Log Setting">12</a>]. The latter development provided a proof (argument of knowledge) for two independent (not 
related) <em>binding</em><sup><a href="cryptography/bulletproofs-and-mimblewimble/MainReport.html#cs" title="A commitment scheme in a 
zero-knowledge proof is a 
cryptographic primitive ...">def</a></sup> vector <em>Pedersen Commitments</em><sup><a href="cryptography/bulletproofs-and-mimblewimble/MainReport.html#ecpc" title="An efficient implementation of the 
Pedersen Commitment  will use secure 
Elliptic Curve Cryptography, which is ...">def</a></sup> that satisfied the given 
inner-product relation. Bulletproofs build on these techniques, which yield communication-efficient, zero-knowledge 
proofs, but offer a further replacement for the inner product argument that reduces overall communication by a factor of 
three ([<a href="http://web.stanford.edu/%7Ebuenz/pubs/bulletproofs.pdf" title="Bulletproofs: Short Proofs for Confidential Transactions and 
More">1</a>], [<a href="https://github.com/adjoint-io/bulletproofs" title="GitHub: adjoint-io/Bulletproofs, Bulletproofs are Short 
Non-interactive Zero-knowledge Proofs that Require no Trusted Setup">29</a>]).</p>
<h3><a class="header" href="#mimblewimble" id="mimblewimble">Mimblewimble</a></h3>
<p><a href="cryptography/bulletproofs-and-mimblewimble/../../protocols/mimblewimble-1/MainReport.html">Mimblewimble</a> is a blockchain protocol designed for confidential 
transactions. The essence is that a Pedersen Commitment to $ 0 $ can be viewed as an Elliptic Curve Digital Signature 
Algorithm (ECDSA) public key, and that for a valid confidential transaction, the difference between outputs, inputs and 
transaction fees must be $ 0 $. A <em>prover</em> constructing a confidential transaction can therefore sign the transaction 
with the difference of the outputs and inputs as the public key. This enables a greatly simplified blockchain in which 
all spent transactions can be pruned, and new nodes can efficiently validate the entire blockchain without downloading 
any old and spent transactions. The blockchain consists only of block-headers, remaining Unspent Transaction Outputs 
(UTXO) with their range proofs and an unprunable transaction kernel per transaction. Mimblewimble also allows 
transactions to be aggregated before being committed to the blockchain ([<a href="http://web.stanford.edu/%7Ebuenz/pubs/bulletproofs.pdf" title="Bulletproofs: Short Proofs for Confidential Transactions and 
More">1</a>], [<a href="https://www.weusecoins.com/mimble-wimble-andrew-poelstra" title="Mimblewimble Explained">20</a>]).</p>
<h2><a class="header" href="#how-do-bulletproofs-work" id="how-do-bulletproofs-work">How do Bulletproofs Work?</a></h2>
<p>The basis of confidential transactions is to replace the input and output amounts with <em>Pedersen 
Commitments</em><sup><a href="cryptography/bulletproofs-and-mimblewimble/MainReport.html#ecpc" title="An efficient implementation of the 
Pedersen Commitment  will use secure 
Elliptic Curve Cryptography, which is ...">def</a></sup>. It is then publicly verifiable that the transactions balance (the sum of the 
committed inputs is greater than the sum of the committed outputs, and all outputs are positive), while keeping the 
specific committed amounts hidden. This makes it a zero-knowledge transaction. The transaction amounts must be encoded 
as $ integers \mod q ​$, which can overflow, but are prevented from doing so by making use of range proofs. This is where 
Bulletproofs come in. The essence of Bulletproofs is its ability to calculate proofs, including range proofs, from 
inner-products.</p>
<p>The <em>prover</em> must convince the <em>verifier</em> that commitment $ C(x,r) = xH + rG $ contains a number such that $ x \in 
[0,2^n - 1] $. If $ \mathbf {a} = (a_1 \mspace{3mu} , \mspace{3mu} ... \mspace{3mu} , \mspace{3mu} a_n) \in {0,1}^n 
$ is the vector containing the bits of $ x $, the basic idea is to hide all the bits of the amount in a single 
vector Pedersen Commitment. It must then be proven that each bit satisfies $ \omega(\omega-1) = 0 $, i.e. each 
$ \omega $ is either $ 0 $ or $ 1 $, and that they sum to $ x $. As part of the ensuing protocol, the <em>verifier</em> sends 
random linear combinations of constraints and challenges $ \in \mathbb{Z_p} $ to the <em>prover</em>. The 
<em>prover</em> is then able to construct a vectorized inner product relation containing the elements of $ \mathbf {a} $, the 
constraints and challenges $ \in \mathbb{Z_p} $, and appropriate blinding vectors $ \in \mathbb Z_p^n $.</p>
<p>These inner product vectors have size $ n ​$ that would require many expensive exponentiations. The Pedersen Commitment 
scheme, shown in Figure 1, allows for a vector to be cut in half, and for the two halves to be compressed together, 
each time calculating a new set of Pedersen Commitment generators. Applying the same trick repeatedly, $ \log _2 n ​$ 
times, produces a single value. This is applied to the inner product vectors; they are reduced interactively with a 
logarithmic number of rounds by the <em>prover</em> and <em>verifier</em> into a single multi-exponentiation of size 
$ 2n + 2 \log_2(n) + 1 ​$. This single multi-exponentiation can then be calculated much faster than $ n ​$ separate ones. 
All of this is made non-interactive using the Fiat-Shamir Heuristic<sup><a href="cryptography/bulletproofs-and-mimblewimble/MainReport.html#fsh" title="The Fiat‑Shamir heuristic is a 
technique in cryptography to 
convert an interactive ...">def</a></sup>.</p>
<p align="center"><img src="cryptography/bulletproofs-and-mimblewimble/sources/VectorCutNHalf.png" width="450" /></p>
<p align="center"><b>Figure&nbsp;1: Vector Pedersen Commitment Cut and Half ([<a href="https://eprint.iacr.org/2016/263.pdf" 
title="Efficient zero-knowledge arguments for arithmetic 
circuits in the discrete log setting, Bootle J et al.">12</a>], 
[<a href="https://www.benthamsgaze.org/2016/10/25/how-to-do-zero-knowledge-from-discrete-logs-in-under-7kb/" 
title="How to do Zero-Knowledge from Discrete-Logs 
in under 7kB, Bootle J.">63</a>])</b></p>
<p>Bulletproofs only rely on the discrete logarithm assumption. In practice, this means that Bulletproofs are 
compatible with any secure elliptic curve, making them extremely versatile. The proof sizes are short; only 
$ [2 \log_2(n) + 9] ​$ elements are required for the range proofs and $ [\log_2(n) + 13] ​$ elements for arithmetic 
circuit proofs, with $ n ​$ denoting the multiplicative complexity. Additionally, the logarithmic proof size enables the 
<em>prover</em> to aggregate multiple range proofs into a single short proof, as well as to aggregate multiple range proofs from 
different parties into one proof (refer to Figure 2) ([<a href="http://web.stanford.edu/%7Ebuenz/pubs/bulletproofs.pdf" title="Bulletproofs: Short Proofs for Confidential Transactions and 
More">1</a>], [<a href="https://drive.google.com/file/d/18OTVGX7COgvnZ7T0ke-ajhMWwOHOWfKV/view" title="Bulletproofs (Slides)">3</a>], [<a href="https://cyber.stanford.edu/sites/default/files/bpase18.pptx" title="Bulletproofs: Short Proofs for Confidential Transactions and More (Slides)">5</a>]).</p>
<p align="center"><img src="cryptography/bulletproofs-and-mimblewimble/sources/AggregateBulletproofsSize.png" width="650" /></p>
<p align="center"><b>Figure&nbsp;2: Logarithmic Aggregate Bulletproofs Proof Sizes 
[<a href="https://drive.google.com/file/d/18OTVGX7COgvnZ7T0ke-ajhMWwOHOWfKV/view" title="Bullet Proofs (Slides), 
Bitcoin Milan Meetup 2018-02-02, 
Andrew Poelstra">3</a>]</b></p>
If all Bitcoin transactions were confidential, approximately 50&nbsp;million UTXOs from approximately 22&nbsp;million 
transactions would result in roughly 160GB range proof data, when using current/linear proof systems and assuming use of 
52&nbsp;bits to represent any value from 1 satoshi up to 21 million bitcoins. Aggregated Bulletproofs would reduce the 
data storage 
requirement to less than 17GB [[1]].
<p>In Mimblewimble, the blockchain grows with the size of the UTXO set. Using Bulletproofs as a drop-in replacement for 
range proofs in confidential transactions, the size of the blockchain would only grow with the number of transactions 
that have unspent outputs. This is much smaller than the size of the UTXO set [<a href="http://web.stanford.edu/%7Ebuenz/pubs/bulletproofs.pdf" title="Bulletproofs: Short Proofs for Confidential Transactions and 
More">1</a>].</p>
<p>The recent implementation of Bulletproofs in Monero on 18 October 2018 saw the average data size on the 
blockchain per 
payment reduce by ~73% and the average USD-based fees reduce by ~94.5% for the period 30 August 2018 to 
28 November 2018 (refer to Figure 3).</p>
<p align="center"><img src="cryptography/bulletproofs-and-mimblewimble/sources/xmr-tx-size.png" width="650" /></p>
<p align="center"><b>Figure&nbsp;3: Monero Payment, Block and Data Size Statistics</b></p>
<h2><a class="header" href="#applications-for-bulletproofs" id="applications-for-bulletproofs">Applications for Bulletproofs</a></h2>
<p>Bulletproofs were designed for range proofs. However, they also generalize to arbitrary arithmetic circuits. 
In practice, this means that Bulletproofs have wide application and can be efficiently used for many types of proofs. 
Use cases of Bulletproofs are listed in this section, but this list may not be exhaustive, as use cases for Bulletproofs 
continue to evolve ([<a href="http://web.stanford.edu/%7Ebuenz/pubs/bulletproofs.pdf" title="Bulletproofs: Short Proofs for Confidential Transactions and 
More">1</a>], [<a href="https://diyhpl.us/wiki/transcripts/2018-02-02-andrew-poelstra-bulletproofs" title="Bulletproofs (Transcript)">2</a>], [<a href="https://drive.google.com/file/d/18OTVGX7COgvnZ7T0ke-ajhMWwOHOWfKV/view" title="Bulletproofs (Slides)">3</a>], [<a href="https://cyber.stanford.edu/sites/default/files/bpase18.pptx" title="Bulletproofs: Short Proofs for Confidential Transactions and More (Slides)">5</a>], [<a href="http://diyhpl.us/wiki/transcripts/blockchain-protocol-analysis-security-engineering/2018/bulletproofs" title="Bulletproofs: Short Proofs for Confidential Transactions and More (Transcripts)">6</a>], [<a href="https://blockstream.com/2018/02/21/bulletproofs-faster-rangeproofs-and-much-more/" title="Bulletproofs: Faster 
Rangeproofs and Much More">59</a>]). </p>
<ol>
<li>
<p>Range proofs</p>
<p>Range proofs are proofs that a secret value, which has been encrypted or committed to, lies in a certain interval. 
It prevents any numbers coming near the magnitude of a large prime, say $ 2^{256} $, that can cause wraparound when 
adding a small number, e.g. proof that $ x \in [0,2^{52} - 1] ​$.</p>
</li>
<li>
<p>Merkle proofs</p>
<p>Hash preimages in a Merkle tree [<a href="https://bitcoin.stackexchange.com/questions/69018/merkle-root-and-merkle-proofs" title="Merkle Root and Merkle Proofs">7</a>] can be leveraged to create zero-knowledge Merkle proofs using Bulletproofs, to 
create efficient proofs of inclusion in massive data sets.</p>
</li>
<li>
<p>Proof of solvency</p>
<p>Proofs of solvency are a specialized application of Merkle proofs; coins can be added into a giant Merkle tree. It 
can then be proven that some outputs are in the Merkle tree and that those outputs add up to some amount that the 
cryptocurrency exchange claims they have control over without revealing any private information. A Bitcoin exchange 
with 2 million customers needs approximately 18GB to prove solvency in a confidential manner using the Provisions 
protocol [<a href="https://eprint.iacr.org/2015/1008.pdf" title="Provisions: Privacy-preserving Proofs of Solvency for Bitcoin Exchanges">58</a>]. Using Bulletproofs and its variant protocols proposed in [<a href="http://web.stanford.edu/%7Ebuenz/pubs/bulletproofs.pdf" title="Bulletproofs: Short Proofs for Confidential Transactions and 
More">1</a>], this size could be reduced to 
approximately 62MB.</p>
</li>
<li>
<p>Multi-signatures with deterministic nonces</p>
<p>With Bulletproofs, every signatory can prove that their nonce was generated deterministically. A SHA256 arithmetic 
circuit could be used in a deterministic way to show that the de-randomized nonces were generated deterministically. 
This would still work if one signatory were to leave the conversation and rejoin later, with no memory of interacting 
with the other parties they were previously interacting with.</p>
</li>
<li>
<p>Scriptless scripts</p>
<p>Scriptless scripts is a way to do smart contracts exploiting the linear property of Schnorr signatures, using an 
older form of zero-knowledge proofs called a Sigma protocol. This can all be done with Bulletproofs, which could be 
extended to allow assets that are functions of other assets, i.e. crypto derivatives.</p>
</li>
<li>
<p>Smart contracts and crypto derivatives</p>
<p>Traditionally, a new trusted setup is needed for each smart contract when verifying privacy-preserving smart 
contracts, but with Bulletproofs, no trusted setup is needed. Verification time, however, is linear, and it might be 
too complex to prove every step in a smart contract. The Refereed Delegation Model [<a href="https://eprint.iacr.org/2011/518.pdf" title="Two 1-Round Protocols for Delegation of Computation">33</a>] has been proposed as an 
efficient protocol to verify smart contracts with public verifiability in the off-line stage, by making use of a 
specific verification circuit linked to a smart contract.</p>
<p>A <em>challenger</em> will input the proof to the verification circuit and get a binary response as to the validity of the 
proof. The <em>challenger</em> can then complain to the smart contract, claim the proof is invalid and send the proof, 
together with the output from a chosen gate in the verification circuit, to the smart contract. Interactive binary 
searches are then used to identify the gate where the proof turns invalid. Hence the smart contract must only 
check a single gate in the verification procedure to decide whether the <em>challenger</em> or <em>prover</em> was correct. The 
cost is logarithmic in the number of rounds and amount of communications, with the smart contract only doing one 
computation. A Bulletproof can be calculated as a short proof for the arbitrary computation in the smart contract, 
thereby creating privacy-preserving smart contracts (refer to Figure 4). </p>
</li>
</ol>
<p align="center"><img src="cryptography/bulletproofs-and-mimblewimble/sources/RefereedDelegation.png" width="600" /></p>
  <div align="center"><b>Figure&nbsp;4: Bulletproofs for Refereed Delegation Model 
  [<a href="https://cyber.stanford.edu/sites/default/files/bpase18.pptx" 
  title="Bulletproofs: Short Proofs for Confidential Transactions 
  and More (Slides), Blockchain Protocol Analysis and 
  Security Engineering 2018, 
  Bünz B. et al">5</a>]</b></div>
<ol start="7">
<li>
<p>Verifiable shuffles</p>
<p>Alice has some computation and wants to prove to Bob that she has done it correctly and has some secret inputs to 
this computation. It is possible to create a complex function that either evaluates to 1 if all secret inputs are 
correct and to 0 otherwise. Such a function can be encoded in an arithmetic circuit and can be implemented with 
Bulletproofs to prove that the transaction is valid.</p>
<p>When a proof is needed that one list of values $[x_1, ... , x_n]$ is a permutation of a second list of values
$[y_1, ... , y_n]$, it is called a verifiable shuffle. It has many applications, e.g. voting, blind signatures 
for untraceable payments and solvency proofs. Currently, the most efficient shuffle has size $O \sqrt{n}$. 
Bulletproofs can be used very efficiently to prove verifiable shuffles of size $O \log(n)$, as shown in Figure 5.</p>
<p>Another potential use case is to verify that two nodes executed the same list of independent instructions 
$ [x1,x4,x3,x2] $ and $ [x1,x2,x3,x4] $, which may be in different order, to arrive at the same next state $ N $. The 
nodes do not need to share the actual instructions with a <em>verifier</em>, but the <em>verifier</em> can show that they executed 
the same set without having knowledge of the instructions.</p>
</li>
</ol>
<p align="center"><img src="cryptography/bulletproofs-and-mimblewimble/sources/VerifiableShuffles.png" width="600" /></p>
  <div align="center"><b>Figure&nbsp;5: Bulletproofs for Verifiable Shuffles 
  [<a href="https://cyber.stanford.edu/sites/default/files/bpase18.pptx" 
  title="Bulletproofs: Short Proofs for Confidential Transactions 
  and More (Slides), Blockchain Protocol Analysis and 
  Security Engineering 2018, 
  Bünz B. et al">5</a>]</b></div>
<ol start="8">
<li>
<p>Batch verifications</p>
<p>Batch verifications can be done using one of the Bulletproofs derivative protocols. This has application where the 
<em>verifier</em> needs to verify multiple (separate) range proofs at once, e.g. a blockchain full node receiving a 
block of transactions needs to verify all transactions as well as range proofs. This batch verification is then 
implemented as one large multi-exponentiation; it is applied to reduce the number of expensive exponentiations.</p>
</li>
</ol>
<h2><a class="header" href="#comparison-to-other-zero-knowledge-proof-systems" id="comparison-to-other-zero-knowledge-proof-systems">Comparison to other Zero-knowledge Proof Systems</a></h2>
<p>Table 1 ([<a href="https://diyhpl.us/wiki/transcripts/2018-02-02-andrew-poelstra-bulletproofs" title="Bulletproofs (Transcript)">2</a>], [<a href="https://cyber.stanford.edu/sites/default/files/bpase18.pptx" title="Bulletproofs: Short Proofs for Confidential Transactions and More (Slides)">5</a>]) shows a high-level comparison between Sigma protocols (i.e. interactive public-coin 
protocols) and the different Zero-knowledge proof systems mentioned in this report. (The most desirable outcomes for 
each measurement are shown in <em><strong>bold italics</strong></em>.) The aim will be to have a proof system that is not interactive, has 
short proof sizes, has linear <em>prover</em> runtime scalability, has efficient (sub-linear) <em>verifier</em> runtime scalability, 
has no trusted setup, is practical and is at least DL secure. Bulletproofs are unique in that they are not interactive, 
have a short proof size, do not require a trusted setup, have very fast execution times and are practical to implement. 
These attributes make Bulletproofs extremely desirable to use as range proofs in cryptocurrencies.</p>
<div align="center"><b>Table 1: Comparison to other Zero-knowledge Proof Systems</b></div>
<table><thead><tr><th>Proof System</th><th>Sigma Protocols</th><th>zk-SNARK</th><th>STARK</th><th>ZKBoo</th><th>Bulletproofs</th></tr></thead><tbody>
<tr><td><b>Interactive</b></td><td>yes</td><td><em><strong>no</strong></em></td><td><em><strong>no</strong></em></td><td><em><strong>no</strong></em></td><td><em><strong>no</strong></em></td></tr>
<tr><td><b>Proof Size</b></td><td>long</td><td><em><strong>short</strong></em></td><td>shortish</td><td>long</td><td><em><strong>short</strong></em></td></tr>
<tr><td><b>Prover Runtime Scalability</b></td><td><em><strong>linear</strong></em></td><td>quasilinear</td><td>quasilinear (big memory requirement)</td><td><em><strong>linear</strong></em></td><td><em><strong>linear</strong></em></td></tr>
<tr><td><b>Verifier Runtime Scalability</b></td><td>linear</td><td><em>efficient</em></td><td><strong><em>efficient</em> (<em>poly-logarithmically</em>)</strong></td><td><em><strong>efficient</strong></em></td><td>linear</td></tr>
<tr><td><b>Trusted Setup</b></td><td><em><strong>no</strong></em></td><td>required</td><td><em><strong>no</strong></em></td><td><em><strong>no</strong></em></td><td><em><strong>no</strong></em></td></tr>
<tr><td><b>Practical</b></td><td><em><strong>yes</strong></em></td><td><em><strong>yes</strong></em></td><td>not   quite</td><td>somewhat</td><td><em><strong>yes</strong></em></td></tr>
<tr><td><b>Security Assumptions</b></td><td><em><strong>DL</strong></em></td><td>non-falsifiable, but not on par with DL</td><td><em><strong>quantum secure One-way Function (<a href="cryptography/bulletproofs-and-mimblewimble/MainReport.html#owf" title="A one-way function is a function that is easy to 
compute on every input, but hard to invert 
given the image of a random input.">OWF</a>) [<a href="https://en.wikipedia.org/wiki/One-way_function" title="Wikipedia: One-way Function">50</a>], which is better than DL</strong></em></td><td><em><strong>similar to STARKs</strong></em></td><td><em><strong>DL</strong></em></td></tr>
</tbody></table>
<h2><a class="header" href="#interesting-bulletproofs-implementation-snippets" id="interesting-bulletproofs-implementation-snippets">Interesting Bulletproofs Implementation Snippets</a></h2>
<p>Bulletproofs development is currently still evolving, as can be seen when following the different community development 
projects. Different implementations of Bulletproofs also offer different levels of efficiency, security and functionality. 
This section describes some of these aspects.</p>
<h3><a class="header" href="#current-and-past-efforts" id="current-and-past-efforts">Current and Past Efforts</a></h3>
<p>The initial prototype Bulletproofs' implementation was done by <a href="https://github.com/bbuenz">Benedikt Bünz</a> in Java 
located at <code>GitHub:bbuenz/BulletProofLib</code> [<a href="https://github.com/bbuenz/BulletProofLib" title="GitHub: bbuenz/BulletProofLib, Library for Generating Non-interactive 
Zero Knowledge Proofs without Trusted Setup (Bulletproofs)">27</a>].</p>
<p>The initial work that provided cryptographic support for a Mimblewimble implementation was mainly done by 
<a href="https://github.com/sipa">Pieter Wuille</a>, <a href="https://github.com/gmaxwell">Gregory Maxwell</a> and 
<a href="https://github.com/apoelstra">Andrew Poelstra</a> in C located at <code>GitHub:ElementsProject/secp256k1-zkp</code> [<a href="https://github.com/ElementsProject/secp256k1-zkp" title="GitHub: ElementsProject/secp256k1-zkp, Experimental Fork of 
libsecp256k1 with Support for Pedersen Commitments and Range Proofs">25</a>]. 
This effort was forked as <code>GitHub:apoelstra/secp256k1-mw</code> [<a href="https://github.com/apoelstra/secp256k1-mw/tree/bulletproofs" title="GitHub: apoelstra/secp256k1-mw, Fork of libsecp-zkp 
`d78f12b` to Add Support for Mimblewimble Primitives">26</a>] with main contributors being 
<a href="https://github.com/apoelstra">Andrew Poelstra</a>, <a href="https://github.com/sipa">Pieter Wuille</a>, and 
<a href="https://github.com/gmaxwell">Gregory Maxwell</a> where Mimblewimble primitives and support for many of the Bulletproof 
protocols (e.g. zero knowledge proofs, range proofs and arithmetic circuits) were added. Current effort also involves 
MuSig [<a href="https://eprint.iacr.org/2018/068.pdf" title="Simple Schnorr Multi-signatures with Applications to Bitcoin">48</a>] support.</p>
<p>The Grin project (an open source Mimblewimble implementation in Rust) subsequently forked 
<code>GitHub:ElementsProject/secp256k1-zkp</code> [<a href="https://github.com/ElementsProject/secp256k1-zkp" title="GitHub: ElementsProject/secp256k1-zkp, Experimental Fork of 
libsecp256k1 with Support for Pedersen Commitments and Range Proofs">25</a>] as <code>GitHub:mimblewimble/secp256k1-zkp</code> [<a href="https://github.com/mimblewimble/secp256k1-zkp" title="GitHub: mimblewimble/secp256k1-zkp, Fork of secp256k1-zkp for the 
Grin/MimbleWimble project">30</a>] and has added Rust wrappers 
to it as <code>mimblewimble/rust-secp256k1-zkp</code> [<a href="https://github.com/mimblewimble/rust-secp256k1-zkp" title="GitHub: mimblewimble/rust-secp256k1-zkp">45</a>] for use in its blockchain. The Beam project (another open source 
Mimblewimble implementation in C++) links directly to <code>GitHub:ElementsProject/secp256k1-zkp</code> [<a href="https://github.com/ElementsProject/secp256k1-zkp" title="GitHub: ElementsProject/secp256k1-zkp, Experimental Fork of 
libsecp256k1 with Support for Pedersen Commitments and Range Proofs">25</a>] as its cryptographic 
sub-module. Refer to <a href="cryptography/bulletproofs-and-mimblewimble/../../protocols/grin-protocol-overview/MainReport.html">Mimblewimble-Grin Blockchain Protocol Overview</a> 
and <a href="cryptography/bulletproofs-and-mimblewimble/../../protocols/grin-beam-comparison/MainReport.html">Grin vs. BEAM, a Comparison</a> for more information about the 
Mimblewimble implementation of Grin and Beam.</p>
<p>An independent implementation for Bulletproof range proofs was done for the Monero project (an open source CryptoNote 
implementation in C++) by <a href="https://github.com/SarangNoether">Sarang Noether</a> [<a href="https://github.com/b-g-goodell/research-lab/tree/master/source-code/StringCT-java" title="GitHub: 
b-g-goodell/research-lab">49</a>] in Java as the precursor and 
<a href="https://github.com/moneromooo-monero">moneromooo-monero</a> [<a href="https://github.com/monero-project/monero/tree/master/src/ringct" title="GitHub: monero-project/monero">46</a>] in C++ as the final implementation. Its implementation 
supports single and aggregate range proofs. </p>
<p>Adjoint, Inc. has also done an independent open source implementation of Bulletproofs in Haskell at 
<code>GitHub: adjoint-io/bulletproofs</code> [<a href="https://github.com/adjoint-io/bulletproofs" title="GitHub: adjoint-io/Bulletproofs, Bulletproofs are Short 
Non-interactive Zero-knowledge Proofs that Require no Trusted Setup">29</a>]. It has an open source implementation of a private permissioned blockchain 
with multiparty workflow aimed at the financial industry.</p>
<p>Chain/Interstellar has done another independent open source implementation of Bulletproofs in Rust from the ground up at 
<code>GitHub:dalek-cryptography/bulletproofs</code> [<a href="https://github.com/dalek-cryptography/bulletproofs" title="GitHub: dalek-cryptography/Bulletproofs, A Pure-Rust 
Implementation of Bulletproofs using Ristretto">28</a>]. It has implemented parallel Edwards formulas [<a href="https://iacr.org/archive/asiacrypt2008/53500329/53500329.pdf" title="Twisted Edwards Curves Revisited">39</a>] using Intel® 
Advanced Vector Extensions 2 (AVX2) to accelerate curve operations. Initial testing suggests approximately 50% speedup 
(twice as fast) over the original <code>libsecp256k1</code>-based Bulletproofs implementation.</p>
<h3><a class="header" href="#security-considerations" id="security-considerations">Security Considerations</a></h3>
<p>Real-world implementation of Elliptic-curve Cryptography (ECC) is largely based on official standards that govern the 
selection of curves in order to try and make the Elliptic-curve Discrete-logarithm Problem (ECDLP) hard to solve, i.e. 
finding an ECC user's secret key given the user's public key. Many attacks break real-world ECC without solving ECDLP 
due to problems in ECC security, where implementations can produce incorrect results and also leak secret data. Some 
implementation considerations also favor efficiency over security. Secure implementations of the standards-based curves 
are theoretically possible, but highly unlikely ([<a href="https://signal.org/docs/specifications/xeddsa" title="The XEdDSA and VXEdDSA Signature Schemes">14</a>], [<a href="http://safecurves.cr.yp.to/" title="SafeCurves: Choosing Safe Curves for Elliptic-curve Cryptography">32</a>]).</p>
<p>Grin, Beam and Adjoint use ECC curve secp256k1 [<a href="http://safecurves.cr.yp.to/www.secg.org/SEC2-Ver-1.0.pdf" title="SEC 2: Recommended Elliptic Curve Domain Parameters, 
Standards for Efficient Cryptography">24</a>] for their Bulletproofs implementation, which fails one out of the 
four ECDLP security criteria and three out of the four ECC security criteria. Monero and Chain/Interstellar use the 
ECC curve Curve25519 [<a href="https://cr.yp.to/ecdh/curve25519-20060209.pdf" title="Curve25519: New Diﬃe-Hellman Speed Records">38</a>] for their Bulletproofs implementation, which passes all ECDLP and ECC security criteria [<a href="http://safecurves.cr.yp.to/" title="SafeCurves: Choosing Safe Curves for Elliptic-curve Cryptography">32</a>].</p>
<p>Chain/Interstellar goes one step further with its use of Ristretto, a technique for constructing prime order elliptic 
curve groups with non-malleable encodings, which allows an existing Curve25519 library to implement a prime-order group 
with only a thin abstraction layer. This makes it possible for systems using Ed25519 signatures to be safely extended 
with zero-knowledge protocols, with no additional cryptographic assumptions and minimal code changes [<a href="https://ristretto.group/ristretto.html" title="The Ristretto Group">31</a>].</p>
<p>The Monero project has also had security audits done on its Bulletproofs' implementation, which resulted in a number of 
serious and critical bug fixes as well as some other code improvements  ([<a href="https://forum.getmonero.org/22/completed-tasks/90007/bulletproofs-audit-fundraising" title="Bulletproofs Audit: 
Fundraising">8</a>], [<a href="https://ostif.org/the-quarkslab-and-kudelski-security-audits-of-monero-bulletproofs-are-complete" title="The QuarksLab and 
Kudelski Security Audits of Monero Bulletproofs are Complete">9</a>], [<a href="https://ostif.org/the-ostif-and-quarkslab-audit-of-monero-bulletproofs-is-complete-critical-bug-patched/" title="The 
OSTIF and QuarksLab Audit of Monero Bulletproofs is Complete – Critical Bug Patched">11</a>]).</p>
<h3><a class="header" href="#wallet-reconstruction-and-switch-commitment---grin" id="wallet-reconstruction-and-switch-commitment---grin">Wallet Reconstruction and Switch Commitment - Grin</a></h3>
<p>Grin implemented a switch commitment [<a href="https://people.mmci.uni-saarland.de/%7Etruffing/papers/switch-commitments.pdf" title="Switch Commitments: A Safety Switch 
for Confidential Transactions">43</a>] as part of a transaction output to be ready for the age of quantum 
adversaries and to pose as a defense mechanism. It had an original implementation that was discarded (completely 
removed) due to it being complex, using a lot of space in the blockchain and allowing inclusion of arbitrary data. Grin 
also employed a complex scheme to embed the transaction amount inside a Bulletproof range proof for wallet 
reconstruction, which was linked to the original switch commitment hash implementation. The latest implementation 
improved on all those aspects and uses a much simpler method to regain the transaction amount from a Bulletproof range 
proof. </p>
<h4><a class="header" href="#initial-implementation" id="initial-implementation">Initial Implementation</a></h4>
<p>The initial Grin implementation ([<a href="https://github.com/mimblewimble/grin/issues/721" title="Message Hiding in Bulletproofs #721">21</a>], [<a href="https://github.com/mimblewimble/grin/issues/734" title="GitHub: mimblewimble/grin, Switch Commits / Bulletproofs - Status 
#734">34</a>]. [<a href="https://github.com/mimblewimble/grin/issues/273" title="GitHub: mimblewimble/grin, Bulletproofs #273">35</a>], [<a href="https://github.com/mimblewimble/grin/pull/730" title="GitHub: mimblewimble/grin, Bulletproof messages #730">54</a>]) hides two things in the Bulletproof range proof: a 
transaction amount for wallet reconstruction and an optional switch commitment hash to make the transaction perfectly 
<em>binding</em><sup><a href="cryptography/bulletproofs-and-mimblewimble/MainReport.html#cs" title="A commitment scheme in a 
zero-knowledge proof is a 
cryptographic primitive ...">def</a></sup> later on, as opposed to currently being perfectly <em>hiding</em><sup><a href="cryptography/bulletproofs-and-mimblewimble/MainReport.html#cs" title="A commitment scheme in a 
zero-knowledge proof is a 
cryptographic primitive ...">def</a></sup>. 
<em>Perfect</em> in this sense means that a quantum adversary (an attacker with infinite computing power) cannot tell what 
amount has been committed to and is also unable to produce fake commitments. <em>Computational</em> means that no efficient 
algorithm running in a practical amount of time can reveal the commitment amount or produce fake commitments, except 
with small probability. The Bulletproof range proofs are stored in the transaction kernel and will thus remain 
persistent in the blockchain.</p>
<p>In this implementation, a Grin transaction output contains the original (Elliptic Curve) <em>Pedersen 
Commitment</em><sup><a href="cryptography/bulletproofs-and-mimblewimble/MainReport.html#ecpc" title="An efficient implementation of the 
Pedersen Commitment  will use secure 
Elliptic Curve Cryptography, which is ...">def</a></sup> as well as the optional switch commitment hash. The switch commitment hash takes the 
resultant blinding factor $ b $, a third cyclic group random generator $ J $ and a wallet-seed derived random 
value $ r $ as input. The transaction output has the following form:</p>
<p>$$
(vG + bH \mspace{3mu} , \mspace{3mu} \mathrm{H_{B2}}(bJ \mspace{3mu} , \mspace{3mu} r))
\tag{1}
$$</p>
<p>where $ \mathrm{H_{B2}} $ is the BLAKE2 hash function [<a href="https://blake2.net" title="BLAKE2 — Fast Secure Hashing">44</a>] and $  \mathrm{H_{B2}}(bJ \mspace{3mu} , \mspace{3mu} r)  $ 
the switch commitment hash. In order for such an amount to be spent, the owner needs to reveal $ b , r $ so that the 
<em>verifier</em> can check the opening of $ \mathrm{H_{B2}}(bJ \mspace{3mu} , \mspace{3mu} r) $ by confirming that it matches 
the value stored in the switch commitment hash portion of the transaction output. Grin implemented the BLAKE2 hash 
function, which outperforms all mainstream hash function implementations in terms of hashing speed with similar security 
to the latest Secure Hash Algorithm 3 (SHA-3) standard [<a href="https://blake2.net" title="BLAKE2 — Fast Secure Hashing">44</a>].</p>
<p>In the event of quantum adversaries, the owner of an output can choose to stay anonymous and not claim ownership or 
reveal $ bJ $ and $ r $, whereupon the amount can be moved to the then hopefully forked quantum resistant blockchain.</p>
<p>In the Bulletproof range proof protocol, two 32-byte scalar nonces $ \tau_1 , \alpha $ (<em>not important to know what they 
are</em>) are generated with a secure random number generator. If the seed for the random number generator is known, the 
scalar values $ \tau_1 , \alpha $ can be recalculated when needed. Sixty-four (64) bytes worth of message space (out of 
674 bytes worth of range proof) are made available by embedding a message into those variables using a logic 
$ \mathrm{XOR} $ gate. This message space is used for the transaction amount for wallet reconstruction.</p>
<p>To ensure that the transaction amount of the output cannot be spent by only opening the (Elliptic Curve) Pedersen 
Commitment $ vG + bH $, the switch commitment hash and embedded message are woven into the Bulletproof range proof 
calculation. The initial part is done by seeding the random number generator used to calculate $ \tau_1 , \alpha $ with 
the output from a seed function $ \mathrm S $ that uses as input a nonce $ \eta $ (which may be equal to the original 
blinding factor $ b $), the (Elliptic Curve) Pedersen Commitment<sup><a href="cryptography/bulletproofs-and-mimblewimble/MainReport.html#ecpc" title="An efficient implementation of the 
Pedersen Commitment  will use secure 
Elliptic Curve Cryptography, which is ...">def</a></sup> $ P $ and the switch commitment 
hash</p>
<p>$$
\mathrm S (\eta \mspace{3mu} , \mspace{3mu} P \mspace{3mu} ,  \mspace{3mu} \mathrm{H_{B2}}(bJ \mspace{3mu} , 
\mspace{3mu} r) ) = \eta \mspace{3mu} \Vert \mspace{3mu} \mathrm{H_{S256}} 
(P \mspace{3mu} \Vert \mspace{3mu} \mathrm{H_{B2}}(bJ \mspace{3mu} , \mspace{3mu} r) )
\tag{2}
$$</p>
<p>where $ \mathrm{H_{S256}}$ is the SHA256 hash function. The Bulletproof range proof is then calculated with an adapted 
pair $ \tilde{\alpha} , \tilde{\tau_1} $, using the original $ \tau_1 , \alpha $ and two<br>32-byte words $ m_{w1} $ and 
$m_{w2} $ that make up the 64-byte embedded message as follows:</p>
<p>$$
\tilde{\alpha} = \mathrm {XOR} ( \alpha \mspace{3mu} , \mspace{3mu} m_{w1}) \mspace{12mu} \mathrm{and} \mspace{12mu} \tilde{\tau_1} = \mathrm {XOR} ( \tau_1 \mspace{3mu} , \mspace{3mu} m_{w2} )
\tag{3}
$$</p>
<p>To retrieve the embedded message, the process is simply inverted. Note that the owner of an output needs to keep record 
of the blinding factor $ b $, the nonce $ \eta $ if not equal to the blinding factor $ b $, as well as the wallet-seed 
derived random value $ r $ to be able to claim such an output.</p>
<h4><a class="header" href="#improved-implementation" id="improved-implementation">Improved Implementation</a></h4>
<p>The latter Grin implementation ([<a href="https://github.com/mimblewimble/grin/issues/998" title="GitHub: mimblewimble/grin, switch commitment discussion #998">56</a>], [<a href="https://github.com/mimblewimble/grin/pull/2007" title="GitHub: mimblewimble/grin, [DNM] Switch commitments #2007">57</a>]) uses Bulletproof range proof rewinding so that wallets can recognize 
their own transaction outputs. This negated the requirement to remember the wallet-seed derived random value $ r $, 
nonce $ \eta $ for the seed function $ \mathrm S $ and use of the adapted pair $ \tilde{\alpha} , \tilde{\tau_1} 
$ in the Bulletproof range proof calculation.</p>
<p>In this implementation, it is not necessary to remember a hash of the switch commitment as part of the transaction output 
set and for it to be passed around during a transaction. The switch commitment looks exactly like the original 
(Elliptic Curve) Pedersen Commitment $ vG + bH $, but in this instance the blinding factor $ b $ is tweaked to be </p>
<p>$$
b = b^\prime + \mathrm{H_{B2}} ( vG + b^\prime H \mspace{3mu} , \mspace{3mu} b^\prime J )
\tag{4}
$$</p>
<p>with $ b^\prime $ being the user generated blinding factor. The (Elliptic Curve) Pedersen Commitment then becomes</p>
<p>$$
vG + b^\prime H + \mathrm{H_{B2}} ( vG + b^\prime H \mspace{3mu} , \mspace{3mu} b^\prime J ) H
\tag{5}
$$</p>
<p>After activation of the switch commitment in the age of quantum adversaries, users can reveal 
$ ( vG + b^\prime H \mspace{3mu} , \mspace{3mu} b^\prime J ) $, and <em>verifiers</em> can check if it is computed correctly and 
use it as if it were the <em>ElGamal Commitment</em><sup><a href="cryptography/bulletproofs-and-mimblewimble/MainReport.html#egc" title="An ElGamal Commitment is a 
Pedersen Commitment with
additional commitment ...">def</a></sup> $ ( vG + b H \mspace{3mu} , \mspace{3mu} b J ) $. </p>
<h4><a class="header" href="#github-extracts" id="github-extracts">GitHub Extracts</a></h4>
<p>The following extracts of discussions depict the initial and improved implementations of the switch commitment and 
retrieving transactions amounts from Bulletproofs for wallet reconstruction.</p>
<p><strong>Bulletproofs #273</strong> [<a href="https://github.com/mimblewimble/grin/issues/273" title="GitHub: mimblewimble/grin, Bulletproofs #273">35</a>]</p>
<p>{<strong>yeastplume</strong>} &quot;The only thing I think we're missing here from being able to use this implementation is the ability 
to store an amount within the range proof (for wallet reconstruction). From conversations with @apoelstra earlier, I 
believe it's possible to store 64 bytes worth of 'message' (not nearly as much as the current range proofs).&quot;</p>
<p>{<strong>apoelstra</strong>} &quot;Ok, I can get you 64 bytes without much trouble (xoring them into* <code>tau_1</code> and <code>alpha</code> which are easy 
to extract from <code>tau_x</code> and <code>mu</code> if you know the original seed used to produce the randomness). I think it's possible to 
get another 32 bytes into <code>t</code> but that's way more involved since <code>t</code> is a big inner-product*.&quot; </p>
<p><strong>Message hiding in Bulletproofs #721</strong> [<a href="https://github.com/mimblewimble/grin/issues/721" title="Message Hiding in Bulletproofs #721">21</a>]</p>
<p>&quot;Breaking out from #273, we need the wind a message into a bulletproof similarly to how it could be done in 'Rangeproof 
Classic'. This is an absolute requirement as we need to embed an output's <code>SwitchCommitHash</code> (which is otherwise not 
committed to) and embed an output amount for wallet reconstruction. We should be able to embed up to 64 bytes of message 
without too much difficulty, and another 32 with more difficulty (see original issue). 64 should be enough for the time 
being.&quot;</p>
<p><strong>Switch Commits/Bulletproofs - Status #734</strong> [<a href="https://github.com/mimblewimble/grin/issues/734" title="GitHub: mimblewimble/grin, Switch Commits / Bulletproofs - Status 
#734">34</a>]</p>
<p>&quot;The <strong>prove</strong> function takes a <strong>value</strong>, a <strong>secret key</strong> (blinding factor in our case), a <strong>nonce</strong>, optional 
<strong>extra_data</strong> and a <strong>generator</strong> and produces a 674 byte proof. I've also modified it to optionally take a <strong>message</strong> 
(more about this in a bit). It creates the Pedersen <strong>commitment</strong> it works upon internally with these values.&quot;</p>
<p>&quot;The <strong>verify</strong> function takes a <strong>proof</strong>, a Pedersen <strong>commitment</strong> and optional <strong>extra_data</strong> and returns true if 
<strong>proof</strong> demonstrates that the value within the Pedersen <strong>commitment</strong> is in the range [0..2^64] (and the 
<strong>extra_data</strong> is correct).&quot;</p>
<p>&quot;Additionally, I've added an <strong>unwind</strong> function which takes a <strong>proof</strong>, a Pedersen <strong>commitment</strong>, optional 
<strong>extra_data</strong> and a 32 bit <strong>nonce</strong> (which needs to be the same as the original nonce used in order to return the same 
message) and returns the hidden <strong>message</strong>.&quot;</p>
<p>&quot;If you have the correct Pedersen <strong>commitment</strong> and <strong>proof</strong> and <strong>extra_data</strong>, and attempt to unwind a <strong>message</strong> 
out using the wrong <strong>nonce</strong>, the attempt won't fail, you'll get out gibberish or just wildly incorrect values as you 
parse back the bytes.&quot;</p>
<p>&quot;The <code>SwitchCommitHash</code>  is currently a field of an output, and while it is stored in the Txo set and passed around 
during a transaction, it is not currently included in the output's hash. It is passed in as the <strong>extra_data</strong> field 
above, meaning that anyone validating the range proof also needs to have the correct switch commit in order to validate 
the range proof.&quot;</p>
<p><strong>Removed all switch commitment usages, including restore #841</strong> [<a href="https://github.com/mimblewimble/grin/pull/841" title="GitHub: mimblewimble/grin, Removed all switch commitment usages, 
including restore #841">55</a>]</p>
<p>{<strong>ignopeverell</strong>} &quot;After some discussion with @antiochp, @yeastplume and @tromp, we decided switch commitments weren't 
worth the cost of maintaining them and their drawbacks. Removing them.&quot;</p>
<p>{<strong>ignopeverell</strong>} &quot;For reference, switch commitments were found to:</p>
<ul>
<li>add a lot of complexity and assumptions</li>
<li>take additional space for little benefit right now</li>
<li>allow the inclusion of arbitrary data, potentially for the worst</li>
<li>provide little to no advantage in case of quantamageddon (as range proofs are still a weakness)&quot;</li>
</ul>
<p>{<strong>apoelstra</strong>} &quot;After chatting with @yeastplume on IRC, I realize that we can actually use rangeproof rewinding for 
wallets to recognize their own outputs, which even avoids the &quot;gap&quot; problem of just scanning for pre-generated keys. 
With that in mind, it's true that the benefit of switch commitments for MW are not spectacular.&quot;</p>
<p><strong>Switch commitment discussion #998</strong> [<a href="https://github.com/mimblewimble/grin/issues/998" title="GitHub: mimblewimble/grin, switch commitment discussion #998">56</a>]</p>
<p>{<strong>antiochp</strong>} &quot;Sounds like there is a &quot;zero cost&quot; way of getting switch commitments in as part of the commitment 
itself, so we would not need to store and maintain a separate &quot;switch commitment&quot; on each output. I saw that switch 
commitments have been removed for various reasons.&quot;</p>
<p>&quot;Let me suggest a variant (idea suggested by Pieter Wuille initially): The switch commitment is (vG + bH), where 
b = b' + hash(vG + b'H,b'J). (So this &quot;tweaks&quot; the commitment, in a pay-to-contract / taproot style). Before the switch, 
this is just used like a normal Pedersen Commitment vG + bH. After the switch, users can reveal (vG + b'H, b'J), and 
verifiers check if it's computed correctly and use as if it were the ElGamal commitment (vG + bH, bJ).&quot;</p>
<p>{<strong>@ignopeverell</strong>} modified the milestones: Beta / testnet3, Mainnet on 11 Jul.</p>
<p>{<strong>@ignopeverell</strong>} added the must-have label on 24 Aug.</p>
<h2><a class="header" href="#conclusions-observations-and-recommendations-2" id="conclusions-observations-and-recommendations-2">Conclusions, Observations and Recommendations</a></h2>
<ul>
<li>
<p>Bulletproofs are not Bulletproofs are not Bulletproofs. This is evident by comparing the functionality, security and 
performance of all the current different Bulletproof implementations as well as the evolving nature of Bulletproofs.</p>
</li>
<li>
<p>The security audit instigated by the Monero project on their Bulletproofs implementation as well as the resulting 
findings and corrective actions prove that every implementation of Bulletproofs has potential risk. This risk is due to 
the nature of confidential transactions; transacted values and token owners are not public.</p>
</li>
<li>
<p>The growing number of open source Bulletproof implementations should strengthen the development of a new confidential 
blockchain protocol such as Tari.</p>
</li>
<li>
<p>In the pure implementation of Bulletproof range proofs, a discrete-log attacker (<em>e.g. a bad actor employing a quantum 
computer</em>) would be able to exploit Bulletproofs to silently inflate any currency that used them. Bulletproofs are perfectly 
<em>hiding</em><sup><a href="cryptography/bulletproofs-and-mimblewimble/MainReport.html#cs" title="A commitment scheme in a 
zero-knowledge proof is a 
cryptographic primitive ...">def</a></sup> (<em>i.e. confidential</em>), but only computationally <em>binding</em><sup><a href="cryptography/bulletproofs-and-mimblewimble/MainReport.html#cs" title="A commitment scheme in a 
zero-knowledge proof is a 
cryptographic primitive ...">def</a></sup> (<em>i.e. not 
quantum resistant</em>). Unconditional soundness is lost due to the data compression being employed ([<a href="http://web.stanford.edu/%7Ebuenz/pubs/bulletproofs.pdf" title="Bulletproofs: Short Proofs for Confidential Transactions and 
More">1</a>], [<a href="https://cyber.stanford.edu/sites/default/files/bpase18.pptx" title="Bulletproofs: Short Proofs for Confidential Transactions and More (Slides)">5</a>], [<a href="http://diyhpl.us/wiki/transcripts/blockchain-protocol-analysis-security-engineering/2018/bulletproofs" title="Bulletproofs: Short Proofs for Confidential Transactions and More (Transcripts)">6</a>] 
and [<a href="https://www.reddit.com/r/Bitcoin/comments/7w72pq/bulletproofs_presentation_at_feb_2_milan_meetup" title="Bulletproofs 
Presentation at Feb 2 Milan Meetup">10</a>]).</p>
</li>
<li>
<p>Bulletproofs are not only about range proofs. All the different Bulletproof use cases have a potential implementation 
in a new confidential blockchain protocol such as Tari; in the base layer as well as in the probable second layer.</p>
</li>
</ul>
<h2><a class="header" href="#references-5" id="references-5">References</a></h2>
<p>[<a href="http://web.stanford.edu/%7Ebuenz/pubs/bulletproofs.pdf" title="Bulletproofs: Short Proofs for Confidential Transactions and 
More">1</a>] B. Bünz, J. Bootle, D. Boneh, A. Poelstra, P. Wuille and G. Maxwell, &quot;Bulletproofs: Short Proofs for Confidential 
Transactions and More&quot;, Blockchain Protocol Analysis and Security Engineering 2018 [online]. 
Available: <a href="http://web.stanford.edu/%7Ebuenz/pubs/bulletproofs.pdf">http://web.stanford.edu/~buenz/pubs/bulletproofs.pdf</a>. Date accessed: 2018‑09‑18.</p>
<p>[<a href="https://diyhpl.us/wiki/transcripts/2018-02-02-andrew-poelstra-bulletproofs" title="Bulletproofs (Transcript)">2</a>] A. Poelstra, &quot;Bulletproofs&quot; (Transcript), Bitcoin Milan Meetup 2018‑02‑02 [online]. Available: 
<a href="https://diyhpl.us/wiki/transcripts/2018-02-02-andrew-poelstra-Bulletproofs">https://diyhpl.us/wiki/transcripts/2018-02-02-andrew-poelstra-Bulletproofs</a>. Date accessed: 2018‑09‑10. </p>
<p>[<a href="https://drive.google.com/file/d/18OTVGX7COgvnZ7T0ke-ajhMWwOHOWfKV/view" title="Bulletproofs (Slides)">3</a>] A. Poelstra, &quot;Bulletproofs&quot; (Slides), Bitcoin Milan Meetup 2018‑02‑02 [online]. Available: 
<a href="https://drive.google.com/file/d/18OTVGX7COgvnZ7T0ke-ajhMWwOHOWfKV/view">https://drive.google.com/file/d/18OTVGX7COgvnZ7T0ke-ajhMWwOHOWfKV/view</a>. Date accessed: 2018‑09‑10. </p>
<p>[<a href="https://medium.com/wolverineblockchain/decoding-zk-snarks-85e73886a040" title="Decoding zk-SNARKs">4</a>] B. Feng, &quot;Decoding zk-SNARKs&quot; [online]. Available: 
<a href="https://medium.com/wolverineblockchain/decoding-zk-snarks-85e73886a040">https://medium.com/wolverineblockchain/decoding-zk-snarks-85e73886a040</a>. Date accessed: 2018‑09‑17. </p>
<p>[<a href="https://cyber.stanford.edu/sites/default/files/bpase18.pptx" title="Bulletproofs: Short Proofs for Confidential Transactions and More (Slides)">5</a>] B. Bünz, J. Bootle, D. Boneh, A. Poelstra, P. Wuille and G. Maxwell, &quot;Bulletproofs: Short Proofs for 
Confidential Transactions and More&quot; (Slides) [online]. Available: 
<a href="https://cyber.stanford.edu/sites/default/files/bpase18.pptx">https://cyber.stanford.edu/sites/default/files/bpase18.pptx</a>. Date accessed: 2018‑09‑18. </p>
<p>[<a href="http://diyhpl.us/wiki/transcripts/blockchain-protocol-analysis-security-engineering/2018/bulletproofs" title="Bulletproofs: Short Proofs for Confidential Transactions and More (Transcripts)">6</a>] B. Bünz, J. Bootle, D. Boneh, A. Poelstra, P. Wuille and G. Maxwell, &quot;Bulletproofs: Short Proofs for 
Confidential Transactions and More (Transcripts)&quot; [online]. Available: 
<a href="http://diyhpl.us/wiki/transcripts/blockchain-protocol-analysis-security-engineering/2018/Bulletproofs">http://diyhpl.us/wiki/transcripts/blockchain-protocol-analysis-security-engineering/2018/Bulletproofs</a>. Date accessed: 
2018‑09‑18. </p>
<p>[<a href="https://bitcoin.stackexchange.com/questions/69018/merkle-root-and-merkle-proofs" title="Merkle Root and Merkle Proofs">7</a>] &quot;Merkle Root and Merkle Proofs&quot; [online]. Available: 
<a href="https://bitcoin.stackexchange.com/questions/69018/Merkle-root-and-Merkle-proofs">https://bitcoin.stackexchange.com/questions/69018/Merkle-root-and-Merkle-proofs</a>. Date accessed: 2018‑10‑10. </p>
<p>[<a href="https://forum.getmonero.org/22/completed-tasks/90007/bulletproofs-audit-fundraising" title="Bulletproofs Audit: 
Fundraising">8</a>] &quot;Bulletproofs Audit: Fundraising&quot; [online]. Available: 
<a href="https://forum.getmonero.org/22/completed-tasks/90007/Bulletproofs-audit-fundraising">https://forum.getmonero.org/22/completed-tasks/90007/Bulletproofs-audit-fundraising</a>. Date accessed: 2018‑10‑23. </p>
<p>[<a href="https://ostif.org/the-quarkslab-and-kudelski-security-audits-of-monero-bulletproofs-are-complete" title="The QuarksLab and 
Kudelski Security Audits of Monero Bulletproofs are Complete">9</a>] &quot;The QuarksLab and Kudelski Security Audits of Monero Bulletproofs are Complete&quot; [online]. Available: 
<a href="https://ostif.org/the-quarkslab-and-kudelski-security-audits-of-monero-Bulletproofs-are-complete">https://ostif.org/the-quarkslab-and-kudelski-security-audits-of-monero-Bulletproofs-are-complete</a>. Date accessed: 
2018‑10‑23. </p>
<p>[<a href="https://www.reddit.com/r/Bitcoin/comments/7w72pq/bulletproofs_presentation_at_feb_2_milan_meetup" title="Bulletproofs 
Presentation at Feb 2 Milan Meetup">10</a>] A. Poelstra, &quot;Bulletproofs Presentation at Feb 2 Milan Meetup, Reddit&quot; [online]. Available: 
<a href="https://www.reddit.com/r/Bitcoin/comments/7w72pq/Bulletproofs_presentation_at_feb_2_milan_meetup">https://www.reddit.com/r/Bitcoin/comments/7w72pq/Bulletproofs_presentation_at_feb_2_milan_meetup</a>. Date accessed: 
2018‑09‑10. </p>
<p>[<a href="https://ostif.org/the-ostif-and-quarkslab-audit-of-monero-bulletproofs-is-complete-critical-bug-patched/" title="The 
OSTIF and QuarksLab Audit of Monero Bulletproofs is Complete – Critical Bug Patched">11</a>] &quot;The OSTIF and QuarksLab Audit of Monero Bulletproofs is Complete – Critical Bug Patched [online]&quot;. Available: 
<a href="https://ostif.org/the-ostif-and-quarkslab-audit-of-monero-Bulletproofs-is-complete-critical-bug-patched">https://ostif.org/the-ostif-and-quarkslab-audit-of-monero-Bulletproofs-is-complete-critical-bug-patched</a>. Date 
accessed: 2018-10-23. </p>
<p>[<a href="https://eprint.iacr.org/2016/263.pdf" title="Efficient Zero-knowledge Arguments for Arithmetic Circuits in the Discrete 
Log Setting">12</a>] J. Bootle, A. Cerulli1, P. Chaidos, J. Groth and C. Petit, &quot;Efficient Zero-knowledge Arguments for Arithmetic 
Circuits in the Discrete Log Setting&quot;, Annual International Conference on the Theory and Applications of Cryptographic 
Techniques, pages 327-357. Springer, 2016 [online]. Available: <a href="https://eprint.iacr.org/2016/263.pdf">https://eprint.iacr.org/2016/263.pdf</a>. Date accessed: 
2018‑09‑21. </p>
<p>[<a href="https://link.springer.com/content/pdf/10.1007%2F978-3-642-03356-8_12.pdf" title="Linear Algebra with Sub-linear 
Zero-knowledge Arguments">13</a>] J. Groth, &quot;Linear Algebra with Sub-linear Zero-knowledge Arguments&quot; [online]. Available: 
<a href="https://link.springer.com/content/pdf/10.1007%2F978-3-642-03356-8_12.pdf">https://link.springer.com/content/pdf/10.1007%2F978-3-642-03356-8_12.pdf</a>. Date accessed: 2018‑09‑21. </p>
<p>[<a href="https://signal.org/docs/specifications/xeddsa" title="The XEdDSA and VXEdDSA Signature Schemes">14</a>] T. Perrin, &quot;The XEdDSA and VXEdDSA Signature Schemes&quot;, 2016-10-20 [online]. Available: 
<a href="https://signal.org/docs/specifications/xeddsa">https://signal.org/docs/specifications/xeddsa</a> and <a href="https://signal.org/docs/specifications/xeddsa/xeddsa.pdf">https://signal.org/docs/specifications/xeddsa/xeddsa.pdf</a>. Date 
accessed: 2018‑10‑23. </p>
<p>[<a href="https://blockstream.com/bitcoin17-final41.pdf" title="Confidential Assets">15</a>] A. Poelstra, A. Back, M. Friedenbach, G. Maxwell and P. Wuille, &quot;Confidential Assets&quot;, Blockstream [online]. 
Available: <a href="https://blockstream.com/bitcoin17-final41.pdf">https://blockstream.com/bitcoin17-final41.pdf</a>. Date accessed: 2018‑09‑25. </p>
<p>[<a href="https://en.wikipedia.org/wiki/Zero-knowledge_proof" title="Wikipedia - Zero-knowledge Proof">16</a>] Wikipedia: &quot;Zero-knowledge Proof&quot; [online]. Available: <a href="https://en.wikipedia.org/wiki/Zero-knowledge_proof">https://en.wikipedia.org/wiki/Zero-knowledge_proof</a>. 
Date accessed: 2018‑09‑18. </p>
<p>[<a href="https://en.wikipedia.org/wiki/Discrete_logarithm" title="Wikipedia: Discrete Logarithm">17</a>] Wikipedia: &quot;Discrete Logarithm&quot; [online]. Available: <a href="https://en.wikipedia.org/wiki/Discrete_logarithm">https://en.wikipedia.org/wiki/Discrete_logarithm</a>. Date 
accessed: 2018‑09‑20. </p>
<p>[<a href="https://link.springer.com/content/pdf/10.1007%2F3-540-47721-7_12.pdf" title="How to Prove Yourself: Practical Solutions 
to Identification and Signature Problems">18</a>] A. Fiat and A. Shamir, &quot;How to Prove Yourself: Practical Solutions to Identification and Signature Problems&quot;. 
CRYPTO 1986: pp. 186‑194 [online]. Available: <a href="https://link.springer.com/content/pdf/10.1007%2F3-540-47721-7_12.pdf">https://link.springer.com/content/pdf/10.1007%2F3-540-47721-7_12.pdf</a>. 
Date accessed: 2018‑09‑20. </p>
<p>[<a href="https://link.springer.com/content/pdf/10.1007%2F978-3-642-34961-4_38.pdf" title="How not to Prove Yourself: Pitfalls of 
the Fiat-Shamir Heuristic and Applications to Helios">19</a>] D. Bernhard, O. Pereira and B. Warinschi, &quot;How not to Prove Yourself: Pitfalls of the Fiat-Shamir Heuristic and 
Applications to Helios&quot; [online]. Available: <a href="https://link.springer.com/content/pdf/10.1007%2F978-3-642-34961-4_38.pdf">https://link.springer.com/content/pdf/10.1007%2F978-3-642-34961-4_38.pdf</a>. 
Date accessed: 2018‑09‑20. </p>
<p>[<a href="https://www.weusecoins.com/mimble-wimble-andrew-poelstra" title="Mimblewimble Explained">20</a>] &quot;Mimblewimble Explained&quot; [online]. Available: <a href="https://www.weusecoins.com/mimble-wimble-andrew-poelstra/">https://www.weusecoins.com/mimble-wimble-andrew-poelstra/</a>. Date 
accessed: 2018‑09‑10. </p>
<p>[<a href="https://github.com/mimblewimble/grin/issues/721" title="Message Hiding in Bulletproofs #721">21</a>] GitHub: &quot;Message Hiding in Bulletproofs #721&quot; [online]. Available: <a href="https://github.com/mimblewimble/grin/issues/721">https://github.com/mimblewimble/grin/issues/721</a>. 
Date accessed: 2018‑09‑10. </p>
<p>[<a href="https://hackage.haskell.org/package/pedersen-commitment" title="Pedersen-commitment: An Implementation of Pedersen 
Commitment Schemes">22</a>] Pedersen-commitment: &quot;An Implementation of Pedersen Commitment Schemes&quot; [online]. Available: 
<a href="https://hackage.haskell.org/package/pedersen-commitment">https://hackage.haskell.org/package/pedersen-commitment</a>. Date accessed: 2018-09-25. </p>
<p>[<a href="https://zkproof.org/documents.html" title="Zero Knowledge Proof Standardization - An Open Industry/Academic Initiative">23</a>] &quot;Zero Knowledge Proof Standardization - An Open Industry/Academic Initiative&quot; [online]. Available: 
<a href="https://zkproof.org/documents.html">https://zkproof.org/documents.html</a>. Date accessed: 2018‑09‑26. </p>
<p>[<a href="http://safecurves.cr.yp.to/www.secg.org/SEC2-Ver-1.0.pdf" title="SEC 2: Recommended Elliptic Curve Domain Parameters, 
Standards for Efficient Cryptography">24</a>] &quot;SEC 2: Recommended Elliptic Curve Domain Parameters, Standards for Efficient Cryptography&quot;, 20 September 2000 
[online]. Available: <a href="http://safecurves.cr.yp.to/www.secg.org/SEC2-Ver-1.0.pdf">http://safecurves.cr.yp.to/www.secg.org/SEC2-Ver-1.0.pdf</a>. Date accessed: 2018‑09‑26. </p>
<p>[<a href="https://github.com/ElementsProject/secp256k1-zkp" title="GitHub: ElementsProject/secp256k1-zkp, Experimental Fork of 
libsecp256k1 with Support for Pedersen Commitments and Range Proofs">25</a>] GitHub: &quot;ElementsProject/secp256k1-zkp, Experimental Fork of libsecp256k1 with Support for Pedersen Commitments 
and Range Proofs&quot; [online]. Available: <a href="https://github.com/ElementsProject/secp256k1-zkp">https://github.com/ElementsProject/secp256k1-zkp</a>. Date accessed: 2018‑09‑18. </p>
<p>[<a href="https://github.com/apoelstra/secp256k1-mw/tree/bulletproofs" title="GitHub: apoelstra/secp256k1-mw, Fork of libsecp-zkp 
`d78f12b` to Add Support for Mimblewimble Primitives">26</a>] GitHub: &quot;apoelstra/secp256k1-mw, Fork of libsecp-zkp <code>d78f12b</code> to Add Support for Mimblewimble Primitives&quot; 
[online]. Available: <a href="https://github.com/apoelstra/secp256k1-mw/tree/Bulletproofs">https://github.com/apoelstra/secp256k1-mw/tree/Bulletproofs</a>. Date accessed: 2018‑09‑18. </p>
<p>[<a href="https://github.com/bbuenz/BulletProofLib" title="GitHub: bbuenz/BulletProofLib, Library for Generating Non-interactive 
Zero Knowledge Proofs without Trusted Setup (Bulletproofs)">27</a>] GitHub: &quot;bbuenz/BulletProofLib, Library for Generating Non-interactive Zero Knowledge Proofs without Trusted 
Setup (Bulletproofs)&quot; [online]. Available: <a href="https://github.com/bbuenz/BulletProofLib">https://github.com/bbuenz/BulletProofLib</a>. Date accessed: 2018‑09‑18. </p>
<p>[<a href="https://github.com/dalek-cryptography/bulletproofs" title="GitHub: dalek-cryptography/Bulletproofs, A Pure-Rust 
Implementation of Bulletproofs using Ristretto">28</a>] GitHub: &quot;dalek-cryptography/Bulletproofs, A Pure-Rust Implementation of Bulletproofs using Ristretto&quot; [online]. 
Available: <a href="https://github.com/dalek-cryptography/Bulletproofs">https://github.com/dalek-cryptography/Bulletproofs</a>. Date accessed: 2018-09-18. </p>
<p>[<a href="https://github.com/adjoint-io/bulletproofs" title="GitHub: adjoint-io/Bulletproofs, Bulletproofs are Short 
Non-interactive Zero-knowledge Proofs that Require no Trusted Setup">29</a>] GitHub: &quot;adjoint-io/Bulletproofs, Bulletproofs are Short Non-interactive Zero-knowledge Proofs that Require no 
Trusted Setup&quot; [online]. Available: <a href="https://github.com/adjoint-io/Bulletproofs">https://github.com/adjoint-io/Bulletproofs</a>. Date accessed: 2018‑09‑10. </p>
<p>[<a href="https://github.com/mimblewimble/secp256k1-zkp" title="GitHub: mimblewimble/secp256k1-zkp, Fork of secp256k1-zkp for the 
Grin/MimbleWimble project">30</a>] GitHub: &quot;mimblewimble/secp256k1-zkp, Fork of secp256k1-zkp for the Grin/MimbleWimble project&quot; [online]. Available: 
<a href="https://github.com/mimblewimble/secp256k1-zkp">https://github.com/mimblewimble/secp256k1-zkp</a>. Date accessed: 2018-09-18. </p>
<p>[<a href="https://ristretto.group/ristretto.html" title="The Ristretto Group">31</a>] &quot;The Ristretto Group&quot; [online]. Available: <a href="https://ristretto.group/ristretto.html">https://ristretto.group/ristretto.html</a>. Date accessed: 2018‑10‑23. </p>
<p>[<a href="http://safecurves.cr.yp.to/" title="SafeCurves: Choosing Safe Curves for Elliptic-curve Cryptography">32</a>] &quot;SafeCurves: Choosing Safe Curves for Elliptic-curve Cryptography&quot; [online]. Available: 
<a href="http://safecurves.cr.yp.to/">http://safecurves.cr.yp.to/</a>. Date accessed: 2018‑10‑23. </p>
<p>[<a href="https://eprint.iacr.org/2011/518.pdf" title="Two 1-Round Protocols for Delegation of Computation">33</a>] R. Canetti, B. Riva and G. N. Rothblum, &quot;Two 1-Round Protocols for Delegation of Computation&quot; [online]. 
Available: <a href="https://eprint.iacr.org/2011/518.pdf">https://eprint.iacr.org/2011/518.pdf</a>. Date accessed: 2018‑10‑11. </p>
<p>[<a href="https://github.com/mimblewimble/grin/issues/734" title="GitHub: mimblewimble/grin, Switch Commits / Bulletproofs - Status 
#734">34</a>] GitHub: &quot;mimblewimble/grin, Switch Commits / Bulletproofs - Status #734&quot; [online]. Available: 
<a href="https://github.com/mimblewimble/grin/issues/734">https://github.com/mimblewimble/grin/issues/734</a>. Date accessed: 2018-09-10. </p>
<p>[<a href="https://github.com/mimblewimble/grin/issues/273" title="GitHub: mimblewimble/grin, Bulletproofs #273">35</a>] GitHub: &quot;mimblewimble/grin, Bulletproofs #273&quot; [online]. Available: 
<a href="https://github.com/mimblewimble/grin/issues/273">https://github.com/mimblewimble/grin/issues/273</a>. Date accessed: 2018‑09‑10. </p>
<p>[<a href="https://en.wikipedia.org/wiki/Commitment_scheme" title="Wikipedia: Commitment Scheme">36</a>] Wikipedia: &quot;Commitment Scheme&quot; [online]. Available: <a href="https://en.wikipedia.org/wiki/Commitment_scheme">https://en.wikipedia.org/wiki/Commitment_scheme</a>. Date 
accessed: 2018‑09‑26. </p>
<p>[<a href="http://cryptography.wikia.com/wiki/Commitment_scheme" title="Cryptography Wikia: Commitment Scheme">37</a>] Cryptography Wikia: &quot;Commitment Scheme&quot; [online]. Available: 
<a href="http://cryptography.wikia.com/wiki/Commitment_scheme">http://cryptography.wikia.com/wiki/Commitment_scheme</a>. Date accessed: 2018‑09‑26. </p>
<p>[<a href="https://cr.yp.to/ecdh/curve25519-20060209.pdf" title="Curve25519: New Diﬃe-Hellman Speed Records">38</a>] D. J. Bernstein, &quot;Curve25519: New Diﬃe-Hellman Speed Records&quot; [online]. Available: 
<a href="https://cr.yp.to/ecdh/curve25519-20060209.pdf">https://cr.yp.to/ecdh/curve25519-20060209.pdf</a>. Date accessed: 2018‑09‑26. </p>
<p>[<a href="https://iacr.org/archive/asiacrypt2008/53500329/53500329.pdf" title="Twisted Edwards Curves Revisited">39</a>] H. Hisil, K. Koon-Ho Wong, G. Carter and E. Dawson, &quot;Twisted Edwards Curves Revisited&quot;, Information Security 
Institute, Queensland University of Technology [online]. Available: 
<a href="https://iacr.org/archive/asiacrypt2008/53500329/53500329.pdf">https://iacr.org/archive/asiacrypt2008/53500329/53500329.pdf</a>. Date accessed: 2018‑09‑26. </p>
<p>[<a href="http://www.semper.org/sirene/publ/SaSt_01.dh-et-al.long.pdf" title="Assumptions Related to Discrete Logarithms: Why 
Subtleties Make a Real Difference">40</a>] A. Sadeghi and M. Steiner, &quot;Assumptions Related to Discrete Logarithms: Why Subtleties Make a Real 
Difference&quot; [online]. Available: <a href="http://www.semper.org/sirene/publ/SaSt_01.dh-et-al.long.pdf">http://www.semper.org/sirene/publ/SaSt_01.dh-et-al.long.pdf</a>. Date accessed: 
2018-09-24. </p>
<p>[<a href="http://cryptography.wikia.com/wiki/Cryptographic_nonce" title="Crypto Wiki: Cryptographic Nonce">41</a>] Crypto Wiki: &quot;Cryptographic Nonce&quot; [online]. Available: <a href="http://cryptography.wikia.com/wiki/Cryptographic_nonce">http://cryptography.wikia.com/wiki/Cryptographic_nonce</a>. 
Date accessed: 2018‑10‑08. </p>
<p>[<a href="https://en.wikipedia.org/wiki/Cryptographic_nonce" title="Wikipedia: Cryptographic Nonce">42</a>] Wikipedia: &quot;Cryptographic Nonce&quot; [online]. Available: <a href="https://en.wikipedia.org/wiki/Cryptographic_nonce">https://en.wikipedia.org/wiki/Cryptographic_nonce</a>. 
Date accessed: 2018-10-08. </p>
<p>[<a href="https://people.mmci.uni-saarland.de/%7Etruffing/papers/switch-commitments.pdf" title="Switch Commitments: A Safety Switch 
for Confidential Transactions">43</a>] T. Ruffing and G. Malavolta, &quot; Switch Commitments: A Safety Switch for Confidential Transactions&quot;, Saarland 
University [online]. Available: <a href="https://people.mmci.uni-saarland.de/%7Etruffing/papers/switch-commitments.pdf">https://people.mmci.uni-saarland.de/~truffing/papers/switch-commitments.pdf</a>. Date 
accessed: 2018‑10‑08. </p>
<p>[<a href="https://blake2.net" title="BLAKE2 — Fast Secure Hashing">44</a>] &quot;BLAKE2 — Fast Secure Hashing&quot; [online]. Available: <a href="https://blake2.net">https://blake2.net</a>. Date accessed: 2018‑10‑08. </p>
<p>[<a href="https://github.com/mimblewimble/rust-secp256k1-zkp" title="GitHub: mimblewimble/rust-secp256k1-zkp">45</a>] GitHub: &quot;mimblewimble/rust-secp256k1-zkp&quot; [online]. Available: 
<a href="https://github.com/mimblewimble/rust-secp256k1-zkp">https://github.com/mimblewimble/rust-secp256k1-zkp</a>. Date accessed: 2018‑11‑16. </p>
<p>[<a href="https://github.com/monero-project/monero/tree/master/src/ringct" title="GitHub: monero-project/monero">46</a>] GitHub: &quot;monero-project/monero [online]&quot;. Available: 
<a href="https://github.com/monero-project/monero/tree/master/src/ringct">https://github.com/monero-project/monero/tree/master/src/ringct</a>. Date accessed: 2018‑11‑16. </p>
<p>[<a href="https://en.wikipedia.org/wiki/Arithmetic_circuit_complexity" title="Wikipedia: Arithmetic Circuit Complexity">47</a>] Wikipedia: &quot;Arithmetic Circuit Complexity [online]&quot;. Available: 
<a href="https://en.wikipedia.org/wiki/Arithmetic_circuit_complexity">https://en.wikipedia.org/wiki/Arithmetic_circuit_complexity</a>. Date accessed: 2018‑11‑08. </p>
<p>[<a href="https://eprint.iacr.org/2018/068.pdf" title="Simple Schnorr Multi-signatures with Applications to Bitcoin">48</a>] G. Maxwell, A. Poelstra1, Y. Seurin and P. Wuille, &quot;Simple Schnorr Multi-signatures with Applications to 
Bitcoin&quot;, 20 May 2018 [online]. Available: <a href="https://eprint.iacr.org/2018/068.pdf">https://eprint.iacr.org/2018/068.pdf</a>. Date accessed: 2018‑07‑24. </p>
<p>[<a href="https://github.com/b-g-goodell/research-lab/tree/master/source-code/StringCT-java" title="GitHub: 
b-g-goodell/research-lab">49</a>] GitHub: &quot;b-g-goodell/research-lab&quot; [online]. Available: 
<a href="https://github.com/b-g-goodell/research-lab/tree/master/source-code/StringCT-java">https://github.com/b-g-goodell/research-lab/tree/master/source-code/StringCT-java</a>. Date accessed: 2018‑11‑16. </p>
<p>[<a href="https://en.wikipedia.org/wiki/One-way_function" title="Wikipedia: One-way Function">50</a>] Wikipedia: &quot;One-way Function&quot; [online]. Available: <a href="https://en.wikipedia.org/wiki/One-way_function">https://en.wikipedia.org/wiki/One-way_function</a>. Date 
accessed: 2018‑11‑27. </p>
<p>[<a href="http://www.e-ijaet.org/media/58I6-IJAET0612695.pdf" title="Intensified ElGamal Cryptosystem (IEC)">51</a>] P. Sharma, A. K. Gupta and S. Sharma, &quot;Intensified ElGamal Cryptosystem (IEC)&quot;, <em>International Journal of 
Advances in Engineering &amp; Technology</em>, January 2012 [online]. Available: 
<a href="http://www.e-ijaet.org/media/58I6-IJAET0612695.pdf">http://www.e-ijaet.org/media/58I6-IJAET0612695.pdf</a>. Date accessed: 2018‑10‑09. </p>
<p>[<a href="https://drive.google.com/file/d/16XGAByoXse5NQl57v_GldJwzmvaQlS94/view" title="On the Security of ElGamal Based 
Encryption">52</a>] Y. Tsiounis and M Yung, &quot;On the Security of ElGamal Based Encryption&quot; [online]. Available: 
<a href="https://drive.google.com/file/d/16XGAByoXse5NQl57v_GldJwzmvaQlS94/view">https://drive.google.com/file/d/16XGAByoXse5NQl57v_GldJwzmvaQlS94/view</a>. Date accessed: 2018‑10‑09. </p>
<p>[<a href="https://en.wikipedia.org/wiki/Decisional_Diffie%E2%80%93Hellman_assumption" title="Wikipedia: Decisional Diffie–Hellman 
Assumption">53</a>] Wikipedia: &quot;Decisional Diffie–Hellman Assumption&quot; [online]. Available: 
<a href="https://en.wikipedia.org/wiki/Decisional_Diffie%E2%80%93Hellman_assumption">https://en.wikipedia.org/wiki/Decisional_Diffie%E2%80%93Hellman_assumption</a>. Date accessed: 2018‑10‑09. </p>
<p>[<a href="https://github.com/mimblewimble/grin/pull/730" title="GitHub: mimblewimble/grin, Bulletproof messages #730">54</a>] GitHub: &quot;mimblewimble/grin, Bulletproof messages #730&quot; [online]. Available: 
<a href="https://github.com/mimblewimble/grin/pull/730">https://github.com/mimblewimble/grin/pull/730</a>. Date accessed: 2018‑11‑29. </p>
<p>[<a href="https://github.com/mimblewimble/grin/pull/841" title="GitHub: mimblewimble/grin, Removed all switch commitment usages, 
including restore #841">55</a>] GitHub: &quot;mimblewimble/grin, Removed all switch commitment usages, including restore #841&quot; [online]. Available: 
<a href="https://github.com/mimblewimble/grin/pull/841">https://github.com/mimblewimble/grin/pull/841</a>. Date accessed: 2018‑11‑29. </p>
<p>[<a href="https://github.com/mimblewimble/grin/issues/998" title="GitHub: mimblewimble/grin, switch commitment discussion #998">56</a>] GitHub: &quot;mimblewimble/grin, switch commitment discussion #998&quot; [online]. Available: 
<a href="https://github.com/mimblewimble/grin/issues/998">https://github.com/mimblewimble/grin/issues/998</a>. Date accessed: 2018‑11‑29. </p>
<p>[<a href="https://github.com/mimblewimble/grin/pull/2007" title="GitHub: mimblewimble/grin, [DNM] Switch commitments #2007">57</a>] GitHub: &quot;mimblewimble/grin, [DNM] Switch commitments #2007&quot; [online]. Available: 
<a href="https://github.com/mimblewimble/grin/pull/2007">https://github.com/mimblewimble/grin/pull/2007</a>. Date accessed: 2018‑11‑29. </p>
<p>[<a href="https://eprint.iacr.org/2015/1008.pdf" title="Provisions: Privacy-preserving Proofs of Solvency for Bitcoin Exchanges">58</a>] G. G. Dagher, B. Bünz, J. Bonneauy, J. Clark and D. Boneh1, &quot;Provisions: Privacy-preserving Proofs of Solvency 
for Bitcoin Exchanges&quot;, October 2015 [online]. Available: <a href="https://eprint.iacr.org/2015/1008.pdf">https://eprint.iacr.org/2015/1008.pdf</a>. Date accessed: 
2018‑11‑29. </p>
<p>[<a href="https://blockstream.com/2018/02/21/bulletproofs-faster-rangeproofs-and-much-more/" title="Bulletproofs: Faster 
Rangeproofs and Much More">59</a>] A. Poelstra, &quot;Bulletproofs: Faster Rangeproofs and Much More&quot;, February 2018 [online]. Available: 
<a href="https://blockstream.com/2018/02/21/bulletproofs-faster-rangeproofs-and-much-more/">https://blockstream.com/2018/02/21/bulletproofs-faster-rangeproofs-and-much-more/</a>. Date accessed: 2018‑11‑30. </p>
<p>[<a href="http://cryptonite.info/files/HMBC.pdf" title="Homomorphic Mini-blockchain Scheme">60</a>] B. Franca, &quot;Homomorphic Mini-blockchain Scheme&quot;, April 2015 [online]. Available: 
<a href="http://cryptonite.info/files/HMBC.pdf">http://cryptonite.info/files/HMBC.pdf</a>. Date accessed: 2018‑11‑22. </p>
<p>[<a href="http://orbilu.uni.lu/bitstream/10993/33705/1/MSPN2017.pdf" title="Efficient Implementation of Pedersen Commitments Using 
Twisted Edwards Curves">61</a>] C. Franck and J. Großschädl, &quot;Efficient Implementation of Pedersen Commitments Using Twisted Edwards Curves&quot;, 
University of Luxembourg [online]. Available: <a href="http://orbilu.uni.lu/bitstream/10993/33705/1/MSPN2017.pdf">http://orbilu.uni.lu/bitstream/10993/33705/1/MSPN2017.pdf</a>. Date 
accessed: 2018‑11‑22. </p>
<p>[<a href="https://github.com/AdamISZ/ConfidentialTransactionsDoc/blob/master/essayonCT.pdf" title="An Investigation into 
Confidential Transactions">62</a>] A. Gibson, &quot;An Investigation into Confidential Transactions&quot;, July 2018 [online]. Available: 
<a href="https://github.com/AdamISZ/ConfidentialTransactionsDoc/blob/master/essayonCT.pdf">https://github.com/AdamISZ/ConfidentialTransactionsDoc/blob/master/essayonCT.pdf</a>. Date accessed: 2018‑11‑22. </p>
<p>[<a href="https://www.benthamsgaze.org/2016/10/25/how-to-do-zero-knowledge-from-discrete-logs-in-under-7kb" title="How to do 
Zero-knowledge from Discrete-Logs in under 7kB">63</a>] J. Bootle, &quot;How to do Zero-knowledge from Discrete-Logs in under 7kB&quot;, October 2016 [online]. Available: 
<a href="https://www.benthamsgaze.org/2016/10/25/how-to-do-zero-knowledge-from-discrete-logs-in-under-7kb">https://www.benthamsgaze.org/2016/10/25/how-to-do-zero-knowledge-from-discrete-logs-in-under-7kb</a>. Date accessed: 
2019‑01‑18. </p>
<h2><a class="header" href="#appendices" id="appendices">Appendices</a></h2>
<h3><a class="header" href="#appendix-a-definition-of-terms" id="appendix-a-definition-of-terms">Appendix A: Definition of Terms</a></h3>
<p>Definitions of terms presented here are high level and general in nature. Full mathematical definitions are available 
in the cited references. </p>
<ul>
<li><strong>Arithmetic Circuits:</strong><a name="ac"> </a>An arithmetic circuit $ C $ over a field $ F $ and variables 
$ (x_1, ..., x_n) $ is a directed acyclic graph whose vertices are called gates. Arithmetic circuits can alternatively be 
described as a list of addition and multiplication gates with a collection of linear consistency equations relating the 
inputs and outputs of the gates. The size of an arithmetic circuit is the number of gates in it, with the depth being 
the length of the longest directed path. <em>Upper bounding</em> the complexity of a polynomial $ f $ is to find any arithmetic 
circuit that can calculate $ f $, whereas <em>lower bounding</em> is to find the smallest arithmetic circuit that can calculate 
$ f $. An example of a simple arithmetic circuit with size six and depth two that calculates a polynomial is shown 
below ([<a href="https://github.com/adjoint-io/bulletproofs" title="GitHub: adjoint-io/Bulletproofs, Bulletproofs are Short 
Non-interactive Zero-knowledge Proofs that Require no Trusted Setup">29</a>], [<a href="https://en.wikipedia.org/wiki/Arithmetic_circuit_complexity" title="Wikipedia: Arithmetic Circuit Complexity">47</a>]).</li>
</ul>
<p align="center"><img src="cryptography/bulletproofs-and-mimblewimble/sources/ArithmiticCircuit.png" width="300" /></p>
<ul>
<li><strong>Argument of Knowledge System:</strong><a name="afs"> </a>Proof systems with computational soundness like 
Bulletproofs are sometimes called argument systems. The terms <em>proof</em> and <em>argument of knowledge</em> have exactly the same 
meaning and can be used interchangeably [<a href="https://github.com/adjoint-io/bulletproofs" title="GitHub: adjoint-io/Bulletproofs, Bulletproofs are Short 
Non-interactive Zero-knowledge Proofs that Require no Trusted Setup">29</a>].</li>
</ul>
<ul>
<li><strong>Commitment Scheme:</strong><a name="cs"> </a>A commitment scheme in a Zero-knowledge Proof<sup><a href="cryptography/bulletproofs-and-mimblewimble/MainReport.html#zk" title="In cryptography, a zero-knowledge 
proof/protocol is a method by which 
one party (the prover) can convince ...">def</a></sup> 
is a cryptographic primitive that allows a <em>prover</em> to commit to only a single chosen value/statement from a finite set 
without the ability to change it later (<em>binding</em> property) while keeping it hidden from a <em>verifier</em> (<em>hiding</em> property). 
Both <em>binding</em> and <em>hiding</em> properties are then further classified in increasing levels of security to be 
<em>computational</em>, <em>statistical</em> or <em>perfect</em>. No commitment scheme can at the same time be perfectly <em>binding</em> and 
perfectly <em>hiding</em> ([<a href="https://en.wikipedia.org/wiki/Commitment_scheme" title="Wikipedia: Commitment Scheme">36</a>], [<a href="http://cryptography.wikia.com/wiki/Commitment_scheme" title="Cryptography Wikia: Commitment Scheme">37</a>]).</li>
</ul>
<ul>
<li><strong>Discrete Logarithm/Discrete Logarithm Problem (DLP):</strong><a name="dlp"> </a>In the mathematics of real 
numbers, the logarithm $ \log_b^a $ is a number $ x $ such that $ b^x=a $, for given numbers $ a $ and $ b $. 
Analogously, in any group  $ G $, powers $ b^k $ can be defined for all integers $ k $, and the discrete logarithm 
$ \log_ba $ is an integer $ k $ such that $ b^k=a $. Algorithms in public-key cryptography base their security on the 
assumption that the discrete logarithm problem over carefully chosen cyclic finite groups and cyclic subgroups of 
elliptic curves over finite fields has no efficient solution ([<a href="https://en.wikipedia.org/wiki/Discrete_logarithm" title="Wikipedia: Discrete Logarithm">17</a>], [<a href="http://www.semper.org/sirene/publ/SaSt_01.dh-et-al.long.pdf" title="Assumptions Related to Discrete Logarithms: Why 
Subtleties Make a Real Difference">40</a>]).</li>
</ul>
<ul>
<li><strong>Elliptic Curve Pedersen Commitment:<a name="ecpc"></strong> </a>An efficient implementation of the Pedersen 
Commitment ([<a href="https://blockstream.com/bitcoin17-final41.pdf" title="Confidential Assets">15</a>], [<a href="https://hackage.haskell.org/package/pedersen-commitment" title="Pedersen-commitment: An Implementation of Pedersen 
Commitment Schemes">22</a>]) will use secure Elliptic Curve Cryptography (ECC), which is based on the algebraic structure 
of elliptic curves over finite (prime) fields. Elliptic curve points are used as basic mathematical objects, instead 
of numbers. Note that traditionally in elliptic curve arithmetic lower case letters are used for ordinary numbers 
(integers) and upper case letters for curve points ([<a href="http://cryptonite.info/files/HMBC.pdf" title="Homomorphic Mini-blockchain Scheme">60</a>], [<a href="http://orbilu.uni.lu/bitstream/10993/33705/1/MSPN2017.pdf" title="Efficient Implementation of Pedersen Commitments Using 
Twisted Edwards Curves">61</a>], [<a href="https://github.com/AdamISZ/ConfidentialTransactionsDoc/blob/master/essayonCT.pdf" title="An Investigation into 
Confidential Transactions">62</a>]).
<ul>
<li>
<p>The generalized Elliptic Curve Pedersen Commitment definition follows 
(refer to <a href="cryptography/bulletproofs-and-mimblewimble/MainReport.html#appendix-b-notation-used">Appendix B: Notation Used</a>):</p>
<ul>
<li>Let $ \mathbb F_p $ be the group of elliptic curve points, where $ p $ is a large prime.</li>
<li>Let $ G \in  \mathbb F_p $ be a random generator point (base point) and let $ H \in  \mathbb F_p $ be specially 
chosen so that the value $ x_H $ to satisfy $ H = x_H G $ cannot be found except if the Elliptic Curve DLP (ECDLP) 
is solved. </li>
<li>Let $ r $ (the blinding factor) be a random value and element of $ \mathbb Z_p $.</li>
<li>The commitment to value $ x \in \mathbb Z_p $ is then determined by calculating $ C(x,r) = rH + xG $, which is 
called the Elliptic Curve Pedersen Commitment.</li>
</ul>
</li>
<li>
<p>Elliptic curve point addition is analogous to multiplication in the originally defined Pedersen Commitment. Thus 
$ g^x $, the number $ g $ multiplied by itself $ m $ times, is analogous to $ xG $, the elliptic curve point $ G $ 
added to itself $ x $ times. In this context $ xG $ is also a point in $ \mathbb F_p $.</p>
</li>
<li>
<p>In the Elliptic Curve context $ C(x,r) = rH + xG $ is then analogous to  $ C(x,r) = h^r g^x $.</p>
</li>
<li>
<p>The number $ H $ is what is known as a Nothing Up My Sleeve (NUMS) number. With secp256k1, the value of $ H $ is the 
SHA256 hash of a simple encoding of the pre-specified generator point $ G $.</p>
</li>
<li>
<p>Similar to Pedersen Commitments, the Elliptic Curve Pedersen Commitments are also additionally homomorphic, such 
that for messages $ x $, $ x_0 $ and $ x_1 $, blinding factors $ r $, $ r_0 $ and $ r_1 $ and scalar $ k $ the 
following relation holds: $ C(x_0,r_0) + C(x_1,r_1) = C(x_0+x_1,r_0+r_1) $ and 
$ C(k \cdot x, k \cdot r) = k \cdot C(x, r) $.</p>
</li>
<li>
<p>In secure implementations of ECC, it is as hard to guess $ x $ from $ xG $ as it is to guess $ x $ from $g^x $. 
This is called the Elliptic Curve DLP (ECDLP).</p>
</li>
<li>
<p>Practical implementations usually consist of three algorithms: <code>Setup()</code> to set up the commitment 
parameters; <code>Commit()</code> to commit to the message using the commitment parameters; and <code>Open()</code> 
to open and verify the commitment.</p>
</li>
</ul>
</li>
</ul>
<ul>
<li><strong>ElGamal Commitment/Encryption:</strong><a name="egc"> </a>An ElGamal commitment is a Pedersen Commitment ([<a href="https://blockstream.com/bitcoin17-final41.pdf" title="Confidential Assets">15</a>], 
[<a href="https://hackage.haskell.org/package/pedersen-commitment" title="Pedersen-commitment: An Implementation of Pedersen 
Commitment Schemes">22</a>]) with an additional commitment $ g^r $ to the randomness used. The ElGamal encryption scheme is based on the 
Decisional Diffe-Hellman (DDH) assumption and the difficulty of the DLP for finite fields. The DDH assumption states 
that it is infeasible for a Probabilistic Polynomial-time (PPT) adversary to solve the DDH problem. <strong>Note:</strong> The 
ElGamal encryption scheme should not be confused with the ElGamal signature scheme ([<a href="http://web.stanford.edu/%7Ebuenz/pubs/bulletproofs.pdf" title="Bulletproofs: Short Proofs for Confidential Transactions and 
More">1</a>], [<a href="http://www.e-ijaet.org/media/58I6-IJAET0612695.pdf" title="Intensified ElGamal Cryptosystem (IEC)">51</a>], [<a href="https://drive.google.com/file/d/16XGAByoXse5NQl57v_GldJwzmvaQlS94/view" title="On the Security of ElGamal Based 
Encryption">52</a>], [<a href="https://en.wikipedia.org/wiki/Decisional_Diffie%E2%80%93Hellman_assumption" title="Wikipedia: Decisional Diffie–Hellman 
Assumption">53</a>]).</li>
</ul>
<ul>
<li><strong>Fiat‑Shamir Heuristic/Transformation:</strong><a name="fsh"> </a>The Fiat‑Shamir heuristic is a technique in 
cryptography to convert an interactive public-coin protocol (Sigma protocol) between a <em>prover</em> and a <em>verifier</em> into a 
one-message (non-interactive) protocol using a cryptographic hash function ([<a href="https://link.springer.com/content/pdf/10.1007%2F3-540-47721-7_12.pdf" title="How to Prove Yourself: Practical Solutions 
to Identification and Signature Problems">18</a>], [<a href="https://link.springer.com/content/pdf/10.1007%2F978-3-642-34961-4_38.pdf" title="How not to Prove Yourself: Pitfalls of 
the Fiat-Shamir Heuristic and Applications to Helios">19</a>]).
<ul>
<li>
<p>The <em>prover</em> will use a <code>Prove()</code> algorithm to calculate a commitment $ A $ with a statement $ Y $ that 
is shared with the <em>verifier</em> and a secret witness value $ w $ as inputs. The commitment $ A $ is then hashed to obtain 
the challenge $ c $, which is further processed with the <code>Prove()</code> algorithm to calculate the response $ f $. 
The single message sent to the <em>verifier</em> then contains the challenge $ c $ and response $ f $.</p>
</li>
<li>
<p>The <em>verifier</em> is then able to compute the commitment $ A $ from the shared statement $ Y $, challenge $ c $ and 
response $ f $. The <em>verifier</em> will then use a <code>Verify()</code> algorithm to verify the combination of shared 
statement $ Y $, commitment $ A $, challenge $ c $ and response $ f $.</p>
</li>
<li>
<p>A weak Fiat‑Shamir transformation can be turned into a strong Fiat‑Shamir transformation if the hashing function 
is applied to the commitment $ A $ and shared statement $ Y $ to obtain the challenge $ c $ as opposed to only the 
commitment $ A ​$.</p>
</li>
</ul>
</li>
</ul>
<ul>
<li><strong>Nonce:</strong><a name="nonce"> </a>In security engineering, <em><strong>nonce</strong></em> is an abbreviation of <i><strong>n</strong>umber used 
<strong>once</strong></i>. In cryptography, a nonce is an arbitrary number that can be used just once. It is often a random or 
pseudo-random number issued in an authentication protocol to ensure that old communications cannot be reused in replay 
attacks ([<a href="http://cryptography.wikia.com/wiki/Cryptographic_nonce" title="Crypto Wiki: Cryptographic Nonce">41</a>], [<a href="https://en.wikipedia.org/wiki/Cryptographic_nonce" title="Wikipedia: Cryptographic Nonce">42</a>]).</li>
</ul>
<ul>
<li><strong>Zero-knowledge Proof/Protocol:</strong><a name="zk"> </a>In cryptography, a zero-knowledge proof/protocol is a 
method by which one party (the <em>prover</em>) can convince another party (the <em>verifier</em>) that a statement $ Y $ is true, 
without conveying any information apart from the fact that the <em>prover</em> knows the value of $ Y $. The proof system must 
be complete, sound and zero-knowledge ([<a href="https://en.wikipedia.org/wiki/Zero-knowledge_proof" title="Wikipedia - Zero-knowledge Proof">16</a>], [<a href="https://zkproof.org/documents.html" title="Zero Knowledge Proof Standardization - An Open Industry/Academic Initiative">23</a>]):
<ul>
<li>
<p>Complete - if the statement is true and both <em>prover</em> and <em>verifier</em> follow the protocol, the <em>verifier</em> will accept.</p>
</li>
<li>
<p>Sound - if the statement is false, and the <em>verifier</em> follows the protocol, the <em>verifier</em> will not be convinced.</p>
</li>
<li>
<p>Zero-knowledge - if the statement is true and the <em>prover</em> follows the protocol, the <em>verifier</em> will not learn any 
confidential information from the interaction with the <em>prover</em>, apart from the fact that the statement is true.</p>
</li>
</ul>
</li>
</ul>
<h3><a class="header" href="#appendix-b-notation-used" id="appendix-b-notation-used">Appendix B: Notation Used</a></h3>
<p>The general notation of mathematical expressions when specifically referenced is given here, based on [<a href="http://web.stanford.edu/%7Ebuenz/pubs/bulletproofs.pdf" title="Bulletproofs: Short Proofs for Confidential Transactions and 
More">1</a>].</p>
<ul>
<li>Let  $ p $ and $ q $ be large prime numbers.</li>
<li>Let $ \mathbb G $ and $ \mathbb Q $ denote cyclic groups of prime order $ p $ and $ q $ respectively.</li>
<li>let $ \mathbb Z_p $ and $ \mathbb Z_q $ denote the ring of integers $ modulo \mspace{4mu} p $ and 
$ modulo \mspace{4mu} q $ respectively.</li>
<li>Let generators of $ \mathbb G $ be denoted by $ g, h, v, u \in \mathbb G $. In other words, there exists a number 
$ g \in \mathbb G  $ such that $  \mathbb G  = \lbrace 1 \mspace{3mu} , \mspace{3mu} g \mspace{3mu} , \mspace{3mu} 
g^2 \mspace{3mu} , \mspace{3mu} g^3 \mspace{3mu} , \mspace{3mu} ... \mspace{3mu} , \mspace{3mu}  g^{p-1} \rbrace 
\equiv  \mathbb Z_p $. 
Note that not every element of $ \mathbb Z_p $ is a generator of $ \mathbb G $.</li>
<li>Let $ \mathbb Z_p^* $ denote $ \mathbb Z_p \setminus \lbrace 0 \rbrace $ and $ \mathbb Z_q^* $ denote 
$ \mathbb Z_q \setminus \lbrace 0 \rbrace $, that is all invertible elements of  $ \mathbb Z_p $ and $ \mathbb Z_q $ 
respectively. This excludes the element $ 0 $ which is not invertible.</li>
</ul>
<h2><a class="header" href="#contributors-4" id="contributors-4">Contributors</a></h2>
<ul>
<li><a href="https://github.com/hansieodendaal">https://github.com/hansieodendaal</a></li>
<li><a href="https://github.com/CjS77">https://github.com/CjS77</a></li>
<li><a href="https://github.com/SWvheerden">https://github.com/SWvheerden</a></li>
<li><a href="https://github.com/philipr-za">https://github.com/philipr-za</a></li>
<li><a href="https://github.com/neonknight64">https://github.com/neonknight64</a></li>
<li><a href="https://github.com/anselld">https://github.com/anselld</a></li>
</ul>
<h1><a class="header" href="#building-on-bulletproofs" id="building-on-bulletproofs">Building on Bulletproofs</a></h1>
<div>
  <p style="float: left;">
    <a href="https://medium.com/@cathieyun/building-on-bulletproofs-2faa58af0ba8"><img src="cryptography/building-on-bulletproofs/profile-pic.png" width="90" /></a>
  </p>
  <p>
    <br>
    &nbsp;&nbsp;&nbsp;&nbsp;<strong>Cathie Yun</strong><br>
    &nbsp;&nbsp;&nbsp;&nbsp;Cryptographer
    <br>
  </p>
</div>
<h2><a class="header" href="#summary" id="summary">Summary</a></h2>
<p>In <a href="https://medium.com/@cathieyun/building-on-bulletproofs-2faa58af0ba8">this post</a> Cathie explains the basics of the 
Bulletproofs zero knowledge proof protocol. She then goes further to explain specific applications built on top of 
Bulletproofs, which can be used for range proofs or constraint system proofs. The constraint system proof protocol was 
used to build a confidential assets scheme called Cloak and a confidential smart contract language called ZkVM.</p>
<p align="center"><img src="cryptography/building-on-bulletproofs/bulletproofs-summary.png" width="1100" /></p>
<h1><a class="header" href="#the-bulletproof-protocols" id="the-bulletproof-protocols">The Bulletproof Protocols</a></h1>
<ul>
<li><a href="cryptography/bulletproofs-protocols/MainReport.html#introduction">Introduction</a></li>
<li><a href="cryptography/bulletproofs-protocols/MainReport.html#preliminaries">Preliminaries</a>
<ul>
<li><a href="cryptography/bulletproofs-protocols/MainReport.html#notation-used">Notation Used</a></li>
<li><a href="cryptography/bulletproofs-protocols/MainReport.html#pedersen-commitments-and-elliptic-curve-pedersen-commitments">Pedersen Commitments and Elliptic Curve Pedersen Commitments</a></li>
<li><a href="cryptography/bulletproofs-protocols/MainReport.html#security-aspects-of-elliptic-curve-pedersen-commitments">Security Aspects of (Elliptic Curve) Pedersen Commitments</a></li>
</ul>
</li>
<li><a href="cryptography/bulletproofs-protocols/MainReport.html#bulletproof-protocols-1">Bulletproof Protocols</a>
<ul>
<li><a href="cryptography/bulletproofs-protocols/MainReport.html#inner-product-argument-protocol-1">Inner-product Argument (Protocol 1)</a></li>
<li><a href="cryptography/bulletproofs-protocols/MainReport.html#how-proof-system-for-protocol-1-works-shrinking-by-recursion">How Proof System for Protocol 1 Works, Shrinking by Recursion</a></li>
<li><a href="cryptography/bulletproofs-protocols/MainReport.html#inner-product-verification-through-multi-exponentiation-protocol-2">Inner-product Verification through Multi-exponentiation (Protocol 2)</a></li>
<li><a href="cryptography/bulletproofs-protocols/MainReport.html#range-proof-protocol-with-logarithmic-size">Range Proof Protocol with Logarithmic Size</a>
<ul>
<li><a href="cryptography/bulletproofs-protocols/MainReport.html#inner-product-range-proof">Inner-product Range Proof</a></li>
<li><a href="cryptography/bulletproofs-protocols/MainReport.html#logarithmic-range-proof">Logarithmic Range Proof</a></li>
<li><a href="cryptography/bulletproofs-protocols/MainReport.html#aggregating-logarithmic-proofs">Aggregating Logarithmic Proofs</a></li>
<li><a href="cryptography/bulletproofs-protocols/MainReport.html#non-interactive-proof-through-fiat-shamir-heuristic">Non-interactive Proof through Fiat-Shamir Heuristic</a></li>
<li><a href="cryptography/bulletproofs-protocols/MainReport.html#mpc-protocol-for-bulletproofs">MPC Protocol for Bulletproofs</a></li>
<li><a href="cryptography/bulletproofs-protocols/MainReport.html#mpc-protocol-security-discussion">MPC Protocol Security Discussion</a></li>
</ul>
</li>
<li><a href="cryptography/bulletproofs-protocols/MainReport.html#zero-knowledge-proof-for-arithmetic-circuits">Zero-knowledge Proof for Arithmetic Circuits</a>
<ul>
<li><a href="cryptography/bulletproofs-protocols/MainReport.html#inner-product-proof-for-arithmetic-circuits-protocol-3">Inner-product Proof for Arithmetic Circuits (Protocol 3)</a></li>
<li><a href="cryptography/bulletproofs-protocols/MainReport.html#logarithmic-sized-non-interactive-protocol-for-arithmetic-circuits">Logarithmic-sized Non-interactive Protocol for Arithmetic Circuits</a></li>
</ul>
</li>
<li><a href="cryptography/bulletproofs-protocols/MainReport.html#optimized-verifier-using-multi-exponentiation-and-batch-verification">Optimized Verifier using Multi-exponentiation and Batch Verification</a>
<ul>
<li><a href="cryptography/bulletproofs-protocols/MainReport.html#multi-exponentiation">Multi-exponentiation</a></li>
<li><a href="cryptography/bulletproofs-protocols/MainReport.html#batch-verification">Batch Verification</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="cryptography/bulletproofs-protocols/MainReport.html#evolving-bulletproof-protocols">Evolving Bulletproof Protocols</a></li>
<li><a href="cryptography/bulletproofs-protocols/MainReport.html#conclusions-observations-and-recommendations">Conclusions, Observations and Recommendations</a></li>
<li><a href="cryptography/bulletproofs-protocols/MainReport.html#references">References</a></li>
<li><a href="cryptography/bulletproofs-protocols/MainReport.html#appendices">Appendices</a>
<ul>
<li><a href="cryptography/bulletproofs-protocols/MainReport.html#appendix-a-definition-of-terms">Appendix A: Definition of Terms</a></li>
</ul>
</li>
<li><a href="cryptography/bulletproofs-protocols/MainReport.html#contributors">Contributors</a></li>
</ul>
<h2><a class="header" href="#introduction-4" id="introduction-4">Introduction</a></h2>
<p>The overview of Bulletproofs given in <a href="cryptography/bulletproofs-protocols/../bulletproofs-and-mimblewimble/MainReport.html">Bulletproofs and Mimblewimble</a> 
was largely based on the original work done by Bünz et al. [<a href="http://web.stanford.edu/%7Ebuenz/pubs/bulletproofs.pdf" title="Bulletproofs: Short Proofs for Confidential Transactions 
and More, Blockchain Protocol Analysis and Security 
Engineering 2018">1</a>]. They documented a number of 
different Bulletproof protocols, but not all of them in an obvious manner. This report summarizes and explains the 
different Bulletproof protocols as simply as possible. It also simplifies the logic and explains the base 
mathematical concepts in more detail where prior knowledge was assumed. The report concludes with a discussion on an 
improved Bulletproof zero-knowledge proof protocol provided by some community members following an evolutionary approach.</p>
<h2><a class="header" href="#preliminaries" id="preliminaries">Preliminaries</a></h2>
<h3><a class="header" href="#notation-used-1" id="notation-used-1">Notation Used</a></h3>
<p>This section gives the general notation of mathematical expressions when specifically referenced, based on [<a href="http://web.stanford.edu/%7Ebuenz/pubs/bulletproofs.pdf" title="Bulletproofs: Short Proofs for Confidential Transactions 
and More, Blockchain Protocol Analysis and Security 
Engineering 2018">1</a>]. This
notation provides important pre-knowledge for the remainder of the report.</p>
<ul>
<li>Let $ p $ and $ q ​$ be large prime numbers.</li>
<li>Let $ \mathbb G ​$ and $ \mathbb Q ​$ denote cyclic groups of prime order 
$ p ​$ and $ q ​$ respectively. </li>
<li>let $ \mathbb Z_p ​$ and $ \mathbb Z_q ​$ denote the ring of integers 
$ modulo \mspace{4mu} p ​$ and $ modulo \mspace{4mu} q ​$ respectively.</li>
<li>Let generators of $ \mathbb G $ be denoted by $ g, h, v, u \in \mathbb G $, i.e. there exists a number 
$ g \in \mathbb G  $ such that $  \mathbb G  = \lbrace 1 \mspace{3mu} , \mspace{3mu} g \mspace{3mu} , 
\mspace{3mu} g^2 \mspace{3mu} , \mspace{3mu} g^3 \mspace{3mu} , \mspace{3mu} ... \mspace{3mu} , \mspace{3mu}  g^{p-1} 
\rbrace \equiv  \mathbb Z_p $. Note that not every element of $ \mathbb Z_p $ is a generator of $ \mathbb G $.</li>
<li>Let $ \mathbb Z_p^* $ denote $ \mathbb Z_p \setminus \lbrace 0 \rbrace $ and $ \mathbb Z_q^* $ denote 
$ \mathbb Z_q \setminus \lbrace 0 \rbrace $, i.e. all invertible elements of $ \mathbb Z_p $ and $ \mathbb Z_q $ 
respectively. This excludes the element $ 0 ​$, which is not invertible.</li>
<li>Let $ \mathbb G^n $ and $ \mathbb Z^n_p $ be vector spaces of dimension 
$ n $ over $ \mathbb G $ and $ \mathbb Z_p $ respectively.</li>
<li>Let $ h^r \mathbf g^\mathbf x = h^r \prod_i g_i^{x_i} \in \mathbb G ​$ be the vector Pedersen 
Commitment<sup><a href="cryptography/bulletproofs-protocols/MainReport.html#pc" title="The Pedersen commitment is a system 
for making blinded non-interactive 
commitments to a value ...">def</a></sup> with 
$ \mathbf {g} = (g_1 \mspace{3mu} , \mspace{3mu} ... \mspace{3mu} , 
\mspace{3mu} g_n) \in \mathbb G^n ​$ and $ \mathbf {x} = (x_1 \mspace{3mu} , \mspace{3mu} ... \mspace{3mu} , 
\mspace{3mu} x_n) \in \mathbb G^n ​$. </li>
<li>Let $ \mathbf {a} \in \mathbb F^n ​$ be a vector with elements 
$ a_1 \mspace{3mu} , \mspace{3mu} . . . \mspace{3mu} , 
\mspace{3mu} a_n \in \mathbb F ​$. </li>
<li>Let $ \langle \mathbf {a}, \mathbf {b} \rangle = 
\sum _{i=1}^n {a_i \cdot b_i} ​$ denote the inner-product between two 
vectors $ \mathbf {a}, \mathbf {b} \in \mathbb F^n ​$. </li>
<li>Let $ \mathbf {a} \circ \mathbf {b} = 
(a_1 \cdot b_1 \mspace{3mu} , \mspace{3mu} . . . \mspace{3mu} , 
\mspace{3mu} a_n \cdot b_n) \in \mathbb F^n ​$ denote the entry wise multiplication of two vectors $ \mathbf {a}, 
\mathbf {b} \in \mathbb F^n ​$. </li>
<li>Let $ \mathbf {A} \circ \mathbf {B} = 
(a_{11} \cdot b_{11} \mspace{3mu} , \mspace{3mu} . . . \mspace{3mu} , 
\mspace{3mu} a_{1m} \cdot b_{1m} \mspace{6mu} ; \mspace{6mu} . . . \mspace{6mu} ; \mspace{6mu} a_{n1} \cdot b_{n1} 
\mspace{3mu} , \mspace{3mu} . . . \mspace{3mu} , \mspace{3mu} a_{nm} \cdot b_{nm} ) $ denote the entry wise 
multiplication of two matrixes, also known as the Hadamard 
Product<sup><a href="cryptography/bulletproofs-protocols/MainReport.html#hdmp" title="In mathematics, the Hadamard product 
is a binary operation that takes two 
matrices A,B of the same dimensions ...">def</a></sup>. </li>
<li>Let $ \mathbf {a} \parallel \mathbf {b} ​$ denote the concatenation of two vectors; if 
$ \mathbf {a} \in \mathbb Z_p^n ​$ 
and $ \mathbf {b} \in \mathbb Z_p^m ​$ then $ \mathbf {a} \parallel \mathbf {b} \in \mathbb Z_p^{n+m} ​$. </li>
<li>Let $ p(X) = \sum _{i=0}^d { \mathbf {p_i} \cdot X^i} \in \mathbb Z_p^n [X] $ be a vector polynomial where each 
coefficient $ \mathbf {p_i} $ is a vector in $ \mathbb Z_p^n $. </li>
<li>Let $ \langle l(X),r(X) \rangle = 
\sum _{i=0}^d { \sum _{j=0}^i { \langle l_i,r_i \rangle \cdot X^{i+j}}} \in 
\mathbb Z_p [X] $ denote the inner-product between two vector 
polynomials $ l(X),r(X) $. </li>
<li>Let $ t(X)=\langle l(X),r(X) \rangle $, then the inner-product is defined such that $ t(x)=\langle l(x),r(x) 
\rangle $ holds for all $ x \in \mathbb{Z_p} $. </li>
<li>Let $ C=g^a = \prod _{i=1}^n g_i^{a_i} \in \mathbb{G} $ be a binding (but not hiding) commitment to the vector 
$ \mathbf {a} \in \mathbb Z_p^n $ where $ \mathbf {g} = 
(g_1 \mspace{3mu} , \mspace{3mu} ... \mspace{3mu} , 
\mspace{3mu} g_n) \in \mathbb G^n $. Given vector $ \mathbf {b} \in \mathbb Z_p^n $ with non-zero entries, 
$ \mathbf {a} \circ \mathbf {b} $ is treated as a new commitment to $ C $. For this let 
$ g_i^\backprime =g_i^{(b_i^{-1})} $ such that 
$ C= \prod _{i=1}^n (g_i^\backprime)^{a_i \cdot b_i} $. The binding property of this new commitment is inherited from 
the old commitment.</li>
<li>Let $ \mathbf a _{[:l]} = ( a_1 \mspace{3mu} , \mspace{3mu} . . . \mspace{3mu} , \mspace{3mu} a_l ) \in \mathbb F ^ l$ 
and $  \mathbf a _{[l:]} = ( a_{1+1} \mspace{3mu} , \mspace{3mu} . . . \mspace{3mu} , \mspace{3mu} a_n ) 
\in \mathbb F ^ {n-l} $ be slices of vectors for $ 0 \le l \le n $ (using Python notation). </li>
<li>Let $ \mathbf {k}^n $ denote the vector containing the first $ n $ powers of $ k \in \mathbb Z_p^* $ such that 
$ \mathbf {k}^n = (1,k,k^2, \mspace{3mu} ... \mspace{3mu} ,k^{n-1}) \in (\mathbb Z_p^*)^n $. </li>
<li>Let $ \mathcal{P} $ and $ \mathcal{V} $ denote the <em>prover</em> and <em>verifier</em> respectively.</li>
<li>Let $ \mathcal{P_{IP}} $ and $ \mathcal{V_{IP}} ​$ denote the <em>prover</em> and <em>verifier</em> in relation to inner-product 
calculations respectively.</li>
</ul>
<h3><a class="header" href="#pedersen-commitments-and-elliptic-curve-pedersen-commitments" id="pedersen-commitments-and-elliptic-curve-pedersen-commitments">Pedersen Commitments and Elliptic Curve Pedersen Commitments</a></h3>
<p>The basis of confidential transactions is the Pedersen Commitment scheme defined in [<a href="https://www.cs.cornell.edu/courses/cs754/2001fa/129.pdf" title="Non-interactive and Information-theoretic
Secure Verifiable Secret Sharing, 
T. Pedersen">15</a>]. </p>
<p>A commitment scheme in a Zero-knowledge Proof<sup><a href="cryptography/bulletproofs-protocols/MainReport.html#zk" title="In cryptography, a zero-knowledge 
proof/protocol is a method by which 
one party (the prover) can convince ...">def</a></sup> is a cryptographic primitive that allows a <em>prover</em> $ \mathcal{P} $ to 
commit to only a single chosen value/statement from a finite set without the ability to change it later (<em>binding</em> 
property), while keeping it hidden from a <em>verifier</em> $ \mathcal{V} $ (<em>hiding</em> property). Both <em>binding</em> and <em>hiding</em> properties are then 
further classified in increasing levels of security to be <em>computational</em>, <em>statistical</em> or <em>perfect</em>:</p>
<ul>
<li><em>Computational</em> means that no efficient algorithm running in a practical amount of time can reveal the commitment 
amount or produce fake commitments, except with a small probability.</li>
<li><em>Statistical</em> means that the probability of an adversary doing the same in a finite amount of time is negligible.</li>
<li><em>Perfect</em> means that a quantum adversary (an attacker with infinite computing power) cannot tell what amount 
has been committed to, and is unable to produce fake commitments.</li>
</ul>
<p>No commitment scheme can simultaneously be perfectly <em>binding</em> and perfectly <em>hiding</em> ([<a href="https://en.wikipedia.org/wiki/Commitment_scheme" title="Wikipedia: Commitment Scheme">12</a>], [<a href="http://cryptography.wikia.com/wiki/Commitment_scheme" title="Cryptography Wikia: Commitment Scheme">13</a>]).</p>
<p>Two variations of the Pedersen Commitment scheme share the same security attributes:</p>
<ul>
<li><strong>Pedersen Commitment:</strong><a name="pc"> </a>The Pedersen Commitment is a system for making a blinded, 
non-interactive commitment to a value ([<a href="http://web.stanford.edu/%7Ebuenz/pubs/bulletproofs.pdf" title="Bulletproofs: Short Proofs for Confidential Transactions 
and More, Blockchain Protocol Analysis and Security 
Engineering 2018">1</a>], [<a href="https://blockstream.com/bitcoin17-final41.pdf" title="Confidential Assets,
A. Poelstra et al.,
Blockstream">3</a>], [<a href="https://hackage.haskell.org/package/pedersen-commitment" title="Pedersen-commitment: An Implementation
of Pedersen Commitment Schemes">8</a>], [<a href="https://www.adjoint.io/docs/cryptography.html#pedersen-commitment-scheme" title="Adjoint Inc. Documentation: 
Pedersen Commitment Scheme">14</a>], [<a href="https://www.cs.cornell.edu/courses/cs754/2001fa/129.pdf" title="Non-interactive and Information-theoretic
Secure Verifiable Secret Sharing, 
T. Pedersen">15</a>]).
<ul>
<li>
<p>The generalized Pedersen Commitment definition follows (refer to <a href="cryptography/bulletproofs-protocols/MainReport.html#notation-used">Notation Used</a>):</p>
<ul>
<li>Let $ q $ be a large prime and $ p $ be a large safe prime such that $ p = 2q + 1 $. </li>
<li>Let $ h $ be a random generator of cyclic group $ \mathbb G $ such that $ h $ is an element of $ \mathbb Z_q^* $. </li>
<li>Let $ a $ be a random value and element of $ \mathbb Z_q^* $ and calculate $ g $ such that $ g = h^a $. </li>
<li>Let $ r $ (the blinding factor) be a random value and element of $ \mathbb Z_p^* $. </li>
<li>The commitment to value $ x $ is then determined by calculating $ C(x,r) = h^r g^x $, which is called the Pedersen 
Commitment.</li>
<li>The generator $ h $ and resulting number $ g $ are known as the commitment bases and should be shared along with
$ C(x,r) $, with whomever wishes to open the value.</li>
</ul>
</li>
<li>
<p>Pedersen Commitments are also additionally homomorphic, such that for messages $ x_0 $ and $ x_1 $ and blinding 
factors $ r_0 $ and $ r_1 $, we have $ C(x_0,r_0) \cdot C(x_1,r_1) = C(x_0+x_1,r_0+r_1) $ </p>
</li>
</ul>
</li>
</ul>
<ul>
<li><strong>Elliptic Curve Pedersen Commitment:</strong><a name="ecpc"> </a>An efficient implementation of the Pedersen 
Commitment<sup><a href="cryptography/bulletproofs-protocols/MainReport.html#pc" title="The Pedersen commitment is a system 
for making blinded non-interactive 
commitments to a value ...">def</a></sup> will use secure Elliptic Curve Cryptography (ECC), which is based on the algebraic 
structure of elliptic curves over finite (prime) fields. Elliptic curve points are used as basic mathematical objects, 
instead of numbers. Note that traditionally in elliptic curve arithmetic, lower-case letters are used for ordinary 
numbers (integers) and upper-case letters for curve points ([<a href="http://cryptonite.info/files/HMBC.pdf" title="Homomorphic Mini-blockchain Scheme, 
B. Franca, 
April 2015">26</a>], [<a href="http://orbilu.uni.lu/bitstream/10993/33705/1/MSPN2017.pdf" title="Efficient Implementation of Pedersen 
Commitments Using Twisted Edwards Curves, 
C. Franck and J. Großschädl, 
University of Luxembourg">27</a>], [<a href="https://github.com/AdamISZ/ConfidentialTransactionsDoc/blob/master/essayonCT.pdf" title="An Investigation into Confidential Transactions, 
A. Gibson, 
July 2018">28</a>]).
<ul>
<li>
<p>The generalized Elliptic Curve Pedersen Commitment definition follows (refer to <a href="cryptography/bulletproofs-protocols/MainReport.html#notation-used*">Notation Used</a>:</p>
<ul>
<li>Let $ \mathbb F_p $ be the group of elliptic curve points, where $ p $ is a large prime.</li>
<li>Let $ G \in  \mathbb F_p $ be a random generator point (base point) and let $ H \in  \mathbb F_p $ be specially 
chosen so that the value $ x_H $ to satisfy $ H = x_H G $ cannot be found except if the Elliptic Curve DLP (ECDLP) 
is solved.</li>
<li>Let $ r $ (the blinding factor) be a random value and element of $ \mathbb Z_p $.</li>
<li>The commitment to value $ x \in \mathbb Z_p $ is then determined by calculating $ C(x,r) = rH + xG ​$, which is 
called the Elliptic Curve Pedersen Commitment.</li>
</ul>
</li>
<li>
<p>Elliptic curve point addition is analogous to multiplication in the originally defined Pedersen 
Commitment<sup><a href="cryptography/bulletproofs-protocols/MainReport.html#pc" title="The Pedersen commitment is a system 
for making blinded non-interactive 
commitments to a value ...">def</a></sup>. Thus $ g^x $, the number $ g $ multiplied by itself $ m $ times, is analogous 
to $ xG $, the elliptic curve point $ G $ added to itself $ x $ times. In this context, $ xG $ is also a point 
in $ \mathbb F_p $.</p>
</li>
<li>
<p>In the Elliptic Curve context, $ C(x,r) = rH + xG $ is then analogous to $ C(x,r) = h^r g^x $.</p>
</li>
<li>
<p>The number $ H $ is what is known as a Nothing Up My Sleeve (NUMS) number. With secp256k1, the value of $ H $ is the 
SHA256 hash of a simple encoding of the prespecified generator point $ G $.</p>
</li>
<li>
<p>Similar to Pedersen Commitments, the Elliptic Curve Pedersen Commitments are also additionally homomorphic, such 
that for messages $ x $, $ x_0 $ and $ x_1 $, blinding factors $ r $, $ r_0 $ and $ r_1 $ and scalar $ k $, the 
following relation holds: $ C(x_0,r_0) + C(x_1,r_1) = C(x_0+x_1,r_0+r_1) $ and 
$ C(k \cdot x, k \cdot r) = k \cdot C(x, r) $.</p>
</li>
<li>
<p>In secure implementations of ECC, it is as hard to guess $ x $ from $ xG $ as it is to guess $ x $ from $g^x $. 
This is called the Elliptic Curve DLP (ECDLP).</p>
</li>
<li>
<p>Practical implementations usually consist of three algorithms: <code>Setup()</code> to set up the commitment 
parameters; <code>Commit()</code> to commit to the message using the commitment parameters; and <code>Open()</code> to 
open and verify the commitment.</p>
</li>
</ul>
</li>
</ul>
<h3><a class="header" href="#security-aspects-of-elliptic-curve-pedersen-commitments" id="security-aspects-of-elliptic-curve-pedersen-commitments">Security Aspects of (Elliptic Curve) Pedersen Commitments</a></h3>
<p>By virtue of their definition, Pedersen Commitments are only computationally <em>binding</em> but perfectly <em>hiding</em>. A 
simplified explanation follows.</p>
<p>If Alice wants to commit to a value $ x $ that will be sent to Bob, who will at a later stage want Alice to prove that 
the value $ x $ is the value that was used to generate the commitment $ C $, then Alice will select random blinding 
factor $ r $, calculate $ C(x,r) = h^r g^x $ and send that to Bob. Later, Alice can reveal $ x $ and $ r $, and Bob can 
do the calculation and see that the commitment $ C $ it produces is the same as the one Alice sent earlier.</p>
<p>Perhaps Alice or Bob has managed to build a computer that can solve the DLP and, given a public key, could find 
alternative solutions to $ C(x,r) = h^r g^x $ in a reasonable time, i.e. 
$  C(x,r) =  h^{r^\prime} g^{x^\prime} $. This means, even though Bob can find values for 
$ r^\prime $ and $ x^\prime $ that produce $ C $, he cannot know if those are the specific $ x $ and $ r $ that Alice 
chose, because there are so many that can produce the same $ C $. Pedersen Commitments are thus perfectly <em>hiding</em>.</p>
<p>Although the Pederson Commitment is perfectly <em>hiding</em>, it does rely on the fact that Alice has NOT cracked the DLP to be 
able to calculate other pairs of input values to open the commitment to another value when challenged. The Pederson 
Commitment is thus only computationally <em>binding</em>.</p>
<h2><a class="header" href="#bulletproof-protocols" id="bulletproof-protocols">Bulletproof Protocols</a></h2>
<p>Bulletproof protocols have multiple applications, most of which are discussed in 
<a href="cryptography/bulletproofs-protocols/../bulletproofs-and-mimblewimble/MainReport.html#applications-for-bulletproofs">Bulletproofs and Mimblewimble</a>. 
The following list links these use cases to the different Bulletproof protocols:</p>
<ul>
<li>
<p>Bulletproofs provide short, non-interactive, zero-knowledge proofs without a trusted setup. The small size of 
Bulletproofs reduces overall cost. This has applicability in distributed systems where proofs are transmitted over a 
network or stored for a long time.</p>
</li>
<li>
<p><a href="cryptography/bulletproofs-protocols/MainReport.html#range-proof-protocol-with-logarithmic-size">Range Proof Protocol with Logarithmic Size</a> provides short, single and 
aggregatable range proofs, and can be used with multiple blockchain protocols including Mimblewimble. These can be 
applied to normal transactions or to some smart contract, where committed values need to be proven to be in a specific 
range without revealing the values.</p>
</li>
<li>
<p>The protocol presented in <a href="cryptography/bulletproofs-protocols/MainReport.html#aggregating-logarithmic-proofs">Aggregating Logarithmic Proofs</a> can be used for Merkle 
proofs and proof of solvency without revealing any additional information.</p>
</li>
<li>
<p>Range proofs can be compiled for a multi-party, single, joined confidential transaction for their known outputs using 
<a href="cryptography/bulletproofs-protocols/MainReport.html#mpc-protocol-for-bulletproofs">MPC Protocol for Bulletproofs</a>. Users do not have to reveal their secret transaction 
values.</p>
</li>
<li>
<p>Verifiable shuffles and multi-signatures with deterministic nonces can be implemented with 
<a href="cryptography/bulletproofs-protocols/MainReport.html#inner-product-proof-for-arithmetic-circuits-protocol-3">Protocol 3</a>.</p>
</li>
<li>
<p>Bulletproofs present an efficient and short zero-knowledge proof for arbitrary Arithmetic 
Circuits<sup><a href="cryptography/bulletproofs-protocols/MainReport.html#ac" title="An arithmetic circuit C over a 
field F and variables (x_1, ..., x_n) 
is a directed acyclic graph ...">def</a></sup> using <a href="cryptography/bulletproofs-protocols/MainReport.html#zero-knowledge-proof-for-arithmetic-circuits">Zero-knowledge Proof for Arithmetic Circuits</a>.</p>
</li>
<li>
<p>Various Bulletproof protocols can be applied to scriptless scripts, to make them non-interactive and not have to use 
Sigma protocols.</p>
</li>
<li>
<p>Batch verifications can be done using 
<a href="cryptography/bulletproofs-protocols/MainReport.html#optimized-verifier-using-multi-exponentiation-and-batch-verification">Optimized Verifier using Multi-exponentiation and Batch Verification</a>, 
e.g. a blockchain full node receiving a block of transactions needs to verify all transactions as well as range proofs.</p>
</li>
</ul>
<p>A detailed mathematical discussion of the different Bulletproof protocols follows. Protocols 1, 2 and 3 are numbered 
consistently with [<a href="http://web.stanford.edu/%7Ebuenz/pubs/bulletproofs.pdf" title="Bulletproofs: Short Proofs for Confidential Transactions 
and More, Blockchain Protocol Analysis and Security 
Engineering 2018">1</a>]. Refer to <a href="cryptography/bulletproofs-protocols/MainReport.html#notation-used">Notation Used</a>.</p>
<p><strong>Note:</strong> Full mathematical definitions and terms not defined are available in [<a href="http://web.stanford.edu/%7Ebuenz/pubs/bulletproofs.pdf" title="Bulletproofs: Short Proofs for Confidential Transactions 
and More, Blockchain Protocol Analysis and Security 
Engineering 2018">1</a>].
<br></p>
<h3><a class="header" href="#inner-product-argument-protocol-1" id="inner-product-argument-protocol-1">Inner-product Argument (Protocol 1)</a></h3>
<p>The first and most important building block of the Bulletproofs is its efficient algorithm to calculate an inner-product 
argument for two independent (not related) binding vector Pedersen Commitments<sup><a href="cryptography/bulletproofs-protocols/MainReport.html#pc" title="The Pedersen commitment is a system 
for making blinded non-interactive 
commitments to a value ...">def</a></sup>. 
Protocol 1 is an argument of knowledge that the <em>prover</em> $ \mathcal{P} $ knows the openings of two binding Pedersen 
vector commitments that satisfy a given inner product relation. Let inputs to the inner-product argument be independent 
generators $ g,h \in \mathbb G^n $, a scalar $ c \in \mathbb Z_p $ and $ P \in \mathbb G $. The argument lets the 
<em>prover</em> $ \mathcal{P} $ convince a <em>verifier</em> $ \mathcal{V} $ that the <em>prover</em> $ \mathcal{P} $ knows two vectors 
$ \mathbf a, \mathbf b \in \mathbb Z^n_p ​$ such that
$$
P =\mathbf{g}^\mathbf{a}\mathbf{h}^\mathbf{b} \mspace{30mu} \mathrm{and} \mspace{30mu} c = 
\langle \mathbf {a} \mspace{3mu}, \mspace{3mu} \mathbf {b} \rangle
$$</p>
<p>$ P ​$ is referred to as the binding vector commitment to $ \mathbf a, \mathbf b ​$. The inner product argument is an 
efficient proof system for the following relation:</p>
<p>$$
{ (\mathbf {g},\mathbf {h} \in \mathbb G^n , \mspace{12mu} P \in \mathbb G , \mspace{12mu} c \in \mathbb Z_p ; 
\mspace{12mu} \mathbf {a}, \mathbf {b} \in \mathbb Z^n_p ) \mspace{3mu} : \mspace{15mu} P = 
\mathbf{g}^\mathbf{a}\mathbf{h}^\mathbf{b} \mspace{3mu} \wedge \mspace{3mu} c = 
\langle \mathbf {a} \mspace{3mu}, \mspace{3mu} \mathbf {b} \rangle } 
\tag{1}
$$</p>
<p>Relation (1) requires sending $ 2n $ elements to the <em>verifier</em> $ \mathcal{V} $. The inner product 
$ c = \langle \mathbf {a} \mspace{3mu}, \mspace{3mu} \mathbf {b} \rangle \ $ can be made part of the vector commitment 
$  P \in \mathbb G  $. This will enable sending only $ 2 \log 2 (n) $ elements to the <em>verifier</em> $ \mathcal{V} $ 
(explained in the next section). For a given $ P \in \mathbb G $, the <em>prover</em> $ \mathcal{P} $ proves that it has 
vectors $ \mathbf {a}, \mathbf {b} \in \mathbb Z^n_p $ for which 
$ P =\mathbf{g}^\mathbf{a}\mathbf{h}^\mathbf{b} \cdot u^{ \langle \mathbf {a}, \mathbf {b} \rangle } $. 
Here $ u \in \mathbb G $ is a fixed group element with an unknown discrete-log relative to 
$ \mathbf {g},\mathbf {h} \in \mathbb G^n ​$. </p>
<p>$$
{ (\mathbf {g},\mathbf {h} \in \mathbb G^n , \mspace{12mu} u,P \in \mathbb G ; 
\mspace{12mu} \mathbf {a}, \mathbf {b} \in \mathbb Z^n_p ) : \mspace{15mu} P = 
\mathbf{g}^\mathbf{a}\mathbf{h}^\mathbf{b} \cdot u^{ \langle \mathbf {a}, \mathbf {b} \rangle } } 
\tag{2}
$$</p>
<p>A proof system for relation (2) gives a proof system for (1) with the same complexity, thus only a proof system for 
relation (2) is required. </p>
<p>Protocol 1 is then defined as the proof system for relation (2) as shown in Figure 1. The element $ u $ is raised 
to a random power $ x $ (the challenge) chosen by the <em>verifier</em> $ \mathcal{V} $ to ensure that the extracted vectors 
$ \mathbf {a}, \mathbf {b} $ from <a href="cryptography/bulletproofs-protocols/MainReport.html#inner-product-verification-through-multi-exponentiation-protocol-2">Protocol 2</a> 
satisfy $ c = \langle \mathbf {a} , \mathbf {b} \rangle $.</p>
<p align="center"><img src="cryptography/bulletproofs-protocols/sources/Protocol-1.png" width="470" /></p>
<div align="center"><b>Figure&nbsp;1: Bulletproofs Protocol 1 
[<a href="http://web.stanford.edu/%7Ebuenz/pubs/bulletproofs.pdf" title="Bulletproofs: Short Proofs for Confidential 
Transactions 
and More, Blockchain Protocol Analysis and Security 
Engineering 2018, 
Bünz B. et al.">1</a>]</b></div>
<p>The argument presented in Protocol 1 has the following Commitment Scheme properties:</p>
<ul>
<li><strong>Perfect completeness (hiding):</strong> Every validity/truth is provable. Also refer to Definition 9 in [<a href="http://web.stanford.edu/%7Ebuenz/pubs/bulletproofs.pdf" title="Bulletproofs: Short Proofs for Confidential Transactions 
and More, Blockchain Protocol Analysis and Security 
Engineering 2018">1</a>].</li>
<li><strong>Statistical witness extended emulation (binding):</strong> Robust against either extracting a non-trivial discrete 
logarithm relation between $ \mathbf {g} , \mathbf {h} , u $ or extracting a valid witness $ \mathbf {a}, \mathbf {b} $.</li>
</ul>
<h3><a class="header" href="#how-proof-system-for-protocol-1-works-shrinking-by-recursion" id="how-proof-system-for-protocol-1-works-shrinking-by-recursion">How Proof System for Protocol 1 Works, Shrinking by Recursion</a></h3>
<p>Protocol 1 uses an inner product argument of two vectors $ \mathbf a, \mathbf b \in \mathbb Z^n_p $ of size $ n $. 
The Pedersen Commitment scheme allows a vector to be cut in half and the two halves to then be compressed together. 
Let $ \mathrm H : \mathbb Z^{2n+1}_p \to \mathbb G $ be a hash function for commitment $ P $, with 
$ P = \mathrm H(\mathbf a , \mathbf b, \langle \mathbf a, \mathbf b \rangle) $. Note that commitment $ P $ and thus 
$ \mathrm H $ is additively homomorphic, therefore sliced vectors of $  \mathbf a, \mathbf b \in \mathbb Z^n_p  $ can be 
hashed together with inner product $ c = \langle \mathbf a , \mathbf b \rangle \in \mathbb Z_p$. If $ n ^\prime = n/2 ​$, 
starting with relation (2), then</p>
<p>$$
\begin{aligned} 
\mathrm H(\mathbf a \mspace{3mu} , \mspace{3mu} \mathbf b \mspace{3mu} , \mspace{3mu} \langle \mathbf a , 
\mathbf b \rangle) &amp;= 
\mathbf{g} ^\mathbf{a} \mathbf{h} ^\mathbf{b} \cdot u^{ \langle \mathbf a, \mathbf b \rangle}
\mspace{20mu} \in \mathbb G
\\
\mathrm H(\mathbf a_{[: n ^\prime]} \mspace{3mu} , \mspace{3mu} \mathbf a_{[n ^\prime :]} \mspace{3mu} , 
\mspace{3mu} \mathbf b_{[: n ^\prime]} \mspace{3mu} , \mspace{3mu} \mathbf b_{[n ^\prime :]} \mspace{3mu} , 
\mspace{3mu} \langle \mathbf {a}, \mathbf {b} \rangle) &amp;= 
\mathbf g ^ {\mathbf a_{[: n ^\prime]}} _{[: n ^\prime]} \cdot \mathbf g ^ {\mathbf a^\prime_{[n ^\prime :]}} 
_{[n ^\prime :]} \cdot 
\mathbf h ^ {\mathbf b_{[: n ^\prime]}} _{[: n ^\prime]} \cdot \mathbf h ^ {\mathbf b^\prime_{[n ^\prime :]}} 
_{[n ^\prime :]} \cdot 
u^{\langle \mathbf {a}, \mathbf {b} \rangle} 
\mspace{20mu} \in \mathbb G
\end{aligned}
$$</p>
<br>
<p>Commitment $ P $ can then further be sliced into $ L $ and $ R $ as follows:</p>
<p>$$
\begin{aligned} 
P &amp;= \mathrm H(\mspace{3mu} \mathbf a_{[: n ^\prime]} \mspace{6mu} , \mspace{6mu} \mathbf a_{[n ^\prime :]} \mspace{6mu} , 
\mspace{6mu} \mathbf b_{[: n ^\prime]} \mspace{6mu} , \mspace{6mu} \mathbf b_{[n ^\prime :]} \mspace{6mu} , \mspace{6mu}
\langle \mathbf {a}, \mathbf {b} \rangle \mspace{49mu}) \mspace{20mu} \in \mathbb G 
\\
L &amp;= \mathrm H(\mspace{3mu} 0 ^ {n ^\prime} \mspace{18mu} , \mspace{6mu} \mathbf a_{[: n ^\prime]} \mspace{6mu} , 
\mspace{6mu} \mathbf b_{[n ^\prime :]} \mspace{6mu} , \mspace{6mu} 0 ^ {n ^\prime} \mspace{18mu} , \mspace{6mu}
\langle \mathbf {a_{[: n ^\prime]}} , \mathbf {b_{[n ^\prime :]}} \rangle \mspace{3mu}) \mspace{20mu} \in \mathbb G 
\\
R &amp;= \mathrm H(\mspace{3mu} \mathbf a_{[n ^\prime :]} \mspace{6mu} , \mspace{6mu} 0 ^ {n ^\prime} \mspace{18mu} , 
\mspace{6mu} 0 ^ {n ^\prime} \mspace{18mu} , \mspace{6mu} \mathbf b_{[: n ^\prime]} \mspace{6mu} , \mspace{6mu}
\langle \mathbf {a_{[n ^\prime :]}} , \mathbf {b_{[: n ^\prime]}} \rangle \mspace{3mu}) \mspace{20mu} \in \mathbb G
\end{aligned}
$$</p>
<br>
<p>The first reduction step is as follows:</p>
<ul>
<li>The <em>prover</em> $ \mathcal{P} $ calculates $ L,R \in \mathbb G $ and sends it to the <em>verifier</em> $ \mathcal{V} $.</li>
<li>The <em>verifier</em> $ \mathcal{V} $ chooses a random $ x  \overset{$}{\gets} \mathbb Z _p $ and sends it to the 
<em>prover</em> $ \mathcal{P} $.</li>
<li>The <em>prover</em> $ \mathcal{P} ​$ calculates $ \mathbf a^\prime , \mathbf b^\prime \in \mathbb Z^{n^\prime}_p ​$ and sends 
it to the <em>verifier</em> $ \mathcal{V} ​$:</li>
</ul>
<p>$$
\begin{aligned} 
\mathbf a ^\prime &amp;= x\mathbf a _{[: n ^\prime]} + x^{-1} \mathbf a _{[n ^\prime :]} \in \mathbb Z^{n^\prime}_p \\
\mathbf b ^\prime &amp;= x^{-1}\mathbf b _{[: n ^\prime]} + x \mathbf b _{[n ^\prime :]} \in \mathbb Z^{n^\prime}_p
\end{aligned}
$$</p>
<ul>
<li>The <em>verifier</em> $ \mathcal{V} ​$ calculates $ P^\prime = L^{x^2} \cdot P \cdot R^{x^{-2}} ​$ and accepts (verify true) if</li>
</ul>
<p>$$
P^\prime = \mathrm H ( x^{-1} \mathbf a^\prime \mspace{3mu} , \mspace{3mu} x \mathbf a^\prime \mspace{6mu} , 
\mspace{6mu} x \mathbf b^\prime \mspace{3mu} , \mspace{3mu} x^{-1} \mathbf b^\prime \mspace{3mu} , 
\mspace{3mu} \langle \mathbf a^\prime , \mathbf b^\prime \rangle ) 
\tag{3}
$$</p>
<br>
<p>So far, the <em>prover</em> $ \mathcal{P} $ only sent $ n + 2 $ elements to the <em>verifier</em> $ \mathcal{V} $, i.e. the four 
tuple $ ( L , R , \mathbf a^\prime , \mathbf b^\prime ) $, approximately half the length compared to sending the complete 
$   \mathbf a, \mathbf b \in \mathbb Z^n_p   $. The test in relation (3) is the same as testing that
$$
P^\prime = 
(\mathbf g ^ {x^{-1}} _{[: n ^\prime]} \circ \mathbf g ^ x _{[n ^\prime :]})^{\mathbf a^\prime} \cdot 
(\mathbf h ^ x _{[: n ^\prime]} \circ \mathbf h ^ {x^{-1}} _{[n ^\prime :]})^{\mathbf b^\prime} \cdot 
u^{\langle \mathbf a^\prime , \mathbf b^\prime \rangle} 
\tag{4}
$$</p>
<p>Thus, the <em>prover</em> $ \mathcal{P} ​$ and <em>verifier</em> $ \mathcal{V} ​$ can recursively engage in an inner-product argument 
for $ P^\prime ​$ with respect to generators </p>
<p>$$
(\mathbf g ^ {x^{-1}} _{[: n ^\prime]} \circ \mathbf g ^ x _{[n ^\prime :]} \mspace{6mu} , \mspace{6mu} 
\mathbf h ^ x _{[: n ^\prime]} \circ \mathbf h ^ {x^{-1}} _{[n ^\prime :]} \mspace{6mu} , \mspace{6mu} 
u )
$$</p>
<p>which will result in a $ \log _2 n $ round protocol with $ 2 \log _2 n $ elements in $ \mathbb G $ and $ 2 $ elements in 
$ \mathbb Z _p $. The <em>prover</em> $ \mathcal{P} $ ends up sending the following terms to the <em>verifier</em> $ \mathcal{V} ​$:
$$
(L_1 , R_1) \mspace{3mu} , \mspace{3mu} . . . \mspace{3mu} , \mspace{3mu} (L_{\log _2 n} , 
R _{\log _2 n}) \mspace{3mu} , \mspace{3mu} (a , b)
$$</p>
<p>where $ a,b \in \mathbb Z _p ​$ are only sent right at the end. This protocol can be made non-interactive using the 
Fiat-Shamir<sup><a href="cryptography/bulletproofs-protocols/MainReport.html#fsh">def</a></sup> heuristic.</p>
<h3><a class="header" href="#inner-product-verification-through-multi-exponentiation-protocol-2" id="inner-product-verification-through-multi-exponentiation-protocol-2">Inner-product Verification through Multi-exponentiation (Protocol 2)</a></h3>
<p>The inner product argument to be calculated is that of two vectors $ \mathbf a, \mathbf b \in \mathbb Z^n_p $ of size 
$ n $. Protocol 2 has a logarithmic number of rounds. In each round, the <em>prover</em> $ \mathcal{P} $ and 
<em>verifier</em> $ \mathcal{V} $ calculate a new set of generators $ ( \mathbf g ^\prime , \mathbf h ^\prime ) $, which would 
require a total of $ 4n $ computationally expensive exponentiations. Multi-exponentiation is a technique to reduce the 
number of exponentiations for a given calculation. In Protocol 2, the number of exponentiations is reduced to a single 
multi-exponentiation by delaying all the exponentiations until the last round. It can also be made non-interactive using 
the Fiat-Shamir<sup><a href="cryptography/bulletproofs-protocols/MainReport.html#fsh">def</a></sup> heuristic, providing a further speedup.</p>
<p>Let $ g $ and $ h $ be the generators used in the final round of the protocol and $ x_j $ be the challenge from the 
$ j _{th} $ round. In the last round, the <em>verifier</em> $ \mathcal{V} $ checks that $ g^a h^b u ^{a \cdot b} = P $, where 
$ a,b \in \mathbb Z_p $ are given by the <em>prover</em> $ \mathcal{P} $. The final $ g $ and $ h $ can be expressed in terms 
of the input generators $ \mathbf {g},\mathbf {h} \in \mathbb G^n $ as:</p>
<p>$$
g = \prod _{i=1}^n g_i^{s_i} \in \mathbb{G}, \mspace{21mu} h=\prod _{i=1}^n h_i^{1/s_i} \in \mathbb{G}
$$</p>
<p>where $ \mathbf {s} = (s_1 \mspace{3mu} , \mspace{3mu} ... \mspace{3mu} , \mspace{3mu} s_n) \in \mathbb Z_p^n $ only 
depends on the challenges $ (x_1 \mspace{3mu} , \mspace{3mu} ... \mspace{3mu} , 
\mspace{3mu} x_{\log_2(n)}) \in \mathbb Z_p^n $.  The scalars of $ \mathbf {s} $ are calculated as follows:</p>
<p>$$
s_i = \prod ^{\log _2 (n)} _{j=1} x ^{b(i,j)} _j 
\mspace{15mu} \mathrm {for} \mspace{15mu} 
i = 1 \mspace{3mu} , \mspace{3mu} ... \mspace{3mu} , \mspace{3mu} n
$$</p>
<p>where</p>
<p>$$
b(i,j) = 
\begin{cases}
\mspace{12mu} 1 \mspace{18mu} \text{if the} \mspace{4mu} j \text{th bit of} \mspace{4mu} i-1 \mspace{4mu} \text{is} 
\mspace{4mu} 1 \\
-1 \mspace{15mu} \text{otherwise}
\end{cases}
$$</p>
<p>The entire verification check in the protocol reduces to a single multi-exponentiation of size $ 2n + 2 \log_2(n) + 1 ​$:</p>
<p>$$
\mathbf g^{a \cdot \mathbf{s}} \cdot \mathbf h^{b \cdot\mathbf{s^{-1}}} \cdot u^{a \cdot b} \mspace{12mu} \overset{?}{=} 
\mspace{12mu} P \cdot \prod _{j=1}^{\log_2(n)} L_j^{x_j^2} \cdot R_j^{x_j^{-2}} 
\tag{5}
$$</p>
<p>Figure 2 shows Protocol 2: </p>
<p align="center"><img src="cryptography/bulletproofs-protocols/sources/Protocol-2.png" width="570" /></p>
<div align="center"><b>Figure&nbsp;2: Bulletproofs Protocol 2 
[<a href="http://web.stanford.edu/%7Ebuenz/pubs/bulletproofs.pdf" title="Bulletproofs: Short Proofs for Confidential 
Transactions 
and More, Blockchain Protocol Analysis and Security 
Engineering 2018, 
Bünz B. et al.">1</a>]</b></div>
<h3><a class="header" href="#range-proof-protocol-with-logarithmic-size" id="range-proof-protocol-with-logarithmic-size">Range Proof Protocol with Logarithmic Size</a></h3>
<p>This protocol provides short and aggregatable range proofs, using the improved inner product argument from Protocol 1. 
It is built up in five parts: </p>
<ul>
<li>how to construct a range proof that requires the <em>verifier</em> $ \mathcal{V} $ to check an inner product between two 
vectors;</li>
<li>how to replace the inner product argument with an efficient inner-product argument;</li>
<li>how to efficiently aggregate $ m $ range proofs into one short proof;</li>
<li>how to make interactive public coin protocols non-interactive by using the Fiat-Shamir<sup><a href="cryptography/bulletproofs-protocols/MainReport.html#fsh">def</a></sup> heuristic; 
and </li>
<li>how to allow multiple parties to construct a single aggregate range proof. </li>
</ul>
<p>Figure 3 gives a diagrammatic overview of a range proof protocol implementation using Elliptic Curve Pedersen 
Commitments<sup><a href="cryptography/bulletproofs-protocols/MainReport.html#ecpc" title="An efficient implementation of the 
Pedersen Commitment will use secure 
Elliptic Curve Cryptography, which is ...">def</a></sup>:</p>
<p align="center"><img src="cryptography/bulletproofs-protocols/sources/RangeProofDiagram.png" width="1000" /></p>
<div align="center"><b>Figure&nbsp;3: Range Proof Protocol Implementation 
Example [<a href="https://doc.dalek.rs/bulletproofs/index.html" title="Dalek Cryptography - 
Crate Bulletproofs">22</a>]</b></div>
<h4><a class="header" href="#inner-product-range-proof" id="inner-product-range-proof">Inner-product Range Proof</a></h4>
<p>This protocol provides the ability to construct a range proof that requires the <em>verifier</em> $ \mathcal{V} ​$ to check an 
inner product between two vectors. The range proof is constructed by exploiting the fact that a Pedersen 
Commitment $ V ​$ is an element in the same group $ \mathbb G ​$ that is used to perform the inner product argument. 
Let $ v \in \mathbb Z_p ​$ and let $ V \in \mathbb G ​$ be a Pedersen Commitment to $ v ​$ using randomness $ \gamma ​$. 
The proof system will convince the <em>verifier</em> $ \mathcal{V} ​$ that commitment $ V ​$ contains a number 
$ v \in [0,2^n - 1] ​$ such that</p>
<p>$$
{ (g,h \in \mathbb{G}) , V , n \mspace{3mu} ; \mspace{12mu} v, \gamma \in \mathbb{Z_p} ) \mspace{3mu} : 
\mspace{3mu} V =h^\gamma g^v \mspace{5mu} \wedge \mspace{5mu} v \in [0,2^n - 1] }
$$</p>
<p>without revealing $ v ​$. Let $ \mathbf {a}_L = (a_1 \mspace{3mu} , \mspace{3mu} ... \mspace{3mu} , 
\mspace{3mu} a_n) \in {0,1}^n ​$ be the vector containing the bits of $ v, ​$ so that $ \langle \mathbf {a}_L, 
\mathbf {2}^n \rangle = v ​$. The <em>prover</em> $ \mathcal{P} ​$ commits to $ \mathbf {a}_L ​$ using a constant size vector 
commitment $ A \in \mathbb{G} ​$. It will convince the <em>verifier</em> $ \mathcal{V} ​$ that $ v ​$ is in $ [0,2^n - 1] ​$ by 
proving that it knows an opening $ \mathbf {a}_L \in \mathbb Z_p^n ​$ of $ A ​$ and $ v, \gamma \in \mathbb{Z_p} ​$ such 
that $ V =h^\gamma g^v ​$ and</p>
<p>$$
\langle \mathbf {a}_L \mspace{3mu} , \mspace{3mu} \mathbf {2}^n \rangle = v \mspace{20mu} \mathrm{and} \mspace{20mu} 
\mathbf {a}_R = \mathbf {a}_L - \mathbf {1}^n \mspace{20mu} \mathrm{and} \mspace{20mu} \mathbf {a}_L \circ \mathbf {a}_R 
= \mathbf{0}^n \mspace{20mu} 
\tag{6}
$$</p>
<p>This proves that $ a_1 \mspace{3mu} , \mspace{3mu} ... \mspace{3mu} , \mspace{3mu} a_n $ are all in $ {0,1} $ and that 
$ \mathbf {a}_L $ is composed of the bits of $ v $. However, the $ 2n + 1 $ constraints need to be expressed as a 
single inner-product constant so that <a href="cryptography/bulletproofs-protocols/MainReport.html#inner-product-argument-protocol-1">Protocol 1</a> can be used, by letting 
the <em>verifier</em> $ \mathcal{V} $ choose a random linear combination of the constraints. To prove that a committed vector 
$ \mathbf {b} \in \mathbb Z_p^n $ satisfies $ \mathbf {b} = \mathbf{0}^n $, it suffices for the 
<em>verifier</em> $ \mathcal{V} $ to send a random $ y \in \mathbb{Z_p} $ to the <em>prover</em> $ \mathcal{P} $ and for the 
<em>prover</em> $ \mathcal{P} $ to prove that $ \langle \mathbf {b}, \mathbf {y}^n \rangle = 0 $, which will convince the 
<em>verifier</em> $ \mathcal{V} $ that $ \mathbf {b} = \mathbf{0}^n $. The <em>prover</em> $ \mathcal{P} $ can thus prove relation 
(6) by proving that
$$
\langle \mathbf {a}_L \mspace{3mu} , \mspace{3mu} \mathbf {2}^n \rangle = v \mspace{20mu} \mathrm{and} \mspace{20mu} 
\langle \mathbf {a}_L - 1 - \mathbf {a}_R \mspace{3mu} , \mspace{3mu} \mathbf {y}^n \rangle=0 \mspace{20mu} \mathrm{and} 
\mspace{20mu} \langle \mathbf {a}_L \mspace{3mu} , \mspace{3mu} \mathbf {a}_R \circ \mathbf {y}^n \rangle = 
\mathbf{0}^n \mspace{20mu}
$$</p>
<p>Building on this, the <em>verifier</em> $ \mathcal{V} $ chooses a random $ z \in \mathbb{Z_p} $ and lets the 
<em>prover</em> $ \mathcal{P} $ prove that</p>
<p>$$
z^2 \cdot \langle \mathbf {a}_L \mspace{3mu} , 
\mspace{3mu} \mathbf {2}^n \rangle + z \cdot \langle \mathbf {a}_L - 1 - \mathbf {a}_R \mspace{3mu} , 
\mspace{3mu} \mathbf {y}^n \rangle + \langle \mathbf {a}_L \mspace{3mu} , 
\mspace{3mu} \mathbf {a}_R \circ \mathbf {y}^n \rangle = z^2 \cdot v \mspace{20mu} 
\tag{7}
$$</p>
<p>Relation (7) can be rewritten as</p>
<p>$$
\langle \mathbf {a}_L - z \cdot \mathbf {1}^n \mspace{3mu} , 
\mspace{3mu} \mathbf {y}^n \circ (\mathbf {a}_R + z \cdot \mathbf {1}^n) +z^2 \cdot \mathbf {2}^n \rangle = 
z^2 \cdot v + \delta (y,z) 
\tag{8}
$$</p>
<p>where</p>
<p>$$
\delta (y,z) = (z-z^2) \cdot \langle \mathbf {1}^n \mspace{3mu} , 
\mspace{3mu} \mathbf {y}^n\rangle -z^3 \cdot \langle \mathbf {1}^n \mspace{3mu} , 
\mspace{3mu} \mathbf {2}^n\rangle \in \mathbb{Z_p}
$$</p>
<p>can be easily calculated by the <em>verifier</em> $ \mathcal{V} ​$. The proof that relation (6) holds was thus reduced to a 
single inner-product identity.</p>
<p>Relation (8) cannot be used in its current form without revealing information about $ \mathbf {a}_L $. Two additional 
blinding vectors $ \mathbf {s}_L , \mathbf {s}_R \in \mathbb Z_p^n $ are introduced with the <em>prover</em> $ \mathcal{P} $ 
and <em>verifier</em> $ \mathcal{V} $ engaging in the zero-knowledge protocol shown in Figure 4:</p>
<p align="center"><img src="cryptography/bulletproofs-protocols/sources/Protocol-2b-part-a.png" width="550" /></p>
<div align="center"><b>Figure&nbsp;4: Bulletproofs Inner-product Range Proof 
Part A [<a href="http://web.stanford.edu/%7Ebuenz/pubs/bulletproofs.pdf" title="Bulletproofs: Short Proofs for 
Confidential Transactions 
and More, Blockchain Protocol Analysis and Security 
Engineering 2018, 
Bünz B. et al.">1</a>]</b></div>
<p>Two linear vector polynomials $ l(X), r(X) \in \mathbb Z^n_p[X] $ are defined as the inner-product terms for relation 
(8), also containing the blinding vectors $ \mathbf {s}_L $ and $ \mathbf {s}_R $. A quadratic polynomial 
$ t(X) \in \mathbb Z_p[X] $ is then defined as the inner product between the two vector polynomials $ l(X), r(X) $ 
such that</p>
<p>$$
t(X) = \langle l(X) \mspace{3mu} , \mspace{3mu} r(X) \rangle = 
t_0 + t_1 \cdot X + t_2 \cdot X^2 \mspace{10mu} \in \mathbb {Z}_p[X]
$$</p>
<p>The blinding vectors $ \mathbf {s}_L ​$ and $ \mathbf {s}_R ​$ ensure that the <em>prover</em> $ \mathcal{P} ​$ can publish 
$ l(x) ​$ and $ r(x) ​$ for one $ x \in \mathbb Z_p^* ​$ without revealing any information about $ \mathbf {a}_L ​$ and 
$ \mathbf {a}_R ​$. The constant term $ t_0 ​$ of the quadratic polynomial $ t(X) ​$ is then the result of the inner 
product in relation (8), and the <em>prover</em> $ \mathcal{P} ​$ needs to convince the <em>verifier</em> $ \mathcal{V} ​$ that </p>
<p>$$
t_0 = z^2 \cdot v + \delta (y,z)
$$</p>
<p>In order to do so, the <em>prover</em> $ \mathcal{P} $ convinces the <em>verifier</em> $ \mathcal{V} $ that it has a commitment to the 
remaining coefficients of $ t(X) $, namely $ t_1,t_2 \in \mathbb Z_p $, by checking the value of $ t(X) $ at a random 
point $ x \in \mathbb Z_p^* $. This is illustrated in Figure 5:</p>
<p align="center"><img src="cryptography/bulletproofs-protocols/sources/Protocol-2b-part-b.png" width="655" /></p>
<div align="center"><b>Figure&nbsp;5: Bulletproofs Inner-product Range Proof 
Part B [<a href="http://web.stanford.edu/%7Ebuenz/pubs/bulletproofs.pdf" title="Bulletproofs: Short Proofs for 
Confidential Transactions 
and More, Blockchain Protocol Analysis and Security 
Engineering 2018, 
Bünz B. et al.">1</a>]</b></div>
<p>The <em>verifier</em> $ \mathcal{V} $ now needs to check that $ l $ and $ r $ are in fact $ l(x) $ and $ r(x) $, and that 
$ t(x) = \langle l \mspace{3mu} , \mspace{3mu} r \rangle $. A commitment for $ \mathbf {a}_R \circ \mathbf {y}^n $ is 
needed and to do so, the commitment generators are switched from $ h \in \mathbb G^n $ to $ h ^\backprime = 
h^{(\mathbf {y}^{-1})}$. Thus $ A $ and $ S $ now become vector commitments to 
$ ( \mathbf {a}_L \mspace{3mu} , \mspace{3mu} \mathbf {a}_R \circ \mathbf {y}^n ) $ and $ ( \mathbf {s}_L \mspace{3mu} , 
\mspace{3mu} \mathbf {s}_R \circ \mathbf {y}^n ) $ respectively, with respect to the new generators 
$ (g, h ^\backprime, h) ​$. This is illustrated in Figure 6.</p>
<p align="center"><img src="cryptography/bulletproofs-protocols/sources/Protocol-2b-part-c.png" width="640" /></p>
<div align="center"><b>Figure&nbsp;6: Bulletproofs Inner-product Range Proof 
Part C [<a href="http://web.stanford.edu/%7Ebuenz/pubs/bulletproofs.pdf" title="Bulletproofs: Short Proofs for 
Confidential Transactions 
and More, Blockchain Protocol Analysis and Security 
Engineering 2018, 
Bünz B. et al.">1</a>]</b></div>
<p>The range proof presented here has the following Commitment Scheme properties:</p>
<ul>
<li><strong>Perfect completeness (hiding).</strong> Every validity/truth is provable. Also refer to Definition 9 in [<a href="http://web.stanford.edu/%7Ebuenz/pubs/bulletproofs.pdf" title="Bulletproofs: Short Proofs for Confidential Transactions 
and More, Blockchain Protocol Analysis and Security 
Engineering 2018">1</a>].</li>
<li><strong>Perfect special Honest Verifier Zero-knowledge (HVZK).</strong> The <em>verifier</em> $ \mathcal{V} $ behaves according to the protocol. 
Also refer to Definition 12 in [<a href="http://web.stanford.edu/%7Ebuenz/pubs/bulletproofs.pdf" title="Bulletproofs: Short Proofs for Confidential Transactions 
and More, Blockchain Protocol Analysis and Security 
Engineering 2018">1</a>].</li>
<li><strong>Computational witness extended emulation (binding).</strong> A witness can be computed in time closely related to time 
spent by the <em>prover</em> $ \mathcal{P} $. Also refer to Definition 10 in [<a href="http://web.stanford.edu/%7Ebuenz/pubs/bulletproofs.pdf" title="Bulletproofs: Short Proofs for Confidential Transactions 
and More, Blockchain Protocol Analysis and Security 
Engineering 2018">1</a>].</li>
</ul>
<h4><a class="header" href="#logarithmic-range-proof" id="logarithmic-range-proof">Logarithmic Range Proof</a></h4>
<p>This protocol replaces the inner product argument with an efficient inner-product argument. In step (63) in 
Figure 5, the <em>prover</em> $ \mathcal{P} $ transmits $ \mathbf {l} $ and $ \mathbf {r} $ to the <em>verifier</em> 
$ \mathcal{V} $, but their size is linear in $ n $. To make this efficient, a proof size that is logarithmic 
in $ n $ is needed. The transfer of $ \mathbf {l} $ and $ \mathbf {r} $ can be eliminated with an inner-product 
argument. Checking correctness of $ \mathbf {l} $ and $ \mathbf {r} $ (step 67 in Figure 6) and 
$ \hat {t} $ (step 68 in Figure 6) is the same as verifying that the witness $ \mathbf {l} , \mathbf {r} $ 
satisfies the inner product of relation (2) on public input 
$ (\mathbf {g} , \mathbf {h} ^ \backprime , P \cdot h^{-\mu}, \hat t) $. Transmission of vectors $ \mathbf {l} $ and 
$ \mathbf {r} $ to the <em>verifier</em> $ \mathcal{V} $ (step 63 in Figure 5) can then be eliminated and transfer 
of information limited to the scalar properties $ ( \tau _x , \mu , \hat t ) $ alone, thereby archiving a proof size 
that is logarithmic in $ n $.</p>
<h4><a class="header" href="#aggregating-logarithmic-proofs" id="aggregating-logarithmic-proofs">Aggregating Logarithmic Proofs</a></h4>
<p>This protocol efficiently aggregates $ m $ range proofs into one short proof with a slight modification to the protocol 
presented in <a href="cryptography/bulletproofs-protocols/MainReport.html#inner-product-range-proof">Inner-product Range Proof</a>. For aggregate range proofs, the inputs of one 
range proof do not affect the output of another range proof. Aggregating logarithmic range proofs is especially helpful 
if a single <em>prover</em> $ \mathcal{P} $ needs to perform multiple range proofs at the same time.</p>
<p>A proof system must be presented for the following relation:</p>
<p>$$
{ (g,h \in \mathbb{G}) , \mspace{9mu} \mathbf {V} \in \mathbb{G}^m \mspace{3mu} ; 
\mspace{9mu} \mathbf {v}, \gamma \in \mathbb Z_p^m ) \mspace{6mu} : \mspace{6mu} V_j =
h^{\gamma_j} g^{v_j} \mspace{6mu} \wedge \mspace{6mu} v_j \in [0,2^n - 1] \mspace{15mu} \forall \mspace{15mu} j \in 
[1,m] } 
\tag{9}
$$</p>
<p>The <em>prover</em> $ \mathcal{P} $ should now compute $ \mspace{3mu} \mathbf a_L \in \mathbb Z_p^{n \cdot m} $ as the 
concatenation of all of the bits for every $ v_j $ such that</p>
<p>$$
\langle \mathbf{2}^n \mspace{3mu} , \mspace{3mu} \mathbf a_L[(j-1) \cdot n : j \cdot n-1] \rangle = 
v_j \mspace{9mu} \forall \mspace{9mu} j \in [1,m] \mspace{3mu}
$$</p>
<p>The quantity $ \delta (y,z) $ is adjusted to incorporate more cross-terms $ n \cdot m $ , the linear vector polynomials 
$ l(X), r(X) $ are adjusted to be in $ \mathbb Z^{n \cdot m}_p[X] $ and the blinding factor $ \tau_x $ for the inner 
product $ \hat{t} $ (step 61 in Figure 5) is adjusted for the randomness of each commitment $ V_j $. The 
verification check (step 65 in Figure 6) is updated to include all $ V_j $ commitments and the definition of 
$ P $ (step 66 in Figure 6) is changed to be a commitment to the new $ r $.</p>
<p>This aggregated range proof that makes use of the inner product argument only uses 
$ 2 \cdot [ \log _2 (n \cdot m)] + 4 $ group elements and $ 5 $ elements in $ \mathbb Z_p $. The growth in size is 
limited to an additive term $ 2 \cdot [ \log _2 (m)] $ as opposed to a multiplicative factor $ m $ for 
$ m $ independent range proofs.</p>
<p>The aggregate range proof presented here has the following Commitment Scheme properties:</p>
<ul>
<li><strong>Perfect completeness (hiding):</strong> Every validity/truth is provable. Also refer to Definition 9 in [<a href="http://web.stanford.edu/%7Ebuenz/pubs/bulletproofs.pdf" title="Bulletproofs: Short Proofs for Confidential Transactions 
and More, Blockchain Protocol Analysis and Security 
Engineering 2018">1</a>].</li>
<li><strong>Perfect special HVZK:</strong> The <em>verifier</em> $ \mathcal{V} $ behaves according to the 
protocol. Also refer to Definition 12 in [<a href="http://web.stanford.edu/%7Ebuenz/pubs/bulletproofs.pdf" title="Bulletproofs: Short Proofs for Confidential Transactions 
and More, Blockchain Protocol Analysis and Security 
Engineering 2018">1</a>].</li>
<li><strong>Computational witness extended emulation (binding):</strong> A witness can be computed in time closely related to time 
spent by the <em>prover</em> $ \mathcal{P} $. Also refer to Definition 10 in [<a href="http://web.stanford.edu/%7Ebuenz/pubs/bulletproofs.pdf" title="Bulletproofs: Short Proofs for Confidential Transactions 
and More, Blockchain Protocol Analysis and Security 
Engineering 2018">1</a>].</li>
</ul>
<h4><a class="header" href="#non-interactive-proof-through-fiat-shamir-heuristic" id="non-interactive-proof-through-fiat-shamir-heuristic">Non-interactive Proof through Fiat-Shamir Heuristic</a></h4>
<p>So far, the <em>verifier</em> $ \mathcal{V} ​$ behaves as an honest verifier and all messages are random elements from 
$ \mathbb Z_p^* ​$. These are the prerequisites needed to convert the protocol presented so far into a non-interactive 
protocol that is secure and has full zero-knowledge in the random oracle model (thus without a trusted setup) using the 
Fiat-Shamir Heuristic<sup><a href="cryptography/bulletproofs-protocols/MainReport.html#fsh" title="The Fiat–Shamir heuristic is a 
technique in cryptography to 
convert an interactive ...">def</a></sup>. </p>
<h4><a class="header" href="#mpc-protocol-for-bulletproofs" id="mpc-protocol-for-bulletproofs">MPC Protocol for Bulletproofs</a></h4>
<p>The Multi-party Computation (MPC) protocol for Bulletproofs allows multiple parties to construct a single, simple, 
efficient, aggregate range proof designed for Bulletproofs. This is valuable when multiple parties want to create a 
single joined confidential transaction, where each party knows some of the inputs and outputs, and needs to create range 
proofs for their known outputs. In Bulletproofs, $ m $ parties, each having a Pedersen Commitment $ (V_k)_{k=1}^m $, can 
generate a single Bulletproof to which each $ V_k $ commits in some fixed range.</p>
<p>Let $ k $ denote the $ k $th party's message, thus $ A^{(k)} $ is generated using only inputs of party $ k $. A set of 
distinct generators $ (g^{(k)}, h^{(k)})^m_{k=1} $ is assigned to each party, and $ \mathbf g,\mathbf h $ is defined as 
the interleaved concatenation of all $ g^{(k)} , h^{(k)} ​$ such that </p>
<p>$$
g_i=g_{[{i \over{m}}]}^{((i-1) \mod m+1)} \mspace{15mu} \mathrm{and} \mspace{15mu} h_i=h_{[{i \over{m}}]}^{((i-1) \mod m+1)}
$$</p>
<p>The protocol either uses three rounds with linear communication in both $ m $ and the binary encoding of the range, or 
it uses a logarithmic number of rounds and communication that is only linear in $ m $. For the linear communication case, 
the protocol in <a href="cryptography/bulletproofs-protocols/MainReport.html#inner-product-range-proof">Inner-product Range Proof</a> is followed with the difference that each party 
generates its part of the proof using its own inputs and generators, i.e.</p>
<p>$$
A^{(k)} , S^{(k)}; \mspace{15mu} T_1^{(k)} , T_2^{(k)}; \mspace{15mu} \tau_x^{(k)} , \mu^{(k)} , \hat{t}^{(k)} , 
\mathbf{l}^{(k)} , \mathbf{r}^{(k)}
$$</p>
<p>These shares are sent to a dealer (this could be anyone, even one of the parties) who adds them homomorphically to 
generate the respective proof components, e.g.</p>
<p>$$
A = \prod^m_{k=1} A^{(k)} \mspace{15mu} \mathrm{and} \mspace{15mu} \tau_x = \prod^m_{k=1} \tau_x^{(k)}
$$</p>
<p>In each round, the dealer generates the challenges using the Fiat-Shamir<sup><a href="cryptography/bulletproofs-protocols/MainReport.html#fsh">def</a></sup> heuristic and the 
combined proof components, and sends them to each party. In the end, each party sends $ \mathbf{l}^{(k)},\mathbf{r}^{(k)} $ 
to the dealer, who computes $ \mathbf{l},\mathbf{r} $ as the interleaved concatenation of all shares. The dealer runs the 
inner product argument (<a href="cryptography/bulletproofs-protocols/MainReport.html#inner-product-argument-protocol-1">Protocol 1</a>) to generate the final proof. Each proof 
component is the (homomorphic) sum of each party's proof components and each share constitutes part of a separate 
zero-knowledge proof. Figure 7 shows an example of the MPC protocol implementation using three rounds with linear 
communication [<a href="https://doc-internal.dalek.rs/bulletproofs/range_proof_mpc/index.html" title="Dalek Cryptography - 
Module bulletproofs::range_proof_mpc">29</a>]: </p>
<p align="center"><img src="cryptography/bulletproofs-protocols/sources/MPC-diagram.png" width="850" /></p>
<div align="center"><b>Figure&nbsp;7: MPC Implementation Example 
[<a href="https://doc-internal.dalek.rs/bulletproofs/range_proof_mpc/index.html" title="Dalek Cryptography - 
Module bulletproofs::range_proof_mpc">29</a>]</b></div>
<p>The communication can be reduced by running a second MPC protocol for the inner product argument, reducing the rounds 
to $ \log_2(l) $. Up to the last $ \log_2(l) $ round, each party's witnesses are independent, and the overall witness is 
the interleaved concatenation of the parties' witnesses. The parties compute $ L^{(k)}, R^{(k)} $ in each round and the 
dealer computes $ L, R $ as the homomorphic sum of the shares. In the final round, the dealer generates the final 
challenge and sends it to each party, who in turn send their witness to the dealer, who completes 
<a href="cryptography/bulletproofs-protocols/MainReport.html#inner-product-verification-through-multi-exponentiation-protocol-2">Protocol 2</a>. </p>
<h4><a class="header" href="#mpc-protocol-security-discussion" id="mpc-protocol-security-discussion">MPC Protocol Security Discussion</a></h4>
<p>With the standard MPC protocol implementation as depicted in Figure 7, there's no guarantee that the dealer behaves 
honestly according to the specified protocol and generates challenges honestly. Since the Bulletproofs protocol is 
special HVZK ([<a href="https://crypto.stackexchange.com/questions/40436/what-is-the-difference-between-honest-verifier-zero-knowledge-and-zero-knowledge" title="Difference between honest 
verifier ZK and ZK">30</a>], [<a href="https://www.cs.jhu.edu/%7Esusan/600.641/scribes/lecture11.pdf" title="Honest Verifier ZK and Fiat-Shamir">31</a>]) only, a secure MPC protocol requires all parties to receive 
partial proof elements and independently compute aggregated challenges, in order to avoid the alternative case where a 
single dealer maliciously generates them. A single dealer can, however, assign index positions to all parties at the 
start of the protocol, and may complete the inner product compression, since it does not rely on partial proof data.</p>
<p>HVZK implies witness-indistinguishability [<a href="https://en.wikipedia.org/wiki/Witness-indistinguishable_proof" title="Wikipedia: Witness-indistinguishable proof">32</a>], but it isn't clear what the implications of this 
would be on the MPC protocol in practice. It could be that there are no practical attacks possible from a malicious 
dealer and that witness-indistinguishability is sufficient.</p>
<h3><a class="header" href="#zero-knowledge-proof-for-arithmetic-circuits" id="zero-knowledge-proof-for-arithmetic-circuits">Zero-knowledge Proof for Arithmetic Circuits</a></h3>
<p>Bulletproofs present an efficient zero-knowledge argument for arbitrary Arithmetic Circuits<sup><a href="cryptography/bulletproofs-protocols/MainReport.html#ac" title="An arithmetic circuit C over a 
field F and variables (x_1, ..., x_n) 
is a directed acyclic graph ...">def</a></sup> with a 
proof size of $ 2 \cdot [ \log _2 (n)+13] $ elements with $ n $ denoting the multiplicative complexity (number of 
multiplication gates) of the circuit. </p>
<p>Bootle et al. [<a href="https://eprint.iacr.org/2016/263.pdf" title="Efficient Zero-knowledge Arguments for Arithmetic 
Circuits in the Discrete Log Setting, J. Bootle et al.">2</a>] showed how an arbitrary arithmetic circuit with $ n $ multiplication gates can be converted into a 
relation containing a Hadamard Product<sup><a href="cryptography/bulletproofs-protocols/MainReport.html#hdmp" title="In mathematics, the Hadamard product 
is a binary operation that takes two 
matrices A,B of the same dimensions ...">def</a></sup> relation with additional linear consistency constraints. 
The communication cost of the addition gates in the argument was removed by providing a technique that can directly 
handle a set of Hadamard products and linear relations together. For a two-input multiplication gate, let $ \mathbf a_L , 
\mathbf a_R $ be the left and right input vectors respectively, then $ \mathbf a_L + \mathbf a_R = \mathbf a_O $ is the 
vector of outputs. Let $ Q \leqslant 2 \cdot n $ be the number of linear consistency constraints, 
$ \mathbf W_{L,q} \mspace{3mu} , \mathbf W_{R,q} \mspace{3mu}, \mathbf W_{O,q} \in \mathbb Z_p^n $ be the gate weights 
and $ c_q \in \mathbb Z_p $ for all $ q \in [1,Q] $, then the linear consistency constraints have the form
$$
\langle \mathbf W_{L,q}, \mathbf a_L \rangle + \langle \mathbf W_{R,q}, \mathbf a_R \rangle +\langle \mathbf W_{O,q}, 
\mathbf a_O \rangle = c_q
$$</p>
<p>The high-level idea of this protocol is to convert the Hadamard Product relation along with the linear consistency 
constraints into a single inner product relation. Pedersen Commitments $ V_j $ are also included as input wires to the 
arithmetic circuit, which is an important refinement, otherwise the arithmetic circuit would need to implement a 
commitment algorithm. The linear constraints also include openings $ v_j $ of $ V_j $. </p>
<h4><a class="header" href="#inner-product-proof-for-arithmetic-circuits-protocol-3" id="inner-product-proof-for-arithmetic-circuits-protocol-3">Inner-product Proof for Arithmetic Circuits (Protocol 3)</a></h4>
<p>Similar to <a href="cryptography/bulletproofs-protocols/MainReport.html#inner-product-range-proof">Inner-product Range Proof</a>, the <em>prover</em> $ \mathcal{P} $ produces a random linear 
combination of the Hadamard Product<sup><a href="cryptography/bulletproofs-protocols/MainReport.html#hdmp" title="In mathematics, the Hadamard product 
is a binary operation that takes two 
matrices A,B of the same dimensions ...">def</a></sup> and linear constraints to form a single inner product 
constraint. If the combination is chosen randomly by the <em>verifier</em> $ \mathcal{V} $, then with overwhelming probability, 
the inner-product constraint implies the other constraints. A proof system must be presented for relation (10) below:</p>
<p>$$
\begin{aligned} 
\mspace{3mu} (g,h \in \mathbb{G} \mspace{3mu} ; \mspace{3mu} \mathbf g,\mathbf h \in \mathbb{G}^n \mspace{3mu} ; 
\mspace{3mu} \mathbf V \in \mathbb{G}^m \mspace{3mu} ; \mspace{3mu} \mathbf W_{L} , \mathbf W_{R} , 
\mathbf W_{O} \in \mathbb Z_p^{Q \times n} \mspace{3mu} ; \\ 
\mathbf W_{V} \in \mathbb Z_p^{Q \times m} \mspace{3mu} ; \mspace{3mu} \mathbb{c} \in \mathbb Z_p^{Q} \mspace{3mu} ; 
\mspace{3mu} \mathbf a_L , \mathbf a_R , \mathbf a_O \in \mathbb Z_p^{n} \mspace{3mu} ; \mspace{3mu} \mathbf v , 
\mathbf \gamma \in \mathbb Z_p^{m}) \mspace{3mu} : \mspace{15mu} \\ 
V_j =h^{\gamma_j} g^{v_j} \mspace{6mu} \forall \mspace{6mu} j \in [1,m] \mspace{6mu} \wedge \mspace{6mu} \mathbf a_L + 
\mathbf a_R = \mathbf a_O \mspace{6mu} \wedge \mspace{50mu} \\ 
\mathbf W_L \cdot \mathbf a_L + \mathbf W_R \cdot \mathbf a_R + \mathbf W_O \cdot \mathbf a_O = 
\mathbf W_V \cdot \mathbf v + \mathbf c \mspace{50mu}
\end{aligned}
\tag{10}
$$</p>
<p>Let $ \mathbf W_V \in \mathbb Z_p^{Q \times m} $ be the weights for a commitment $ V_j $. Relation (10) only holds when 
$ \mathbf W_{V} $ is of rank $ m $, i.e. if the columns of the matrix are 
all linearly independent. </p>
<p>Figure 8 presents Part 1 of the protocol, where the <em>prover</em> $ \mathcal{P} $ commits to $ l(X),r(X),t(X) $:</p>
<p align="center"><img src="cryptography/bulletproofs-protocols/sources/Protocol-3-part-1.png" width="690" /></p>
<div align="center"><b>Figure&nbsp;8: Bulletproofs' Protocol 3 (Part 1) 
[<a href="http://web.stanford.edu/%7Ebuenz/pubs/bulletproofs.pdf" title="Bulletproofs: Short Proofs for Confidential 
Transactions 
and More, Blockchain Protocol Analysis and Security 
Engineering 2018, 
Bünz B. et al.">1</a>]</b></div>
<p>Figure 9 presents Part 2 of the protocol, where the <em>prover</em> 
$ \mathcal{P} ​$ convinces the <em>verifier</em> 
$ \mathcal{V} ​$ that the polynomials are well formed and that $ \langle l(X),r(X) \rangle = t(X) ​$:</p>
<p align="center"><img src="cryptography/bulletproofs-protocols/sources/Protocol-3-part-2.png" width="690" /></p>
<div align="center"><b>Figure&nbsp;9: Bulletproofs' Protocol 3 (Part 2) 
[<a href="http://web.stanford.edu/%7Ebuenz/pubs/bulletproofs.pdf" title="Bulletproofs: Short Proofs for Confidential 
Transactions 
and More, Blockchain Protocol Analysis and Security 
Engineering 2018, 
Bünz B. et al.">1</a>]</b></div>
<p>The proof system presented here has the following Commitment Scheme properties:</p>
<ul>
<li><strong>Perfect completeness (hiding):</strong> Every validity/truth is provable. Also refer to Definition 9 in [<a href="http://web.stanford.edu/%7Ebuenz/pubs/bulletproofs.pdf" title="Bulletproofs: Short Proofs for Confidential Transactions 
and More, Blockchain Protocol Analysis and Security 
Engineering 2018">1</a>].</li>
<li><strong>Perfect HVZK:</strong> The <em>verifier</em>  $ \mathcal{V} ​$ behaves according to the protocol. Also 
refer to Definition 12 in [<a href="http://web.stanford.edu/%7Ebuenz/pubs/bulletproofs.pdf" title="Bulletproofs: Short Proofs for Confidential Transactions 
and More, Blockchain Protocol Analysis and Security 
Engineering 2018">1</a>].</li>
<li><strong>Computational witness extended emulation (binding):</strong> A witness can be computed in time closely related to time 
spent by the <em>prover</em> $ \mathcal{P} $. Also refer to Definition 10 in [<a href="http://web.stanford.edu/%7Ebuenz/pubs/bulletproofs.pdf" title="Bulletproofs: Short Proofs for Confidential Transactions 
and More, Blockchain Protocol Analysis and Security 
Engineering 2018">1</a>].</li>
</ul>
<h4><a class="header" href="#logarithmic-sized-non-interactive-protocol-for-arithmetic-circuits" id="logarithmic-sized-non-interactive-protocol-for-arithmetic-circuits">Logarithmic-sized Non-interactive Protocol for Arithmetic Circuits</a></h4>
<p>Similar to <a href="cryptography/bulletproofs-protocols/MainReport.html#logarithmic-range-proof">Logarithmic Range Proof</a>, the communication cost of 
<a href="cryptography/bulletproofs-protocols/MainReport.html#inner-product-proof-for-arithmetic-circuits-protocol-3">Protocol 3</a> can be reduced by using the efficient inner 
product argument. Transmission of vectors $ \mathbf {l} ​$ and $ \mathbf {r} ​$ to the <em>verifier</em> $ \mathcal{V} ​$ 
(step 82 in Figure 9) can be eliminated, and transfer of information limited to the scalar properties 
$ ( \tau _x , \mu , \hat t ) ​$ alone. The <em>prover</em> $ \mathcal{P} ​$ and <em>verifier</em> $ \mathcal{V} ​$ engage in an inner 
product argument on public input $ (\mathbf {g} , \mathbf {h} ^ \backprime , P \cdot h^{-\mu}, \hat t) ​$ to check 
correctness of $ \mathbf {l} ​$ and $ \mathbf {r} ​$ (step 92 in Figure 9) and $ \hat {t} ​$ (step 88 in 
Figure 9); this is the same as verifying that the witness $ \mathbf {l} , \mathbf {r} ​$ satisfies the inner product 
of relation. Communication is now reduced to $ 2 \cdot [ \log_22(n)] + 8 ​$ group elements and $ 5 ​$ elements in 
$ \mathbb Z ​$ instead of $ 2 \cdot n ​$ elements, thereby achieving a proof size that is logarithmic in $ n ​$.</p>
<p>Similar to <a href="cryptography/bulletproofs-protocols/MainReport.html#non-interactive-proof-through-fiat-shamir-heuristic">Non-interactive Proof through Fiat-Shamir-Heuristic</a>, 
the protocol presented so far can be turned into an efficient, non-interactive proof that is secure and full 
zero-knowledge in the random oracle model (thus without a trusted setup) using the Fiat-Shamir Heuristic<sup><a href="cryptography/bulletproofs-protocols/MainReport.html#fsh" title="The Fiat–Shamir heuristic is a 
technique in cryptography to 
convert an interactive ...">def</a></sup>.</p>
<p>The proof system presented here has the following Commitment Scheme properties:</p>
<ul>
<li><strong>Perfect completeness (hiding):</strong> Every validity/truth is provable. Also refer to Definition 9 in [<a href="http://web.stanford.edu/%7Ebuenz/pubs/bulletproofs.pdf" title="Bulletproofs: Short Proofs for Confidential Transactions 
and More, Blockchain Protocol Analysis and Security 
Engineering 2018">1</a>].</li>
<li><strong>Statistical zero-knowledge:</strong> The <em>verifier</em> $ \mathcal{V} $ behaves according to the protocol and 
$ \mathbf {l} , \mathbf {r} $ can be efficiently simulated.</li>
<li><strong>Computational soundness (binding):</strong> if the generators $ \mathbf {g} , \mathbf {h} , g , h ​$ are independently 
generated, then finding a discrete logarithm relation between them is as hard as breaking the Discrete Log Problem.</li>
</ul>
<h3><a class="header" href="#optimized-verifier-using-multi-exponentiation-and-batch-verification" id="optimized-verifier-using-multi-exponentiation-and-batch-verification">Optimized Verifier using Multi-exponentiation and Batch Verification</a></h3>
<p>In many of the Bulletproofs' <a href="cryptography/bulletproofs-protocols/../bulletproofs-and-mimblewimble/MainReport.html#applications-for-bulletproofs">Use Cases</a>, 
the <em>verifier's</em> runtime is of particular interest. This protocol presents optimizations for a single range proof that 
is also extendable to <a href="cryptography/bulletproofs-protocols/MainReport.html#aggregating-logarithmic-proofs">aggregate range proofs</a> and the 
<a href="cryptography/bulletproofs-protocols/MainReport.html#zero-knowledge-proof-for-arithmetic-circuits">arithmetic circuit protocol</a>.</p>
<h4><a class="header" href="#multi-exponentiation" id="multi-exponentiation">Multi-exponentiation</a></h4>
<p>In <a href="cryptography/bulletproofs-protocols/MainReport.html#inner-product-verification-through-multi-exponentiation-protocol-2">Protocol 2</a>, verification of the inner-product 
is reduced to a single multi-exponentiation. This can be extended to verify the whole range proof using a single 
multi-exponentiation of size $ 2n + \log_2(n) + 7 $. In 
<a href="cryptography/bulletproofs-protocols/MainReport.html#inner-product-verification-through-multi-exponentiation-protocol-2">Protocol 2</a>, the Bulletproof 
<em>verifier</em> $ \mathcal{V} $ only performs two checks: step 68 in Figure 6 and 
step 16 in Figure 2.</p>
<p>In the protocol presented in Figure 10, which is processed by the <em>verifier</em> $ \mathcal{V} $, $ x_u $ is the 
challenge from <a href="cryptography/bulletproofs-protocols/MainReport.html#inner-product-argument-protocol-1">Protocol 1</a>, $ x_j $ the challenge from round $ j $ of 
<a href="cryptography/bulletproofs-protocols/MainReport.html#inner-product-verification-through-multi-exponentiation-protocol-2">Protocol 2</a>, and $ L_j , R_j $ the $ L , 
R $ values from round $ j $ of <a href="cryptography/bulletproofs-protocols/MainReport.html#inner-product-verification-through-multi-exponentiation-protocol-2">Protocol 2</a>. </p>
<p align="center"><img src="cryptography/bulletproofs-protocols/sources/Protocol-4.png" width="570" /></p>
<div align="center"><b>Figure&nbsp;10: Bulletproofs Optimized Verifier using Multi-exponentiation and Batch 
Verification [<a href="http://web.stanford.edu/%7Ebuenz/pubs/bulletproofs.pdf" title="Bulletproofs: Short Proofs for 
Confidential Transactions 
and More, Blockchain Protocol Analysis and Security 
Engineering 2018, 
Bünz B. et al.">1</a>]</b></div>
<p>A further idea is that multi-exponentiation (steps 98 and 105 in Figure 10) be delayed until those checks are 
performed, and that they are also combined into a single check using a random value $ c \xleftarrow[]{$} \mathbf Z_p ​$. 
This follows from the fact that if $ A^cB = 1 ​$ for a random $ c ​$, then with high probability, 
$ A = 1 \mspace 3mu \wedge \mspace 3mu B = 1 ​$. Various algorithms are known to compute the multi-exponentiations and 
scalar quantities (steps 101 and 102 in Figure 10) efficiently (sub-linearly), thereby further improving the 
speed and efficiency of the protocol.</p>
<h4><a class="header" href="#batch-verification" id="batch-verification">Batch Verification</a></h4>
<p>A further important optimization concerns the verification of multiple proofs. The essence of the verification is to 
calculate a large multi-exponentiation. Batch verification is applied in order to reduce the number of expensive 
exponentiations. This is based on the observation that checking 
$ g^x = 1 \mspace 3mu \wedge \mspace 3mu g^y = 1 ​$ can 
be checked by drawing a random scalar $ \alpha ​$ from a large enough domain and checking that $ g^{\alpha x + y} = 1 ​$. 
With high probability, the latter equation implies the first. When applied to multi-exponentiations, 
$ 2n ​$ exponentiations can be saved per additional proof. Verifying $ m ​$ distinct range proofs of size $ n ​$ only 
requires a single multi-exponentiation of size $ 2n+2+m \cdot (2 \cdot \log (n) + 5 ) ​$ along with 
$ O ( m \cdot n ) ​$ scalar operations.</p>
<h2><a class="header" href="#evolving-bulletproof-protocols" id="evolving-bulletproof-protocols">Evolving Bulletproof Protocols</a></h2>
<p>Interstellar [<a href="https://interstellar.com" title="Inter/stellar Website">24</a>] recently introduced the Programmable Constraint Systems for Bulletproofs [<a href="https://medium.com/interstellar/programmable-constraint-systems-for-bulletproofs-365b9feb92f7" title="Programmable Constraint Systems for Bulletproofs,
Interstellar,
C. Yun">23</a>], an evolution of 
<a href="cryptography/bulletproofs-protocols/MainReport.html#zero-knowledge-proof-for-arithmetic-circuits">Zero-knowledge Proof for Arithmetic Circuits</a>, extending it to support 
proving arbitrary statements in zero-knowledge using a constraint system, bypassing arithmetic circuits altogether. 
They provide an Application Programmers Interface (API) for building a constraint system directly, without the need to 
construct arithmetic expressions and then transform them into constraints. The Bulletproof constraint system proofs are 
then used as building blocks for a confidential assets protocol called Cloak.</p>
<p>The constraint system has three kinds of variables: </p>
<ul>
<li>High-level witness variables
<ul>
<li>known only to the <em>prover</em> $ \mathcal{P} $, as external inputs to the constraint system;</li>
<li>represented as individual Pedersen Commitments to the external variables in Bulletproofs.</li>
</ul>
</li>
<li>Low-level witness variables
<ul>
<li>known only to the <em>prover</em> $ \mathcal{P} $, as internal to the constraint system;</li>
<li>representing the inputs and outputs of the multiplication gates.</li>
</ul>
</li>
<li>Instance variables
<ul>
<li>known to both the <em>prover</em> $ \mathcal{P} $ and the <em>verifier</em>; </li>
<li>$ \mathcal{V} $, as public parameters;</li>
<li>represented as a family of constraint systems parameterized by public inputs (compatible with Bulletproofs);</li>
<li>folding all instance variables into a single constant parameter internally.</li>
</ul>
</li>
</ul>
<p>Instance variables can select the constraint system out of a family for each proof. The constraint system becomes a 
challenge from a <em>verifier</em> $ \mathcal{V} ​$ to a <em>prover</em> $ \mathcal{P} ​$, where some constraints are generated randomly 
in response to the <em>prover</em>'s $ \mathcal{P} ​$ commitments. Challenges to parametrize constraint systems make the 
resulting proof smaller, requiring only $ O(n) ​$ multiplications instead of 
$ O(n^2) ​$ in the case of verifiable 
shuffles when compared to a static constraint system.</p>
<p>Merlin transcripts [<a href="https://doc.dalek.rs/merlin/index.html" title="Dalek Cryptography - 
Crate Merlin">25</a>] employing the Fiat-Shamir Heuristic<sup><a href="cryptography/bulletproofs-protocols/MainReport.html#fsh" title="The Fiat–Shamir heuristic is a 
technique in cryptography to 
convert an interactive ...">def</a></sup> are used to generate the challenges. 
The challenges are bound to the high-level witness variables (the external inputs to the constraint system), which are 
added to the transcript before any of the constraints are created. The <em>prover</em> $ \mathcal{P} $ and 
<em>verifier</em> $ \mathcal{V} $ can then compute weights for some constraints with the use of the challenges.</p>
<p>Because the challenges are not bound to low-level witness variables, the resulting construction can be unsafe. 
Interstellar are working on an improvement to the protocol that would allow challenges to be bound to a subset of the 
low-level witness variables, and have a safer API using features of Rust’s type system.</p>
<p>The resulting API provides a single code path used by both the <em>prover</em> 
$ \mathcal{P} ​$ and 
<em>verifier</em> $ \mathcal{V} ​$ to allocate variables and define constraints. This is organized into a hierarchy of 
task-specific gadgets, which manages allocation, assignment and constraints on the variables, ensuring that all 
variables are constrained. Gadgets interact with mutable constraint system objects, which are specific to the 
<em>prover</em> $ \mathcal{P} ​$ and <em>verifier</em> $ \mathcal{V} ​$. They also receive secret variables and public parameters and 
generate challenges.</p>
<p>The Bulletproofs library [<a href="https://doc.dalek.rs/bulletproofs/index.html" title="Dalek Cryptography - 
Crate Bulletproofs">22</a>] does not provide any standard gadgets, but only an API for the constraint system. 
Each protocol built on top of the Bulletproofs library must create its own collection of gadgets to enable building a 
complete constraint system out of them. Figure 11 shows the Interstellar Bulletproof zero-knowledge proof protocol 
built with their programmable constraint system:</p>
<p align="center"><img src="cryptography/bulletproofs-protocols/sources/InterstellarConstraintSystem.png" width="870" /></p>
<div align="center"><b>Figure&nbsp;11: Interstellar Bulletproof Zero-knowledge Proof Protocol 
[<a href="https://medium.com/interstellar/programmable-constraint-systems-for-bulletproofs-365b9feb92f7" 
title="Programmable Constraint Systems for Bulletproofs,
Interstellar,
Cathie Yun">23</a>]</b></div>
<h2><a class="header" href="#conclusions-observations-and-recommendations-3" id="conclusions-observations-and-recommendations-3">Conclusions, Observations and Recommendations</a></h2>
<ul>
<li>
<p>Bulletproofs have many potential use cases or 
<a href="cryptography/bulletproofs-protocols/../bulletproofs-and-mimblewimble/MainReport.html#applications-for-bulletproofs">applications</a>, 
but are still under <a href="cryptography/bulletproofs-protocols/../bulletproofs-and-mimblewimble/MainReport.html#current-and-past-efforts">development</a>. A new 
confidential blockchain protocol such as Tari should carefully consider expanded use of Bulletproofs to maximally leverage 
functionality of the code base.</p>
</li>
<li>
<p>Bulletproofs are not done yet, as illustrated in <a href="cryptography/bulletproofs-protocols/MainReport.html#evolving-bulletproof-protocols">Evolving Bulletproof Protocols</a>, 
and their further development and efficient implementation have a lot of traction in the community.</p>
</li>
<li>
<p>Bünz et al. [<a href="http://web.stanford.edu/%7Ebuenz/pubs/bulletproofs.pdf" title="Bulletproofs: Short Proofs for Confidential Transactions 
and More, Blockchain Protocol Analysis and Security 
Engineering 2018">1</a>] proposed that the switch commitment scheme defined by Ruffing et al. [<a href="https://eprint.iacr.org/2017/237.pdf" title="Switch Commitments: A Safety Switch 
for Confidential Transactions, 
T. Ruffing et al.">10</a>] can be used for 
Bulletproofs if doubts in the underlying cryptographic hardness (discrete log) assumption arise in future. The switch 
commitment scheme allows for a blockchain with proofs that are currently only computationally binding to later switch 
to a proof system that is perfectly binding and secure against quantum adversaries; this will weaken the perfectly 
hiding property as a drawback and slow down all proof calculations. In the Bünz et al. [<a href="http://web.stanford.edu/%7Ebuenz/pubs/bulletproofs.pdf" title="Bulletproofs: Short Proofs for Confidential Transactions 
and More, Blockchain Protocol Analysis and Security 
Engineering 2018">1</a>] proposal, all Pedersen 
Commitments will be replaced with ElGamal Commitments<sup><a href="cryptography/bulletproofs-protocols/MainReport.html#egc" title="An ElGamal Commitment is a 
Pedersen Commitment with
additional commitment ...">def</a></sup> to move from computationally binding to 
perfectly binding. They also gave further ideas about how the ElGamal commitments can possibly be enhanced to improve 
the hiding property to be statistical or perfect. 
(Refer to the Grin projects' implementation 
<a href="cryptography/bulletproofs-protocols/../bulletproofs-and-mimblewimble/MainReport.html#wallet-reconstruction-and-switch-commitment---grin">here</a>.)</p>
</li>
<li>
<p>It is important that developers understand more about the fundamental underlying mathematics when implementing 
something like Bulletproofs, even if they just reuse libraries developed by someone else.</p>
</li>
<li>
<p>With the standard <a href="cryptography/bulletproofs-protocols/MainReport.html#mpc-protocol-for-bulletproofs">MPC protocol</a> implementation, there is no guarantee that the dealer 
behaves honestly according to the protocol and generates challenges honestly. The protocol can be extended to be more 
secure if all parties receive partial proof elements and independently compute aggregated challenges.</p>
</li>
</ul>
<h2><a class="header" href="#references-6" id="references-6">References</a></h2>
<p>[<a href="http://web.stanford.edu/%7Ebuenz/pubs/bulletproofs.pdf" title="Bulletproofs: Short Proofs for Confidential Transactions 
and More, Blockchain Protocol Analysis and Security 
Engineering 2018">1</a>] B. Bünz, J. Bootle, D. Boneh, A. Poelstra, P. Wuille and G. Maxwell, &quot;Bulletproofs: Short Proofs for Confidential 
Transactions and More&quot;, <em>Blockchain Protocol Analysis and Security Engineering 2018</em> [online]. 
Available: <a href="http://web.stanford.edu/%7Ebuenz/pubs/bulletproofs.pdf">http://web.stanford.edu/~buenz/pubs/bulletproofs.pdf</a>. Date accessed: 2018‑09‑18.</p>
<p>[<a href="https://eprint.iacr.org/2016/263.pdf" title="Efficient Zero-knowledge Arguments for Arithmetic 
Circuits in the Discrete Log Setting, J. Bootle et al.">2</a>] J. Bootle, A. Cerulli, P. Chaidos, J. Groth and C. Petit, &quot;Efficient Zero-knowledge Arguments for Arithmetic 
Circuits in the Discrete Log Setting&quot;, <em>Annual International Conference on the Theory and Applications of Cryptographic</em> 
<em>Techniques</em>, pp. 327‑357. Springer, 2016 [online]. Available: <a href="https://eprint.iacr.org/2016/263.pdf">https://eprint.iacr.org/2016/263.pdf</a>. Date accessed: 
2018‑09‑21.</p>
<p>[<a href="https://blockstream.com/bitcoin17-final41.pdf" title="Confidential Assets,
A. Poelstra et al.,
Blockstream">3</a>] A. Poelstra, A. Back, M. Friedenbach, G. Maxwell G. and P. Wuille, &quot;Confidential Assets&quot;, Blockstream [online]. 
Available: 
<a href="https://blockstream.com/bitcoin17-final41.pdf">https://blockstream.com/bitcoin17-final41.pdf</a>. Date accessed: 2018‑09‑25.</p>
<p>[<a href="https://en.wikipedia.org/wiki/Zero-knowledge_proof" title="Wikipedia - Zero-knowledge Proof">4</a>] Wikipedia: &quot;Zero-knowledge Proof&quot; [online]. Available: <a href="https://en.wikipedia.org/wiki/Zero-knowledge_proof">https://en.wikipedia.org/wiki/Zero-knowledge_proof</a>. 
Date accessed: 2018‑09‑18. </p>
<p>[<a href="https://en.wikipedia.org/wiki/Discrete_logarithm" title="Wikipedia: Discrete Logarithm">5</a>] Wikipedia: &quot;Discrete Logarithm&quot; [online]. Available: <a href="https://en.wikipedia.org/wiki/Discrete_logarithm">https://en.wikipedia.org/wiki/Discrete_logarithm</a>. 
Date accessed: 2018‑09‑20.</p>
<p>[<a href="https://link.springer.com/content/pdf/10.1007%2F3-540-47721-7_12.pdf" title="How to Prove Yourself: Practical Solutions to 
Identification and Signature Problems, 
A. Fiat et al.">6</a>] A. Fiat and A. Shamir, &quot;How to Prove Yourself: Practical Solutions to Identification and Signature Problems&quot;, 
CRYPTO 1986: pp. 186‑194 [online]. Available: <a href="https://link.springer.com/content/pdf/10.1007%2F3-540-47721-7_12.pdf">https://link.springer.com/content/pdf/10.1007%2F3-540-47721-7_12.pdf</a>. 
Date accessed: 2018‑09‑20.</p>
<p>[<a href="https://link.springer.com/content/pdf/10.1007%2F978-3-642-34961-4_38.pdf" title="How not to Prove Yourself: Pitfalls of the 
Fiat-Shamir Heuristic and Applications to Helios, 
D. Bernhard et al.">7</a>] D. Bernhard, O. Pereira and B. Warinschi, &quot;How not to Prove Yourself: Pitfalls of the Fiat-Shamir Heuristic and 
Applications to Helios&quot; [online]. Available: <a href="https://link.springer.com/content/pdf/10.1007%2F978-3-642-34961-4_38.pdf">https://link.springer.com/content/pdf/10.1007%2F978-3-642-34961-4_38.pdf</a>. 
Date accessed: 2018‑09‑20.</p>
<p>[<a href="https://hackage.haskell.org/package/pedersen-commitment" title="Pedersen-commitment: An Implementation
of Pedersen Commitment Schemes">8</a>] &quot;Pedersen-commitment: An Implementation of Pedersen Commitment Schemes&quot; [online]. Available: 
<a href="https://hackage.haskell.org/package/pedersen-commitment">https://hackage.haskell.org/package/pedersen-commitment</a>. Date accessed: 2018‑09‑25.</p>
<p>[<a href="https://zkproof.org/documents.html" title="Zero Knowledge Proof Standardization - 
An Open Industry/Academic Initiative">9</a>] &quot;Zero Knowledge Proof Standardization - An Open Industry/Academic Initiative&quot; [online]. Available: 
<a href="https://zkproof.org/documents.html">https://zkproof.org/documents.html</a>. Date accessed: 2018‑09‑26.</p>
<p>[<a href="https://eprint.iacr.org/2017/237.pdf" title="Switch Commitments: A Safety Switch 
for Confidential Transactions, 
T. Ruffing et al.">10</a>] T. Ruffing and G. Malavolta, &quot;Switch Commitments: A Safety Switch for Confidential Transactions&quot; [online]. 
Available: <a href="https://eprint.iacr.org/2017/237.pdf">https://eprint.iacr.org/2017/237.pdf</a>. Date accessed: 2018‑09‑26.</p>
<p>[<a href="https://github.com/adjoint-io/bulletproofs" title="GitHub: adjoint-io/Bulletproofs, Bulletproofs are Short
Non-interactive Zero-knowledge Proofs that Require 
no Trusted Setup">11</a>] GitHub: &quot;adjoint-io/Bulletproofs, Bulletproofs are Short Non-interactive Zero-knowledge Proofs that Require no 
Trusted Setup&quot; [online]. Available: <a href="https://github.com/adjoint-io/Bulletproofs">https://github.com/adjoint-io/Bulletproofs</a>. Date accessed: 2018‑09‑10.</p>
<p>[<a href="https://en.wikipedia.org/wiki/Commitment_scheme" title="Wikipedia: Commitment Scheme">12</a>] Wikipedia: &quot;Commitment Scheme&quot; [online]. Available: <a href="https://en.wikipedia.org/wiki/Commitment_scheme">https://en.wikipedia.org/wiki/Commitment_scheme</a>. 
Date accessed: 2018‑09‑26.</p>
<p>[<a href="http://cryptography.wikia.com/wiki/Commitment_scheme" title="Cryptography Wikia: Commitment Scheme">13</a>] Cryptography Wikia: &quot;Commitment Scheme&quot; [online]. Available: <a href="http://cryptography.wikia.com/wiki/Commitment_scheme">http://cryptography.wikia.com/wiki/Commitment_scheme</a>. 
Date accessed: 2018‑09‑26.</p>
<p>[<a href="https://www.adjoint.io/docs/cryptography.html#pedersen-commitment-scheme" title="Adjoint Inc. Documentation: 
Pedersen Commitment Scheme">14</a>] Adjoint Inc. Documentation: &quot;Pedersen Commitment Scheme&quot; [online]. Available:
<a href="https://www.adjoint.io/docs/cryptography.html#pedersen-commitment-scheme">https://www.adjoint.io/docs/cryptography.html#pedersen-commitment-scheme</a>. Date accessed: 2018‑09‑27.</p>
<p>[<a href="https://www.cs.cornell.edu/courses/cs754/2001fa/129.pdf" title="Non-interactive and Information-theoretic
Secure Verifiable Secret Sharing, 
T. Pedersen">15</a>] T. Pedersen. &quot;Non-interactive and Information-theoretic Secure Verifiable Secret Sharing&quot; [online].
Available: <a href="https://www.cs.cornell.edu/courses/cs754/2001fa/129.pdf">https://www.cs.cornell.edu/courses/cs754/2001fa/129.pdf</a>. Date accessed: 2018‑09‑27.</p>
<p>[<a href="http://www.semper.org/sirene/publ/SaSt_01.dh-et-al.long.pdf" title="Assumptions Related to Discrete Logarithms: 
Why Subtleties Make a Real Difference, 
A. Sadeghi et al.">16</a>] A. Sadeghi and M. Steiner, &quot;Assumptions Related to Discrete Logarithms: Why Subtleties Make a Real Difference&quot; 
[online]. Available: <a href="http://www.semper.org/sirene/publ/SaSt_01.dh-et-al.long.pdf">http://www.semper.org/sirene/publ/SaSt_01.dh-et-al.long.pdf</a>. Date accessed: 2018‑09‑24.</p>
<p>[<a href="http://www.e-ijaet.org/media/58I6-IJAET0612695.pdf" title="Intensified ElGamal Cryptosystem (IEC), P. Sharma et al.
International Journal of Advances in Engineering &amp; Technology,
Jan 2012">17</a>] P. Sharma P, A. Gupta and S. Sharma, &quot;Intensified ElGamal Cryptosystem (IEC)&quot;, <em>International Journal of Advances 
in Engineering &amp; Technology</em>, January 2012 [online].* Available: <a href="http://www.e-ijaet.org/media/58I6-IJAET0612695.pdf">http://www.e-ijaet.org/media/58I6-IJAET0612695.pdf</a>. 
Date accessed: 2018‑10‑09.</p>
<p>[<a href="https://drive.google.com/file/d/16XGAByoXse5NQl57v_GldJwzmvaQlS94/view" title="On the Security of ElGamal Based Encryption,
Y. Tsiounis et al.">18</a>] Y. Tsiounis and M. Yung M, &quot;On the Security of ElGamal Based Encryption&quot; [online]. 
Available: <a href="https://drive.google.com/file/d/16XGAByoXse5NQl57v_GldJwzmvaQlS94/view">https://drive.google.com/file/d/16XGAByoXse5NQl57v_GldJwzmvaQlS94/view</a>. Date accessed: 2018‑10‑09.</p>
<p>[<a href="https://en.wikipedia.org/wiki/Decisional_Diffie%E2%80%93Hellman_assumption" title="Wikipedia: Decisional Diffie–Hellman Assumption">19</a>] Wikipedia: &quot;Decisional Diffie–Hellman Assumption&quot; [online].
Available: <a href="https://en.wikipedia.org/wiki/Decisional_Diffie%E2%80%93Hellman_assumption">https://en.wikipedia.org/wiki/Decisional_Diffie%E2%80%93Hellman_assumption</a>. Date accessed: 2018‑10‑09.</p>
<p>[<a href="https://en.wikipedia.org/wiki/Arithmetic_circuit_complexity" title="Wikipedia: Arithmetic Circuit Complexity">20</a>] Wikipedia: &quot;Arithmetic Circuit Complexity&quot; [online]. Available: <a href="https://en.wikipedia.org/wiki/Arithmetic_circuit_complexity">https://en.wikipedia.org/wiki/Arithmetic_circuit_complexity</a>. 
Date accessed: 2018‑11‑08.</p>
<p>[<a href="https://en.wikipedia.org/wiki/Hadamard_product_(matrices)" title="Wikipedia: Hadamard Product (Matrices)">21</a>] Wikipedia: &quot;Hadamard Product (Matrices)&quot; [online]. Available: <a href="https://en.wikipedia.org/wiki/Hadamard_product_(matrices)">https://en.wikipedia.org/wiki/Hadamard_product_(matrices)</a>. 
Date accessed: 2018‑11‑12.</p>
<p>[<a href="https://doc.dalek.rs/bulletproofs/index.html" title="Dalek Cryptography - 
Crate Bulletproofs">22</a>] Dalek Cryptography - Crate Bulletproofs [online]. Available: <a href="https://doc.dalek.rs/bulletproofs/index.html">https://doc.dalek.rs/bulletproofs/index.html</a>. 
Date accessed: 2018‑11‑12.</p>
<p>[<a href="https://medium.com/interstellar/programmable-constraint-systems-for-bulletproofs-365b9feb92f7" title="Programmable Constraint Systems for Bulletproofs,
Interstellar,
C. Yun">23</a>] &quot;Programmable Constraint Systems for Bulletproofs&quot; [online].
Available: <a href="https://medium.com/interstellar/programmable-constraint-systems-for-bulletproofs-365b9feb92f7">https://medium.com/interstellar/programmable-constraint-systems-for-bulletproofs-365b9feb92f7</a>. 
Date accessed: 2018‑11‑22.</p>
<p>[<a href="https://interstellar.com" title="Inter/stellar Website">24</a>] Inter/stellar website [online]. Available: <a href="https://interstellar.com">https://interstellar.com</a>. Date accessed: 
2018‑11‑22.</p>
<p>[<a href="https://doc.dalek.rs/merlin/index.html" title="Dalek Cryptography - 
Crate Merlin">25</a>] &quot;Dalek Cryptography - Crate Merlin&quot; [online]. Available: <a href="https://doc.dalek.rs/merlin/index.html">https://doc.dalek.rs/merlin/index.html</a>. Date accessed: 
2018‑11‑22.</p>
<p>[<a href="http://cryptonite.info/files/HMBC.pdf" title="Homomorphic Mini-blockchain Scheme, 
B. Franca, 
April 2015">26</a>] B. Franca, &quot;Homomorphic Mini-blockchain Scheme&quot;, April 2015 [online]. Available: <a href="http://cryptonite.info/files/HMBC.pdf">http://cryptonite.info/files/HMBC.pdf</a>. 
Date accessed: 2018‑11‑22.</p>
<p>[<a href="http://orbilu.uni.lu/bitstream/10993/33705/1/MSPN2017.pdf" title="Efficient Implementation of Pedersen 
Commitments Using Twisted Edwards Curves, 
C. Franck and J. Großschädl, 
University of Luxembourg">27</a>] C. Franck and J. Großschädl, &quot;Efficient Implementation of Pedersen Commitments Using Twisted Edwards Curves&quot;, 
University of Luxembourg [online]. Available: <a href="http://orbilu.uni.lu/bitstream/10993/33705/1/MSPN2017.pdf">http://orbilu.uni.lu/bitstream/10993/33705/1/MSPN2017.pdf</a>. Date accessed: 
2018‑11‑22.</p>
<p>[<a href="https://github.com/AdamISZ/ConfidentialTransactionsDoc/blob/master/essayonCT.pdf" title="An Investigation into Confidential Transactions, 
A. Gibson, 
July 2018">28</a>] A. Gibson, &quot;An Investigation into Confidential Transactions&quot;, July 2018 
[online]. Available: <a href="https://github.com/AdamISZ/ConfidentialTransactionsDoc/blob/master/essayonCT.pdf">https://github.com/AdamISZ/ConfidentialTransactionsDoc/blob/master/essayonCT.pdf</a>. Date accessed: 
2018‑11‑22.</p>
<p>[<a href="https://doc-internal.dalek.rs/bulletproofs/range_proof_mpc/index.html" title="Dalek Cryptography - 
Module bulletproofs::range_proof_mpc">29</a>] &quot;Dalek Cryptography - Module bulletproofs::range_proof_mpc&quot; [online]. Available: <a href="https://doc-internal.dalek.rs/bulletproofs/range_proof_mpc/index.html">https://doc-internal.dalek.rs/bulletproofs/range_proof_mpc/index.html</a>. Date accessed: 
2019‑07‑10.</p>
<p>[<a href="https://crypto.stackexchange.com/questions/40436/what-is-the-difference-between-honest-verifier-zero-knowledge-and-zero-knowledge" title="Difference between honest 
verifier ZK and ZK">30</a>] &quot;What is the difference between honest verifier zero knowledge and zero knowledge?&quot; [Online]. Available: 
<a href="https://crypto.stackexchange.com/questions/40436/what-is-the-difference-between-honest-verifier-zero-knowledge-and-zero-knowledge">https://crypto.stackexchange.com/questions/40436/what-is-the-difference-between-honest-verifier-zero-knowledge-and-zero-knowledge</a>. 
Date accessed: 2019‑11‑12.</p>
<p>[<a href="https://www.cs.jhu.edu/%7Esusan/600.641/scribes/lecture11.pdf" title="Honest Verifier ZK and Fiat-Shamir">31</a>] &quot;600.641 Special Topics in Theoretical Cryptography - Lecture 11: Honest Verifier ZK and Fiat-Shamir&quot; [online]. 
Available: <a href="https://www.cs.jhu.edu/%7Esusan/600.641/scribes/lecture11.pdf">https://www.cs.jhu.edu/~susan/600.641/scribes/lecture11.pdf</a>. Date accessed: 2019‑11‑12.</p>
<p>[<a href="https://en.wikipedia.org/wiki/Witness-indistinguishable_proof" title="Wikipedia: Witness-indistinguishable proof">32</a>] Wikipedia: &quot;Witness-indistinguishable proof&quot; [online]. Available: 
<a href="https://en.wikipedia.org/wiki/Witness-indistinguishable_proof">https://en.wikipedia.org/wiki/Witness-indistinguishable_proof</a>. Date accessed: 2019‑11‑12.</p>
<h2><a class="header" href="#appendices-1" id="appendices-1">Appendices</a></h2>
<h3><a class="header" href="#appendix-a-definition-of-terms-1" id="appendix-a-definition-of-terms-1">Appendix A: Definition of Terms</a></h3>
<p>Definitions of terms presented here are high level and general in nature. Full mathematical definitions are available 
in the cited references. </p>
<ul>
<li><strong>Arithmetic Circuits:</strong><a name="ac"> </a>An arithmetic circuit $ C $ over a field $ F $ and variables 
$ (x_1, ..., x_n) $ is a directed acyclic graph whose vertices are called gates. Arithmetic circuits can alternatively 
be described as a list of addition and multiplication gates with a collection of linear consistency equations relating 
the inputs and outputs of the gates. The size of an arithmetic circuit is the number of gates in it, with the depth 
being the length of the longest directed path. <em>Upper bounding</em> the complexity of a polynomial $ f $ is to find any 
arithmetic circuit that can calculate $ f $, whereas <em>lower bounding</em> is to find the smallest arithmetic circuit that 
can calculate $ f $. An example of a simple arithmetic circuit with size six and depth two that calculates a polynomial 
is shown here ([<a href="https://github.com/adjoint-io/bulletproofs" title="GitHub: adjoint-io/Bulletproofs, Bulletproofs are Short
Non-interactive Zero-knowledge Proofs that Require 
no Trusted Setup">11</a>], [<a href="https://en.wikipedia.org/wiki/Arithmetic_circuit_complexity" title="Wikipedia: Arithmetic Circuit Complexity">20</a>]):</li>
</ul>
<p align="center"><img src="cryptography/bulletproofs-protocols/sources/ArithmiticCircuit.png" width="300" /></p>
<ul>
<li><strong>Discrete Logarithm/Discrete Logarithm Problem (DLP):</strong><a name="dlp"> </a>In the mathematics of real 
numbers, the logarithm $ \log_b^a $ is a number $ x $ such that 
$ b^x=a $​, for given numbers $ a $ and $ b ​$. 
Analogously, in any group $ G $ , powers $ b^k $ can be defined for all integers $ k $, and the discrete logarithm 
$ \log_ba $ is an integer $ k $ such that $ b^k=a $​. Algorithms in public-key cryptography base their security on the 
assumption that the discrete logarithm problem over carefully chosen cyclic finite groups and cyclic subgroups of 
elliptic curves over finite fields has no efficient solution ([<a href="https://en.wikipedia.org/wiki/Discrete_logarithm" title="Wikipedia: Discrete Logarithm">5</a>], [<a href="http://www.semper.org/sirene/publ/SaSt_01.dh-et-al.long.pdf" title="Assumptions Related to Discrete Logarithms: 
Why Subtleties Make a Real Difference, 
A. Sadeghi et al.">16</a>]).</li>
</ul>
<ul>
<li><strong>ElGamal Commitment/Encryption:</strong><a name="egc"> </a>An ElGamal commitment is a Pedersen 
Commitmentdef with an additional commitment $ g^r $ to the randomness used. The ElGamal encryption 
scheme is based on the Decisional Diffe-Hellman (DDH) assumption and the difficulty of the DLP for finite fields. The 
DDH assumption states that it is infeasible for a Probabilistic Polynomial-time (PPT) adversary to solve the DDH 
problem ([<a href="http://web.stanford.edu/%7Ebuenz/pubs/bulletproofs.pdf" title="Bulletproofs: Short Proofs for Confidential Transactions 
and More, Blockchain Protocol Analysis and Security 
Engineering 2018">1</a>], [<a href="http://www.e-ijaet.org/media/58I6-IJAET0612695.pdf" title="Intensified ElGamal Cryptosystem (IEC), P. Sharma et al.
International Journal of Advances in Engineering &amp; Technology,
Jan 2012">17</a>], [<a href="https://drive.google.com/file/d/16XGAByoXse5NQl57v_GldJwzmvaQlS94/view" title="On the Security of ElGamal Based Encryption,
Y. Tsiounis et al.">18</a>], [<a href="https://en.wikipedia.org/wiki/Decisional_Diffie%E2%80%93Hellman_assumption" title="Wikipedia: Decisional Diffie–Hellman Assumption">19</a>]). 
<strong>Note:</strong> The ElGamal encryption scheme should not be confused with the ElGamal signature 
scheme. </li>
</ul>
<ul>
<li><strong>Fiat–Shamir Heuristic/Transformation:</strong><a name="fsh"> </a>The Fiat–Shamir heuristic is a technique in 
cryptography to convert an interactive public-coin protocol (Sigma protocol) between a <em>prover</em> $ \mathcal{P} $ and a 
<em>verifier</em> $ \mathcal{V} $ into a one-message (non-interactive) protocol using a cryptographic hash function ([<a href="https://link.springer.com/content/pdf/10.1007%2F3-540-47721-7_12.pdf" title="How to Prove Yourself: Practical Solutions to 
Identification and Signature Problems, 
A. Fiat et al.">6</a>], [<a href="https://link.springer.com/content/pdf/10.1007%2F978-3-642-34961-4_38.pdf" title="How not to Prove Yourself: Pitfalls of the 
Fiat-Shamir Heuristic and Applications to Helios, 
D. Bernhard et al.">7</a>]).
<ul>
<li>
<p>The <em>prover</em> $ \mathcal{P} $ will use a <code>Prove()</code> algorithm to calculate a commitment $ A $ with a statement $ Y $ that 
is shared with the <em>verifier</em> $ \mathcal{V} $ and a secret witness value $ w $ as inputs. The commitment $ A $ is then hashed to 
obtain the challenge $ c $, which is further processed with the <code>Prove()</code> algorithm to calculate the 
response $ f $. The single message sent to the <em>verifier</em> $ \mathcal{V} $ then contains the challenge $ c $ and response $ f $.</p>
</li>
<li>
<p>The <em>verifier</em> $ \mathcal{V} $ is then able to compute the commitment $ A $ from the shared statement $ Y $, challenge $ c $ and 
response $ f $. The <em>verifier</em> $ \mathcal{V} $ will then use a <code>Verify()</code> algorithm to verify the combination of shared 
statement $ Y $, commitment $ A $, challenge $ c $ and response $ f $.</p>
</li>
<li>
<p>A weak Fiat–Shamir transformation can be turned into a strong Fiat–Shamir transformation if the hashing function is 
applied to the commitment $ A $ and shared statement $ Y $ to obtain the challenge $ c $ as opposed to only the 
commitment $ A $.</p>
</li>
</ul>
</li>
</ul>
<ul>
<li><strong>Hadamard Product:</strong><a name="hdmp"> </a>In mathematics, the Hadamard product is a binary operation that takes 
two matrices $ \mathbf {A} , \mathbf {B} $ of the same dimensions, and produces another matrix of the same dimensions 
where each element $ i,j $ is the product of elements $ i,j $ of the original two matrices. The Hadamard product 
$ \mathbf {A} \circ \mathbf {B} $ is different from normal matrix multiplication, most notably because it is also 
commutative $ [ \mathbf {A} \circ \mathbf {B} = \mathbf {B} \circ \mathbf {A} ] $ ​along with being associative 
$ [ \mathbf {A} \circ ( \mathbf {B} \circ \mathbf {C} ) = ( \mathbf {A} \circ \mathbf {B} ) \circ \mathbf {C} ] $ and 
distributive over addition $ [ \mathbf {A} \circ ( \mathbf {B} + \mathbf {C} ) = \mathbf {A} \circ \mathbf {B} + 
\mathbf {A} \circ \mathbf {C} ] $ ([<a href="https://en.wikipedia.org/wiki/Hadamard_product_(matrices)" title="Wikipedia: Hadamard Product (Matrices)">21</a>]).</li>
</ul>
<p>$$
\mathbf {A} \circ \mathbf {B} = \mathbf {C} = (a_{11} \cdot b_{11} \mspace{3mu} , \mspace{3mu} . . . \mspace{3mu} , 
\mspace{3mu} a_{1m} \cdot b_{1m} \mspace{6mu} ; \mspace{6mu} . . . \mspace{6mu} ; 
\mspace{6mu} a_{n1} \cdot b_{n1} \mspace{3mu} , \mspace{3mu} . . . \mspace{3mu} , \mspace{3mu} a_{nm} \cdot b_{nm} )
$$</p>
<ul>
<li><strong>Zero-knowledge Proof/Protocol:</strong><a name="zk"> </a>In cryptography, a zero-knowledge proof/protocol is a 
method by which one party (the <em>prover</em> $ \mathcal{P} $) can convince another party (the <em>verifier</em> $ \mathcal{V} $) that a statement $ Y $ is true, without 
conveying any information apart from the fact that the <em>prover</em> $ \mathcal{P} $ knows the value of $ Y $. The proof system must be 
complete, sound and zero-knowledge ([<a href="https://en.wikipedia.org/wiki/Zero-knowledge_proof" title="Wikipedia - Zero-knowledge Proof">4</a>], [<a href="https://zkproof.org/documents.html" title="Zero Knowledge Proof Standardization - 
An Open Industry/Academic Initiative">9</a>]).
<ul>
<li>
<p>Complete: If the statement is true, and both the <em>prover</em> $ \mathcal{P} $ and <em>verifier</em> $ \mathcal{V} $ follow the protocol, the verifier will accept.</p>
</li>
<li>
<p>Sound: If the statement is false, and the <em>verifier</em> $ \mathcal{V} $ follows the protocol, the <em>verifier</em> $ \mathcal{P} $ will not be convinced.</p>
</li>
<li>
<p>Zero-knowledge: If the statement is true, and the <em>prover</em> $ \mathcal{P} $ follows the protocol, the <em>verifier</em> $ \mathcal{V} $ will not learn any 
confidential information from the interaction with the <em>prover</em> $ \mathcal{P} $ apart from the fact that the statement is true.</p>
</li>
</ul>
</li>
</ul>
<h2><a class="header" href="#contributors-5" id="contributors-5">Contributors</a></h2>
<ul>
<li><a href="https://github.com/hansieodendaal">https://github.com/hansieodendaal</a></li>
<li><a href="https://github.com/neonknight64">https://github.com/neonknight64</a></li>
<li><a href="https://github.com/CjS77">https://github.com/CjS77</a></li>
<li><a href="https://github.com/philipr-za">https://github.com/philipr-za</a></li>
<li><a href="https://github.com/SarangNoether">https://github.com/SarangNoether</a></li>
<li><a href="https://github.com/anselld">https://github.com/anselld</a></li>
</ul>
<h1><a class="header" href="#pure-rust-elliptic-curve-cryptography" id="pure-rust-elliptic-curve-cryptography">Pure-Rust Elliptic Curve Cryptography</a></h1>
<div>
  <p style="float: left;">
    <img src="cryptography/pure-rust-ecc/isis-agora-lovecruft.png" width="90" /></a>
  </p>
  <p>
    <br>
    &nbsp;&nbsp;&nbsp;&nbsp;<strong>Isis Agora Lovecruft</strong><br>
    &nbsp;&nbsp;&nbsp;&nbsp;Cryptographer
    <br>
  </p>
</div>
<h2><a class="header" href="#summary-1" id="summary-1">Summary</a></h2>
<p>Fast, Safe, Pure-Rust Elliptic Curve Cryptography by Isis Lovecruft &amp; Henry De Valence</p>
<p>This talk discusses the design and implementation of
<a href="https://github.com/dalek-cryptography/curve25519-dalek">curve25519-dalek</a>, a pure-Rust implementation of operations on
the elliptic curve known as Curve25519.</p>
<p>They discuss the goals of the library and give a brief overview of the implementation strategy.</p>
<p>They also discuss features of the Rust language that allow them to achieve competitive performance without sacrificing
safety or readability, and future features that could allow them to achieve more safety and more performance.</p>
<p>Finally, they will discuss how the dalek library makes it easy to implement complex cryptographic primitives, such as
zero-knowledge proofs.</p>
<p>The content in this video is not complicated, but it is an <strong>advanced</strong> topic, since it dives deep into the internals of
how cryptographic operations are implemented on computers.</p>
<h2><a class="header" href="#video" id="video">Video</a></h2>
<iframe width="750" height="400" src="https://www.youtube-nocookie.com/embed/tH_pdYyqK4o" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<h2><a class="header" href="#slides" id="slides">Slides</a></h2>
<p><embed src="Fast Safe Pure-Rust Elliptic Curve Cryptography (Slides).pdf" 
type="application/pdf" width="750" height="500" /></p>
<br>
<h1><a class="header" href="#zk-snarks" id="zk-snarks">zk-SNARKs</a></h1>
<ul>
<li><a href="cryptography/zksnarks/mainreport.html#introduction">Introduction</a> </li>
<li><a href="cryptography/zksnarks/mainreport.html#what-is-zkp-a-complete-guide-to-zero-knowledge-proof">What is ZKP? A Complete Guide to Zero-knowledge Proof</a> 
<ul>
<li><a href="cryptography/zksnarks/mainreport.html#overview">Overview</a></li>
<li><a href="cryptography/zksnarks/mainreport.html#summary">Summary</a></li>
</ul>
</li>
<li><a href="cryptography/zksnarks/mainreport.html#introduction-to-zk-snarks">Introduction to zk-SNARKs</a>
<ul>
<li><a href="cryptography/zksnarks/mainreport.html#overview-1">Overview</a></li>
<li><a href="cryptography/zksnarks/mainreport.html#summary-1">Summary</a></li>
<li><a href="cryptography/zksnarks/mainreport.html#video">Video</a></li>
</ul>
</li>
<li><a href="cryptography/zksnarks/mainreport.html#comparing-general-purpose-zk-snarks">Comparing General-purpose zk-SNARKs</a> 
<ul>
<li><a href="cryptography/zksnarks/mainreport.html#overview-2">Overview</a></li>
<li><a href="cryptography/zksnarks/mainreport.html#summary-2">Summary</a></li>
</ul>
</li>
<li><a href="cryptography/zksnarks/mainreport.html#quadratic-arithmetic-programs---from-zero-to-hero">Quadratic Arithmetic Programs - from Zero to Hero</a> 
<ul>
<li><a href="cryptography/zksnarks/mainreport.html#overview-3">Overview</a></li>
<li><a href="cryptography/zksnarks/mainreport.html#summary-3">Summary</a></li>
</ul>
</li>
<li><a href="cryptography/zksnarks/mainreport.html#explaining-snarks-series-part-i-to-part-vii">Explaining SNARKs Series: Part I to Part VII</a> 
<ul>
<li><a href="cryptography/zksnarks/mainreport.html#overview-4">Overview</a></li>
<li><a href="cryptography/zksnarks/mainreport.html#part-i-homomorphic-hidings">Part I: Homomorphic Hidings</a> </li>
<li><a href="cryptography/zksnarks/mainreport.html#part-ii-blind-evaluation-of-polynomials">Part II: Blind Evaluation of Polynomials</a> </li>
<li><a href="cryptography/zksnarks/mainreport.html#part-iii-the-knowledge-of-coefficient-test-and-assumption">Part III: The Knowledge of Coefficient Test and Assumption</a> </li>
<li><a href="cryptography/zksnarks/mainreport.html#part-iv-how-to-make-blind-evaluation-of-polynomials-verifiable">Part IV: How to make Blind Evaluation of Polynomials Verifiable</a> </li>
<li><a href="cryptography/zksnarks/mainreport.html#part-v-from-computations-to-polynomials">Part V: From Computations to Polynomials</a> </li>
<li><a href="cryptography/zksnarks/mainreport.html#part-vi-the-pinocchio-protocol">Part VI: The Pinocchio Protocol</a> </li>
<li><a href="cryptography/zksnarks/mainreport.html#part-vii-pairings-of-elliptic-curves">Part VII: Pairings of Elliptic Curves</a></li>
</ul>
</li>
<li><a href="cryptography/zksnarks/mainreport.html#zk-sharks-combining-succinct-verification-and-public-coin-setup">zk-SHARKs: Combining Succinct Verification and Public Coin Setup</a> 
<ul>
<li><a href="cryptography/zksnarks/mainreport.html#background">Background</a></li>
<li><a href="cryptography/zksnarks/mainreport.html#summary-4">Summary</a></li>
</ul>
</li>
<li><a href="cryptography/zksnarks/mainreport.html#references">References</a></li>
</ul>
<h2><a class="header" href="#introduction-5" id="introduction-5">Introduction</a></h2>
<p>Zero-knowledge proof protocols have gained much attention in the past decade, due to the popularity of cryptocurrencies. 
A zero-knowledge Succinct Non-interactive Argument of Knowledge (zk-SNARK), referred to here as an <em>argument of 
knowledge,</em> is a special kind of a zero-knowledge proof. The difference between a <em>proof of knowledge</em> and an <em>argument 
of knowledge</em> is rather technical for the intended audience of this report. The distinction lies in the difference 
between <em>statistical soundness</em> and <em>computational soundness</em>. The technical reader is referred to 
[<a href="http://crypto.cs.mcgill.ca/%7Ecrepeau/PDF/BCC88-jcss.pdf" title="Minimum Disclosure
Proofs of Knowledge">1</a>] or [<a href="http://people.seas.harvard.edu/%7Esalil/research/SZKargs-focs.pdf" title="Statistical Zero-knowledge
Arguments for NP from
Any One-way Function
(Extended 
Abstract)">2</a>]. </p>
<p>zk-SNARKs have found many applications in zero-knowledge proving systems, libraries of proving systems such as 
<em>libsnark</em> and <em>bellman</em> and general-purpose compilers from high-level languages such as <em>Pinocchio</em>. &quot;DIZK: A 
Distributed Zero Knowledge Proof System&quot;, by Wu et al. [<a href="https://www.usenix.org/system/files/conference/usenixsecurity18/sec18-wu.pdf" title="DIZK: A Distributed
Zero Knowledge
Proof System">3</a>], is one of the best papers on zk-SNARKs, at least from a 
cryptographer's point of view. Coins such as Zerocoin and Zcash use zk-SNARKs. The content reflected in this curated 
content report, although not all inclusive, covers all the necessary basics one needs to understand zk-SNARKs and their 
implementations.</p>
<h2><a class="header" href="#what-is-zkp-a-complete-guide-to-zero-knowledge-proof" id="what-is-zkp-a-complete-guide-to-zero-knowledge-proof">What is ZKP? A Complete Guide to Zero-knowledge Proof</a></h2>
<div>
  <p style="float: left;">
    <img src="cryptography/zksnarks/sources/hasib_anwar.png" width="90" />
  </p>
  <p>
    <br>
    &nbsp;&nbsp;&nbsp;&nbsp;<strong>Hasib Anwar</strong><br>
    &nbsp;&nbsp;&nbsp;&nbsp;Just is a born geek
    <br>
    <br>
  </p>
</div>
<h3><a class="header" href="#overview-1" id="overview-1">Overview</a></h3>
<p>A zero-knowledge proof is a technique one uses to prove to a verifier that one has knowledge of some secret information, 
without disclosing the information. This is a powerful tool in the blockchain world, particularly in cryptocurrencies. 
The aim is to achieve a trustless network, i.e. anyone in the network should be able to verify information recorded in a 
block.</p>
<h3><a class="header" href="#summary-2" id="summary-2">Summary</a></h3>
<p>In <a href="https://101blockchains.com/zero-knowledge-proof/">this post</a>, Anwar provides an excellent zero-knowledge 
infographic that summarizes what a zero-knowledge proof is, its main properties (completeness, soundness and 
zero-knowledge), as well as its <em>use cases</em> such as <em>authentication</em>, <em>secure data sharing</em> and <em>file-system control</em>. 
Find what Anwar calls a <em>complete guide to zero-knowledge proofs</em>, 
<a href="https://101blockchains.com/zero-knowledge-proof/#prettyPhoto">here</a>.</p>
<h2><a class="header" href="#introduction-to-zk-snarks" id="introduction-to-zk-snarks">Introduction to zk-SNARKs</a></h2>
<div>
  <p style="float: left;">
    <img src="cryptography/zksnarks/sources/chris_reitweissner.png" width="90" />
  </p>
  <p>
    <br>
    &nbsp;&nbsp;&nbsp;&nbsp;<strong>Dr Christian Reitwiessner</strong><br>
    &nbsp;&nbsp;&nbsp;&nbsp;Ethereum Foundation
    <br>
    <br>
  </p>
</div>
<h3><a class="header" href="#overview-2" id="overview-2">Overview</a></h3>
<p>A typical zero-knowledge proof protocol involves at least two participants: the <em>Verifier</em> and the <em>Prover</em>. 
The <em>Verifier</em> sends a challenge to the <em>Prover</em> in the form of a computational problem. The <em>Prover</em> has to solve the 
computational problem and, without revealing the solution, send proof of the correct solution to the <em>Verifier</em>. </p>
<h3><a class="header" href="#summary-3" id="summary-3">Summary</a></h3>
<p>zk-SNARKs are important in blockchains for at least two reasons:</p>
<ul>
<li>Blockchains are by nature not scalable. They 
thus benefit in that zk-SNARKs allow a verifier to verify a given <em>proof</em> of a computation without having to actually 
carry out the computation.</li>
<li>Blockchains are public and need to be <em>trustless,</em> as explained earlier. The <em>zero-knowledge</em> property of 
zk‑SNARKs as well as the possibility to put in place a so-called <em>trusted setup</em> make this <em>almost</em> possible. </li>
</ul>
<p>Reitwiessner uses an example of a mini 4 x 4 Sudoku challenge as an example of an interactive zero-knowledge proof. He 
explains how it would fall short of the <em>zero-knowledge</em> property without the use of homomorphic encryption as well as 
putting in place a <em>trusted setup</em>. Reitwiessner proceeds to explain how computations involving <em>polynomials</em> are better 
suited as challenges posed by the <em>Verifier</em> to the <em>Prover</em>.</p>
<h3><a class="header" href="#video-1" id="video-1">Video</a></h3>
<p>The slides from the talk can be found <a href="https://chriseth.github.io/notes/talks/intro_to_zksnarks/#/27">here</a>.</p>
<iframe width="640" height="360" src="https://www.youtube.com/embed/jr95o_k_SwI" frameborder="0" allow="accelerometer; 
autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<h2><a class="header" href="#comparing-general-purpose-zk-snarks" id="comparing-general-purpose-zk-snarks">Comparing General-purpose zk-SNARKs</a></h2>
<div>
  <p style="float: left;">
    <img src="cryptography/zksnarks/sources/ronald_mannak.png" width="90" />
  </p>
  <p>
    <br>
    &nbsp;&nbsp;&nbsp;&nbsp;<strong>Ronald Mannak</strong><br>
    &nbsp;&nbsp;&nbsp;&nbsp;Open-source Blockchain Developer
    <br>
    <br>
  </p>
</div>
<h3><a class="header" href="#overview-3" id="overview-3">Overview</a></h3>
<p>Recently, zk-SNARK constructs such as Supersonic [<a href="https://eprint.iacr.org/2019/1229.pdf" title="Transparent SNARKs
from DARK Compilers">4</a>] and Halo [<a href="https://eprint.iacr.org/2019/1021.pdf" title="Halo: Recursive Proof
Composition without
a Trusted Setup">5</a>] were created mainly for efficiency of proofs. The 
following article by Mannak gives a quick survey of the most recent developments, comparing general-purpose zk-SNARKs. 
The article is easy to read. It provides the technical reader with relevant references to scholarly research papers.</p>
<h3><a class="header" href="#summary-4" id="summary-4">Summary</a></h3>
<p>The main drawback of zk-SNARKs is their reliance on a <em>common reference string</em> that is created using a <em>trusted setup</em>. 
In <a href="https://medium.com/coinmonks/comparing-general-purpose-zk-snarks-51ce124c60bd?">this post</a>, Mannak mentions three 
issues with reference strings or having a trusted setup:</p>
<ul>
<li>A leaked reference string can be used to create 
undetectable fake proofs.</li>
<li>One setup is only applicable to one computation, thus making smart contracts impossible.</li>
<li>Reference strings are not upgradeable. This means that a whole new <em>ceremony</em> is required, 
even for minor <em>bug fixes</em> in crypto coins.</li>
</ul>
<p>After classifying zk-SNARKs according to the type of trusted setup they use, Mannak compares their 
<em>proof</em> and <em>verification sizes</em> as well as <em>performance</em>. </p>
<h2><a class="header" href="#quadratic-arithmetic-programs---from-zero-to-hero" id="quadratic-arithmetic-programs---from-zero-to-hero">Quadratic Arithmetic Programs - from Zero to Hero</a></h2>
<div>
  <p style="float: left;">
    <img src="cryptography/zksnarks/sources/vitalik_buterin.png" width="90" />
  </p>
  <p>
    <br>
    &nbsp;&nbsp;&nbsp;&nbsp;<strong>Vitalik Buterin</strong><br>
    &nbsp;&nbsp;&nbsp;&nbsp;Co-founder of Ethereum
    <br>
    <br>
  </p>
</div>
<h3><a class="header" href="#overview-4" id="overview-4">Overview</a></h3>
<p>The zk-SNARK end-to-end journey is to create a function or a protocol that takes the proof, given by the Prover, and 
checks its veracity. In a zk-SNARK proof, a computation is verified step by step. To do so, the computation is first 
turned into an arithmetic circuit. Each of its wires is then assigned a value that results from feeding specific inputs 
to the circuit. Next, each computing node of the arithmetic circuit (called a “gate” - an analogy of the nomenclature of 
electronic circuits) is transformed into a constraint that verifies the output wire has the value it should have for the 
values assigned to the input wires. This process involves transforming statements or computational problems into various 
formats on which a zk-SNARK proof can be performed. The following seven steps depicts the process for achieving a zk-SNARK:</p>
<p><code>Computational Problem  —&gt;  Arithmetic Circuit  —&gt;  R1CS  —&gt;  QAP  —&gt;  Linear PCP  —&gt;  Linear Interactive Proof  -&gt;  zk-SNARK</code></p>
<h3><a class="header" href="#summary-5" id="summary-5">Summary</a></h3>
<p>In <a href="https://medium.com/@VitalikButerin/quadratic-arithmetic-programs-from-zero-to-hero-f6d558cea649?source=post_page-----f6d558cea649----------------------">this post</a>, 
Buterin explains how zk-SNARKs work, using an example that focuses on the first three steps of the process given above. 
Buterin explains how a computational problem can be written as an arithmetic circuit, converted into a rank-1 constraint 
system or R1CS, and ultimately transform the R1CS into a quadratic arithmetic program.</p>
<h2><a class="header" href="#explaining-snarks-series-part-i-to-part-vii" id="explaining-snarks-series-part-i-to-part-vii">Explaining SNARKs Series: Part I to Part VII</a></h2>
<div>
  <p style="float: left;">
    <img src="cryptography/zksnarks/sources/ariel_gabizon.png" width="90" />
  </p>
  <p>
    <br>
    &nbsp;&nbsp;&nbsp;&nbsp;<strong>Ariel Gabizon</strong><br>
    &nbsp;&nbsp;&nbsp;&nbsp;Engineer at Zcash
    <br>
    <br>
  </p>
</div>
<h3><a class="header" href="#overview-5" id="overview-5">Overview</a></h3>
<p>The explanation of zk-SNARKs given by <a href="cryptography/zksnarks/mainreport.html#quadratic-arithmetic-programs---from-zero-to-hero">Buterin above</a>, and similar 
explanations by Pinto (<a href="http://coders-errand.com/constraint-systems-for-zk-snarks/" title="Constraint Systems for ZK SNARKs">6</a>], [<a href="http://coders-errand.com/the-vanishing-polynomial-for-qaps/" title="The Vanishing Polynomial
for QAPs">7</a>]), although excellent in clarifying the R1CS and the Quadratic Arithmatic Program (QAP) 
concepts, do not explain how zero-knowledge is achieved in zk-SNARKs. For a step-by-step and mathematical explanation of 
how this is achieved, as used in Zcash, refer to the seven-part series listed here. </p>
<h3><a class="header" href="#part-i-homomorphic-hidings" id="part-i-homomorphic-hidings">[Part I: Homomorphic Hidings]</a></h3>
<p>This <a href="https://z.cash/blog/snark-explain">post</a> explains how zk-SNARKs use <em>homomorphic hiding</em> or 
<em>homomorphic encryption</em> in order to achieve zero-knowledge proofs. Gabizon dives into the <em>mathematics</em> that underpins 
the cryptographic security of homomorphic encryption afforded by the difficulty of solving <em>discrete log problems</em> in a 
finite group of a large <em>prime</em> order. </p>
<h3><a class="header" href="#part-ii-blind-evaluation-of-polynomials" id="part-ii-blind-evaluation-of-polynomials">[Part II: Blind Evaluation of Polynomials]</a></h3>
<p>This <a href="https://z.cash/blog/snark-explain2">post</a> explains how the power of the <em>homomorphic property</em> of these types of 
hidings is seen in how it easily extends to linear combinations. Since any polynomial evaluated at a specific value 
$x = \bf{s} $ is a <em>weighted linear combination</em> of powers of $\bf{s}​$, this property allows sophisticated 
zero-knowledge proofs to be set up. </p>
<p>For example, two parties can set up a <em>zero-knowledge proof</em> where the Verifier can request the Prover to prove 
knowledge of the &quot;right&quot; polynomial $P(x)$, without revealing $P(x)$ to the Verifier. All that the Verifier requests 
is for the Prover to evaluate $P(x)$ at a secret point $\bf{s}$, without learning what $\bf{s}$ is. Thus, instead of 
sending $\bf{s}$ in the open, the Verifier sends homomorphic hidings of the necessary power of $\bf{s}$. The Prover 
therefore simply evaluates the right linear combination of the hidings as dictated to by the polynomial $P(x)$. This is 
how the Prover performs what is called a <em>blind evaluation of the polynomial</em> $P(x)$ at a secret point $\bf{s}​$ 
only known by the Verifier.</p>
<h3><a class="header" href="#part-iii-the-knowledge-of-coefficient-test-and-assumption" id="part-iii-the-knowledge-of-coefficient-test-and-assumption">[Part III: The Knowledge of Coefficient Test and Assumption]</a></h3>
<p>In this <a href="https://z.cash/blog/snark-explain3">post</a>, Gabizon notes that it is necessary to force the Prover to comply 
with the rules of the protocol. Although this is covered in the next part of the series, in this post he considers <em>the 
Knowledge of Coefficient (KC) Test</em>, as well as its <em>KC assumption</em>. </p>
<p>The KC Test is in fact a request for a <em>proof</em> in the form of a challenge that a Verifier poses to a Prover. The 
Verifier sends a pair  $( a, b )$  of elements of a prime field, where $a$ is such that $b = \alpha \cdot a$, to the 
Prover. The Verifier challenges the Prover to produce a similar pair $( a', b' )$, where  $b' = \alpha \cdot a' $ for 
the same scalar $\alpha$. The KC assumption is that if the Prover succeeds with a non-negligible probability, then the 
Prover knows the ratio between $a$ and $a'$. Gabizon explains how this two concept can be formalized using an 
<em>extractor</em> of the Prover. </p>
<h3><a class="header" href="#part-iv-how-to-make-blind-evaluation-of-polynomials-verifiable" id="part-iv-how-to-make-blind-evaluation-of-polynomials-verifiable">[Part IV: How to make Blind Evaluation of Polynomials Verifiable]</a></h3>
<p>In <a href="https://z.cash/blog/snark-explain4">this part</a> of the series, Gabizon explains how to make the <em>blind 
evaluation of polynomials</em> of Part II above, verifiable. This requires an extension of the <em>Knowledge of Coefficient 
Assumption</em> considered in Part III. Due to the homomorphic property of the used homomorphic hiding function, the Prover 
is able to receive several hidings of $\alpha​$-pairs from the Verifier, evaluate the polynomial $P(x)​$ on a 
particular linear combination of these hidings of $\alpha​$-pairs and send the resulting pair to the Verifier. Now, 
according to the extended <em>Knowledge of Coefficient Assumption</em> of degree $d​$, the Verifier can know, with a high 
probability, that the Prover knows the &quot;right&quot; polynomial, 
$P(x)​$, without disclosing it.</p>
<h3><a class="header" href="#part-v-from-computations-to-polynomials" id="part-v-from-computations-to-polynomials">[Part V: From Computations to Polynomials]</a></h3>
<p><a href="https://z.cash/blog/snark-explain5">This post</a> aims to translate statements that are to be proved and verified 
into the language of polynomials. Gabizon explains the same process discussed above by Buterin, for transforming a 
computational problem into an <em>arithmetic circuit</em> and ultimately into a QAP. However, unlike Buterin, Gabizon does 
not mention constraint systems. </p>
<h3><a class="header" href="#part-vi-the-pinocchio-protocol" id="part-vi-the-pinocchio-protocol">[Part VI: The Pinocchio Protocol]</a></h3>
<p>The <a href="https://z.cash/blog/snark-explain6">Pinocchio protocol</a> is used as an example of how the QAP computed in the 
previous parts of this series can be used between both the Prover and the Verifier to achieve a zero-knowledge proof 
with negligible probability that the Verifier would accept a wrong polynomial as correct. The low probability is 
guaranteed by a well-known theorem that &quot;two different polynomials of degree at most $2d$ can agree on at most $2d$ 
points in the given prime field&quot;. Gabizon further discusses how to restrict the Prover to choose their polynomials 
according to the assignment $\bf{s}$ given by the Verifier, and how the Prover can use randomly chosen field elements 
to <em>blind</em> all the information they send to the Verifier. </p>
<h3><a class="header" href="#part-vii-pairings-of-elliptic-curves" id="part-vii-pairings-of-elliptic-curves">[Part VII: Pairings of Elliptic Curves]</a></h3>
<p><a href="https://z.cash/blog/snark-explain7">This part</a> of the series aims to set up a Common Reference String (CRS) model that 
can be used to convert the <em>verifiable blind evaluation</em> of the polynomial of Part IV into a <em>non-interactive proof 
system</em>. A homomorphic hiding that supports both addition and multiplication is needed for this purpose. Such a 
homomorphic hiding is created from what is known as <em>Tate pairings</em>. Since <em>Tate pairings</em> emanate from Elliptic Curve 
Groups, Gabizon starts by defining these groups. </p>
<p>The Pinnochio SNARK, however, uses a relaxed notion of a <em>non-interactive proof</em>, where the use of a CRS is allowed. The 
CRS is created before any proofs are constructed, according to a certain randomized process, and is broadcast to all 
parties. The assumption here is that the randomness used in creating the CRS is not known to any of the parties. </p>
<p>The intended non-interactive evaluation protocol has three parts; Setup, Proof, and Verification. In the Setup, the CRS 
and a random field element $\bf{s}$ are used to calculate the Verifier's challenge (i.e. the set of $\alpha$-pairs a in 
Part IV).</p>
<h2><a class="header" href="#zk-sharks-combining-succinct-verification-and-public-coin-setup" id="zk-sharks-combining-succinct-verification-and-public-coin-setup">zk-SHARKs: Combining Succinct Verification and Public Coin Setup</a></h2>
<div>
  <p style="float: left;">
    <img src="cryptography/zksnarks/sources/madars_virza.png" width="90" />
  </p>
  <p>
    <br>
    &nbsp;&nbsp;&nbsp;&nbsp;<strong>Madars Virza</strong><br>
    &nbsp;&nbsp;&nbsp;&nbsp;Scientist, MIT
    <br>
    <br>
  </p>
</div>
<h3><a class="header" href="#background-4" id="background-4">Background</a></h3>
<p>Most of the research done on zero-knowledge proofs has been about the efficiency of these types of proofs and making 
them more practical, especially in cryptocurrencies. One of the most recent innovations is that of the so-called 
<em>zk-SHARKs</em> (short for <em>zero-knowledge Succinct Hybrid ARguments of Knowledge</em>) designed by Mariana Raykova, Eran Tromer 
and Madars Virza.</p>
<h3><a class="header" href="#summary-6" id="summary-6">Summary</a></h3>
<p>Virza starts with a concise survey of the best zk-SNARK protocols and their applications while giving an assessment of 
the efficiency of zero-knowledge proof implementations in the context of blockchains. He mentions that although 
zero-knowledge proofs have found practical applications in <em>privacy preserving cryptocurrencies</em>, <em>privacy preserving 
smart contracts</em>, <em>proof of regulatory compliance</em> and <em>blockchain-based sovereign identity</em>, they still have a few 
shortcomings. While QAP-based zero-knowledge proofs can execute fast verifications, they still require a <em>trusted 
setup</em>. Also, in Probabilistically Checkable Proof (PCP)-based zk-SNARKs, the speed of verification decays with the 
increasing statement size. </p>
<p>Virza mentions that the danger of slow verification can tempt miners to skip validation of transactions. This can cause 
forks such as the July 2015 Bitcoin fork. He uses the Bitcoin fork example and slow verification as motivation for a 
zero-knowledge protocol that allows multiple verification modes. This will allow miners to carry out an <em>optimistic 
verification</em> without losing much time and later check the validity of transactions by using <em>prudent verification</em>. The 
<em>zk-SHARK</em> is introduced as one such zero-knowledge protocol that implements these two types of verification modes. It 
is a <em>hybrid,</em> as it incorporates a Non-interactive Zero-knowledge (NIZK) proof inside a  SNARK. The internal design of 
the NIZK verifier is algebraic in nature, using a new compilation technique for linear PCPs. The special-purpose SNARK, 
which constitutes the main part of the zk-SHARK, is dedicated to verifying an <em>encoded polynomial delegation</em> problem.</p>
<p>The design of zk-SHARKs is ingenious and aims at avoiding unnecessary coin forkings.</p>
<h3><a class="header" href="#video-2" id="video-2">Video</a></h3>
<p>The slides from the <a href="https://dci.mit.edu/zksharks">talk</a> can be found 
<a href="https://madars.org/sharks/2019-04-10-SHARK-zkproof-workshop.pdf">here</a>.</p>
<iframe width="640" height="360" src="https://www.youtube.com/embed/OP8ydUxAVt4" frameborder="0" allow="accelerometer; 
autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<h2><a class="header" href="#references-7" id="references-7">References</a></h2>
<p>[<a href="http://crypto.cs.mcgill.ca/%7Ecrepeau/PDF/BCC88-jcss.pdf" title="Minimum Disclosure
Proofs of Knowledge">1</a>] G. Brassard, D. Chaum and C. Crepeau, &quot;Minimum Disclosure Proofs of Knowledge&quot; [online]. Available:
<a href="http://crypto.cs.mcgill.ca/%7Ecrepeau/PDF/BCC88-jcss.pdf">http://crypto.cs.mcgill.ca/~crepeau/PDF/BCC88-jcss.pdf</a>. Date accessed: 2019‑12‑07.</p>
<p>[<a href="http://people.seas.harvard.edu/%7Esalil/research/SZKargs-focs.pdf" title="Statistical Zero-knowledge
Arguments for NP from
Any One-way Function
(Extended 
Abstract)">2</a>] M. Nguyen, S. J. Ong and S. Vadhan, &quot;Statistical Zero-knowledge Arguments for NP from any One-way Function 
(Extended Abstract)&quot; [online]. Available: <a href="http://people.seas.harvard.edu/%7Esalil/research/SZKargs-focs.pdf">http://people.seas.harvard.edu/~salil/research/SZKargs-focs.pdf</a>. 
Date accessed: 2019‑12‑07.</p>
<p>[<a href="https://www.usenix.org/system/files/conference/usenixsecurity18/sec18-wu.pdf" title="DIZK: A Distributed
Zero Knowledge
Proof System">3</a>] H. Wu, W. Zheng, A. Chiesa, R. A. Popa and I. Stoica, &quot;DIZK: A Distributed Zero Knowledge Proof System&quot;, 
UC Berkeley [online]. Available: <a href="https://www.usenix.org/system/files/conference/usenixsecurity18/sec18-wu.pdf">https://www.usenix.org/system/files/conference/usenixsecurity18/sec18-wu.pdf</a>. 
Date accessed: 2019‑12‑07.</p>
<p>[<a href="https://eprint.iacr.org/2019/1229.pdf" title="Transparent SNARKs
from DARK Compilers">4</a>] B. Bünz, B. Fisch and A. Szepieniec, &quot;Transparent SNARKs from DARK Compilers&quot; [online]. Available: 
<a href="https://eprint.iacr.org/2019/1229.pdf">https://eprint.iacr.org/2019/1229.pdf</a>. Date accessed: 2019‑12‑07.</p>
<p>[<a href="https://eprint.iacr.org/2019/1021.pdf" title="Halo: Recursive Proof
Composition without
a Trusted Setup">5</a>] S. Bowe, J. Grigg and D. Hopwood, &quot;Halo: Recursive Proof Composition without a Trusted Setup&quot; [online]. Available: 
<a href="https://eprint.iacr.org/2019/1021.pdf">https://eprint.iacr.org/2019/1021.pdf</a>. Date accessed: 2019‑12‑07. </p>
<p>[<a href="http://coders-errand.com/constraint-systems-for-zk-snarks/" title="Constraint Systems for ZK SNARKs">6</a>] A. Pinto, &quot;Constraint Systems for ZK SNARKs&quot; [online]. Available: 
<a href="http://coders-errand.com/constraint-systems-for-zk-snarks/">http://coders-errand.com/constraint-systems-for-zk-snarks/</a>. Date accessed: 2019‑03‑06. </p>
<p>[<a href="http://coders-errand.com/the-vanishing-polynomial-for-qaps/" title="The Vanishing Polynomial
for QAPs">7</a>] A. Pinto, &quot;The Vanishing Polynomial for QAPs&quot;, 23 March 2019 [online]. Available: 
<a href="http://coders-errand.com/the-vanishing-polynomial-for-qaps/">http://coders-errand.com/the-vanishing-polynomial-for-qaps/</a>. Date accessed: 2019‑10‑10.</p>
<h1><a class="header" href="#rank-1-constraint-system-with-application-to-bulletproofs" id="rank-1-constraint-system-with-application-to-bulletproofs"><strong>Rank-1 Constraint System with Application to Bulletproofs</strong></a></h1>
<ul>
<li><a href="cryptography/r1cs-bulletproofs/mainreport.html#introduction">Introduction</a> </li>
<li><a href="cryptography/r1cs-bulletproofs/mainreport.html#arithmetic-circuits">Arithmetic Circuits</a>
<ul>
<li><a href="cryptography/r1cs-bulletproofs/mainreport.html#overview">Overview</a></li>
<li><a href="cryptography/r1cs-bulletproofs/mainreport.html#definition-of-arithmetic-circuit">Definition of Arithmetic Circuit</a></li>
<li><a href="cryptography/r1cs-bulletproofs/mainreport.html#example-of-arithmetic-circuit">Example of Arithmetic Circuit</a> </li>
</ul>
</li>
<li><a href="cryptography/r1cs-bulletproofs/mainreport.html#rank-1-constraint-systems">Rank-1 Constraint Systems</a>
<ul>
<li><a href="cryptography/r1cs-bulletproofs/mainreport.html#overview-1">Overview</a></li>
<li><a href="cryptography/r1cs-bulletproofs/mainreport.html#definition-of-constraint-system">Definition of Constraint System</a></li>
<li><a href="cryptography/r1cs-bulletproofs/mainreport.html#r1cs-definition-of-zksnarks">R1CS Definition of zk-SNARKs</a></li>
<li><a href="cryptography/r1cs-bulletproofs/mainreport.html#example-of-rank-1-constraint-system">Example of Rank-1 Constraint System</a> </li>
</ul>
</li>
<li><a href="cryptography/r1cs-bulletproofs/mainreport.html#from-arithmetic-circuits-to-programmable-constraint-systems-for-bulletproofs">From Arithmetic Circuits to Programmable Constraint Systems for Bulletproofs </a> </li>
<li><a href="cryptography/r1cs-bulletproofs/mainreport.html#interstellars-bulletproof-constraint-system">Interstellar's Bulletproof Constraint System</a>
<ul>
<li><a href="cryptography/r1cs-bulletproofs/mainreport.html#overview-2">Overview</a> </li>
<li><a href="cryptography/r1cs-bulletproofs/mainreport.html#easy-to-build-constraint-systems">Easy-to-build Constraint Systems</a> </li>
<li><a href="cryptography/r1cs-bulletproofs/mainreport.html#about-gadgets">About Gadgets</a> </li>
<li><a href="cryptography/r1cs-bulletproofs/mainreport.html#interstellars-concluding-remarks">Interstellar's Concluding Remarks</a> </li>
<li><a href="cryptography/r1cs-bulletproofs/mainreport.html#r1cs-factorization-example-for-bulletproofs">R1CS Factorization Example for Bulletproofs </a></li>
</ul>
</li>
<li><a href="cryptography/r1cs-bulletproofs/mainreport.html#conclusions-observations-and-recommendations">Conclusions, Observations and Recommendations</a></li>
<li><a href="cryptography/r1cs-bulletproofs/mainreport.html#references">References</a> </li>
<li><a href="cryptography/r1cs-bulletproofs/mainreport.html#appendices">Appendix</a>
<ul>
<li><a href="cryptography/r1cs-bulletproofs/mainreport.html#appendix-a-definition-of-terms">Appendix A: Definition of Terms</a> </li>
<li><a href="cryptography/r1cs-bulletproofs/mainreport.html#appendix-b-notation-used">Appendix B: Notation Used</a></li>
</ul>
</li>
<li><a href="cryptography/r1cs-bulletproofs/mainreport.html#contributors">Contributors</a> </li>
</ul>
<h2><a class="header" href="#introduction-6" id="introduction-6">Introduction</a></h2>
<p>This report explains the technical underpinnings of Rank-1 Constraint Systems (R1CSs) as applied 
to Bulletproofs. </p>
<p>The literature on the use of R1CSs in zero-knowledge (ZK) proofs, for example in zero-knowledge Succinct Non-interactive 
ARguments of Knowledge (zk‑SNARKs), shows that this mathematical tool is used simply as one part of many in 
a complex process towards achieving the proof [<a href="https://electriccoin.co/blog/snark-explain5/" title="Explaining SNARKs Part V: From Computations to Polynomials">1</a>]. Not much attention is given to it, not even in explaining 
what &quot;rank-1&quot; actually means. Although the terminology is similar to the traditional <em>rank of a matrix</em> in 
linear algebra, examples on the Internet do not yield a <em>reduced matrix with only one non-zero row or column</em>. </p>
<p>R1CSs became more prominent for Bulletproofs due to research work done by Cathie Yun and her colleagues at Interstellar. 
The constraint 
system, in particular R1CS, is used as an add-on to Bulletproof protocols. The title of 
Yun's article, &quot;Building on Bulletproofs&quot; 
[<a href="https://medium.com/@cathieyun/building-on-bulletproofs-2faa58af0ba8" title="Building on Bulletproofs">2</a>], suggests this is true. One of the Interstellar team's goals is to use the constraint system in their 
Confidential Asset Protocol called the Cloak and in their envisaged Spacesuit. 
Despite their work on using R1CS being research in progress, their detailed notes on constraint systems and their 
implementation in RUST are available in [<a href="https://doc-internal.dalek.rs/bulletproofs/notes/r1cs_proof/index.html" title="Module Bulletproofs::Notes::r1cs_proof">3</a>]. </p>
<p>The aim of this report is to: </p>
<ul>
<li>highlight the connection between arithmetic circuits and R1CSs; </li>
<li>clarify the difference R1CSs make in Bulletproofs and in range proofs; </li>
<li>compare ZK proofs for arithmetic circuits and programmable constraint systems. </li>
</ul>
<h2><a class="header" href="#arithmetic-circuits" id="arithmetic-circuits">Arithmetic Circuits</a></h2>
<h3><a class="header" href="#overview-6" id="overview-6">Overview</a></h3>
<p>Many problems in <em>Symbolic Computation</em><sup><a href="cryptography/r1cs-bulletproofs/mainreport.html#sc" title="The study and development of algorithms 
and software for manipulating ...">def</a></sup> and cryptography can be expressed as the task of computing 
some polynomials. Arithmetic circuits are the most standard model for studying the complexity of such computations. 
ZK proofs form a core building block of many cryptographic protocols. Of special interest are ZK proof systems capable 
of proving the correct computation of arbitrary arithmetic circuits ([<a href="https://pdfs.semanticscholar.org/06c8/ea507b2c4aaf7b421bd0c93e6145e3ff7517.pdf?_ga=2.124585865.240482160.1578465071-151955209.1571053591" title="Generic Zero-knowledge and MultiQuadratic Systems">6</a>], [<a href="http://www.cs.tau.ac.il/%7Eshpilka/publications/SY10.pdf" title="Arithmetic Circuits: A Survey of Recent Results and Open 
Questions">7</a>]).</p>
<h3><a class="header" href="#definition-of-arithmetic-circuit" id="definition-of-arithmetic-circuit">Definition of Arithmetic Circuit</a></h3>
<p>An arithmetic circuit $\mathcal{A}$ over the field<sup><a href="cryptography/r1cs-bulletproofs/mainreport.html#fd" title="Any set of elements together with binary operations 'addition' and 'multiplication' satisfying field axioms ... ">def</a></sup> $\mathcal{F}$ and the set of variables 
$X = \lbrace {x_1,\dots,x_n} \rbrace$ is a directed acyclic graph such that the vertices of $\mathcal{A}$ are called 
<em>gates</em>, while the edges are called <em>wires</em> [<a href="http://www.cs.tau.ac.il/%7Eshpilka/publications/SY10.pdf" title="Arithmetic Circuits: A Survey of Recent Results and Open 
Questions">7</a>]: </p>
<ul>
<li>A gate is of in-degree $l$ if it has $l$ incoming wires, and similarly, of out-degree $k$ if 
it has $k$ outgoing wires. </li>
<li>Every gate in $\mathcal{A}$ of in-degree 0 is labeled with either a variable ${x_i}$ or some field 
element from $\mathcal{F}$. Such a gate is called an input gate. Every gate of out-degree 0 is called an 
output gate or the root. </li>
<li>Every other gate in $\mathcal{A}$ is labeled with either $\otimes$ or $\oplus$, and called a 
multiplication gate or addition gate, respectively. </li>
<li>An arithmetic circuit is called a formula if it is a directed tree whose edges are directed from the leaves 
to the root. </li>
<li>The depth of a node is the number of edges in the longest directed path between the node and the root.</li>
<li>The size of $\mathcal{A}$, denoted $|\mathcal{A}|$, is the number of wires, i.e. edges, in $\mathcal{A}$. </li>
</ul>
<p>Arithmetic circuits of interest and most applicable to this report are those with gates of in-degree 2 and out-degree 1. 
A typical multiplication gate has a left input $a_L$, a right input $a_R$ and 
an output $a_O$ (shown in Figure 1). Note that $ a_L \cdot a_R - a_O = 0 $.</p>
<p align="center"><img src="cryptography/r1cs-bulletproofs/sources/basic-multiplication-gate.png" width="170" /></p>
<div align="center"><b>Figure 1: Typical Multiplication Gate</b></div> 
<p>In cases where the inputs and outputs are all vectors of size 
$n$, i.e. 
$\mathbf{a_L} = ( a_{L, 1}, a_{L, 2}, \dots, a_{L, n})$,
$\mathbf{a_R} = ( a_{R, 1}, a_{R, 2}, \dots, a_{R, n})$ 
and 
$\mathbf{a_O} = ( a_{O, 1}, a_{O, 2}, \dots, a_{O, n})$, 
then multiplication of 
$ \mathbf{a_L} $ 
and
$ \mathbf{a_R} $ 
is defined as an entry-wise 
product called the <strong>Hadamard product</strong>: </p>
<p>$$
\mathbf{a_L}\circ \mathbf{a_R} = \big(( a_{L, 1} \cdot a_{R, 1} ), ( a_{L, 2} \cdot a_{R, 2} ), \dots, ( a_{L, n} \cdot 
a_{R, n} ) \big) = \mathbf{a_O}
$$</p>
<p>The equation ${ \mathbf{a_L}\circ \mathbf{a_R} = \mathbf{a_O} }$ 
is referred to as a multiplicative constraint, 
but is also known as the Hadamard relation [<a href="http://web.stanford.edu/%7Ebuenz/pubs/bulletproofs.pdf" title="Bulletproofs: Short Proofs for Confidential Transactions and More">4</a>]. </p>
<h3><a class="header" href="#example-of-arithmetic-circuit" id="example-of-arithmetic-circuit">Example of Arithmetic Circuit</a></h3>
<p>An arithmetic circuit computes a polynomial in a natural way, as shown in this example. Consider the following 
arithmetic circuit $\mathcal{A}$ with inputs $\lbrace x_1, x_2, 1 \rbrace$ over some field $\mathcal{F}​$: </p>
<p align="center"><img src="cryptography/r1cs-bulletproofs/sources/polynomial-eg-ac.png" width="400" /></p>
<div align="center"><b>Figure 2: Arithmetic Circuit</b></div> 
<p>The output of $\mathcal{A}​$ above is the polynomial $x^2_1 \cdot x_2 + x_1 + 1 ​$ of total degree three. A typical 
computational problem would involve finding the solution to, let's say, $x^2_1 \cdot x_2 + x_1 + 1 = 22​$. Or, in a 
proof of knowledge scenario, the prover has to prove to the verifier that they have the correct solution to such an 
equation. Following the wires in the example shows that an arithmetic circuit actually breaks down the given computation 
into smaller equations corresponding to each gate: </p>
<p>$$
u = x_1 \cdot x_1 \text{,} \ \  v = u \cdot x_2 \text{,} \ \ y = x_1 + 1 \ \text {and} \ z = v + y
$$</p>
<p>The variables $u, v​$ and $ y ​$ are called auxiliary variables or low-level variables, while 
${ z }​$ is the output of $ \mathcal{A} ​$. Thus, in addition to computing polynomials naturally, an 
arithmetic circuit helps in reducing a computation to a low-level language involving only two variables, 
one operation and an output. </p>
<p>ZK proofs in general require that statements to be proved are expressed in their 
simplest terms for efficiency. A ZK proof's end-to-end journey is to create a <em>function</em> 
to write proofs about, yet such a function needs to work with specific constructs.
In making ZK proofs more efficient: &quot;these functions have to be specified as sequences of very simple terms, 
namely, additions and multiplications of only two terms in a particular field&quot; [<a href="http://coders-errand.com/constraint-systems-for-zk%E2%80%91SNARKs/" title="Constraint Systems for ZK SNARKs">8</a>]. This is where arithmetic circuits 
come in. </p>
<p>In verifying a ZK proof, the verifier needs to carry out a step-by-step check of the computations. When these 
computations are expressed in terms of arithmetic circuits, the process translates to checking
whether the output $ a_O $ of each gate is correct with respect to the given inputs 
$ a_L $ and $ a_R $. That is, testing if $ a_L \cdot a_R - a_O = 0 $ for each multiplication 
gate. </p>
<h2><a class="header" href="#rank-1-constraint-systems" id="rank-1-constraint-systems">Rank-1 Constraint Systems</a></h2>
<h3><a class="header" href="#overview-7" id="overview-7">Overview</a></h3>
<p>Although a computational problem is typically expressed in terms of a high-level programming language, a ZK proof 
requires 
it to be expressed in terms of a set of quadratic constraints, which are closely related to circuits of logical gates. </p>
<p>Other than in Bulletproof constructions, R1CS types of constraint systems have been featured in several 
constructions of zk‑SNARKs. At times they were simply referred to as quadratic constraints or quadratic equations; 
refer to 
[<a href="https://pdfs.semanticscholar.org/06c8/ea507b2c4aaf7b421bd0c93e6145e3ff7517.pdf?_ga=2.124585865.240482160.1578465071-151955209.1571053591" title="Generic Zero-knowledge and MultiQuadratic Systems">6</a>], [<a href="https://www.usenix.org/system/files/conference/usenixsecurity18/sec18-wu.pdf" title="DIZK: A Distributed Zero 
Knowledge Proof System">9</a>] and [<a href="https://eprint.iacr.org/2013/507.pdf" title="SNARKs for C: Verifying Program Executions Succinctly and in Zero Knowledge 
(extended version)">10</a>]. </p>
<h3><a class="header" href="#definition-of-constraint-system" id="definition-of-constraint-system">Definition of Constraint System</a></h3>
<p>A constraint system was originally defined by Bootle et al. in [<a href="https://eprint.iacr.org/2016/263.pdf" title="Efficient Zero-knowledge Arguments for Arithmetic Circuits in the Discrete 
Log Setting">5</a>], who first expressed arithmetic circuit 
satisfiability in terms of the Hadamard relation and linear constraints:</p>
<p>$$
\mathbf{W_L\cdot { a_L} + W_R\cdot { a_R} + W_O\cdot { a_O } = c }
$$</p>
<p>where $\mathbf{c}​$ is a vector of constant terms used in linear constraints, and $\mathbf{W_L, W_R}​$ and $\mathbf{W_O}​$ 
are weights applied to respective input vectors and output vectors. Bunz et al. [<a href="http://web.stanford.edu/%7Ebuenz/pubs/bulletproofs.pdf" title="Bulletproofs: Short Proofs for Confidential Transactions and More">4</a>] incorporated a vector $\mathbf{v}​$ and 
vector of weights $\mathbf{W_V}​$ into the Bootle et al. definition: 
$$
\mathbf{W_L\cdot { a_L} + W_R\cdot { a_R} + W_O\cdot { a_O } = W_V\cdot { v + c} }
$$</p>
<p>where $\mathbf{v} = {(v_1, v_2, \dots, v_m )}$ is a secret vector of openings ${v_i}$ of the 
<a href="cryptography/r1cs-bulletproofs/../bulletproofs-protocols/MainReport.html#pedersen-commitments-and-elliptic-curve-pedersen-commitments">Pedersen Commitments</a> 
$V_i$, $ i \in (1, 2, \cdots, m) $ and 
$\mathbf{W_V}$ is a vector of weights for all commitments $V_i$. This incorporation of the secret vector $\mathbf{v}$ 
and the corresponding vector of weights $\mathbf{W_V}​$ into the linear consistency constraints enabled them to provide a 
protocol for a more general setting [<a href="http://web.stanford.edu/%7Ebuenz/pubs/bulletproofs.pdf" title="Bulletproofs: Short Proofs for Confidential Transactions and More">4</a>, page 24]. </p>
<p>The Dalek team give a more general definition of a constraint system [<a href="https://doc-internal.dalek.rs/bulletproofs/notes/r1cs_proof/index.html" title="Module Bulletproofs::Notes::r1cs_proof">3</a>]. A <strong>constraint system</strong> is a collection of 
arithmetic constraints over a set of variables. There are two kinds of 
variables in the constraint system:</p>
<ul>
<li>${m}$ <strong>high-level</strong> variables, the input secrets ${ \mathbf{v}}$; </li>
<li>$ n$ <strong>low-level</strong> variables, the internal input vectors ${ \mathbf{a}_L}$ and 
${ \mathbf{a}_R},$ and output vectors ${ \mathbf{a}_O } $ of the multiplication gates.</li>
</ul>
<p>Specifically, an R1CS is a system that consists of two sets of constraints [<a href="https://doc-internal.dalek.rs/bulletproofs/notes/r1cs_proof/index.html" title="Module Bulletproofs::Notes::r1cs_proof">3</a>]: </p>
<ul>
<li>${ n}$ multiplicative constraints, $ \mathbf{ a_L \circ a_R = a_O } $; and</li>
<li>${ q}$ linear constraints, $\mathbf{W_L\cdot { a_L} + W_R\cdot { a_R} + W_O\cdot { a_O } = W_V\cdot { v + c} } $. </li>
</ul>
<h3><a class="header" href="#r1cs-definition-of-zksnarks" id="r1cs-definition-of-zksnarks">R1CS Definition of zk‑SNARKs</a></h3>
<p>Arithmetic circuits and R1CS are more naturally applied to zk‑SNARKs, and these are implemented in 
cryptocurrencies such as Zerocoin and Zcash; refer to [<a href="https://electriccoin.co/blog/snark-explain5/" title="Explaining SNARKs Part V: From Computations to Polynomials">1</a>]. 
To illustrate the simplicity of this concept, a definition (from [<a href="https://medium.com/@VitalikButerin/quadratic-arithmetic-programs-from-zero-to-hero-f6d558cea649" title="Quadratic 
Arithmetic Programs: from Zero to Hero">11</a>]) of an R1CS as it applies to zk‑SNARKs is 
provided in this paragraph. </p>
<p>An R1CS is a sequence of groups of three vectors ${ \bf{a_L}}, { \bf{a_R}}, { \bf{a_O}},$ and the 
solution to an R1CS is a vector ${ \bf{s}}$ that satisfies the equation:</p>
<p>$$
{ \langle {\mathbf{a_L}, \mathbf{s}} \rangle \cdot \langle {\mathbf{a_R}, \mathbf{s}} \rangle - \langle {\mathbf{a_O}, \mathbf{s}} \rangle = 0 }
$$</p>
<p>where</p>
<p>$$
\langle {\mathbf{a_L}, \mathbf{s}} \rangle = a_{L, 1} \cdot s_1 + a_{L, 2} \cdot s_2 + \cdots + a_{L, n} \cdot s_n ​
$$</p>
<p>which is the inner product of the vectors 
$ \mathbf{a_{L}} = (a_{L,1}, a_{L,2}, ..., a_{L,n} )​$
and
$ {\mathbf{s}} = (s_1, s_2, ..., s_n) ​$.</p>
<h3><a class="header" href="#example-of-rank-1-constraint-system" id="example-of-rank-1-constraint-system">Example of Rank-1 Constraint System</a></h3>
<p>One solution to the equation ${x^2_1 x_2 + x_1 + 1 = 22}$, from the preceding example of an arithmetic circuit, is 
${ x_1 = 3}$ 
and ${ { x_2 = 2 }}$ belonging to the appropriate field ${ \mathcal{F}}$. Thus the solution vector 
${ { s = ( const, x_1, x_2, z, u, v, y )}}$ becomes ${ { s = ( 1, 3, 2, 22, 9, 18, 4 )}}$. </p>
<p>It is easy to check that the R1CS for the computation problem in the preceding example is as follows (one need only test 
if ${ \langle {\mathbf{a_L}, \mathbf{s}} \rangle \cdot \langle {\mathbf{a_R}, \mathbf{s}} \rangle - \langle {\mathbf{a_O}, \mathbf{s}} \rangle = 0}​$ 
for each equation). </p>
<div align="center"><b>Table 1: Equations and Rank-1 Constraint System Vectors</b></div> 
<table><thead><tr><th>Equation</th><th>Rank-1 Constraint System Vectors</th></tr></thead><tbody>
<tr><td>${ u = x_1\cdot x_1}$</td><td>$ {\bf{a_L}} = ( 0, 1, 0, 0, 0, 0, 0 ), \ \ {\bf{a_R}} = ( 0, 1, 0, 0, 0, 0, 0  ),\ \ {\bf{a_O}} = ( 0, 0, 0, 0, 1, 0, 0  ) $</td></tr>
<tr><td>$ { v = u\cdot x_2 }$</td><td>$ {\bf{a_L}} = ( 0, 0, 0, 0, 1, 0, 0 ),\ \ {\bf{a_R}} = ( 0, 0, 1, 0, 0, 0, 0  ),\ \ {\bf{a_O}} = ( 0, 0, 0, 0, 0, 1, 0 )  $</td></tr>
<tr><td>$ { y = 1\cdot( x_1 + 1 ) } $</td><td>${\bf{a_L}} = ( 1, 1, 0, 0, 0, 0, 0 ),\ \ {\bf{a_R}} = ( 1, 0, 0, 0, 0, 0, 0 ),\ \ {\bf{a_O}} = ( 0, 0, 0, 0, 0, 0, 1 ) $</td></tr>
<tr><td>$ { z = 1\cdot( v + y )} $</td><td>${\bf{a_L}} = ( 0, 0, 0, 0, 0, 1, 1 ),\ \ {\bf{a_R}} = ( 1, 0, 0, 0, 0, 0, 0 ),\ \ {\bf{a_O}} = ( 0, 0, 0, 1, 0, 0, 0 )$</td></tr>
</tbody></table>
<p>In a more formal definition, an <strong>R1CS</strong> is a set of three matrices ${\bf{ A_L, A_R }}$ and ${\bf A_O}$, 
where the rows of each matrix are formed by the corresponding vectors $ {\bf{a_L }}$, ${ \bf{a_R }}$ and 
${ \bf{a_O}} $, respectively, as shown in Table 1: </p>
<p>$$
\bf{A_L} = \bf{\begin{bmatrix} 0&amp;1&amp;0&amp;0&amp;0&amp;0&amp;0 \\ 0&amp;0&amp;0&amp;0&amp;1&amp;0&amp;0 \\ 1&amp;1&amp;0&amp;0&amp;0&amp;0&amp;0 \\ 0&amp;0&amp;0&amp;0&amp;0&amp;1&amp;1 \end{bmatrix}} \text{,} \quad 
\bf{A_R} = \bf{\begin{bmatrix} 0&amp;1&amp;0&amp;0&amp;0&amp;0&amp;0 \\ 0&amp;0&amp;1&amp;0&amp;0&amp;0&amp;0 \\ 1&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0 \\ 1&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0 \end{bmatrix}} \text{,} \quad 
\bf{A_O} = \bf{\begin{bmatrix} 0&amp;0&amp;0&amp;0&amp;1&amp;0&amp;0 \\ 0&amp;0&amp;0&amp;0&amp;0&amp;1&amp;0 \\ 0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;1 \\ 0&amp;0&amp;0&amp;1&amp;0&amp;0&amp;0 \end{bmatrix}}
$$</p>
<p>Observe that ${ \bf{ (A_L * s^T) \cdot (A_R * s^T ) - (A_O * s^T)} = 0 }$, where &quot;$ * $&quot; is 
<em>matrix multiplication</em> and ${ \bf s^T}$ is the transpose of the solution vector ${ \bf{s}}$ [<a href="http://coders-errand.com/constraint-systems-for-zk%E2%80%91SNARKs/" title="Constraint Systems for ZK SNARKs">8</a>]. </p>
<h2><a class="header" href="#from-arithmetic-circuits-to-programmable-constraint-systems-for-bulletproofs" id="from-arithmetic-circuits-to-programmable-constraint-systems-for-bulletproofs">From Arithmetic Circuits to Programmable Constraint Systems for Bulletproofs</a></h2>
<p>Interstellar's &quot;Programmable Constraint Systems for Bulletproofs&quot; [<a href="https://medium.com/interstellar/programmable-constraint-systems-for-bulletproofs-365b9feb92f7" title="Programmable 
Constraint Systems for Bulletproofs">12</a>]
is an extension of &quot;Efficient Zero-knowledge Arguments for Arithmetic Circuits in the Discrete 
Log Setting&quot; by Bootle et al. [<a href="https://eprint.iacr.org/2016/263.pdf" title="Efficient Zero-knowledge Arguments for Arithmetic Circuits in the Discrete 
Log Setting">5</a>], enabling protocols that 
support proving of arbitrary statements in ZK using constraint systems. Although the focus here is on the 
two works of research [<a href="https://eprint.iacr.org/2016/263.pdf" title="Efficient Zero-knowledge Arguments for Arithmetic Circuits in the Discrete 
Log Setting">5</a>] and [<a href="https://medium.com/interstellar/programmable-constraint-systems-for-bulletproofs-365b9feb92f7" title="Programmable 
Constraint Systems for Bulletproofs">12</a>], the Bulletproofs paper by Bunz et al. [<a href="http://web.stanford.edu/%7Ebuenz/pubs/bulletproofs.pdf" title="Bulletproofs: Short Proofs for Confidential Transactions and More">4</a>] is here recognized as a bridge 
between the two. Table 2 compares these three research documents.</p>
<p>All these ZK proofs are based on the difficulty of the discrete logarithm problem. </p>
<div align="center"><b>Table 2: Comparison of Three Research Documents on ZK Proofs</b></div>  
<table><thead><tr><th>No.</th><th>Efficient Zero-knowledge Arguments for Arithmetic Circuits in the Discrete Log Setting [<a href="https://eprint.iacr.org/2016/263.pdf" title="Efficient Zero-knowledge Arguments for Arithmetic Circuits in the Discrete 
Log Setting">5</a>] (2016)</th><th>Bulletproofs: Short Proofs for Confidential Transactions and More [<a href="http://web.stanford.edu/%7Ebuenz/pubs/bulletproofs.pdf" title="Bulletproofs: Short Proofs for Confidential Transactions and More">4</a>] (2017)</th><th>Programmable Constraint Systems [<a href="https://medium.com/interstellar/programmable-constraint-systems-for-bulletproofs-365b9feb92f7" title="Programmable 
Constraint Systems for Bulletproofs">12</a>] (2018)</th></tr></thead><tbody>
<tr><td>1.</td><td>Introduces the Hadamard relation and linear constraints.</td><td>Turns the Hadamard relation and linear constraints into a single linear constraint, and these are in fact the R1CS.</td><td>Generalizes constraint systems and uses what is called gadgets as building blocks for constraint systems.</td></tr>
<tr><td>2.</td><td>Improves on Groth's work [<a href="https://iacr.org/archive/crypto2009/56770190/56770190.pdf" title="Linear Algebra with Sub-linear Zero-knowledge Arguments">13</a>] on ZK proofs. Reducing a $\sqrt{N}$ complexity to $6log_2(N) + 13$, where $N$ is the circuit size.</td><td>Improves on Bootle et al.'s work [<a href="https://eprint.iacr.org/2016/263.pdf" title="Efficient Zero-knowledge Arguments for Arithmetic Circuits in the Discrete 
Log Setting">5</a>]. Reducing a $6log_2(N) + 13$ complexity to $2log_2(N) + 13$, where $N$ is the circuit size.</td><td>Adds constraint systems to Bunz et al.'s work on Bulletproofs, which are short proofs. The complexity advantage is seen in proving several statements at once.</td></tr>
<tr><td>3.</td><td>Introduces logarithm-sized inner-product ZK proofs.</td><td>Introduces Bulletproofs, extending proofs to proofs of arbitrary statements. The halving method is used on the inner-products, resulting in the above reduction in complexity.</td><td>Introduces gadgets that are actually add-ons to an ordinary ZK proof. A range proof is an example of a gadget.</td></tr>
<tr><td>4.</td><td>Uses Fiat-Shamir heuristics in order to achieve non-interactive ZK proofs.</td><td>Bulletproofs also use the Fiat Shamir heuristics to achieve non-interaction.</td><td>Merlin transcripts are specifically used for a Fiat-Shamir transformation to achieve non-interaction.</td></tr>
<tr><td>5.</td><td>The Pedersen commitments are used in order to achieve ZK property.</td><td>Eliminates the need for a commitment algorithm by including Pedersen commitments among the inputs to the verification proof.</td><td>Low-level variables, representing inputs and outputs to multiplication gates, are computed per proof and committed using a single vector Pedersen commitment.</td></tr>
<tr><td>6.</td><td>The ZK proof involves conversion of the arithmetic circuit into an R1CS.</td><td>The mathematical expression of a Hadamard relation is closely related to an arithmetic circuit. The use of this relation plus linear constraints as a single constraint amounts to using a constraint system.</td><td>Although arithmetic circuits are not explicitly used here, the Hadamard relation remains the same as first seen in Bulletproofs, more so in the inner-product proof.</td></tr>
</tbody></table>
<p>Interstellar is building an Application Programming Interface (API) that allows developers to choose their own 
collection of gadgets suitable for the protocol they wish to develop, as discussed in the 
<a href="cryptography/r1cs-bulletproofs/mainreport.html#interstellars-bulletproof-constraint-system">next section</a>. </p>
<h2><a class="header" href="#interstellars-bulletproof-constraint-system" id="interstellars-bulletproof-constraint-system">Interstellar's Bulletproof Constraint System</a></h2>
<h3><a class="header" href="#overview-8" id="overview-8">Overview</a></h3>
<p>The Interstellar team paved the way for the implementation of several cryptographic primitives in the RUST language, 
including <em>Ristretto</em> [<a href="https://docs.rs/curve25519-dalek/0.15.1/curve25519_dalek/ristretto/index.html" title="Ristretto">14</a>], a construction 
of a prime-order group using a cofactor-8 curve known as Curve25519. They reported on how they implemented Bulletproofs 
in Henry de Valence's article, &quot;Bulletproofs Pre-release&quot; [<a href="https://medium.com/interstellar/bulletproofs-pre-release-fcb1feb36d4b" title="Bulletproofs pre-release">15</a>]. 
An update on their progress in extending the implementation of Bulletproofs [<a href="http://github.com/dalek-cryptography/bulletproofs/" title="Dalek's Bulletproofs Implementation">16</a>] 
to a constraint system API, which enables ZK proofs of arbitrary statements, was given in Cathie Yun's 
article, &quot;Programmable Constraint Systems for Bulletproofs&quot;
[<a href="https://medium.com/interstellar/programmable-constraint-systems-for-bulletproofs-365b9feb92f7" title="Programmable 
Constraint Systems for Bulletproofs">12</a>]. The Hadamard relation and linear constraints together 
form the constraint system as formalized by the Interstellar team. Most of the mathematical background of these 
constraints and bulletproofs is contained in Bunz et al.'s paper [<a href="http://web.stanford.edu/%7Ebuenz/pubs/bulletproofs.pdf" title="Bulletproofs: Short Proofs for Confidential Transactions and More">4</a>].</p>
<p>Dalek's constraint system, as defined earlier in <a href="cryptography/r1cs-bulletproofs/mainreport.html#definition-of-constraint-system">Definition of Constraint System</a>, is 
a collection of two types of arithmetic constraints: multiplicative constraints and linear constraints, over a set of 
high-level and low-level variables. </p>
<h3><a class="header" href="#easy-to-build-constraint-systems" id="easy-to-build-constraint-systems">Easy-to-build Constraint Systems</a></h3>
<p>In this Bulletproofs framework, a prover can build a constraint system in two steps:</p>
<ul>
<li>Firstly, committing to secret inputs and allocating high-level variables corresponding to the inputs.</li>
<li>secondly, selecting a suitable combination of multiplicative constraints and linear constraints, as well as requesting a random 
scalar in response to the high-level variables already committed [<a href="https://doc-internal.dalek.rs/bulletproofs/notes/r1cs_proof/index.html" title="Module Bulletproofs::Notes::r1cs_proof">3</a>]. </li>
</ul>
<p>Reference [<a href="https://medium.com/coinmonks/zero-knowledge-proofs-using-bulletproofs-4a8e2579fc82" title="Zero Knowledge Proofs 
using Bulletproofs">17</a>] gives an excellent outline of ZK proofs that use Bulletproofs: </p>
<ol>
<li>The prover commits to a value(s) that they want to prove knowledge of. </li>
<li>The prover generates the proof by enforcing the constraints over the committed values and any additional public 
values. The constraints might require the prover to commit to some additional variables. </li>
<li>The prover sends the verifier all the commitments made in step 1 and step 2, along with the proof from step 2. </li>
<li>The verifier now verifies the proof by enforcing the same constraints over the commitments, plus any public values.</li>
</ol>
<h3><a class="header" href="#about-gadgets" id="about-gadgets">About Gadgets</a></h3>
<p>Consider a verifiable shuffle: given two lists of committed values ${ x_1, x_2, . . ., x_n}$ and 
${ y_1, y_2, . . ., y_n},$ prove that the second list is a permutation of the first. Bunz et al. ([<a href="http://web.stanford.edu/%7Ebuenz/pubs/bulletproofs.pdf" title="Bulletproofs: Short Proofs for Confidential Transactions and More">4</a>, page 5]) 
mention that 
the use of bulletproofs improves the complexity of such a verifiable shuffle to size $\mathcal{O}(log(n))​$ compared to 
previous implementation results. Although not referred to as a <em>gadget</em> in the paper, this is in 
fact a shuffle gadget. The term <em>gadget</em> was used and popularized by the Interstellar team, who introduced gadgets 
as building blocks of constraint systems; refer to [<a href="https://medium.com/@cathieyun/building-on-bulletproofs-2faa58af0ba8" title="Building on Bulletproofs">2</a>]. </p>
<p>A <em>shuffle gadget</em> (Figure 3) is any function whose outputs are but a permutation of its inputs. By definition of a 
permutation, the 
number of inputs to a shuffle gadget is always the same as the number of outputs. </p>
<p align="center"><img src="cryptography/r1cs-bulletproofs/sources/simple-shuffle-diagram.png" width="550" /></p>
<div align="center"><b>Figure 3: Simple Shuffle Gadgets with Two Inputs 
[<a href="https://medium.com/@cathieyun/building-on-bulletproofs-2faa58af0ba8" title="Building on Bulletproofs">2</a>]
</b></div>
<p>The Interstellar team mentions other gadgets: “merge”, “split” and a “range proof” that are implemented in their 
Confidential Assets scheme called the Cloak. 
Just as a shuffle gadget creates constraints that prove that 
two sets of variables are equal up to a permutation, a range-proof gadget checks that a given value is in the interval
$ [ 0, 2^n ] $ 
where 
$ n $ 
is the size of the input vector
[<a href="https://doc-internal.dalek.rs/bulletproofs/notes/r1cs_proof/index.html" title="Module Bulletproofs::Notes::r1cs_proof">3</a>]. </p>
<p>Gadgets in their simplest form merely receive some variables as inputs and produce corresponding output values. However, 
they 
may allocate more variables, sometimes called auxiliary variables, for internal use, and produce constraints involving 
all these variables. The main advantage of gadgets is that they are composable, thus a more complex 
gadget can always be created from a number of single gadgets. Interstellar's Bulletproofs API allows developers to choose their own collection of gadgets suitable for the protocol they wish to develop. </p>
<h3><a class="header" href="#interstellars-concluding-remarks" id="interstellars-concluding-remarks">Interstellar's Concluding Remarks</a></h3>
<p>Cathie Yun reports in [<a href="https://medium.com/interstellar/programmable-constraint-systems-for-bulletproofs-365b9feb92f7" title="Programmable 
Constraint Systems for Bulletproofs">12</a>] that their &quot;work on Cloak and Spacesuit is far from complete&quot; and mentions that they 
still have two goals to achieve: </p>
<ul>
<li>Firstly, in order to &quot;ensure that challenge-based variables cannot be inspected&quot; and prevent the user from 
accidentally breaking soundness of their gadgets, the Bulletproofs protocol needs to be slightly extended, enabling it 
to commit &quot;to a portion of low-level variables using a single vector Pedersen commitment without an overhead of 
additional individual high-level Pedersen commitments&quot; [<a href="https://medium.com/interstellar/programmable-constraint-systems-for-bulletproofs-365b9feb92f7" title="Programmable 
Constraint Systems for Bulletproofs">12</a>]. </li>
<li>Secondly, to &quot;improve privacy in Cloak&quot; by enabling &quot;multi-party proving of a single constraint system&quot;. That is, 
&quot;building a joint proof of a single constraint system by multiple parties, without sharing their secret inputs with 
each other&quot;.</li>
</ul>
<p>All-in-all, Yun regards constraint systems as &quot;very powerful because they can represent any efficiently 
verifiable program&quot; [<a href="https://medium.com/@cathieyun/building-on-bulletproofs-2faa58af0ba8" title="Building on Bulletproofs">2</a>]. </p>
<h3><a class="header" href="#r1cs-factorization-example-for-bulletproofs" id="r1cs-factorization-example-for-bulletproofs">R1CS Factorization Example for Bulletproofs</a></h3>
<p>In [<a href="https://medium.com/coinmonks/zero-knowledge-proofs-using-bulletproofs-4a8e2579fc82" title="Zero Knowledge Proofs 
using Bulletproofs">17</a>], Harchandani explores the Dalek Bulletproofs API, using various examples. Of interest
is the factorization problem, which is one out of the six R1CS Bulletproof examples 
discussed in the article. 
The computational challenge is to &quot;<em>prove knowledge of factors</em> p 
<em>and</em> q <em>of a given number</em> r <em>without revealing the factors</em>&quot;. </p>
<p>Table 3 gives an outline of the description and the code lines of the example. Harchandani's complete 
code of this example can be found in [<a href="https://github.com/lovesh/bulletproofs/blob/e477511a20bdb8de8f4fa82cb789ba71cc66afd8/tests/basic_r1cs.rs#L17" title="Factors R1CS Bulletproofs Example">18</a>]. Important to note is that the verifier must have an exact copy of the R1CS 
circuit used by the prover.</p>
<div align="center"><b>Table 3: Example of Bulletproof Constraint</b></div>  
<table><thead><tr><th>No.</th><th align="left">Description</th><th>Code Lines</th></tr></thead><tbody>
<tr><td>1.</td><td align="left">Create two pairs of generators; one pair for the <br/>Pedersen commitments and the other for the <br/>Bulletproof.</td><td><code>let pc_gens = PedersenGens::default();</code><br/><code>let bp_gens = BulletproofGens::new(128, 1);</code></td></tr>
<tr><td>2.</td><td align="left">Instantiate the prover using the commitment <br/>and Bulletproofs generators of Step 1, to <br/>produce the prover's transcript.</td><td><code>let mut prover_transcript = Transcript::new(b&quot;Factors&quot;);</code><br/><code>let mut prover = Prover::new(&amp;bp_gens, &amp;pc_gens, &amp;mut prover_transcript);</code></td></tr>
<tr><td>3.</td><td align="left">Prover commits to variables using the Pedersen <br/>commitments, creates variables corresponding to <br/>each commitment and adds the variables to the <br/>transcript.</td><td><code>let x1 = Scalar::random(&amp;mut rng);</code><br/><code>let (com_p, var_p) = prover.commit(p.into(), x1);</code><br/><code>let x2 = Scalar::random(&amp;mut rng);</code><br/><code>let (com_q, var_q) = prover.commit(q.into(), x2);</code></td></tr>
<tr><td>4.</td><td align="left">Prover constrains the variables in two steps: <br/>a. Prover multiplies the variables of step 3 and captures <br/>the product in the &quot;output&quot; variable O. <br/>b. Prover wants to ensure the difference of the product O and r is zero.</td><td><code>let (_, _, o) = prover.multiply(var_p.into(), var_q.into());</code><br/><code>let r_lc: LinearCombination = vec![(Variable::One(), r.into())].iter().collect();</code><br/><code>prover.constrain(o - r_lc);</code></td></tr>
<tr><td>5.</td><td align="left">Prover creates the proof.</td><td><code>let proof = prover.prove().unwrap();</code></td></tr>
<tr><td>6.</td><td align="left">Instantiation of the verifier using the Pedersen <br/>commitments and Bulletproof generators. The <br/>verifier creates its own transcript.</td><td><code>let mut verifier_transcript = Transcript::new(b&quot;Factors&quot;);</code><br/><code>let mut verifier = Verifier::new(&amp;bp_gens, &amp;pc_gens, &amp;mut verifier_transcript);</code></td></tr>
<tr><td>7.</td><td align="left">Verifier records commitments for p and q sent by <br/>prover in the transcript, and creates variables for <br/>them similar to the prover's.</td><td><code>let var_p = verifier.commit(commitments.0);</code><br/><code>let var_q = verifier.commit(commitments.1);</code></td></tr>
<tr><td>8.</td><td align="left">Verifier constrains variables corresponding to <br/>the commitments.</td><td><code>let (_, _, o) = verifier.multiply(var_p.into(), var_q.into());</code><br/><code>let r_lc: LinearCombination = vec![(Variable::One(), r.into())].iter().collect();</code><br/><code>verifier.constrain(o - r_lc);</code></td></tr>
<tr><td>9.</td><td align="left">Verifier verifies the proof.</td><td><code>verifier.verify(&amp;proof)</code></td></tr>
</tbody></table>
<h2><a class="header" href="#conclusions-observations-and-recommendations-4" id="conclusions-observations-and-recommendations-4">Conclusions, Observations and Recommendations</a></h2>
<p>Constraint systems form a natural language for most computational problems expressed as arithmetic circuits, and have 
found ample application in both zk‑SNARKs and Bulletproofs. The use of ZK proofs for arithmetic circuits and 
programmable constraint systems has evolved considerably as illustrated in Table 2. Although much work still needs 
to be done, Bulletproofs with constraint systems built on them promise to be powerful tools for efficient handling of 
verifiable programs. The leverage that developers have, in choosing whatever gadgets they wish to implement, leaves 
enough room to build proof systems that have some degree of modularity. Proof system examples by both Dalek and 
Harchandani are valuable examples of what can be achieved with Bulletproofs and R1CSs. This framework provides great 
opportunities in building blockchain-enabled confidential digital asset schemes. </p>
<h2><a class="header" href="#references-8" id="references-8">References</a></h2>
<p>[<a href="https://electriccoin.co/blog/snark-explain5/" title="Explaining SNARKs Part V: From Computations to Polynomials">1</a>] A. Gabizon, &quot;Explaining SNARKs Part V: From Computations to Polynomials&quot; [online]. Available:
<a href="https://electriccoin.co/blog/snark-explain5/">https://electriccoin.co/blog/snark-explain5/</a>. Date accessed: 2020‑01‑03.</p>
<p>[<a href="https://medium.com/@cathieyun/building-on-bulletproofs-2faa58af0ba8" title="Building on Bulletproofs">2</a>] C. Yun, &quot;Building on Bulletproofs&quot; [online]. 
Available: <a href="https://medium.com/@cathieyun/building-on-bulletproofs-2faa58af0ba8">https://medium.com/@cathieyun/building-on-bulletproofs-2faa58af0ba8</a>. 
Date accessed: 2020‑01‑03.</p>
<p>[<a href="https://doc-internal.dalek.rs/bulletproofs/notes/r1cs_proof/index.html" title="Module Bulletproofs::Notes::r1cs_proof">3</a>] Dalek's R1CS documents, &quot;Module Bulletproofs::r1cs_proof&quot; [online]. Available: <a href="https://doc-internal.dalek.rs/bulletproofs/notes/r1cs_proof/index.html">https://doc-internal.dalek.rs/bulletproofs/notes/r1cs_proof/index.html</a>. Date accessed: 2020‑01‑07. </p>
<p>[<a href="http://web.stanford.edu/%7Ebuenz/pubs/bulletproofs.pdf" title="Bulletproofs: Short Proofs for Confidential Transactions and More">4</a>] B. Bünz, J. Bootle, D. Boneh, A. Poelstra, P. Wuille and G. Maxwell, &quot;Bulletproofs: Short Proofs for Confidential 
Transactions and More&quot; [online], Blockchain Protocol Analysis and Security Engineering 2018 . 
Available: <a href="http://web.stanford.edu/%7Ebuenz/pubs/bulletproofs.pdf">http://web.stanford.edu/~buenz/pubs/bulletproofs.pdf</a>. Date accessed: 2019‑11‑21.</p>
<p>[<a href="https://eprint.iacr.org/2016/263.pdf" title="Efficient Zero-knowledge Arguments for Arithmetic Circuits in the Discrete 
Log Setting">5</a>] J. Bootle, A. Cerulli, P. Chaidos, J. Groth and C. Petit, &quot;Efficient Zero-knowledge Arguments for Arithmetic 
Circuits in the Discrete Log Setting&quot; [online], Annual International Conference on the Theory and Applications of Cryptographic 
Techniques, pp. 327‑357. Springer, 2016 . Available: <a href="https://eprint.iacr.org/2016/263.pdf">https://eprint.iacr.org/2016/263.pdf</a> Date accessed: 2019‑12‑21.</p>
<p>[<a href="https://pdfs.semanticscholar.org/06c8/ea507b2c4aaf7b421bd0c93e6145e3ff7517.pdf?_ga=2.124585865.240482160.1578465071-151955209.1571053591" title="Generic Zero-knowledge and MultiQuadratic Systems">6</a>] A. Szepieniec and B. Preneel, &quot;Generic Zero-knowledge and Multivariate Quadratic Systems&quot; [online]. Available: 
<a href="https://pdfs.semanticscholar.org/06c8/ea507b2c4aaf7b421bd0c93e6145e3ff7517.pdf?_ga=2.124585865.240482160.1578465071-151955209.1571053591">https://pdfs.semanticscholar.org/06c8/ea507b2c4aaf7b421bd0c93e6145e3ff7517.pdf?_ga=2.124585865.240482160.1578465071-151955209.1571053591</a>. 
Date accessed: 2019‑12‑31.</p>
<p>[<a href="http://www.cs.tau.ac.il/%7Eshpilka/publications/SY10.pdf" title="Arithmetic Circuits: A Survey of Recent Results and Open 
Questions">7</a>] A. Shpilka and A. Yehudayoff, &quot;Arithmetic Circuits: A Survey of Recent Results and Open Questions&quot; [online], 
Technion-Israel Institute of Technology, Haifa, Israel, 2010 . Available: <a href="http://www.cs.tau.ac.il/%7Eshpilka/publications/SY10.pdf">http://www.cs.tau.ac.il/~shpilka/publications/SY10.pdf</a>. 
Date accessed: 2019‑12‑21. </p>
<p>[<a href="http://coders-errand.com/constraint-systems-for-zk%E2%80%91SNARKs/" title="Constraint Systems for ZK SNARKs">8</a>] A. Pinto, &quot;Constraint Systems for ZK SNARKs&quot; [online]. Available: 
<a href="http://coders-errand.com/constraint-systems-for-zk&amp;#8209;SNARKs/">http://coders-errand.com/constraint-systems-for-zk&amp;#8209;SNARKs/</a>. Date accessed: 2019‑12‑23.</p>
<p>[<a href="https://www.usenix.org/system/files/conference/usenixsecurity18/sec18-wu.pdf" title="DIZK: A Distributed Zero 
Knowledge Proof System">9</a>] H. Wu, W. Zheng, A. Chiesa, R. Ada Popa, and I. Stoica, &quot;DIZK: A Distributed Zero Knowledge 
Proof System&quot; [online], Proceedings of the 27th USENIX Security Symposium, August 15–17, 2018. Available: 
<a href="https://www.usenix.org/system/files/conference/usenixsecurity18/sec18-wu.pdf">https://www.usenix.org/system/files/conference/usenixsecurity18/sec18-wu.pdf</a>. Date accessed: 2019‑12‑14. </p>
<p>[<a href="https://eprint.iacr.org/2013/507.pdf" title="SNARKs for C: Verifying Program Executions Succinctly and in Zero Knowledge 
(extended version)">10</a>] E. Ben-Sasson, A. Chiesa, D. Genkin, E. Tromer and M. Virza, &quot;SNARKs for C: Verifying Program 
Executions Succinctly and in Zero Knowledge (extended version)&quot; [online], October 2013. Available: 
<a href="https://eprint.iacr.org/2013/507.pdf">https://eprint.iacr.org/2013/507.pdf</a>. Date accessed: 2019‑12‑17. </p>
<p>[<a href="https://medium.com/@VitalikButerin/quadratic-arithmetic-programs-from-zero-to-hero-f6d558cea649" title="Quadratic 
Arithmetic Programs: from Zero to Hero">11</a>] V. Buterin, &quot;Quadratic Arithmetic Programs: from Zero to Hero&quot; [online], 12 December 2016. Available: 
<a href="https://medium.com/@VitalikButerin/quadratic-arithmetic-programs-from-zero-to-hero-f6d558cea649">https://medium.com/@VitalikButerin/quadratic-arithmetic-programs-from-zero-to-hero-f6d558cea649</a>. 
Date accessed: 2019‑12‑19.</p>
<p>[<a href="https://medium.com/interstellar/programmable-constraint-systems-for-bulletproofs-365b9feb92f7" title="Programmable 
Constraint Systems for Bulletproofs">12</a>] C. Yun, &quot;Programmable Constraint Systems for Bulletproofs&quot; [online]. Available: 
<a href="https://medium.com/interstellar/programmable-constraint-systems-for-bulletproofs-365b9feb92f7">https://medium.com/interstellar/programmable-constraint-systems-for-bulletproofs-365b9feb92f7</a>. 
Date accessed: 2019‑12‑04.</p>
<p>[<a href="https://iacr.org/archive/crypto2009/56770190/56770190.pdf" title="Linear Algebra with Sub-linear Zero-knowledge Arguments">13</a>] J. Groth, &quot;Linear Algebra with Sub-linear Zero-knowledge Arguments&quot; [online], Advances in Cryptology – CRYPTO 2009, 
pages 192–208, 2009. Available: <a href="https://iacr.org/archive/crypto2009/56770190/56770190.pdf">https://iacr.org/archive/crypto2009/56770190/56770190.pdf</a>. 
Date accessed: 2019‑12‑04.</p>
<p>[<a href="https://docs.rs/curve25519-dalek/0.15.1/curve25519_dalek/ristretto/index.html" title="Ristretto">14</a>] Dalek, &quot;Ristretto&quot; [online]. Available: <a href="https://docs.rs/curve25519-dalek/0.15.1/curve25519_dalek/ristretto/index.html">https://docs.rs/curve25519-dalek/0.15.1/curve25519_dalek/ristretto/index.html</a> 
Date accessed: 2019‑10‑17</p>
<p>[<a href="https://medium.com/interstellar/bulletproofs-pre-release-fcb1feb36d4b" title="Bulletproofs pre-release">15</a>] H. Valence, &quot;Bulletproofs Pre-release&quot; [online]. Available: <a href="https://medium.com/interstellar/bulletproofs-pre-release-fcb1feb36d4b">https://medium.com/interstellar/bulletproofs-pre-release-fcb1feb36d4b</a> 
Date accessed: 2019‑11‑21.</p>
<p>[<a href="http://github.com/dalek-cryptography/bulletproofs/" title="Dalek's Bulletproofs Implementation">16</a>] Dalek, &quot;Bulletproofs Implementation&quot; [online]. Available:
<a href="http://github.com/dalek-cryptography/bulletproofs/">http://github.com/dalek-cryptography/bulletproofs/</a> Date accessed: 2019‑10‑02.</p>
<p>[<a href="https://medium.com/coinmonks/zero-knowledge-proofs-using-bulletproofs-4a8e2579fc82" title="Zero Knowledge Proofs 
using Bulletproofs">17</a>] L. Harchandani, &quot;Zero Knowledge Proofs using Bulletproofs&quot; [online]. Available: 
<a href="https://medium.com/coinmonks/zero-knowledge-proofs-using-bulletproofs-4a8e2579fc82">https://medium.com/coinmonks/zero-knowledge-proofs-using-bulletproofs-4a8e2579fc82</a>. 
Date accessed: 2020‑01‑03.</p>
<p>[<a href="https://github.com/lovesh/bulletproofs/blob/e477511a20bdb8de8f4fa82cb789ba71cc66afd8/tests/basic_r1cs.rs#L17" title="Factors R1CS Bulletproofs Example">18</a>] L. Harchandani, &quot;Factors R1CS Bulletproofs Example&quot; [online]. 
Available: <a href="https://github.com/lovesh/bulletproofs/blob/e477511a20bdb8de8f4fa82cb789ba71cc66afd8/tests/basic_r1cs.rs#L17">https://github.com/lovesh/bulletproofs/blob/e477511a20bdb8de8f4fa82cb789ba71cc66afd8/tests/basic_r1cs.rs#L17</a>. 
Date accessed: 2019‑10‑02. </p>
<p>[<a href="https://en.wikipedia.org/wiki/Computer_algebra" title="Computer Algebra - Wikipedia">19</a>] &quot;Computer Algebra&quot; [online]. Available: <a href="https://en.wikipedia.org/wiki/Computer_algebra">https://en.wikipedia.org/wiki/Computer_algebra</a>. 
Date accessed: 2020‑02‑05. </p>
<p>[<a href="https://en.wikipedia.org/wiki/Binary_operation" title="Field Theory - WolframMathWorld">20</a>] Wikipedia: &quot;Binary Operation&quot; [online]. Available: &lt;https://en.wikipedia.org/wiki/Binary_operation &gt;. 
Date accessed: 2020‑02‑06. </p>
<p>[<a href="http://mathworld.wolfram.com/FieldAxioms.html" title="Field Theory - WolframMathWorld">21</a>] WolframMathWorld, &quot;Field Theory&quot; [online]. Available: <a href="http://mathworld.wolfram.com/FieldAxioms.html">http://mathworld.wolfram.com/FieldAxioms.html</a>. 
Date accessed: 2020‑02‑06. </p>
<p>[<a href="https://en.wikipedia.org/wiki/Finite_field" title="Field Theory - Wikipedia">22</a>] Wikipedia: &quot;Finite Theory&quot; [online]. Available: <a href="https://en.wikipedia.org/wiki/Finite_field">https://en.wikipedia.org/wiki/Finite_field</a>. 
Date accessed: 2020‑02‑06. </p>
<h2><a class="header" href="#appendices-2" id="appendices-2">Appendices</a></h2>
<h3><a class="header" href="#appendix-a-definition-of-terms-2" id="appendix-a-definition-of-terms-2">Appendix A: Definition of Terms</a></h3>
<p>Definitions of terms presented here are high level and general in nature. Full mathematical definitions are available in 
the cited references. </p>
<ul>
<li><strong>Symbolic Computation:</strong><a name="sc"> </a>The study and development of algorithms and software for manipulating 
mathematical expressions and other mathematical objects [<a href="https://en.wikipedia.org/wiki/Computer_algebra" title="Computer Algebra - Wikipedia">19</a>]. </li>
</ul>
<ul>
<li>
<p><strong>Binary Operation:</strong> An operation $ * $ or a calculation that combines two elements $ \mathcal{a} $ and 
$ \mathcal{b}$, called operands, to produce another element $ \mathcal{a} * \mathcal{b} $ [<a href="https://en.wikipedia.org/wiki/Binary_operation" title="Field Theory - WolframMathWorld">20</a>].</p>
</li>
<li>
<p><strong>Field:</strong> <a name="fd"> </a>Any set $ \mathcal{F} $ of elements together with <em>Binary Operations</em> $ + $ and 
$ \cdot $, called addition and multiplication, respectively, is a <strong>field</strong> if for any three elements 
$ \mathcal{a}, \mathcal{b} $ and $ \mathcal{c} $ in $ \mathcal{F} $ satisfy the field axioms given in the following table. 
A <strong>Finite field</strong> is any field $ \mathcal{F} $ that contains a finite number of elements ([<a href="http://mathworld.wolfram.com/FieldAxioms.html" title="Field Theory - WolframMathWorld">21</a>], [<a href="https://en.wikipedia.org/wiki/Finite_field" title="Field Theory - Wikipedia">22</a>]).</p>
</li>
</ul>
<div align="center"><b>Table A.1: Axioms of a Field </b></div> 
<table><thead><tr><th>Name</th><th>Addition</th><th>Multiplication</th></tr></thead><tbody>
<tr><td>associativity</td><td><img src="http://mathworld.wolfram.com/images/equations/FieldAxioms/Inline1.gif" alt="(a+b)+c=a+(b+c)" /></td><td><img src="http://mathworld.wolfram.com/images/equations/FieldAxioms/Inline2.gif" alt="(ab)c=a(bc)" /></td></tr>
<tr><td>commutativity</td><td><img src="http://mathworld.wolfram.com/images/equations/FieldAxioms/Inline3.gif" alt="a+b=b+a" /></td><td><img src="http://mathworld.wolfram.com/images/equations/FieldAxioms/Inline4.gif" alt="ab=ba" /></td></tr>
<tr><td>distributivity</td><td><img src="http://mathworld.wolfram.com/images/equations/FieldAxioms/Inline5.gif" alt="a(b+c)=ab+ac" /></td><td><img src="http://mathworld.wolfram.com/images/equations/FieldAxioms/Inline6.gif" alt="(a+b)c=ac+bc" /></td></tr>
<tr><td>identity</td><td><img src="http://mathworld.wolfram.com/images/equations/FieldAxioms/Inline7.gif" alt="a+0=a=0+a" /></td><td><img src="http://mathworld.wolfram.com/images/equations/FieldAxioms/Inline8.gif" alt="a·1=a=1·a" /></td></tr>
<tr><td>inverses</td><td><img src="http://mathworld.wolfram.com/images/equations/FieldAxioms/Inline9.gif" alt="a+(-a)=0=(-a)+a" /></td><td><img src="http://mathworld.wolfram.com/images/equations/FieldAxioms/Inline10.gif" alt="aa^(-1)=1=a^(-1)a if a!=0" /></td></tr>
</tbody></table>
<h3><a class="header" href="#appendix-b-notation-used-1" id="appendix-b-notation-used-1">Appendix B: Notation Used</a></h3>
<ul>
<li>
<p>Let $ \mathcal{F} $ be a field. </p>
</li>
<li>
<p>Let $ \mathbf{a} = (a_1, a_2, ..., a_n ) $ be a vector with $n$ components $ a_1, a_2, ..., a_n $, which 
are elements of some field $ \mathcal{F} ​$.</p>
</li>
<li>
<p>Let $\mathbf{s}^T​$ be the transpose of a vector $ \mathbf{s} = ( s_1, s_2, \dots, s_n )​$ of size $ n ​$ such that 
$ \mathbf{s}^T = \begin{bmatrix} s_1 \\ s_2 \\ \cdot \\ \cdot \\ \cdot \\ s_n \end{bmatrix} ​$ </p>
</li>
</ul>
<h2><a class="header" href="#contributors-6" id="contributors-6">Contributors</a></h2>
<ul>
<li><a href="https://github.com/Empiech007">https://github.com/Empiech007</a></li>
<li><a href="https://github.com/hansieodendaal">https://github.com/hansieodendaal</a> </li>
<li><a href="https://github.com/anselld">https://github.com/anselld</a> </li>
</ul>
<h1><a class="header" href="#consensus-mechanisms" id="consensus-mechanisms">Consensus Mechanisms</a></h1>
<h2><a class="header" href="#purpose-1" id="purpose-1">Purpose</a></h2>
<p>Consensus mechanisms &quot;are crucial for a blockchain in order to function correctly. They make sure everyone uses the same 
blockchain&quot; [<a href="https://hackernoon.com/different-blockchain-consensus-mechanisms-d19ea6c3bcd6" title="Different Blockchain Consensus Mechanisms">1</a>].</p>
<h2><a class="header" href="#definitions-1" id="definitions-1">Definitions</a></h2>
<ul>
<li>
<p>From <strong>Investopedia</strong>: A 
consensus mechanism is a fault-tolerant mechanism that is used in computer and blockchain systems to achieve the 
necessary agreement on a single data value or a single state of the network among distributed processes or multi-agent 
systems [<a href="https://www.investopedia.com/terms/c/consensus-mechanism-cryptocurrency.asp" title="Consensus Mechanism (Cryptocurrency)">2</a>].</p>
</li>
<li>
<p>From <strong>KPMG</strong>: 
Consensus mechanism - A method of authenticating and validating a value or transaction on a Blockchain or a distributed 
ledger without the need to trust or rely on a central authority. Consensus mechanisms are central to the functioning of 
any blockchain or distributed ledger [<a href="https://assets.kpmg/content/dam/kpmg/pdf/2016/06/kpmg-blockchain-consensus-mechanism.pdf" title="Consensus - Immutable Agreement for the Internet of Value">3</a>].</p>
</li>
</ul>
<h2><a class="header" href="#references-9" id="references-9">References</a></h2>
<p>[<a href="https://hackernoon.com/different-blockchain-consensus-mechanisms-d19ea6c3bcd6" title="Different Blockchain Consensus Mechanisms">1</a>] &quot;Different Blockchain Consensus Mechanisms&quot;, <em>Hacker Noon</em> [online]. 
Available: <a href="https://hackernoon.com/different-blockchain-consensus-mechanisms-d19ea6c3bcd6">https://hackernoon.com/different-blockchain-consensus-mechanisms-d19ea6c3bcd6</a>. Date accessed: 2019‑06‑07.</p>
<p>[<a href="https://www.investopedia.com/terms/c/consensus-mechanism-cryptocurrency.asp" title="Consensus Mechanism (Cryptocurrency)">2</a>] Investopedia: &quot;Consensus Mechanism (Cryptocurrency)&quot; [online]. 
Available: <a href="https://www.investopedia.com/terms/c/consensus-mechanism-cryptocurrency.asp">https://www.investopedia.com/terms/c/consensus-mechanism-cryptocurrency.asp</a>. Date accessed: 2019‑06‑07.</p>
<p>[<a href="https://assets.kpmg/content/dam/kpmg/pdf/2016/06/kpmg-blockchain-consensus-mechanism.pdf" title="Consensus - Immutable Agreement for the Internet of Value">3</a>] KPMG: &quot;Consensus - Immutable Agreement for the Internet of Value&quot; [online]. 
Available: <a href="https://assets.kpmg/content/dam/kpmg/pdf/2016/06/kpmg-blockchain-consensus-mechanism.pdf">https://assets.kpmg/content/dam/kpmg/pdf/2016/06/kpmg-blockchain-consensus-mechanism.pdf</a>. 
Date accessed: 2019‑06‑07.</p>
<h1><a class="header" href="#understanding-byzantine-fault-tolerant-consensus" id="understanding-byzantine-fault-tolerant-consensus">Understanding Byzantine Fault-tolerant Consensus</a></h1>
<ul>
<li><a href="consensus-mechanisms/BFT/understanding_bft_consensus.html#background">Background</a></li>
<li><a href="consensus-mechanisms/BFT/understanding_bft_consensus.html#randomized-gossip-methods">Randomized Gossip Methods</a>
<ul>
<li><a href="consensus-mechanisms/BFT/understanding_bft_consensus.html#summary">Summary</a></li>
<li><a href="consensus-mechanisms/BFT/understanding_bft_consensus.html#video">Video</a></li>
<li><a href="consensus-mechanisms/BFT/understanding_bft_consensus.html#slides">Slides</a></li>
</ul>
</li>
<li><a href="consensus-mechanisms/BFT/understanding_bft_consensus.html#byzantine-fault-tolerance-blockchain-and-beyond">Byzantine Fault Tolerance, Blockchain and Beyond</a>
<ul>
<li><a href="consensus-mechanisms/BFT/understanding_bft_consensus.html#summary-1">Summary</a></li>
<li><a href="consensus-mechanisms/BFT/understanding_bft_consensus.html#video-1">Video</a></li>
</ul>
</li>
</ul>
<h2><a class="header" href="#background-5" id="background-5">Background</a></h2>
<p>When considering the concept of consensus in cryptocurrency and cryptographic protocols, the Byzantine Generals Problem 
is often referenced, where a protocol is described as being Byzantine Fault Tolerant (BFT). This stems from an analogy, 
as a means to understand the problem of distributed consensus.</p>
<p><strong>To classify Byzantine failure:</strong>
If a node in a system is exhibiting Byzantine failure, it is called a traitor node. The traitor (which is a flaky or 
malicious node) sends conflicting messages, leading to an incorrect result of the calculation that the distributed 
system is trying to perform.</p>
<h2><a class="header" href="#randomized-gossip-methods" id="randomized-gossip-methods">Randomized Gossip Methods</a></h2>
<div>
  <p style="float: left;">
    <img src="consensus-mechanisms/BFT/sources/dahlia_malkhi.png" width="90" />
  </p>
  <p>
    <br>
    &nbsp;&nbsp;&nbsp;&nbsp;<strong>Dr. Dahlia Malkhi</strong><br>
    &nbsp;&nbsp;&nbsp;&nbsp;Ph.D. Computer Science
    <br>
    <br>
  </p>
</div>
<h3><a class="header" href="#summary-7" id="summary-7">Summary</a></h3>
<p><em>&quot;Randomized Gossip Methods&quot;</em> by Dahlia Malkhi, PWL Conference, September 2016.</p>
<p>As an introduction, gossip-based protocols are simple, robust, efficient and fault tolerant. This talk provides insight 
into gossip protocols and how they function, as well as the reasoning behind the instances in which they do not function. It 
touches on three protocols from randomized gossip methods: Rumor Mongering, which spreads gossip in each communication; 
Name Dropper, which pushes new neighbors in each communication; and Scalable Weakly-consistent Infection-style Process 
Group Membership (SWIM), which pulls a heartbeat in each communication.</p>
<h3><a class="header" href="#video-3" id="video-3">Video</a></h3>
<p><strong>Note:</strong> Transcripts are available <a href="https://github.com/papers-we-love/pwlconf-info/blob/master/2016/dahlia-malkhi/dahlia_pwlconf_captions.srt">here</a>.</p>
<iframe width="750" height="600" src="https://www.youtube.com/embed/Gxf5glthqrk" frameborder="0" 
allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<h3><a class="header" href="#slides-1" id="slides-1">Slides</a></h3>
<p><embed src="https://speakerd.s3.amazonaws.com/presentations/c1c33de400a44e90911569ce999bde95/PWL-Sep-2016hotel.pdf" 
type="application/pdf" width="750" height="600" /></p>
<br>
<h2><a class="header" href="#byzantine-fault-tolerance-blockchain-and-beyond" id="byzantine-fault-tolerance-blockchain-and-beyond">Byzantine Fault Tolerance, Blockchain and Beyond</a></h2>
<div>
  <p style="float: left;">
    <img src="consensus-mechanisms/BFT/sources/ittai_abraham.png" width="90" />
  </p>
  <p>
    <br>
    &nbsp;&nbsp;&nbsp;&nbsp;<strong>Dr. Ittai Abraham</strong><br>
    &nbsp;&nbsp;&nbsp;&nbsp;Ph.D. Computer Science
    <br>
    <br>
  </p>
</div>
<h3><a class="header" href="#summary-8" id="summary-8">Summary</a></h3>
<p><em>&quot;BFT, Blockchain and Beyond&quot;</em> by Ittai Abraham, Israel Institute for Advanced Studies, 2018. </p>
<p>This talk provides an overview of blockchain and decentralized trust, with the focus on Byzantine Fault Tolerance (BFT). 
Traditional BFT protocols are assessed and compared with the modern Nakamoto Consensus. </p>
<p>The presentation looks at a hybrid solution of combining traditional and modern consensus mechanisms. The talk delves 
into the types of consensus; asynchrony, synchrony and partial synchrony, and provides a brief history of all three, as well as 
their recent implementation and responsiveness.</p>
<p>In addition, the fundamental trade-off of decentralized trust is assessed, and performance, 
decentralization and privacy are compared. </p>
<h3><a class="header" href="#video-4" id="video-4">Video</a></h3>
<p><strong>Part 1</strong></p>
<iframe width="750" height="600" src="https://www.youtube.com/embed/N_3r-NkBUTk" frameborder="0" allow="accelerometer; 
autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p><strong>Part 2</strong></p>
<iframe width="750" height="600" src="https://www.youtube.com/embed/c72itS8BfC0" frameborder="0" allow="accelerometer; 
autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<h1><a class="header" href="#bft-consensus-mechanisms" id="bft-consensus-mechanisms">BFT Consensus Mechanisms</a></h1>
<iframe width=750 height=600 src="https://gitpitch.com/tari-labs/tari-university/master?p=/src/consensus-mechanisms/BFT-consensusmechanisms#/"></iframe>
<h3><a class="header" href="#having-trouble-viewing-this-presentation-1" id="having-trouble-viewing-this-presentation-1">Having trouble viewing this presentation?</a></h3>
<p>View it in a <a href="https://gitpitch.com/tari-labs/tari-university/master?p=/src/consensus-mechanisms/BFT-consensusmechanisms#/">separate window</a>.</p>
<h1><a class="header" href="#introduction-to-applications-of-byzantine-consensus-mechanisms" id="introduction-to-applications-of-byzantine-consensus-mechanisms">Introduction to Applications of Byzantine Consensus Mechanisms</a></h1>
<ul>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#introduction">Introduction</a></li>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#brief-survey-of-byzantine-fault-tolerant-consensus-mechanisms">Brief Survey of Byzantine Fault-tolerant Consensus Mechanisms</a></li>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#permissioned-byzantine-fault-tolerant-protocols">Permissioned Byzantine Fault-tolerant Protocols</a>
<ul>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#background">Background</a></li>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#protocols">Protocols</a>
<ul>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#hyperledger-fabric">Hyperledger Fabric</a></li>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#tendermint">Tendermint</a>
<ul>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#overview">Overview</a></li>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#sentry-nodes">Sentry Nodes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#permissionless-byzantine-fault-tolerant-protocols">Permissionless Byzantine Fault-tolerant Protocols</a>
<ul>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#background">Background</a></li>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#protocols-and-algorithms">Protocols and Algorithms</a>
<ul>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#paxos">Paxos</a></li>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#chandra-toueg">Chandra Toueg</a></li>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#raft">Raft</a></li>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#hashgraph">Hashgraph</a>
<ul>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#background">Background</a></li>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#gossip-protocol">Gossip Protocol</a></li>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#ancestors">Ancestors</a></li>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#strongly-seeing">Seeing</a></li>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#strongly-seeing">Strongly Seeing</a></li>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#construct-of-gossiping">Construct of Gossiping</a></li>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#internal-consensus">Internal Consensus</a></li>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#criticisms">Criticisms</a></li>
</ul>
</li>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#sintra">SINTRA</a></li>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#honeybadgerbft">HoneyBadgerBFT</a></li>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#stellar-consensus-protocol">Stellar Consensus Protocol</a></li>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#linbft">LinBFT</a></li>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#algorand">Algorand</a></li>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#thunderella">Thunderella</a></li>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#snowflake-to-avalanche">Snowflake to Avalanche</a></li>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#parsec">PARSEC</a></li>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#democratic-bft">Democratic BFT</a></li>
</ul>
</li>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#summary-of-findings">Summary of Findings</a></li>
</ul>
</li>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#references">References</a></li>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#appendices">Appendices</a>
<ul>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#appendix-a-terminology">Appendix A: Terminology</a>
<ul>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#consensus">Consensus</a></li>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#binary-consensus">Binary Consensus</a></li>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#byzantine-fault-tolerance">Byzantine Fault Tolerance</a></li>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#practical-byzantine-fault-tolerant-variants">Practical Byzantine Fault-tolerant Variants</a></li>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#deterministic-and-non-deterministic-protocols">Deterministic and Non-deterministic Protocols</a></li>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#scalability-performance-trade-off">Scalability-Performance Trade-off</a></li>
</ul>
</li>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#appendix-b-timing-assumptions">Appendix B: Timing Assumptions</a>
<ul>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#forms-of-timing-assumptions---degrees-of-synchrony">Forms of Timing Assumptions (Degrees of Synchrony)</a>
<ul>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#synchrony">Synchrony</a></li>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#partial-synchrony">Partial Synchrony</a>
<ul>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#unknown-t-model">Unknown-△T Model</a></li>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#eventually-synchronous">Eventually Synchronous</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#weak-synchrony">Weak Synchrony</a></li>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#random-synchrony">Random Synchrony</a></li>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#asynchrony">Asynchrony</a>
<ul>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#asynchronous-networks-and-protocols">Asynchronous Networks and Protocols</a></li>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#counting-rounds-in-asynchronous-networks">Counting Rounds in Asynchronous Networks</a></li>
</ul>
</li>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#problem-with-timing-assumptions">Problem with Timing Assumptions</a>
<ul>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#general">General</a></li>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#denial-of-service-attack">Denial of Service Attack</a></li>
</ul>
</li>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#flp-impossibility">FLP Impossibility</a></li>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#randomized-agreement">Randomized Agreement</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#contributors">Contributors</a></li>
</ul>
<h2><a class="header" href="#introduction-7" id="introduction-7">Introduction</a></h2>
<p>When considering how Tari will potentially build its second layer, an analysis of the most promising Byzantine 
Consensus Mechanisms and their applications was sought. </p>
<p>Important to consider is the &quot;scalability trilemma&quot;. This phrase, referred to in [<a href="https://bitcoinist.com/breaking-down-the-scalability-trilemma/" title="Breaking down the Blockchain 
Scalability Trilemma">1</a>], takes into account the potential 
trade-offs regarding decentralization, security and scalability: </p>
<ul>
<li>
<p><strong>Decentralization.</strong> A core principle on which the majority of the systems are built, taking into account 
censorship-resistance and ensuring that everyone, without prejudice, is permitted to participate in the decentralized 
system. </p>
</li>
<li>
<p><strong>Scalability.</strong> Encompasses the ability of the network to process transactions. Thus, if a public blockchain is 
deemed to be efficient, effective and usable, it should be designed to handle millions of users on the network. </p>
</li>
<li>
<p><strong>Security.</strong> Refers to the immutability of the ledger and takes into account threats of 51% attacks, Sybil attacks, 
Distributed Denial of Service (DDoS) attacks, etc. </p>
</li>
</ul>
<p>Through the recent development of this ecosystem, most blockchains have focused on two of the three factors, namely 
decentralization and security, at the expense of scalability. The primary reason for this is that nodes must reach 
consensus before transactions can be processed [<a href="https://bitcoinist.com/breaking-down-the-scalability-trilemma/" title="Breaking down the Blockchain 
Scalability Trilemma">1</a>].</p>
<p>This report examines proposals considering Byzantine Fault-tolerant (BFT) consensus mechanisms, and considers their 
feasibility and efficiency in meeting the characteristics of scalability, decentralization and security. In each 
instance, the following are assessed:</p>
<ul>
<li>protocol assumptions;</li>
<li>reference implementations; and</li>
<li>discernment regarding whether the protocol may be used for Tari as a means to maintain the distributed asset state. </li>
</ul>
<p><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#appendix-a-terminology">Appendix A</a> contains terminology related to consensus mechanisms, including definitions of 
<a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#consensus">Consensus</a>; <a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#binary-consensus">Binary Consensus</a>; <a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#byzantine-fault-tolerance">Byzantine Fault Tolerance</a>; 
<a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#practical-byzantine-fault-tolerant-variants">Practical Byzantine Fault-tolerant Variants</a>; <a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#deterministic-and-non-deterministic-protocols">Deterministic and 
Non-deterministic Protocols</a>; and 
<a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#scalability-performance-trade-off">Scalability-Performance Trade-off</a>.</p>
<p><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#appendix-b-timing-assumptions">Appendix B</a> discusses timing assumptions, including degrees of synchrony, which range 
from <a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#synchrony">Synchrony</a> and <a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#partial-synchrony">Partial Synchrony</a> to  <a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#weak-synchrony">Weak Synchrony</a>, 
<a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#random-synchrony">Random Synchrony</a> and <a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#asynchrony">Asynchrony</a>; as well as the problem with timing assumptions, 
including <a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#denial-of-service-attack">Denial of Service (DoS) Attack</a>, <a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#flp-impossibility">FLP Impossibility</a> 
and <a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#randomized-agreem#the-flp-impossibilityent">Randomized Agreement</a>.</p>
<h2><a class="header" href="#brief-survey-of-byzantine-fault-tolerant-consensus-mechanisms" id="brief-survey-of-byzantine-fault-tolerant-consensus-mechanisms">Brief Survey of Byzantine Fault-tolerant Consensus Mechanisms</a></h2>
<p>Many peer-to-peer, online, real-time strategy games use a modified lockstep protocol as a consensus protocol in order to 
manage the game state between players in a game. Each game action results in a game state delta broadcast to all other 
players in the game, along with a hash of the total game state. Each player validates the change by applying the delta 
to their own game state and comparing the game state hashes. If the hashes do not agree, then a vote is cast, and those 
players whose game states are in the minority are disconnected and removed from the game (known as a desync) [<a href="https://en.wikipedia.org/wiki/Consensus_(computer_science)" title="Wikipedia: Consensus Mechanisms">2</a>].</p>
<h2><a class="header" href="#permissioned-byzantine-fault-tolerant-protocols" id="permissioned-byzantine-fault-tolerant-protocols">Permissioned Byzantine Fault-tolerant Protocols</a></h2>
<h3><a class="header" href="#background-6" id="background-6">Background</a></h3>
<p>Byzantine agreement schemes are considered well suited for permissioned blockchains, where the identity of the 
participants is known. Examples include Hyperledger and Tendermint. Here, the Federated Consensus Algorithm is 
implemented [<a href="http://conferences.inf.ed.ac.uk/EuroDW2018/papers/eurodw18-Rusch.pdf" title="High-Performance Consensus Mechanisms for 
Blockchains">3</a>]. </p>
<h3><a class="header" href="#protocols" id="protocols">Protocols</a></h3>
<h4><a class="header" href="#hyperledger-fabric" id="hyperledger-fabric">Hyperledger Fabric</a></h4>
<p>Hyperledger Fabric (HLF) began as a project under the LinX Foundation in early 2016 [<a href="https://www.zurich.ibm.com/dccl/papers/cachin_dccl.pdf" title="Architecture of the Hyperledger 
Blockchain Fabric">4</a>]. The aim was to create an 
open-source, cross-industry, standard platform for distributed ledgers. HLF is an implementation of a distributed ledger 
platform for running smart contracts and leveraging familiar and proven technologies. It has a modular architecture, 
allowing pluggable implementations of various functions. The distributed ledger protocol of the fabric is run on the 
peers. The fabric distinguishes peers as:</p>
<ul>
<li><strong>validating peers</strong> (they run the consensus algorithm, thus validating the transactions); and</li>
<li><strong>non-validating peers</strong> (they act as a proxy that helps in connecting clients to validating peers).</li>
</ul>
<p>The validating peers run a BFT consensus protocol for executing a replicated state machine that accepts deploy, invoke 
and query transactions as operations [<a href="https://ieeexplore.ieee.org/document/8014672/" title="Survey of Consensus Protocols of Blockchain Applications,
4th International Conference on Advanced Computing 
and Communication Systems.">5</a>].</p>
<p>The blockchain's hash chain is computed based on the executed transactions and resulting persistent state. The 
replicated execution of chaincode (the transaction that involves accepting the code of the smart contract to be 
deployed) is used for validating the transactions. It is assumed that among <em>n</em> validating peers, at most <em>f&lt;n/3</em> (where 
<em>f</em> is the number of faulty nodes and <em>n</em> is the number of nodes present in the network) may behave arbitrarily, while 
others will execute correctly, thus adapting to concept BFT consensus. Since HLF proposes to follow a Practical Byzantine 
Fault-tolerant (PBFT) consensus protocol, the chaincode transactions must be deterministic in nature, otherwise 
different peers might have different persistent states. The SIEVE protocol is used to filter out the 
non-deterministic transactions, thus assuring a unique persistent state among peers [<a href="https://ieeexplore.ieee.org/document/8014672/" title="Survey of Consensus Protocols of Blockchain Applications,
4th International Conference on Advanced Computing 
and Communication Systems.">5</a>].</p>
<p>While being redesigned for a v1.0 release, the format's goal was to achieve extensibility. This version allowed for 
modules such as membership and consensus mechanism to be exchanged. Being permissioned, this consensus mechanism is 
mainly responsible for receiving the transaction request from the clients and establishing a total execution order. So 
far, these pluggable consensus modules include a centralized, single order for testing purposes, and a crash-tolerant 
ordering service based on Apache Kafka [<a href="http://conferences.inf.ed.ac.uk/EuroDW2018/papers/eurodw18-Rusch.pdf" title="High-Performance Consensus Mechanisms for 
Blockchains">3</a>].</p>
<h4><a class="header" href="#tendermint" id="tendermint">Tendermint</a></h4>
<h5><a class="header" href="#overview-9" id="overview-9">Overview</a></h5>
<p>Tendermint Core is a BFT Proof-of-Stake (PoS) protocol, which is composed of two protocols in one: a consensus algorithm 
and a peer-to-peer networking protocol. Inspired by the design goal behind <a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/./Permissionless-Byzantine-Fault-Tolerant-Protocols(Part1).html#raft">Raft</a>, 
the authors of [<a href="https://blog.cosmos.network/tendermint-explained-bringing-bft-based-pos-to-the-public-blockchain-domain-f22e274a0fdb" title="Tendermint Explained - Bringing BFT-based
PoS to the Public Blockchain Domain">6</a>] specified Tendermint as being an easy-to-understand, developer-friendly algorithm that can do 
algorithmically complex systems engineering.</p>
<p>Tendermint is modeled as a deterministic protocol, live under partial synchrony, which achieves throughput within the 
bounds of the latency of the network and individual processes themselves. </p>
<p>Tendermint rotates through the validator set, in a weighted round-robin fashion. The higher the stake (i.e. voting 
power) that a validator possesses, the greater its weighting; and the more times, proportionally, it will be elected as a 
leader. Thus, if one validator has the same amount of voting power as another validator, they will both be elected by 
the protocol an equal amount of times [<a href="https://blog.cosmos.network/tendermint-explained-bringing-bft-based-pos-to-the-public-blockchain-domain-f22e274a0fdb" title="Tendermint Explained - Bringing BFT-based
PoS to the Public Blockchain Domain">6</a>]. </p>
<p>Critics have argued that Tendermint is not decentralized, and that one can distinguish and target leadership, launching 
a DDoS attack against them, and sniffling the progression of the chain. Although Sentry Architecture (containing sentry 
nodes, refer to <a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#sentry-nodes">Sentry Nodes</a>) has been implemented in Tendermint, the argument regarding the degree of 
decentralization is still questionable. </p>
<h5><a class="header" href="#sentry-nodes" id="sentry-nodes">Sentry Nodes</a></h5>
<p>Sentry nodes are guardians of a validator node and provide validator nodes with access to the rest of the network. They 
are well connected to other full nodes on the network. Sentry nodes may be dynamic, but should maintain persistent 
connections to some evolving random subset of each other. They should always expect to have direct incoming connections 
from the validator node and its backup(s). They do not report the validator node's address in the Peer Exchange Reactor 
(PEX) and may be more strict about the quality of peers they keep.</p>
<p>Sentry nodes belonging to validators that trust each other may wish to maintain persistent connections via Virtual 
Private Network (VPN) with one another, but only report each other sparingly in the PEX [<a href="https://github.com/tendermint/tendermint/blob/master/docs/spec/p2p/node.md" title="Tendermint Peer Discovery">7</a>].</p>
<h2><a class="header" href="#permissionless-byzantine-fault-tolerant-protocols" id="permissionless-byzantine-fault-tolerant-protocols">Permissionless Byzantine Fault-tolerant Protocols</a></h2>
<h3><a class="header" href="#background-7" id="background-7">Background</a></h3>
<p>BFT protocols face several limitations when utilized in permissionless blockchains. They do not scale well with the 
number of participants, resulting in performance deterioration for the targeted network sizes. In addition, they are 
not well established in this setting, thus they are prone to security issues such as Sybil attacks. Currently, there 
are approaches that attempt to circumvent or solve this problem [<a href="http://conferences.inf.ed.ac.uk/EuroDW2018/papers/eurodw18-Rusch.pdf" title="High-Performance Consensus Mechanisms for 
Blockchains">3</a>].</p>
<h3><a class="header" href="#protocols-and-algorithms" id="protocols-and-algorithms">Protocols and Algorithms</a></h3>
<h4><a class="header" href="#paxos" id="paxos">Paxos</a></h4>
<p>The Paxos family of protocols includes a spectrum of trade-offs between the number of processors, number of message 
delays before learning the agreed value, activity level of individual participants, number of messages sent and types 
of failures. Although the FLP theorem (named after the authors Michael J. Fischer, Nancy Lynch, and Mike Paterson) 
states that there is no deterministic fault-tolerant consensus protocol that can guarantee progress in an asynchronous 
network, Paxos guarantees safety (consistency), and the conditions that could prevent it from making progress are 
difficult to provoke [<a href="https://en.wikipedia.org/wiki/Paxos_(computer_science)" title="Wikipedia: Paxos">8</a>].</p>
<p>Paxos achieves consensus as long as there are <em>f</em> failures, where <em>f &lt; (n-1)/2</em>. These failures cannot be Byzantine, 
otherwise the BFT proof would be violated. Thus it is assumed that messages are never corrupted, and that nodes do not 
collude to subvert the system. </p>
<p>Paxos proceeds through a set of negotiation rounds, with one node having &quot;Leadership&quot; status. Progress will stall if 
the leader becomes unreliable, until a new leader is elected, or if an old leader suddenly comes back online and a 
dispute between two leader nodes arises.</p>
<h4><a class="header" href="#chandra-toueg" id="chandra-toueg">Chandra-Toueg</a></h4>
<p>The Chandra–Toueg consensus algorithm [<a href="https://en.wikipedia.org/wiki/Chandra%E2%80%93Toueg_consensus_algorithm" title="Wikipedia: Chandra-Toueg Consensus 
Algorithm">9</a>], published in 1996, relies on a special node that acts as a failure 
detector. In essence, it pings other nodes to make sure they are still responsive. This implies that the detector stays 
online and that the detector must continuously be made aware when new nodes join the network.</p>
<p>The algorithm itself is similar to the Paxos algorithm, which also relies on failure detectors and requires 
<em>f&lt;n/2</em>, where n is the total number of processes.</p>
<h4><a class="header" href="#raft" id="raft">Raft</a></h4>
<p>Raft is a consensus algorithm designed as an alternative to Paxos. It was meant to be more understandable than Paxos by 
means of separation of logic, but it is also formally proven safe and offers some additional features [<a href="https://en.wikipedia.org/wiki/Raft_(computer_science)" title="Wikipedia: Raft">10</a>].</p>
<p>Raft achieves consensus via an elected leader. Each follower has a timeout in which it expects the heartbeat from the 
leader. It is thus a synchronous protocol. If the leader fails, an election is held to find a new leader. This entails 
nodes nominating themselves on a first-come, first-served basis. Hung votes require the election to be scrapped and 
restarted. This suggests that a high degree of cooperation is required by nodes, and that malicious nodes could easily 
collude to disrupt a leader and then prevent a new leader from being elected. Raft is a simple algorithm, but is clearly 
unsuitable for consensus in cryptocurrency applications.</p>
<p>While Paxos, Raft and many other well-known protocols tolerate crash faults, BFT protocols, beginning with PBFT, 
tolerate even arbitrary corrupted nodes. Many subsequent protocols offer improved performance, often through optimistic 
execution that provides excellent performance when there are no faults; when clients do not contend much; and when the 
network is well behaved, and there is at least some progress. </p>
<p>In general, BFT systems are evaluated in deployment scenarios where latency and the central processing unit (CPU) are 
the bottleneck. Thus the most effective protocols reduce the number of rounds and minimize expensive cryptographic 
operations.</p>
<p>In a recent line of work, [<a href="https://www.usenix.org/legacy/event/nsdi09/tech/full_papers/clement/clement.pdf" title="Making Byzantine Fault Tolerant 
Systems Tolerate Byzantine Faults">11</a>] advocated improvement of the worst-case performance, providing service quality 
guarantees even when the system is under attack, even if this comes at the expense of performance in the optimistic 
case. However, although the &quot;Robust BFT protocols in this vein gracefully tolerate comprised nodes, they still rely on 
timing assumptions about the underlying network&quot; [<a href="https://eprint.iacr.org/2016/199.pdf" title="The Honey Badger of BFT Protocols">28</a>]. Thus, focus shifted to asynchronous networks.</p>
<h4><a class="header" href="#hashgraph" id="hashgraph">Hashgraph</a></h4>
<h5><a class="header" href="#background-8" id="background-8">Background</a></h5>
<p>The Hashgraph consensus algorithm [<a href="https://www.swirlds.com/downloads/SWIRLDS-TR-2016-01.pdf" title="Hashgraph White Paper">12</a>] was released in 2016. It claims Byzantine Fault Tolerance (BFT) under complete 
<strong>asynchrony</strong> assumptions, no leaders, no round robin, no Proof-of-Work (PoW), eventual consensus with probability one, 
and high speed in the absence of faults. </p>
<p>Hashgraph is based on the gossip protocol, which is a fairly efficient distribution strategy that entails nodes randomly 
sharing information with each other, similar to how human beings gossip.</p>
<p>Nodes jointly build a Hashgraph reflecting all of the gossip events. This allows Byzantine agreement to be achieved 
through virtual voting. Alice does not send Bob a vote over the Internet. Instead, Bob calculates what vote Alice would 
have sent, based on his knowledge of what Alice knows.</p>
<p>Hashgraph uses digital signatures to prevent undetectable changes to transmitted messages. It does not violate the FLP 
theorem, since it is <em>non-deterministic</em>. </p>
<p>The Hashgraph has some similarities to a blockchain. To quote the white paper: &quot;The Hashgraph consensus algorithm is 
equivalent to a blockchain in which the 'chain' is constantly branching, without any pruning, where no blocks are ever 
stale, and where each miner is allowed to mine many new blocks per second, without proof-of-work&quot; [<a href="https://www.swirlds.com/downloads/SWIRLDS-TR-2016-01.pdf" title="Hashgraph White Paper">12</a>].</p>
<p>Because each node keeps track of the Hashgraph, there is no need to have voting rounds in Hashgraph; each node already 
knows what all of its peers will vote for, and thus consensus is reached purely by analyzing the graph. </p>
<h5><a class="header" href="#gossip-protocol" id="gossip-protocol">Gossip Protocol</a></h5>
<p>The gossip protocol works like this:</p>
<ul>
<li>Alice selects a random peer node, say Bob, and sends him <em>everything she knows</em>. She then selects another random node 
and repeats the process indefinitely.</li>
<li>Bob, on receiving Alice's information, marks this as a gossip event and fills in any gaps in his knowledge from 
Alice's information. Once done, he continues gossiping, using his updated information.</li>
</ul>
<p>The basic idea behind the gossip protocol is the following: A node wants to share some information with the other nodes 
in the network. Then, periodically, it randomly selects a node from the set of nodes and exchanges the information. The 
node that receives the information then randomly selects a node from the set of nodes and exchanges the information, 
and so on. The information is periodically sent to <em>N</em> targets, where <em>N</em> is the fanout [<a href="https://managementfromscratch.wordpress.com/2016/04/01/introduction-to-gossip/" title="Introduction to Gossip">13</a>].</p>
<p>The <em>cycle</em> is the number of rounds to spread the information. The <em>fanout</em> is the number of nodes a node gossips with 
in each cycle.</p>
<p>With a fanout = 1, $O(LogN)$ cycles are necessary for the update to reach all the nodes. In this way, information 
spreads throughout the network in an exponential fashion [<a href="https://www.swirlds.com/downloads/SWIRLDS-TR-2016-01.pdf" title="Hashgraph White Paper">12</a>].</p>
<p>The gossip history can be represented as a directed graph, as shown in Figure 1. </p>
<p align="center"><img src="consensus-mechanisms/BFT-consensus-mechanisms-applications/../assets/gossip.png" width="400" /></p>
<p align="center"><b>Figure 1: Gossip Protocol Directed Graph</b></p>
<p>Hashgraph introduces a few important concepts that are used repeatedly in later BFT consensus algorithms: famous 
witnesses and strongly seeing.</p>
<h5><a class="header" href="#ancestors" id="ancestors">Ancestors</a></h5>
<p>If an event (<em>x1</em>) comes before another event (<em>x2</em>) and they are connected by a line, the older event is an <em>ancestor</em> 
of that event. If both events were created by the <em>same node</em>, then <em>x1</em> is a <em>self-ancestor</em> of <em>x2</em>. </p>
<p><strong>Note:</strong> The gossip protocol defines an event as being a (self-)ancestor of itself!</p>
<h5><a class="header" href="#seeing" id="seeing">Seeing</a></h5>
<p>If an event <em>x1</em> is an ancestor of <em>x2</em>, then we say that <em>x1</em> <strong>sees</strong> <em>x2</em>, as long as the node is not aware of any 
forks from <em>x2</em>. So in the absence of forks, all events will <em>see</em> all of their ancestors.</p>
<pre><code class="language-text">     +-----&gt; y
     |
x +--+
     |
     +-----&gt; z
</code></pre>
<p>In the preceding example, <em>x</em> is an ancestor of both y and z. However, because there is no ancestor relationship between 
<em>y</em> and <em>z</em>, the <em>seeing</em> condition fails, and so <em>y</em> cannot see <em>x</em>, and <em>z</em> cannot see <em>x</em>.</p>
<p>It may be the case that it takes time before nodes in the protocol detect the fork. For instance, Bob may create 
<em>z</em> and <em>y</em>, but share <em>z</em> with Alice and <em>y</em> with Charlie. Both Alice and Charlie will eventually learn about the 
deception, but until that point, Alice will believe that <em>y</em> sees <em>x</em>, and Charlie will believe that <em>z</em> sees <em>x</em>. This 
is where the concept of <em>strongly seeing</em> comes in. </p>
<h5><a class="header" href="#strongly-seeing" id="strongly-seeing">Strongly Seeing</a></h5>
<p>If a node examines its Hashgraph and notices that an event <em>z</em> <em>sees</em> an event <em>x</em>, and not only that, but it can draw 
an ancestor relationship (usually via multiple routes) through a super-majority of peer nodes, and that a different 
event from each node also sees <em>x</em>, then it is said that according to this node, <em>z</em> <em>strongly sees</em> <em>x</em>. The example in 
Figure 2 comes from [<a href="https://www.swirlds.com/downloads/SWIRLDS-TR-2016-01.pdf" title="Hashgraph White Paper">12</a>]:</p>
<p align="center"><img src="consensus-mechanisms/BFT-consensus-mechanisms-applications/../assets/strongly-seeing.png" width="600" /></p>
<p align="center"><b>Figure 2: Illustration of Strongly-seeing </b></p>
<h5><a class="header" href="#construct-of-gossiping" id="construct-of-gossiping">Construct of Gossiping</a></h5>
<p>The main consensus algorithm loop consists of every node (Alice), selecting a random peer node (Bob) and sharing their 
graph history. Now Alice and Bob have the same graph history.</p>
<p>Alice and Bob both create a new event with the new knowledge they have just learnt from their peer. Alice repeats this 
process continuously.</p>
<h5><a class="header" href="#internal-consensus" id="internal-consensus">Internal Consensus</a></h5>
<p>After a sync, a node will determine the order for as many events as possible, using three procedures. The algorithm uses 
constant <em>n</em> (the number of nodes) and a small constant value <em>c</em>&gt;2.</p>
<ul>
<li>Firstly, we have the <strong>Swirlds Hashgraph consensus algorithm</strong>. Each member runs this in parallel. Each sync brings in 
new events, which are then added to the Hashgraph. All known events are then divided into rounds. Then the first events 
in each round are decided on as being famous or not (through purely local Byzantine agreement with virtual voting). Then 
the total order is found on those events for which enough information is available. If two members independently assign 
a position in history to an event, they are guaranteed to assign the same position, and guaranteed to never change it, 
even as more information comes in. Furthermore, each event is eventually assigned such a position, with a probability 
of 
one [<a href="https://www.swirlds.com/downloads/SWIRLDS-TR-2016-01.pdf" title="Hashgraph White Paper">12</a>].</li>
</ul>
<pre><code class="language-text">in parallel:
    loop
      sync all known events to a random member
    end loop

    loop
      receive a sync
      create a new event
      call divideRounds
      call decideFame
      call findOrder
    end loop
</code></pre>
<ul>
<li>Secondly, we have the <strong>divideRounds procedure</strong>. As soon as an event x is known, it is assigned a round number 
x.round, and the Boolean value x.witness is calculated, indicating whether it is the first event that a member created 
in that round [<a href="https://www.swirlds.com/downloads/SWIRLDS-TR-2016-01.pdf" title="Hashgraph White Paper">12</a>].</li>
</ul>
<pre><code class="language-proceduredivideRounds">      for each event x
        r ← max round of parents of x ( or 1 if none exist )
        if x can strongly see more than 2/3*n round r witnesses
          x.round ← r + 1
        else
          x.round ← r
        x.witness ← ( x has no self parent ) || ( x.round &gt; x.selfParent.round )
</code></pre>
<ul>
<li>Thirdly, we have the <strong>decideFame procedure</strong>. For each witness event (i.e. an event x where x.witness is true), 
decide whether it is famous (i.e. assign a Boolean to x.famous). This decision is done by a Byzantine agreement protocol 
based on virtual voting. Each member runs it locally, on their own copy of the Hashgraph, with no additional 
communication. The protocol treats the events in the Hashgraph as if they were sending votes to each other, although the 
calculation is purely local to a member’s computer. The member assigns votes to the witnesses of each round, for 
several rounds, until more than two-thirds of the population agrees [<a href="https://www.swirlds.com/downloads/SWIRLDS-TR-2016-01.pdf" title="Hashgraph White Paper">12</a>].</li>
</ul>
<pre><code class="language-proceduredecideFame">      for each event x in order from earlier rounds to later
        x.famous ← UNDECIDED
        for each event y in order from earlier rounds to later
          if x.witness and y.witness and y.round &gt; x.round
            d ← y.round - x.round
            s ← the set of witness events in round y.round-1 that y can strongly see
            v ← majority vote in s ( is TRUE for a tie )
            t ← number of events in s with a vote of v
            if d = 1 // first round of the election
              y.vote ← can y see x ?
            else if d mod c &gt; 0 // this is a normal round
                if t &gt; 2* n /3 // if supermajority, then decide
                  x.famous ← v
                  y.vote ← v
                  break // y loop
                else // else, just vote
                  y.vote ← v
            else if t &gt; 2* n /3 // this is a coin round
              y.vote ← v
            else // else flip a coin
              y.vote ← middle bit of y.signature
</code></pre>
<h5><a class="header" href="#criticisms" id="criticisms">Criticisms</a></h5>
<p>An attempt to address some of the following criticisms has been presented [<a href="https://www.swirlds.com/downloads/SWIRLDS-TR-2016-01.pdf" title="Swirlds and Sybil Attacks">14</a>]: </p>
<ul>
<li>The Hashgraph protocol is patented and is not open source.</li>
<li>In addition, the Hashgraph white paper assumes that <em>n</em>, the number of nodes in the network, is constant. In practice, 
<em>n</em> can increase, but performance likely degrades badly as <em>n</em> becomes large [<a href="https://hackernoon.com/demystifying-hashgraph-benefits-and-challenges-d605e5c0cee5" title="Demystifying Hashgraph: 
Benefits and Challenges">15</a>].</li>
<li>Hashgraph is not as &quot;fair&quot; as claimed in their paper, with at least one attack being proposed [<a href="https://medium.com/opentoken/hashgraph-a-whitepaper-review-f7dfe2b24647" title="Hashgraph: A Whitepaper Review">16</a>].</li>
</ul>
<h4><a class="header" href="#sintra" id="sintra">SINTRA</a></h4>
<p>SINTRA is a Secure INtrusion-Tolerant Replication Architecture used for the coordination in asynchronous networks 
subject to Byzantine faults. It consists of a collection of protocols and is implemented in Java, providing secure 
replication and coordination among a group of servers connected by a wide-area network, such as the Internet. For a 
group consisting of <em>n</em> servers, it tolerates up to $t&lt;n/3$ servers failing in arbitrary, malicious ways, which is 
optimal for the given model. The servers are connected only by asynchronous point-to-point communication links. Thus, 
SINTRA automatically tolerates timing failures as well as attacks that exploit timing. The SINTRA group model is static. 
This means that failed servers must be recovered by mechanisms outside of SINTRA, and the group must be initialized by a 
trusted process.</p>
<p>The protocols exploit randomization, which is needed to solve Byzantine agreement in such asynchronous distributed 
systems. Randomization is provided by a threshold-cryptographic pseudorandom generator, a coin-tossing protocol based 
on the Diffie-Hellman problem. Threshold cryptography is a fundamental concept in SINTRA, as it allows the group to 
perform a common cryptographic operation for which the secret key is shared among the servers such that no single 
server or small coalition of corrupted servers can obtain useful information about the key. SINTRA provides 
threshold-cryptographic schemes for digital signatures, public-key encryption and unpredictable pseudorandom number 
generation (coin-tossing). It contains broadcast primitives for reliable and consistent broadcasts, which provide 
agreement on individual messages sent by distinguished senders. However, these primitives cannot guarantee a total order 
for a stream of multiple messages delivered by the system, which is needed to build fault-tolerant services using the 
state machine replication paradigm. This is the problem of atomic broadcast and requires more expensive protocols based 
on Byzantine agreement. SINTRA provides multiple randomized Byzantine agreement protocols, for binary and multi-valued 
agreement, and implements an atomic broadcast channel on top of agreement. An atomic broadcast that also maintains a 
causal order in the presence of Byzantine faults is provided by the secure causal atomic broadcast channel [<a href="https://cachin.com/cc/papers/sintra.pdf" title="Secure Intrusion-tolerant Replication 
on the Internet">17</a>].</p>
<p>Figure 3 illustrates SINTRA's modular design. Modularity greatly simplifies the construction and analysis of the complex 
protocols needed to tolerate Byzantine faults.</p>
<p align="center"><img src="consensus-mechanisms/BFT-consensus-mechanisms-applications/../assets/design-of-sintra.png" width="300" /></p>
<p align="center"><b>Figure 3: Design of SINTRA </b></p>
<h4><a class="header" href="#honeybadgerbft" id="honeybadgerbft">HoneyBadgerBFT</a></h4>
<p>HoneyBadgerBFT was released in November 2016 and is seen as the first practical <strong>asynchronous</strong> BFT consensus 
algorithm. It was designed with cryptocurrencies in mind, where bandwidth is considered scarce, but an abundance of CPU 
power is available. Thus, the protocol implements public-private key encryption to increase the efficiency of the 
establishment of consensus. The protocol works with a fixed set of servers to run the consensus. However, this leads to 
centralization and allows an attacker to specifically target these servers [<a href="http://conferences.inf.ed.ac.uk/EuroDW2018/papers/eurodw18-Rusch.pdf" title="High-Performance Consensus Mechanisms for 
Blockchains">3</a>].</p>
<p>In its threshold encryption scheme, any one party can encrypt a message using a master public key, and it requires f+1 
correct nodes to compute and reveal decryption shares for a ciphertext before the plaintext can be recovered.</p>
<p>The work of HoneyBadgerBFT is closely related to <a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/./Permissionless-Byzantine-Fault-Tolerant-Protocols(Part1).html#sintra">SINTRA</a>, 
which, as mentioned earlier, is a system implementation based on the asynchronous atomic broadcast protocol from [<a href="https://www.shoup.net/papers/ckps.pdf" title="Secure and Efficient Asynchronous Broadcast Protocols">18</a>]. 
This protocol consists of a reduction from Atomic Broadcast Channel (ABC) to Asynchronous Common Subset (ACS), as well 
as a reduction from ACS to Multi-value Validated Agreement (MVBA). </p>
<p>HoneyBadger offers a novel reduction from ABC to ACS that provides better efficiency (by O(N) factor) through batching, 
while using threshold encryption to preserve censorship resilience. Better efficiency is also obtained by cherry-picking 
improved instantiations of subcomponents. For example, the expensive MVBA is circumvented by using an alternative ACS 
along with an efficient reliable broadcast (RBC) [<a href="https://eprint.iacr.org/2016/199.pdf" title="The Honey Badger of BFT Protocols">28</a>].</p>
<h4><a class="header" href="#stellar-consensus-protocol" id="stellar-consensus-protocol">Stellar Consensus Protocol</a></h4>
<p>Stellar Consensus Protocol (SCP) is an <strong>asynchronous</strong> protocol proposed. It considered to be a global consensus 
protocol consisting of nomination protocol and ballot protocol. SCP is said to be BFT, by bringing with it the concept 
of quorum slices and defeated BFT [<a href="https://ieeexplore.ieee.org/document/8014672/" title="Survey of Consensus Protocols of Blockchain Applications,
4th International Conference on Advanced Computing 
and Communication Systems.">5</a>].</p>
<p>Each participant forms a quorum of other users, thus creating a trust hierarchy, which requires complex trust decisions [<a href="http://conferences.inf.ed.ac.uk/EuroDW2018/papers/eurodw18-Rusch.pdf" title="High-Performance Consensus Mechanisms for 
Blockchains">3</a>]. 
Initially, the nomination proctor is run. During this, new values called candidate values are proposed for agreement. 
Each node receiving these values will vote for a single value among these. Eventually, it results in unanimously 
selected values for that slot. </p>
<p>After successful execution of nomination protocol, the nodes deploy the ballot protocol. This involves the federated 
voting to either commit or abort the values resulting from nomination protocol. This results in externalizing the ballot 
for the current slot. The aborted ballots are now declared irrelevant. However, there can be stuck states where nodes 
cannot reach a conclusion regarding whether to abort or commit a value. This situation is avoided by moving it to a 
higher-valued ballot, and considering it in a new ballot protocol execution. This aids in case a node believes that this 
stuck ballot was committed. Thus SCP assures avoidance and management of stuck states and provides liveliness. </p>
<p>The concept of quorum slices in case of SCP provides asymptotic security and flexible trust, making it more acceptable 
than other earlier consensus algorithms utilizing Federated BFT, such as the Ripple protocol consensus algorithm [<a href="https://ripple.com/files/ripple_consensus_whitepaper.pdf" title="The Ripple Protocol Consensus 
Algorithm">29</a>]. 
Here, the user is provided more independence in deciding whom to trust [<a href="http://the-eye.eu/public/Books/campdivision.com/PDF/Computers%20General/Privacy/bitcoin/tendermint_v05.pdf" title="Tendermint: Consensus without Mining">30</a>].</p>
<p>SCP protocol claims to be free of blocked states, and provides decentralized control, asymptotic security, flexible 
trust and low latency. However, it does not guarantee safety all the time. If the user node chooses an inefficient 
quorum slice, security is not guaranteed. In the event of partition or misbehaving nodes, it halts progress of the 
network until consensus can be reached.</p>
<h4><a class="header" href="#linbft" id="linbft">LinBFT</a></h4>
<p>LinBFT is a BFT protocol for blockchain systems. It allows for the amortized communication volume per block <em>O(n)</em> under 
reasonable conditions (where <em>n</em> is the number of participants) while satisfying deterministic guarantees on safety and 
liveness. It satisfies liveness in a <strong>partially synchronous</strong> network. </p>
<p>LinBFT cuts down its <em>O(n</em><sup>4</sup><em>)</em> complexity by implementing changes by <em>O(n)</em>: linear view change, threshold 
signature and verifiable random functions. This is clearly optimal, in that disseminating a block already takes <em>O(n)</em> 
transmissions. </p>
<p>LinBFT is designed to be implemented for permissionless, public blockchain systems and takes into account anonymous 
participants without a public-key infrastructure, PoS, rotating leader and dynamic participant set [<a href="https://arxiv.org/pdf/1807.01829.pdf" title="LinBFT: Linear-Communication Byzantine 
Fault Tolerance for Public Blockchains">31</a>]. For instance, 
participants can be anonymous, without a centralized public key infrastructure (PKI) public key among 
themselves, and participate in a distributed key generation (DKG) protocol required to create threshold signatures, 
both of which are communication-heavy processes. </p>
<p>LinBFT is compatible with PoS, which counters Sybil attacks and deters dishonest behavior through slashing [<a href="https://arxiv.org/pdf/1807.01829.pdf" title="LinBFT: Linear-Communication Byzantine 
Fault Tolerance for Public Blockchains">31</a>].</p>
<h4><a class="header" href="#algorand" id="algorand">Algorand</a></h4>
<p>The Algorand white paper was released in May 2017. Algorand is a <strong>synchronous</strong> BFT consensus mechanism, where the 
blocks are added at a minimum rate [<a href="https://arxiv.org/pdf/1607.01341.pdf" title="Algorand White Paper">19</a>]. It allows participants to privately check whether they are chosen for 
consensus participation and requires only one message per user, thus limiting possible attacks [<a href="http://conferences.inf.ed.ac.uk/EuroDW2018/papers/eurodw18-Rusch.pdf" title="High-Performance Consensus Mechanisms for 
Blockchains">3</a>].</p>
<p>Alogrand scales up to 500,000 users by employing verifiable random functions, which are pseudorandom functions able to 
provide verifiable proofs that the output of said function is correct [<a href="http://conferences.inf.ed.ac.uk/EuroDW2018/papers/eurodw18-Rusch.pdf" title="High-Performance Consensus Mechanisms for 
Blockchains">3</a>]. It introduces the concept of a <em>concrete coin</em>. 
Most of these BFT algorithms require some type of randomness oracle, but all nodes need to see the same value if the 
oracle is consulted. This had previously been achieved through a _common _<em>coin</em> idea. The <em>concrete coin</em> uses a much 
simpler approach, but only returns a binary value [<a href="https://arxiv.org/pdf/1607.01341.pdf" title="Algorand White Paper">19</a>].</p>
<h4><a class="header" href="#thunderella" id="thunderella">Thunderella</a></h4>
<p>Thunderella implements an asynchronous strategy, where a <strong>synchronous</strong> strategy is used as a fallback in the event of 
a malfunction [<a href="https://eprint.iacr.org/2017/913.pdf" title="Thunderella White Paper">20</a>], thus it achieves both robustness and speed. It can be applied in permissionless networks using PoW. 
Network robustness and &quot;instant confirmations&quot; require 75% of the network to be honest, as well as the presence of a 
leader node.</p>
<h4><a class="header" href="#snowflake-to-avalanche" id="snowflake-to-avalanche">Snowflake to Avalanche</a></h4>
<p>This consensus protocol was first seen in [<a href="https://ipfs.io/ipfs/QmUy4jh5mGNZvLkjies1RWM4YuvJh5o2FYopNPVYwrRVGV" title="Snowflake to Avalanche...">39</a>]. The paper outlines four protocols that are building blocks forming a 
protocol family. These leaderless BFT protocols, published by Team Rocket, are built on a metastable mechanism. They are 
called Slush, Snowflake, Snowball and Avalanche.</p>
<p>The protocols differ from the traditional consensus protocols and the Nakamoto consensus protocols by not requiring an 
elected leader. Instead, the protocol simply guides all the nodes to consensus. </p>
<p>These four protocols are described as a new family of protocols due to this concept of metastability: a means to 
establish consensus by guiding all nodes towards an emerging consensus without requiring leaders, while still 
maintaining the same level of security and inducing a speed that exceeds current protocols. </p>
<p>This is achieved through the formation of &quot;sub-quorums&quot;, which are small, randomized samples from nodes on the network. 
This allows for greater throughputs and sees parallel consensuses running before they merge to form the overarching 
consensus, which can be seen as similar in nature to the gossip protocol. </p>
<p>With regard to safety, throughput (the number of transactions per second) and scalability (the number of people 
supported by the network), Slush, Snowflake, Snowball and Avalanche seem to be able to achieve all three. They impart a 
probabilistic safety guarantee in the presence of Byzantine adversaries and achieve a high throughput and scalability 
due to their concurrent nature. A <strong>synchronous</strong> network is assumed. </p>
<p>The current problem facing the design of BFT protocols is that a system can be very fast when a small number of nodes 
are active, as there are fewer decisions to make. However, when there are many users and an increase in transactions, 
the system cannot be maintained. </p>
<p>Unlike the PoW implementation, which requires constant active participation from the miners, Avalanche can function even 
when nodes are dormant. </p>
<p>While traditional consensus protocols require <em>O</em>(n<sup>2</sup>) communication, their communication complexity ranges 
from <em>O(kn log n)</em> to <em>O(kn)</em> for some security parameter <em>k&lt;&lt;n</em>. In a sense, Team Rocket highlight that the 
communication complexity of their protocols is less intensive than that of <em>O</em>(n<sup>2</sup>) communications, thus 
making these protocols faster and more scalable. </p>
<p>To backtrack a bit, Big <em>O</em> notation is used in Computer Science to describe the performance or complexity of an 
algorithm. It describes the worst-case scenario and can be used to describe the execution time required by an algorithm [<a href="https://rob-bell.net/2009/06/a-beginners-guide-to-big-o-notation/" title="A Beginner's Guide to Big O Notation">21</a>]. 
In the case of consensus algorithms, <em>O</em> describes a finite expected number of steps or operations [<a href="http://www.cs.yale.edu/homes/aspnes/papers/jalg90.pdf" title="Fast Randomized Consensus using Shared Memory">22</a>]. For example, 
<em>O</em>(1) describes an algorithm that will always execute in the same time, regardless of the size of the input data set. 
<em>O</em>(n) describes an algorithm whose performance will grow linearly and in direct proportion to the size of the input 
data set. <em>O</em>(n<sup>2</sup>) represents an algorithm whose performance is directly proportional to the square of the 
size of the input data set.</p>
<p>The reason for this is <em>O(n<sup>2</sup>)</em> suggests that the rate of growth of function is determined by <em>n<sup>2</sup></em>, 
where <em>n</em> is the number of people on the network. Thus, the addition of a person exponentially increases the time taken 
to disseminate the information on the network, while traditional consensus protocols require everyone to communicate 
with one another, making it a laborious process [<a href="https://flatoutcrypto.com/home/avalancheprotocol" title="Protocol Spotlight: Avalanche Part 1">32</a>].</p>
<p>Despite assuming a synchronous network, which is susceptible to the DoS attacks, this new family of protocols &quot;reaches 
a level of security that is simply good enough while surging forward with other advancements&quot; [<a href="https://flatoutcrypto.com/home/avalancheprotocol" title="Protocol Spotlight: Avalanche Part 1">32</a>]. </p>
<h4><a class="header" href="#parsec" id="parsec">PARSEC</a></h4>
<p>PARSEC is a BFT consensus algorithm possessing <strong>weak synchrony</strong> assumptions (highly asynchronous, assuming random 
delays with finite expected value). Similar to Hashgraph, it has no leaders, no round robin, no PoW and reaches eventual 
consensus with probability one. It 
differs from Hashgraph, in that it provides high speed in the absence and presence of faults. Thus, it avoids the 
structures of delegated PoS (DPoS), which requires a trusted set of leaders, and does not have a round robin (where a 
permissioned set of miners sign each block).</p>
<p>PARSEC is fully open, unlike Hashgraph, which is patented and closed sourced. The reference implementation of PARSEC, 
written in Rust, was released a few weeks after the white paper ([<a href="http://docs.maidsafe.net/Whitepapers/pdf/PARSEC.pdf" title="Protocol for Asynchronous, Reliable, 
Secure and Efficient Consensus (PARSEC)">33</a>], [<a href="https://github.com/maidsafe/parsec" title="GitHub repository: Protocol for Asynchronous,
Reliable, Secure and Efficient Consensus">23</a>]).</p>
<p>The general problem in reaching Byzantine agreement on any value is reduced to the simple problem of reaching binary 
Byzantine agreement on the nodes participating in each decision. This has allowed PARSEC to reuse the binary 
Byzantine agreement protocol (Signature-free Asynchronous Byzantine Consensus) after adapting it to the gossip protocol [<a href="https://medium.com/@flatoutcrypto/project-spotlight-maidsafe-and-parsec-part-1-4830cec8d9e3" title="Project Spotlight: 
Maidsafe and PARSEC Part 1">34</a>]. </p>
<p>Similar to HoneybadgerBFT, this protocol is composed through the additions of interesting ideas presented in literature. 
Similar to Hashgraph and Avalanche, a gossip protocol is used to allow efficient communication between nodes [<a href="http://docs.maidsafe.net/Whitepapers/pdf/PARSEC.pdf" title="Protocol for Asynchronous, Reliable, 
Secure and Efficient Consensus (PARSEC)">33</a>].</p>
<p>Finally, the need for a trusted leader or a trusted setup phase implied in [<a href="https://hal.inria.fr/hal-00944019v2/document" title="Signature-Free Asynchronous Byzantine 
Consensus with $t&lt;n/3​$ and *O*(n&lt;sup&gt;2&lt;/sup&gt;) Messages">27</a>] is removed by porting the key ideas 
to an asynchronous setting [<a href="https://people.csail.mit.edu/silvio/Selected%20Scientific%20Papers/Distributed%20Computation/BYZANTYNE%20AGREEMENT%20MADE%20TRIVIAL.pdf" title="Byzantine Agreement Made Trivial">35</a>].</p>
<p>The network is set to <em>N of N</em> instances of the algorithm communicating via randomly synchronous connections. Due to 
random synchrony, all users can reach an agreement as to what is going on. There is no guarantee for nodes on the 
timing that they should be receiving messages, and a possibility of up to <em>t</em> Byzantine (arbitrary) failures are 
allowed, where <em>3t</em>&lt;N. The instances where no failures have occurred are deemed correct or honest, while the failed 
instances are termed faulty or malicious. Since a Byzantine failure model allows for malicious behavior, any set of 
instances containing more than 2/3N of them is referred to as the supermajority. </p>
<p>When a node receives a gossip request, it creates a new event and sends a response back (in Hashgraph, the response was 
optional). Each gossip event contains [<a href="https://flatoutcrypto.com/home/maidsafeparsecexplanationpt2" title="Project Spotlight: Maidsafe and PARSEC Part 2">24</a>]:</p>
<ol>
<li>The data being transmitted.</li>
<li>The self-parent (the hash of another gossip event created by the same node).</li>
<li>The other-parent (a hash of another gossip event created by a different node).</li>
<li>The <em>Cause</em> for creation, which can be a Request for information, a <em>Response</em> to another node’s request, or an 
<em>Observation</em>. An observation is when a node creates a gossip event to record an observation that the node made 
themselves.</li>
<li>The creator ID (public key).</li>
<li>The signature – signing the preceding information.</li>
</ol>
<p>The self-parent and other-parent prevent tampering because they are signed and related to other gossip events [<a href="https://flatoutcrypto.com/home/maidsafeparsecexplanationpt2" title="Project Spotlight: Maidsafe and PARSEC Part 2">24</a>].</p>
<p>As with Hashgraph, it is difficult for adversaries to interfere with the consensus algorithm, because all voting is 
<em>virtual</em> and done without sharing details of votes cast. Each node figures out what other nodes would have voted, based 
on their copy of the gossip graph.</p>
<p>PARSEC also uses the concept of a <em>concrete coin</em>, from Algorand. This is used to break ties, particularly in cases 
where an adversary is carefully managing communication between nodes in order to maintain a deadlock on votes.</p>
<p>In step 1, nodes try and converge on a &quot;true&quot; result for a set of results. If this is not achieved, they move on to 
step  2, which is trying to converge on a &quot;false&quot; result. If consensus still cannot be reached, a coin flip is made 
and they go back to step 1 in another voting round.</p>
<h4><a class="header" href="#democratic-bft" id="democratic-bft">Democratic BFT</a></h4>
<p>This is a deterministic Byzantine consensus algorithm that relies on a new weak coordinator. This protocol is 
implemented in the Red Belly blockchain and is said to achieve 30,000 transactions per second on Amazon Cloud Trials 
[<a href="https://www.ccn.com/tag/red-belly-blockchain/" title="Red Belly Blockchain">25</a>]. Through the coupling with an optimized variant of the reduction of multivalve to binary consensus from [<a href="https://dl.acm.org/citation.cfm?id=198088" title="Asynchronous Secure Computations with 
Optimal Resilience">26</a>], 
the Democratic BFT (DBFT) consensus algorithm was generated. It terminates in four message delays in the good case, 
when all non-faulty processes propose the same value [<a href="http://gramoli.redbellyblockchain.io/web/doc/pubs/DBFT-preprint.pdf" title="DBFT: Efficient Byzantine Consensus 
with a Weak Coordinator and its Application 
to Consortium Blockchains">36</a>].</p>
<p>The term weak coordinator is used to describe the ability of the algorithm to terminate in the presence of a faulty or 
slow coordinator, unlike previous algorithms that do not have the ability to terminate. The fundamental idea here is to 
allow processes to complete asynchronous rounds as soon as they receive a threshold of messages, instead of having to 
wait for a message from a coordinator that may be slow. The resulting algorithm assumes partial synchrony; is resilience 
and time optimal; and does not require signatures. </p>
<p>Moving away from the impossibility of solving consensus in asynchronous message systems, where processes can be faulty 
or Byzantine, the technique of randomization or additional synchrony is adopted. </p>
<p>Randomized algorithms can use per-process &quot;local&quot; coins, or a shared <em>common coin</em> to solve consensus probabilistically 
among <em>n</em> processes despite $t&lt;n/3​$ Byzantine processes. When based on local coins, the existing algorithms converge 
<em>O(n</em><sup>2.5</sup><em>)</em> expected time. </p>
<p>A recent randomized algorithm that does not contain a signature solves consensus in <em>O</em>(1) expected time under a fair 
scheduler, where <em>O</em> is the binary.</p>
<p>To solve the consensus problem deterministically and prevent the use of the common coin, researchers have assumed partial 
or eventual synchrony. Here, these solutions require a unique coordinator process, referred to as the leader, in order 
to remain non-faulty.</p>
<p>There are advantages and disadvantages to this technique:</p>
<ul>
<li>
<p>The advantage is that if the coordinator is non-faulty, and if the messages are delivered in a timely manner in an 
asynchronous round, then the coordinator broadcasts its proposal to all processes and this value is decided after a 
constant number of message delays.</p>
</li>
<li>
<p>The disadvantage is that a faulty coordinator can dramatically impact the algorithm performance by leveraging the 
power it has in a round, and imposing its value on all. Non-faulty processes thus have no other choice but to decide 
nothing in this round. </p>
</li>
</ul>
<p>This protocol sees the use of a weak coordinator, which allows for the introduction of a new deterministic Byzantine 
consensus algorithm that is time optimal, resilience optimal and does not require the use of signatures. Unlike the 
classic, strong coordinator, the weak coordinator does not impose its value. It allows non-faulty processes to decide 
a value quickly, without the need of the coordinator, while helping the algorithm to terminate if non-faulty processes 
know that they proposed distinct values that might all be decided. In addition, the presence of a weak coordinator 
allows rounds to be executed optimistically without waiting for a specific message. This is unlike classic BFT 
algorithms that have to wait for a particular message from their coordinator, and occasionally have to recover from a 
slow network or faulty coordinator. </p>
<p>With regard to the problem of a slow of Byzantine coordinator, the weak coordinator helps agreement by contributing a 
value while still allowing termination in a constant number of message delays. It is thus unlike the classic coordinator 
or the eventual leader, which cannot be implemented in the Binary Byzantine Consensus Algorithm, BAMP<sub>n,t</sub>[<em>t&lt;n/3</em>].</p>
<p>The validation of protocol was conducted similarly to that of the HoneyBadger blockchain, where &quot;Coin&quot;, the randomization 
algorithm from [<a href="https://hal.inria.fr/hal-00944019v2/document" title="Signature-Free Asynchronous Byzantine 
Consensus with $t&lt;n/3​$ and *O*(n&lt;sup&gt;2&lt;/sup&gt;) Messages">27</a>] was used. Using the 100 Amazon Virtual Machines located in five data centers on different 
continents, it was shown that the DBFT algorithm outperforms that of &quot;Coin&quot;, which is known to terminate in <em>O</em>(1) rounds 
in expectation. In addition, since Byzantine behaviors have been seen to severely affect the performance of strong 
coordinator-based consensus, four different Byzantine attacks have been tested in the validation. </p>
<h2><a class="header" href="#summary-of-findings" id="summary-of-findings">Summary of Findings</a></h2>
<p><a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#table_bft">Table 1</a> highlights the characteristics of the above-mentioned BFT Protocols. Asymptotic Security, 
Permissionless Blockchain, Timing Assumptions, Decentralized Control, Low Latency and Flexible Trust form part of the 
value system. </p>
<ul>
<li>Asymptotic Security - this depends only on digital signatures (and hash functions) for security.</li>
<li>Permissionless Protocol - this allows anybody to create an address and begin interacting with the protocol.</li>
<li>Timing Assumptions - refer to <a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#forms-of-timing-assumptions---degrees-of-synchrony">Forms of Timing Assumptions - Degrees of Synchrony</a>.</li>
<li>Decentralized Control - consensus is achieved and defended by protecting the identity of that node until its job is 
done, through a leaderless node. </li>
<li>Low Latency - this describes a computer network that is optimized to process a very high volume of data messages with
minimal delay.</li>
<li>Flexible Trust - where users have the freedom to trust any combinations of parties they see fit.</li>
</ul>
<p align="center"><b><a name="table_bft"> </a>Table 1: Characteristics of BFT Protocols</b></p>
<table><thead><tr><th>Protocol</th><th align="center">Permissionless Protocol</th><th align="center">Timing Assumptions</th><th align="center">Decentralized Control</th><th align="center">Low Latency</th><th align="center">Flexible Trust</th><th align="center">Asymptotic Security</th></tr></thead><tbody>
<tr><td>Hyperledger Fabric (HLF)</td><td align="center"></td><td align="center">Partially synchronous</td><td align="center">✓</td><td align="center"></td><td align="center">✓</td><td align="center"></td></tr>
<tr><td>Tendermint</td><td align="center"></td><td align="center">Partially synchronous</td><td align="center"></td><td align="center">✓</td><td align="center">✓</td><td align="center">✓</td></tr>
<tr><td>Paxos</td><td align="center">✓</td><td align="center">Partially synchronous</td><td align="center">✓</td><td align="center">✓</td><td align="center">✓</td><td align="center"></td></tr>
<tr><td>Chandra-Toureg</td><td align="center">✓</td><td align="center">Partially synchronous</td><td align="center">✓</td><td align="center"></td><td align="center">✓</td><td align="center"></td></tr>
<tr><td>Raft</td><td align="center">✓</td><td align="center">Weakly synchronous</td><td align="center">✓</td><td align="center">✓</td><td align="center">✓</td><td align="center"></td></tr>
<tr><td>HashGraph</td><td align="center">✓</td><td align="center">Asynchronous</td><td align="center">✓</td><td align="center">✓</td><td align="center">✓</td><td align="center"></td></tr>
<tr><td>SINTRA</td><td align="center">✓</td><td align="center">Asynchronous</td><td align="center">✓</td><td align="center"></td><td align="center">✓</td><td align="center"></td></tr>
<tr><td>HoneyBadgerBFT</td><td align="center">✓</td><td align="center">Asynchronous</td><td align="center">✓</td><td align="center">✓</td><td align="center">✓</td><td align="center">✓</td></tr>
<tr><td>Stellar Consensus Protocol</td><td align="center">✓</td><td align="center">Asynchronous</td><td align="center">✓</td><td align="center">✓</td><td align="center">✓</td><td align="center">✓</td></tr>
<tr><td>LinBFT</td><td align="center">✓</td><td align="center">Partially synchronous</td><td align="center">✓</td><td align="center"></td><td align="center">✓</td><td align="center"></td></tr>
<tr><td>Algorand</td><td align="center">✓</td><td align="center">Synchronous</td><td align="center">✓</td><td align="center">✓</td><td align="center">✓</td><td align="center"></td></tr>
<tr><td>Thunderella</td><td align="center">✓</td><td align="center">Synchronous</td><td align="center">✓</td><td align="center">✓</td><td align="center">✓</td><td align="center"></td></tr>
<tr><td>Avalanche</td><td align="center">✓</td><td align="center">Synchronous</td><td align="center">✓</td><td align="center">✓</td><td align="center">✓</td><td align="center"></td></tr>
<tr><td>PARSEC</td><td align="center">✓</td><td align="center">Weakly synchronous</td><td align="center">✓</td><td align="center"></td><td align="center">✓</td><td align="center"></td></tr>
<tr><td>Democratic BFT</td><td align="center">✓</td><td align="center">Partially synchronous</td><td align="center">✓</td><td align="center">✓</td><td align="center">✓</td><td align="center"></td></tr>
</tbody></table>
<p>BFT consensus protocols have been considered as a means to disseminate and validate information. The question of whether 
Schnorr multisignatures can perform the same function in validating information through the action of signing will form 
part of the next review. </p>
<h2><a class="header" href="#references-10" id="references-10">References</a></h2>
<p>[<a href="https://bitcoinist.com/breaking-down-the-scalability-trilemma/" title="Breaking down the Blockchain 
Scalability Trilemma">1</a>] B. Asolo, &quot;Breaking down the Blockchain Scalability Trilemma&quot; [online]. 
Available: <a href="https://bitcoinist.com/breaking-down-the-scalability-trilemma/">https://bitcoinist.com/breaking-down-the-scalability-trilemma/</a>. Date accessed: 2018‑10‑01.</p>
<p>[<a href="https://en.wikipedia.org/wiki/Consensus_(computer_science)" title="Wikipedia: Consensus Mechanisms">2</a>] Wikipedia: &quot;Consensus Mechanisms&quot; [online]. Available: <a href="https://en.wikipedia.org/wiki/Consensus_(computer_science)">https://en.wikipedia.org/wiki/Consensus_(computer_science)</a>. 
Date accessed: 2018‑10‑01.</p>
<p>[<a href="http://conferences.inf.ed.ac.uk/EuroDW2018/papers/eurodw18-Rusch.pdf" title="High-Performance Consensus Mechanisms for 
Blockchains">3</a>] S. Rusch, &quot;High-performance Consensus Mechanisms for Blockchains&quot; [online]. 
Available: <a href="http://conferences.inf.ed.ac.uk/EuroDW2018/papers/eurodw18-Rusch.pdf">http://conferences.inf.ed.ac.uk/EuroDW2018/papers/eurodw18-Rusch.pdf</a>. Date accessed: 2018‑08‑30.</p>
<p>[<a href="https://www.zurich.ibm.com/dccl/papers/cachin_dccl.pdf" title="Architecture of the Hyperledger 
Blockchain Fabric">4</a>] C. Cachin &quot;Architecture of the Hyperledger Blockchain Fabric&quot; [online]. 
Available: <a href="https://www.zurich.ibm.com/dccl/papers/cachin_dccl.pdf">https://www.zurich.ibm.com/dccl/papers/cachin_dccl.pdf</a>. Date accessed: 2018‑09‑16.</p>
<p>[<a href="https://ieeexplore.ieee.org/document/8014672/" title="Survey of Consensus Protocols of Blockchain Applications,
4th International Conference on Advanced Computing 
and Communication Systems.">5</a>] L. S. Sankar, M. Sindhu and M. Sethumadhavan, &quot;Survey of Consensus Protocols on Blockchain Applications&quot; [online]. 
Available: <a href="https://ieeexplore.ieee.org/document/8014672/">https://ieeexplore.ieee.org/document/8014672/</a>. Date accessed: 2018‑08‑30.</p>
<p>[<a href="https://blog.cosmos.network/tendermint-explained-bringing-bft-based-pos-to-the-public-blockchain-domain-f22e274a0fdb" title="Tendermint Explained - Bringing BFT-based
PoS to the Public Blockchain Domain">6</a>] &quot;Tendermint Explained - Bringing BFT-based PoS to the Public Blockchain Domain&quot; [online]. 
Available: <a href="https://blog.cosmos.network/tendermint-explained-bringing-bft-based-pos-to-the-public-blockchain-domain-f22e274a0fdb">https://blog.cosmos.network/tendermint-explained-bringing-bft-based-pos-to-the-public-blockchain-domain-f22e274a0fdb</a>.
Date accessed: 2018‑09‑30.</p>
<p>[<a href="https://github.com/tendermint/tendermint/blob/master/docs/spec/p2p/node.md" title="Tendermint Peer Discovery">7</a>] &quot;Tendermint Peer Discovery&quot; [online]. Available: <a href="https://github.com/tendermint/tendermint/blob/master/docs/spec/p2p/node.md">https://github.com/tendermint/tendermint/blob/master/docs/spec/p2p/node.md</a>. 
Date accessed: 2018‑10‑22.</p>
<p>[<a href="https://en.wikipedia.org/wiki/Paxos_(computer_science)" title="Wikipedia: Paxos">8</a>] Wikipedia: &quot;Paxos&quot; [online]. Available: <a href="https://en.wikipedia.org/wiki/Paxos_(computer_science)">https://en.wikipedia.org/wiki/Paxos_(computer_science)</a>. Date accessed: 
2018‑10‑01.</p>
<p>[<a href="https://en.wikipedia.org/wiki/Chandra%E2%80%93Toueg_consensus_algorithm" title="Wikipedia: Chandra-Toueg Consensus 
Algorithm">9</a>] Wikipedia: &quot;Chandra-Toueg Consensus Algorithm&quot; [online]. Available: 
<a href="https://en.wikipedia.org/wiki/Chandra%E2%80%93Toueg_consensus_algorithm">https://en.wikipedia.org/wiki/Chandra%E2%80%93Toueg_consensus_algorithm</a>. 
Date accessed: 2018‑09‑13.</p>
<p>[<a href="https://en.wikipedia.org/wiki/Raft_(computer_science)" title="Wikipedia: Raft">10</a>] Wikipedia: &quot;Raft&quot; [online]. Available: <a href="https://en.wikipedia.org/wiki/Raft_(computer_science)">https://en.wikipedia.org/wiki/Raft_(computer_science)</a>. Date accessed: 
2018‑09‑13.</p>
<p>[<a href="https://www.usenix.org/legacy/event/nsdi09/tech/full_papers/clement/clement.pdf" title="Making Byzantine Fault Tolerant 
Systems Tolerate Byzantine Faults">11</a>] A. Clement, E. Wong, L. Alvisi, M. Dahlin and M. Marchetti, &quot;Making Byzantine Fault Tolerant Systems Tolerate 
Byzantine Faults&quot; [online]. Available: <a href="https://www.usenix.org/legacy/event/nsdi09/tech/full_papers/clement/clement.pdf">https://www.usenix.org/legacy/event/nsdi09/tech/full_papers/clement/clement.pdf</a>. 
Date accessed 2018‑10‑22.</p>
<p>[<a href="https://www.swirlds.com/downloads/SWIRLDS-TR-2016-01.pdf" title="Hashgraph White Paper">12</a>] L. Baird, &quot;The Swirlds Hashgraph Consensus Algorithm: Fair, Fast, Byzantine Fault Tolerance&quot; [online]. 
Available: <a href="https://www.swirlds.com/downloads/SWIRLDS-TR-2016-01.pdf">https://www.swirlds.com/downloads/SWIRLDS-TR-2016-01.pdf</a>. Date accessed: 2018‑09‑30.</p>
<p>[<a href="https://managementfromscratch.wordpress.com/2016/04/01/introduction-to-gossip/" title="Introduction to Gossip">13</a>] &quot;Just My Thoughts: Introduction to Gossip&quot; [online]. Available: 
<a href="https://managementfromscratch.wordpress.com/2016/04/01/introduction-to-gossip/">https://managementfromscratch.wordpress.com/2016/04/01/introduction-to-gossip/</a>. 
Date accessed 2018‑10‑22.</p>
<p>[<a href="https://www.swirlds.com/downloads/SWIRLDS-TR-2016-01.pdf" title="Swirlds and Sybil Attacks">14</a>] L. Baird, &quot;Swirlds and Sybil Attacks&quot; [online]. Available: <a href="http://www.swirlds.com/downloads/Swirlds-and-Sybil-Attacks.pdf">http://www.swirlds.com/downloads/Swirlds-and-Sybil-Attacks.pdf</a>. 
Date accessed: 2018‑09‑30. </p>
<p>[<a href="https://hackernoon.com/demystifying-hashgraph-benefits-and-challenges-d605e5c0cee5" title="Demystifying Hashgraph: 
Benefits and Challenges">15</a>] Y. Jia, &quot;Demystifying Hashgraph: Benefits and Challenges&quot; [online]. 
Available: <a href="https://hackernoon.com/demystifying-Hashgraph-benefits-and-challenges-d605e5c0cee5">https://hackernoon.com/demystifying-Hashgraph-benefits-and-challenges-d605e5c0cee5</a>. Date accessed: 
2018‑09‑30.</p>
<p>[<a href="https://medium.com/opentoken/hashgraph-a-whitepaper-review-f7dfe2b24647" title="Hashgraph: A Whitepaper Review">16</a>] M. Graczyk, &quot;Hashgraph: A Whitepaper Review&quot; [online]. Available: 
<a href="https://medium.com/opentoken/Hashgraph-a-whitepaper-review-f7dfe2b24647">https://medium.com/opentoken/Hashgraph-a-whitepaper-review-f7dfe2b24647</a>. 
Date accessed: 2018‑09‑30.</p>
<p>[<a href="https://cachin.com/cc/papers/sintra.pdf" title="Secure Intrusion-tolerant Replication 
on the Internet">17</a>] C. Cachin and J. A. Poritz, &quot;Secure Intrusion-tolerant Replication on the Internet&quot; [online]. 
Available: <a href="https://cachin.com/cc/papers/sintra.pdf">https://cachin.com/cc/papers/sintra.pdf</a>. Date accessed: 2018‑10‑22.</p>
<p>[<a href="https://www.shoup.net/papers/ckps.pdf" title="Secure and Efficient Asynchronous Broadcast Protocols">18</a>] C. Cachin, K. Kursawe, F. Petzold and V. Shoup, &quot;Secure and Efficient Asynchronous Broadcast Protocols&quot; [online]. 
Available: <a href="https://www.shoup.net/papers/ckps.pdf">https://www.shoup.net/papers/ckps.pdf</a>. Date accessed 2018‑10‑22.</p>
<p>[<a href="https://arxiv.org/pdf/1607.01341.pdf" title="Algorand White Paper">19</a>] J. Chen and S. Micali, &quot;Algorand&quot; White Paper&quot; [online]. Available: <a href="https://arxiv.org/pdf/1607.01341.pdf">https://arxiv.org/pdf/1607.01341.pdf</a>. 
Date accessed: 2018‑09‑13.</p>
<p>[<a href="https://eprint.iacr.org/2017/913.pdf" title="Thunderella White Paper">20</a>] R. Pass and E. Shi, &quot;Thunderella: Blockchains with Optimistic Instant Confirmation&quot; White Paper [online]. 
Available: <a href="https://eprint.iacr.org/2017/913.pdf">https://eprint.iacr.org/2017/913.pdf</a>. Date accessed: 2018‑09‑13.</p>
<p>[<a href="https://rob-bell.net/2009/06/a-beginners-guide-to-big-o-notation/" title="A Beginner's Guide to Big O Notation">21</a>] &quot;A Beginner's Guide to Big O Notation&quot; [online]. Available: 
<a href="https://rob-bell.net/2009/06/a-beginners-guide-to-big-o-notation/">https://rob-bell.net/2009/06/a-beginners-guide-to-big-o-notation/</a>. 
Date accessed: 2018‑10‑22.</p>
<p>[<a href="http://www.cs.yale.edu/homes/aspnes/papers/jalg90.pdf" title="Fast Randomized Consensus using Shared Memory">22</a>] J. Aspnes and M. Herlihy, &quot;Fast Randomized Consensus using Shared Memory&quot; [online]. 
Available: <a href="http://www.cs.yale.edu/homes/aspnes/papers/jalg90.pdf">http://www.cs.yale.edu/homes/aspnes/papers/jalg90.pdf</a>. Date accessed: 2018‑10‑22.</p>
<p>[<a href="https://github.com/maidsafe/parsec" title="GitHub repository: Protocol for Asynchronous,
Reliable, Secure and Efficient Consensus">23</a>] &quot;Prototol for Asynchronous, Reliable, Secure and Efficient Consensus&quot; [online]. Available: 
<a href="https://github.com/maidsafe/parsec">https://github.com/maidsafe/parsec</a>. 
Date accessed 2018‑10‑22.</p>
<p>[<a href="https://flatoutcrypto.com/home/maidsafeparsecexplanationpt2" title="Project Spotlight: Maidsafe and PARSEC Part 2">24</a>] &quot;Project Spotlight: Maidsafe and PARSEC Part 2&quot; [online]. Available: 
<a href="https://flatoutcrypto.com/home/maidsafeparsecexplanationpt2">https://flatoutcrypto.com/home/maidsafeparsecexplanationpt2</a>. 
Date accessed: 2018‑09‑18.</p>
<p>[<a href="https://www.ccn.com/tag/red-belly-blockchain/" title="Red Belly Blockchain">25</a>] &quot;Red Belly Blockchain&quot; [online]. Available: <a href="https://www.ccn.com/tag/red-belly-blockchain/">https://www.ccn.com/tag/red-belly-blockchain/</a>. Date accessed: 
2018‑10‑10.</p>
<p>[<a href="https://dl.acm.org/citation.cfm?id=198088" title="Asynchronous Secure Computations with 
Optimal Resilience">26</a>] M. Ben-Or, B. Kelmer and T Rabin, &quot;Asynchronous Secure Computations with Optimal Resilience&quot; [online]. 
Available: <a href="https://dl.acm.org/citation.cfm?id=198088">https://dl.acm.org/citation.cfm?id=198088</a>. Date accessed 2018‑10‑22.</p>
<p>[<a href="https://hal.inria.fr/hal-00944019v2/document" title="Signature-Free Asynchronous Byzantine 
Consensus with $t&lt;n/3​$ and *O*(n&lt;sup&gt;2&lt;/sup&gt;) Messages">27</a>] A. Mostefaoui, M.Hamouna and Michel Raynal, &quot;Signature-free Asynchronous Byzantine Consensus with $t&lt;n/3$ and 
<em>O</em>(n<sup>2</sup>) Messages&quot; [online]. Available: <a href="https://hal.inria.fr/hal-00944019v2/document">https://hal.inria.fr/hal-00944019v2/document</a>. 
Date accessed 2018‑10‑22.</p>
<p>[<a href="https://eprint.iacr.org/2016/199.pdf" title="The Honey Badger of BFT Protocols">28</a>] A. Miller, Y. Xia, K. Crowman, E. Shi and D. Song, &quot;The Honey Badger of BFT Protocols&quot;, White Paper [online]. 
Available: <a href="https://eprint.iacr.org/2016/199.pdf">https://eprint.iacr.org/2016/199.pdf</a>. Date accessed: 2018‑08‑30.</p>
<p>[<a href="https://ripple.com/files/ripple_consensus_whitepaper.pdf" title="The Ripple Protocol Consensus 
Algorithm">29</a>] D. Schwartz, N. Youngs and A. Britto, &quot;The Ripple Protocol Consensus Algorithm&quot; [online]. 
Available: <a href="https://ripple.com/files/ripple_consensus_whitepaper.pdf">https://ripple.com/files/ripple_consensus_whitepaper.pdf</a>. Date accessed: 2018‑09‑13.</p>
<p>[<a href="http://the-eye.eu/public/Books/campdivision.com/PDF/Computers%20General/Privacy/bitcoin/tendermint_v05.pdf" title="Tendermint: Consensus without Mining">30</a>] J. Kwon, &quot;TenderMint: Consensus without Mining&quot;  [online]. 
Available: <a href="http://the-eye.eu/public/Books/campdivision.com/PDF/Computers%20General/Privacy/bitcoin/tendermint_v05.pdf">http://the-eye.eu/public/Books/campdivision.com/PDF/Computers%20General/Privacy/bitcoin/tendermint_v05.pdf</a>. 
Date accessed: 2018‑09‑20.</p>
<p>[<a href="https://arxiv.org/pdf/1807.01829.pdf" title="LinBFT: Linear-Communication Byzantine 
Fault Tolerance for Public Blockchains">31</a>] Y. Yang, &quot;LinBFT: Linear-Communication Byzantine Fault Tolerance for Public Blockchains&quot; [online]. 
Available: <a href="https://arxiv.org/pdf/1807.01829.pdf">https://arxiv.org/pdf/1807.01829.pdf</a>. Date accessed: 2018‑09‑20.</p>
<p>[<a href="https://flatoutcrypto.com/home/avalancheprotocol" title="Protocol Spotlight: Avalanche Part 1">32</a>] &quot;Protocol Spotlight: Avalanche Part 1&quot; [online]. Available: <a href="https://flatoutcrypto.com/home/avalancheprotocol">https://flatoutcrypto.com/home/avalancheprotocol</a>. 
Date Accessed: 2018‑09‑09.</p>
<p>[<a href="http://docs.maidsafe.net/Whitepapers/pdf/PARSEC.pdf" title="Protocol for Asynchronous, Reliable, 
Secure and Efficient Consensus (PARSEC)">33</a>] P. Chevalier, B. Kaminski, F. Hutchison, Q. Ma and S. Sharma, &quot;Protocol for Asynchronous, Reliable, Secure and 
Efficient Consensus (PARSEC)&quot;. White Paper [online]. Available: <a href="http://docs.maidsafe.net/Whitepapers/pdf/PARSEC.pdf">http://docs.maidsafe.net/Whitepapers/pdf/PARSEC.pdf</a>. 
Date accessed: 2018‑08‑30.</p>
<p>[<a href="https://medium.com/@flatoutcrypto/project-spotlight-maidsafe-and-parsec-part-1-4830cec8d9e3" title="Project Spotlight: 
Maidsafe and PARSEC Part 1">34</a>] &quot;Project Spotlight: Maidsafe and PARSEC Part 1&quot; [online]. 
Available: <a href="https://medium.com/@flatoutcrypto/project-spotlight-maidsafe-and-parsec-part-1-4830cec8d9e3">https://medium.com/@flatoutcrypto/project-spotlight-maidsafe-and-parsec-part-1-4830cec8d9e3</a>. 
Date accessed: 2018‑08‑30.</p>
<p>[<a href="https://people.csail.mit.edu/silvio/Selected%20Scientific%20Papers/Distributed%20Computation/BYZANTYNE%20AGREEMENT%20MADE%20TRIVIAL.pdf" title="Byzantine Agreement Made Trivial">35</a>] S. Micali, &quot;Byzantine Agreement Made Trivial&quot; [online]. Available: <a href="https://people.csail.mit.edu/silvio/Selected%20Scientific%20Papers/Distributed%20Computation/BYZANTYNE%20AGREEMENT%20MADE%20TRIVIAL.pdf">https://people.csail.mit.edu/silvio/Selected%20Scientific%20Papers/Distributed%20Computation/BYZANTYNE%20AGREEMENT%20MADE%20TRIVIAL.pdf</a>. 
Date accessed: 2018‑08‑30.</p>
<p>[<a href="http://gramoli.redbellyblockchain.io/web/doc/pubs/DBFT-preprint.pdf" title="DBFT: Efficient Byzantine Consensus 
with a Weak Coordinator and its Application 
to Consortium Blockchains">36</a>] T. Crain, V. Gramoli, M. Larrea and M. Raynal, &quot;DBFT: Efficient Byzantine Consensus with a Weak Coordinator and 
its Application to Consortium Blockchains&quot; [online]. Available: <a href="http://gramoli.redbellyblockchain.io/web/doc/pubs/DBFT-preprint.pdf">http://gramoli.redbellyblockchain.io/web/doc/pubs/DBFT-preprint.pdf</a>. 
Date accessed: 2018‑09‑30.</p>
<p>[<a href="https://en.wikipedia.org/wiki/Byzantine_fault_tolerance" title="Byzantine Fault Tolerance, Wikipedia">37</a>] Wikipedia: &quot;Byzantine Fault Tolerance&quot; [online]. Available: <a href="https://en.wikipedia.org/wiki/Byzantine_fault_tolerance">https://en.wikipedia.org/wiki/Byzantine_fault_tolerance</a>. 
Date accessed: 2018‑09‑30.</p>
<p>[<a href="https://en.wikipedia.org/wiki/Liveness" title="Liveness, Wikipedia">38</a>] Wikipedia: &quot;Liveness&quot; [online]. Available: <a href="https://en.wikipedia.org/wiki/Liveness">https://en.wikipedia.org/wiki/Liveness</a>. Date accessed: 
2018‑09‑30.</p>
<p>[<a href="https://ipfs.io/ipfs/QmUy4jh5mGNZvLkjies1RWM4YuvJh5o2FYopNPVYwrRVGV" title="Snowflake to Avalanche...">39</a>] Team Rocket, &quot;Snowflake to Avalanche: A Novel Metastable Consensus Protocol Family for
Cryptocurrencies&quot; [online]. Available: <a href="https://ipfs.io/ipfs/QmUy4jh5mGNZvLkjies1RWM4YuvJh5o2FYopNPVYwrRVGV">https://ipfs.io/ipfs/QmUy4jh5mGNZvLkjies1RWM4YuvJh5o2FYopNPVYwrRVGV</a>. Date 
accessed: 2018‑09‑30.</p>
<h2><a class="header" href="#appendices-3" id="appendices-3">Appendices</a></h2>
<h3><a class="header" href="#appendix-a-terminology" id="appendix-a-terminology">Appendix A: Terminology</a></h3>
<p>In order to gain a full understanding of the field of consensus mechanisms, specifically BFT consensus mechanisms, 
certain terms and concepts need to be defined and fleshed out.</p>
<h4><a class="header" href="#consensus" id="consensus">Consensus</a></h4>
<p>Distributed agents (these could be computers, generals coordinating an attack, or sensors in a nuclear plant) that 
communicate via a network (be it digital, courier or mechanical) need to agree on facts in order to act
as a coordinated whole.</p>
<p>When all non-faulty agents agree on a given fact, then we say that the network is in consensus. Consensus is achieved 
when all non-faulty agents agree on a prescribed fact. </p>
<p>A consensus protocol may adhere to a host of formal requirements, including:</p>
<ul>
<li><strong>Agreement</strong> - where all correct processes agree on the same fact. </li>
<li><strong>Weak Validity</strong> - where, for all correct processes, the output must be the input for some correct process.</li>
<li><strong>Strong Validity</strong> - where, if all correct processes receive the same input value, they must all output that value.</li>
<li><strong>Termination</strong> - where all processes must eventually decide on an output value [<a href="https://en.wikipedia.org/wiki/Consensus_(computer_science)" title="Wikipedia: Consensus Mechanisms">2</a>].</li>
</ul>
<h4><a class="header" href="#binary-consensus" id="binary-consensus">Binary Consensus</a></h4>
<p>There is a unique case of the consensus problem, referred to as the binary consensus, which restricts the input and 
hence the output domain to a single binary digit {0,1}. </p>
<p>When the input domain is large, relative to the number of processes, e.g. an input set of all the natural numbers, it 
can be shown that consensus is impossible in a synchronous message passing model [<a href="https://en.wikipedia.org/wiki/Consensus_(computer_science)" title="Wikipedia: Consensus Mechanisms">2</a>].</p>
<h4><a class="header" href="#byzantine-fault-tolerance" id="byzantine-fault-tolerance">Byzantine Fault Tolerance</a></h4>
<p>Byzantine failures are considered the most general and most difficult class of failures among the failure modes. The 
so-called fail-stop failure mode occupies the simplest end of the spectrum. Whereas fail-stop failure mode simply means 
that the only way to fail is a node crash, detected by other nodes, Byzantine failures imply no restrictions, which 
means that the failed node can generate arbitrary data, pretending to be a correct one. Thus, Byzantine failures can 
confuse failure detection systems, which makes fault tolerance difficult [<a href="https://en.wikipedia.org/wiki/Byzantine_fault_tolerance" title="Byzantine Fault Tolerance, Wikipedia">37</a>]. </p>
<p>Several papers in the literature contextualize the problem using generals at different camps, situated outside the enemy 
castle, needing to decide whether or not to attack. A consensus algorithm that would fail, would perhaps see one general 
attack while all the others stay back, resulting in the vulnerability of first general. </p>
<p>One key property of a blockchain system is that the nodes do not trust each other, meaning that some may behave in 
a Byzantine manner. The consensus protocol must therefore tolerate Byzantine failures. </p>
<p>A network is Byzantine Fault Tolerant (BFT) when it can provide service and reach a consensus despite faults or failures 
of the system. The processes use a protocol for consensus or atomic broadcast (a broadcast where all correct processes 
in a system of multiple processes receive the same set of messages in the same order); i.e. the same sequence of 
messages [[46]]) agree on a common sequence of operations to execute [<a href="https://eprint.iacr.org/2017/913.pdf" title="Thunderella White Paper">20</a>].</p>
<p>The literature on distributed consensus is vast, and there are many variants of previously proposed protocols being 
developed for blockchains. They can be largely classified along a spectrum:</p>
<ul>
<li>
<p>One extreme consists of purely 
computation-based protocols, which use proof of computation to randomly select a node that single-handedly decides the 
next operation.</p>
</li>
<li>
<p>The other extreme is purely communication-based protocols, in which nodes have equal votes and go 
through multiple rounds of communication to reach consensus, Practical Byzantine Fault Tolerance (PBFT) being the prime 
example, 
which is a replication algorithm designed to be BFT [<a href="https://en.wikipedia.org/wiki/Raft_(computer_science)" title="Wikipedia: Raft">10</a>].</p>
</li>
</ul>
<p>For systems with <em>n</em> nodes, of which <em>f</em> are Byzantine, it has been shown that <em>no algorithm exists</em> that solves the 
consensus problem for <em>f &gt; n/3</em> [<a href="https://rob-bell.net/2009/06/a-beginners-guide-to-big-o-notation/" title="A Beginner's Guide to Big O Notation">21</a>].</p>
<p>So how then does the Bitcoin protocol get away with only needing 51% honest nodes to reach consensus? Well, strictly 
speaking, Bitcoin is NOT a BFT-CM, because there is never absolute finality in bitcoin ledgers; there is 
always a chance (however small) that someone can 51% attack the network and rewrite the entire history. Bitcoin is a 
probabilistic consensus, rather than deterministic.</p>
<h4><a class="header" href="#practical-byzantine-fault-tolerant-variants" id="practical-byzantine-fault-tolerant-variants">Practical Byzantine Fault-tolerant Variants</a></h4>
<p>PoW suffers from non-finality, i.e. a block appended to a blockchain is not confirmed until it is extended by many other 
blocks. Even then, its existence in the blockchain is only probabilistic. For example, eclipse attacks on Bitcoin 
exploit this probabilistic guarantee to allow double spending. In contrast, the original PBFT protocol is 
deterministic [<a href="https://en.wikipedia.org/wiki/Raft_(computer_science)" title="Wikipedia: Raft">10</a>].</p>
<h4><a class="header" href="#deterministic-and-non-deterministic-protocols" id="deterministic-and-non-deterministic-protocols">Deterministic and Non-deterministic Protocols</a></h4>
<p>Deterministic, bounded Byzantine agreement relies on consensus being finalized for each epoch before moving to the next 
one, ensuring that there is some safety about a consensus reference point prior to continuing. If, instead, you allow an 
unbounded number of consensus agreements within the same epoch, then there is no overall consensus reference point with 
which to declare finality, and thus safety is compromised [<a href="https://en.wikipedia.org/wiki/Paxos_(computer_science)" title="Wikipedia: Paxos">8</a>].</p>
<p>For non-deterministic or probabilistic protocols, the probability that an honest node is undecided after <em>r</em> rounds 
approaches zero as r approaches infinity.</p>
<p>Non-deterministic protocols that solve consensus under the purely asynchronous case potentially rely on random oracles 
and generally incur high message complexity overhead, as they depend on reliable broadcasting for all communication.</p>
<p>Protocols such as HoneyBadgerBFT fall into this class of nondeterministic protocols under asynchrony. Normally, they 
require three instances of reliable broadcast for a single round of communication [<a href="https://blog.cosmos.network/tendermint-explained-bringing-bft-based-pos-to-the-public-blockchain-domain-f22e274a0fdb" title="Tendermint Explained - Bringing BFT-based
PoS to the Public Blockchain Domain">6</a>].</p>
<h4><a class="header" href="#scalability-performance-trade-off" id="scalability-performance-trade-off">Scalability-Performance Trade-off</a></h4>
<p>As briefly mentioned in the <a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#introduction">Introduction</a>, the scalability of BFT protocols considering the number of 
participants is highly limited and the performance of most protocols deteriorates as the number of involved replicas 
increases. This effect is especially problematic for BFT deployment in permissionless blockchains [<a href="https://github.com/tendermint/tendermint/blob/master/docs/spec/p2p/node.md" title="Tendermint Peer Discovery">7</a>].</p>
<p>The problem of BFT scalability is twofold: a high throughput, as well as a large consensus group with good 
reconfigurability that can tolerate a high number of failures are both desirable properties in BFT protocols. However, 
they are often in direct conflict. </p>
<p>Bitcoin mining, for example, supports thousands of participants, offers good reconfigurability, i.e. nodes can join or 
leave the network at any time, and can tolerate a high number of failures. However, they are only able to process a 
severely limited number of transactions per second. Most BFT protocols achieve a significantly higher throughput, but 
are limited to small groups of participants of less than 20 nodes and the group reconfiguration is not easily achievable. </p>
<p>Several approaches have been employed to remedy these problems, e.g. threshold cryptography, creating new consensus 
groups for every round and limiting the number of necessary messages to reach consensus [<a href="http://conferences.inf.ed.ac.uk/EuroDW2018/papers/eurodw18-Rusch.pdf" title="High-Performance Consensus Mechanisms for 
Blockchains">3</a>].</p>
<h3><a class="header" href="#appendix-b-timing-assumptions" id="appendix-b-timing-assumptions">Appendix B: Timing Assumptions</a></h3>
<h4><a class="header" href="#forms-of-timing-assumptions---degrees-of-synchrony" id="forms-of-timing-assumptions---degrees-of-synchrony">Forms of Timing Assumptions - Degrees of Synchrony</a></h4>
<h5><a class="header" href="#synchrony" id="synchrony">Synchrony</a></h5>
<p>Here, the time for nodes to wait and receive information is predefined. If a node has not received an input within the 
redefined time structure, there is a problem [<a href="https://ieeexplore.ieee.org/document/8014672/" title="Survey of Consensus Protocols of Blockchain Applications,
4th International Conference on Advanced Computing 
and Communication Systems.">5</a>].</p>
<p>In synchronous systems, it is assumed that all communications proceed in rounds. In one round, a process may send all 
the messages it requires, while receiving all messages from other processes. In this manner, no message from one round 
may influence any messages sent within the same round [<a href="https://rob-bell.net/2009/06/a-beginners-guide-to-big-o-notation/" title="A Beginner's Guide to Big O Notation">21</a>].</p>
<p>A △T-synchronous network guarantees that every message sent is delivered after, at most, a delay of △T (where △T is a 
measure of real time) [<a href="https://blog.cosmos.network/tendermint-explained-bringing-bft-based-pos-to-the-public-blockchain-domain-f22e274a0fdb" title="Tendermint Explained - Bringing BFT-based
PoS to the Public Blockchain Domain">6</a>]. Synchronous protocols come to a consensus after △T [<a href="https://ieeexplore.ieee.org/document/8014672/" title="Survey of Consensus Protocols of Blockchain Applications,
4th International Conference on Advanced Computing 
and Communication Systems.">5</a>].</p>
<h5><a class="header" href="#partial-synchrony" id="partial-synchrony">Partial Synchrony</a></h5>
<p>Here, the network retains some form of a predefined timing structure. However, it can operate without knowing said 
assumption of how fast nodes can exchange messages over the network. Instead of pushing out a block every x seconds, a 
partially synchronous blockchain would gauge the limit, with messages always being sent and received within the unknown 
deadline. </p>
<p>Partially synchronous protocols come to a consensus in an unknown, but finite period [<a href="https://ieeexplore.ieee.org/document/8014672/" title="Survey of Consensus Protocols of Blockchain Applications,
4th International Conference on Advanced Computing 
and Communication Systems.">5</a>].</p>
<h6><a class="header" href="#unknown-t-model" id="unknown-t-model">Unknown-△T Model</a></h6>
<p>The protocol is unable to use the delay bound as a parameter [<a href="https://blog.cosmos.network/tendermint-explained-bringing-bft-based-pos-to-the-public-blockchain-domain-f22e274a0fdb" title="Tendermint Explained - Bringing BFT-based
PoS to the Public Blockchain Domain">6</a>]. </p>
<h6><a class="header" href="#eventually-synchronous" id="eventually-synchronous">Eventually Synchronous</a></h6>
<p>The message delay bound △ is only guaranteed to hold after some (unknown instant, called the &quot;Global Stabilization 
Time&quot; [<a href="https://blog.cosmos.network/tendermint-explained-bringing-bft-based-pos-to-the-public-blockchain-domain-f22e274a0fdb" title="Tendermint Explained - Bringing BFT-based
PoS to the Public Blockchain Domain">6</a>].</p>
<h5><a class="header" href="#weak-synchrony" id="weak-synchrony">Weak Synchrony</a></h5>
<p>Most existing BFT systems, even those called &quot;robust&quot;, assume some variation of <em>weak synchrony</em>, where messages are 
guaranteed to be delivered after a certain bound △T, but △T may be time-varying or unknown to the protocol designer. </p>
<p>However, the liveness properties of weakly synchronous protocols can fail completely when the expected timing assumptions 
are violated, e.g. due to a malicious network adversary. In general, liveness refers to a set of properties of concurrent 
systems, that require a system to make progress despite the fact that its concurrently executing components may have to 
&quot;take turns&quot; in critical sections. These are parts of the program that cannot be simultaneously run by multiple 
components [<a href="https://en.wikipedia.org/wiki/Liveness" title="Liveness, Wikipedia">38</a>]. </p>
<p>Even when the weak synchrony assumptions are satisfied in practice, weakly synchronous protocols degrade significantly in 
throughput when the underlying network is unpredictable. Unfortunately, weakly asynchronous protocols require timeout 
parameters that are difficult to tune, especially in cryptocurrency application settings; and when the chosen timeout 
values are either too long or too short, throughput can be hampered. </p>
<p>In terms of feasibility, both weak and partially synchronous protocols are equivalent. A protocol that succeeds in one 
setting can be systematically adapted for another. In terms of concrete performance, however, adjusting for weak 
synchrony means gradually increasing the timeout parameter over time, e.g. by an exponential back-off policy. This 
results in delays when recovering from transient network partition. Protocols typically manifest these assumptions in 
the form of a timeout event. For example, if parties detect that no progress has been made within a certain interval, 
then they take a corrective action such as electing a new leader. Asynchronous protocols do not rely on timers, and make 
progress whenever messages are delivered, regardless of actual clock time [<a href="https://blog.cosmos.network/tendermint-explained-bringing-bft-based-pos-to-the-public-blockchain-domain-f22e274a0fdb" title="Tendermint Explained - Bringing BFT-based
PoS to the Public Blockchain Domain">6</a>].</p>
<h5><a class="header" href="#random-synchrony" id="random-synchrony">Random Synchrony</a></h5>
<p>Messages are delivered with random delays, such that the average delay is finite. There may be periods of arbitrarily 
long days (this is a weaker assumption than weak synchrony, and only a bit stronger than full asynchrony, where the only 
guarantee is that messages are eventually delivered). It is impossible to tell whether an instance has failed by 
completely stopping, or if there is just a delay in message delivery [<a href="https://bitcoinist.com/breaking-down-the-scalability-trilemma/" title="Breaking down the Blockchain 
Scalability Trilemma">1</a>].</p>
<h5><a class="header" href="#asynchrony" id="asynchrony">Asynchrony</a></h5>
<h6><a class="header" href="#asynchronous-networks-and-protocols" id="asynchronous-networks-and-protocols">Asynchronous Networks and Protocols</a></h6>
<p>In an asynchronous network, the adversary can deliver messages in any order and at any time. However, the message must 
eventually be delivered between correct nodes. Nodes in an asynchronous network effectively have no use for real-time 
clocks, and can only take actions based on the ordering of messages they receive [<a href="https://blog.cosmos.network/tendermint-explained-bringing-bft-based-pos-to-the-public-blockchain-domain-f22e274a0fdb" title="Tendermint Explained - Bringing BFT-based
PoS to the Public Blockchain Domain">6</a>]. The speed is determined by the 
speed at which the network communicates, instead of a fixed limit of x seconds. </p>
<p>An asynchronous protocol requires a different means to decide when all nodes are able to come to a consensus.</p>
<p>As will be discussed in <a href="consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html#flp-impossibility">FLP Impossibility</a>, FLP result rules out the possibility of the 
deterministic asynchronous protocols for atomic broadcast and many other tasks. A deterministic protocol must therefore 
make some stronger timing assumptions [<a href="https://blog.cosmos.network/tendermint-explained-bringing-bft-based-pos-to-the-public-blockchain-domain-f22e274a0fdb" title="Tendermint Explained - Bringing BFT-based
PoS to the Public Blockchain Domain">6</a>].</p>
<h6><a class="header" href="#counting-rounds-in-asynchronous-networks" id="counting-rounds-in-asynchronous-networks">Counting Rounds in Asynchronous Networks</a></h6>
<p>Although the guarantee of eventual delivery is decoupled from notions of &quot;real time&quot;, it is nonetheless desirable to 
characterize the running time of asynchronous protocols. The standard approach is for the adversary to assign each 
message a virtual round number, subject to the condition that every (<em>r</em>-1) message between correct nodes must be 
delivered before any (<em>r</em>+1) message is sent. </p>
<h4><a class="header" href="#problem-with-timing-assumptions" id="problem-with-timing-assumptions">Problem with Timing Assumptions</a></h4>
<h5><a class="header" href="#general" id="general">General</a></h5>
<p>The problem with both synchronous and partially synchronous assumptions is that &quot;the protocols based on timing 
assumptions are unsuitable for decentralized, cryptocurrency settings, where network links can be unreliable, network 
speeds change rapidly, and network delays may even be adversarially induced&quot; [<a href="https://blog.cosmos.network/tendermint-explained-bringing-bft-based-pos-to-the-public-blockchain-domain-f22e274a0fdb" title="Tendermint Explained - Bringing BFT-based
PoS to the Public Blockchain Domain">6</a>].</p>
<h5><a class="header" href="#denial-of-service-attack" id="denial-of-service-attack">Denial of Service Attack</a></h5>
<p>Basing a protocol on timings, exposes the network to Denial of Service (DoS) attacks. A synchronous protocol will be 
deemed unsafe if a DoS slows down the network sufficiently. Even though a partially synchronous protocol would be safe, 
it would be unable to operate, as the messages would be exposed to interference. </p>
<p>An asynchronous protocol would be able to function under a DoS attack. However, it is difficult to reach consensus, as 
it is impossible to know if the network is under attack, or if a particular message is delayed by the protocol itself. </p>
<h4><a class="header" href="#flp-impossibility" id="flp-impossibility">FLP Impossibility</a></h4>
<p>Reference [<a href="http://www.cs.yale.edu/homes/aspnes/papers/jalg90.pdf" title="Fast Randomized Consensus using Shared Memory">22</a>] maps out what it is possible to achieve with distributed processes in an asynchronous environment. </p>
<p>The result, referred to as the FLP result, which raised the problem of consensus, i.e. getting a distributed network of 
processors to agree on a common value. This problem was known to be solvable in a synchronous setting, where processes 
could proceed in simultaneous steps. The synchronous solution was seen as resilient to faults, where processors crash 
and take no further part in the computation. Synchronous models allow failures to be detected by waiting one entire step 
length for a reply from a processor, and presuming that it has crashed if no reply is received. </p>
<p>This kind of failure detection is not possible in an asynchronous setting, as there are no bounds on the amount of time 
a processor might take to complete its work and then respond. The FLP result shows that in an asynchronous setting, 
where only one processor might crash, there is no distributed algorithm that solves the consensus problem [<a href="https://github.com/maidsafe/parsec" title="GitHub repository: Protocol for Asynchronous,
Reliable, Secure and Efficient Consensus">23</a>].</p>
<h4><a class="header" href="#randomized-agreement" id="randomized-agreement">Randomized Agreement</a></h4>
<p>The consensus problem involves an asynchronous system of processes, some of which may be unreliable. The problem is for 
the reliable processes to agree on a binary value. Every protocol for this problem has the possibility of 
nontermination [<a href="http://www.cs.yale.edu/homes/aspnes/papers/jalg90.pdf" title="Fast Randomized Consensus using Shared Memory">22</a>]. While the vast majority of PBFT protocols steer clear of this impossibility result by making 
timing assumptions, randomness (and, in particular, cryptography) provides an alternative route. Asynchronous BFT 
protocols have been used for a variety of tasks such as binary agreement (ABA), reliable broadcast (RBC) and more [<a href="https://blog.cosmos.network/tendermint-explained-bringing-bft-based-pos-to-the-public-blockchain-domain-f22e274a0fdb" title="Tendermint Explained - Bringing BFT-based
PoS to the Public Blockchain Domain">6</a>].</p>
<h2><a class="header" href="#contributors-7" id="contributors-7">Contributors</a></h2>
<ul>
<li><a href="https://github.com/kevoulee">https://github.com/kevoulee</a></li>
<li><a href="https://github.com/CjS77">https://github.com/CjS77</a></li>
<li><a href="https://github.com/hansieodendaal">https://github.com/hansieodendaal</a></li>
<li><a href="https://github.com/anselld">https://github.com/anselld</a></li>
</ul>
<h1><a class="header" href="#scaling" id="scaling">Scaling</a></h1>
<h2><a class="header" href="#purpose-2" id="purpose-2">Purpose</a></h2>
<p>The blockchain scalability problem refers to the discussion concerning the limits on the transaction throughput a 
blockchain network can process. It is related to the fact that records (known as blocks) in the bitcoin blockchain are 
limited in size and frequency [<a href="https://en.wikipedia.org/wiki/Bitcoin_scalability_problem" title="Bitcoin Scalability Problem">1</a>].</p>
<h2><a class="header" href="#definitions-2" id="definitions-2">Definitions</a></h2>
<ul>
<li>
<p>From <strong>Bitcoin StackExchange</strong>: The term &quot;on-chain scaling&quot; is frequently used to exclusively refer to 
increasing the blockchain capacity by means of bigger blocks. However, in the literal sense of the term, it should refer 
to any sort of protocol change that improves the network's capacity at the blockchain layer. These approaches tend to 
provide at most a linear capacity increase, although some are also scalability improvements [<a href="https://bitcoin.stackexchange.com/questions/63375/what-is-the-difference-between-on-chain-scaling-and-off-chain-scaling" title="What is the Difference between On-chain 
Scaling and Off-chain Scaling?">2</a>].</p>
<p>Examples:</p>
<ul>
<li>blocksize/blockweight increase;</li>
<li>witness discount of segregated witness;</li>
<li>smaller size of Schnorr signatures;</li>
<li>Bellare-Neven signature aggregation;</li>
<li>key aggregation.</li>
</ul>
</li>
<li>
<p>From <strong>Tari Labs</strong>: 
Analogous to the OSI layers for communication, in blockchain technology decentralized Layer 2 protocols, also commonly 
referred to as Layer 2 scaling, refers to transaction throughput scaling solutions. Decentralized Layer 2 protocols run 
on top of the main blockchain (off-chain), while preserving the attributes of the main blockchain (e.g. crypto-economic 
consensus). Instead of each transaction, only the resultant of a number of transactions is embedded on-chain [<a href="scaling/layer2scaling-landscape/layer2scaling-survey.html#what-is-layer-2-scaling" title="Layer 2 Scaling Survey - 
What is Layer 2 Scaling?">3</a>].</p>
</li>
</ul>
<h2><a class="header" href="#references-11" id="references-11">References</a></h2>
<p>[<a href="https://en.wikipedia.org/wiki/Bitcoin_scalability_problem" title="Bitcoin Scalability Problem">1</a>] Wikipedia: &quot;Bitcoin Scalability Problem&quot; [online]. Available: <a href="https://en.wikipedia.org/wiki/Bitcoin_scalability_problem">https://en.wikipedia.org/wiki/Bitcoin_scalability_problem</a>. 
Date accessed: 2019‑06‑11.</p>
<p>[<a href="https://bitcoin.stackexchange.com/questions/63375/what-is-the-difference-between-on-chain-scaling-and-off-chain-scaling" title="What is the Difference between On-chain 
Scaling and Off-chain Scaling?">2</a>] Bitcoin StackExchange: &quot;What is the Difference between On-chain Scaling and Off-chain Scaling?&quot; [online]. 
Available: <a href="https://bitcoin.stackexchange.com/questions/63375/what-is-the-difference-between-on-chain-scaling-and-off-chain-scaling">https://bitcoin.stackexchange.com/questions/63375/what-is-the-difference-between-on-chain-scaling-and-off-chain-scaling</a>. 
Date accessed: 2019‑06‑10.</p>
<p>[<a href="scaling/layer2scaling-landscape/layer2scaling-survey.html#what-is-layer-2-scaling" title="Layer 2 Scaling Survey - 
What is Layer 2 Scaling?">3</a>] Tari Labs: &quot;Layer 2 Scaling Survey - What is Layer 2 Scaling?&quot; [online]. 
Available: <a href="scaling/layer2scaling-landscape/layer2scaling-survey.html#what-is-layer-2-scaling">layer2scaling-landscape/layer2scaling-survey.html#what-is-layer-2-scaling</a>. 
Date accessed: 2019‑06‑10.</p>
<h1><a class="header" href="#layer-2-scaling-survey" id="layer-2-scaling-survey">Layer 2 Scaling Survey</a></h1>
<ul>
<li><a href="scaling/layer2scaling-landscape/layer2scaling-survey.html#what-is-layer-2-scaling">What is Layer 2 Scaling?</a></li>
<li><a href="scaling/layer2scaling-landscape/layer2scaling-survey.html#how-will-this-be-applicable-to-tari">How will this be Applicable to Tari?</a></li>
<li><a href="scaling/layer2scaling-landscape/layer2scaling-survey.html#layer-2-scaling-current-initiatives">Layer 2 Scaling Current Initiatives</a>
<ul>
<li><a href="scaling/layer2scaling-landscape/layer2scaling-survey.html#micropayment-channels">Micropayment Channels</a></li>
<li><a href="scaling/layer2scaling-landscape/layer2scaling-survey.html#state-channels">State Channels</a></li>
<li><a href="scaling/layer2scaling-landscape/layer2scaling-survey.html#off-chain-matching-engines">Off-chain Matching Engines</a></li>
<li><a href="scaling/layer2scaling-landscape/layer2scaling-survey.html#masternodes">Masternodes</a></li>
<li><a href="scaling/layer2scaling-landscape/layer2scaling-survey.html#plasma">Plasma</a></li>
<li><a href="scaling/layer2scaling-landscape/layer2scaling-survey.html#truebit">TrueBit</a></li>
<li><a href="scaling/layer2scaling-landscape/layer2scaling-survey.html#tumblebit">TumbleBit</a></li>
<li><a href="scaling/layer2scaling-landscape/layer2scaling-survey.html#counterparty">Counterparty</a></li>
<li><a href="scaling/layer2scaling-landscape/layer2scaling-survey.html#2-way-pegged-secondary-blockchains">2-Way Pegged Secondary Blockchains</a></li>
<li><a href="scaling/layer2scaling-landscape/layer2scaling-survey.html#lumino">Lumino</a></li>
<li><a href="scaling/layer2scaling-landscape/layer2scaling-survey.html#scriptless-scripts">Scriptless Scripts</a></li>
<li><a href="scaling/layer2scaling-landscape/layer2scaling-survey.html#directed-acyclic-graph-dag-derivative-protocols">Directed Acyclic Graph (DAG) Derivative Protocols</a></li>
</ul>
</li>
<li><a href="scaling/layer2scaling-landscape/layer2scaling-survey.html#observations">Observations</a></li>
<li><a href="scaling/layer2scaling-landscape/layer2scaling-survey.html#references">References</a></li>
<li><a href="scaling/layer2scaling-landscape/layer2scaling-survey.html#contributors">Contributors</a></li>
</ul>
<h2><a class="header" href="#what-is-layer-2-scaling" id="what-is-layer-2-scaling">What is Layer 2 Scaling?</a></h2>
<p>In the blockchain and cryptocurrency world, transaction processing scaling is a tough problem to solve. This is limited 
by the average block creation time, the block size limit, and the number of newer blocks needed to confirm a transaction 
(confirmation time). These factors make &quot;<em>over the counter</em>&quot; type transactions similar to Master Card or Visa nearly 
impossible if done on the main blockchain (on-chain).</p>
<p align="center"><img src="scaling/layer2scaling-landscape/sources/waiting.png" width="470" /></p>
<p>Let's postulate that blockchain and cryptocurrency &quot;take over the world&quot; and are responsible for all global non-cash 
transactions performed, i.e. 433.1 billion in 2014 to 2015 [<a href="https://worldpaymentsreport.com/" title="World Payments Report 2017, © 2017
Capgemini and BNP Paribas">24</a>]. This means 13,734 transactions per second (tx/s) on 
average! <em>(To put this into perspective, VisaNet currently processes 160 billion transactions per year [<a href="https://usa.visa.com/visa-everywhere/innovation/contactless-payments-around-the-globe.html" title="VISA">25</a>] and is 
capable of handling more than 65,000 transaction messages per second [<a href="https://usa.visa.com/dam/VCOM/download/corporate/media/visanet-technology/visa-net-fact-sheet.pdf" title="VisaNet Fact Sheet 2017 Q4">26</a>].)</em> This means that if all of those were 
simple single-input-single-output non-cash transactions and performed on:</p>
<ul>
<li>
<p>SegWit-enabled Bitcoin &quot;like&quot; blockchains that can theoretically handle ~21.31tx/s, we would need ~644 parallel 
versions, and with a SegWit transaction size of 190 bytes [<a href="https://bitcoin.stackexchange.com/questions/59408/with-100-segwit-transactions-what-would-be-the-max-number-of-transaction-confi" title="With 100% segwit transactions, 
what would be the max number of 
transaction confirmation possible 
on a block?">27</a>], the combined blockchain growth would be <em>~210GB per 
day</em>! </p>
</li>
<li>
<p>Ethereum &quot;like&quot; blockchains, and taking current gas prices into account, Ethereum can theoretically process ~25.4tx/s, 
then ~541 parallel versions would be needed and, with a transaction size of 109 bytes ([<a href="https://bitsonblocks.net/2016/10/02/a-gentle-introduction-to-ethereum/" title="A Gentle Introduction to Ethereum">28</a>], [<a href="https://ethereum.stackexchange.com/questions/30175/what-is-the-size-bytes-of-a-simple-ethereum-transaction-versus-a-bitcoin-trans?rq=1" title="What is the size (bytes) of 
a simple Ethereum transaction 
versus a Bitcoin transaction?">29</a>]), the combined 
blockchain growth would be <em>~120GB per day</em>!</p>
</li>
</ul>
<p>This is why we need a proper scaling solution that would not bloat the blockchain.</p>
<p>The Open Systems Interconnection (OSI) model defines seven layers for communication functions of a computing system. 
Layer 1 refers to the physical layer and Layer 2 to the data link layer. Layer 1 is never concerned with 
functions of Layer 2 and up; it just delivers transmission and reception of raw data. In turn, Layer 2 only 
knows about Layer 1 and defines the protocols that deliver node-to-node data transfer [<a href="https://en.wikipedia.org/wiki/OSI_model" title="OSI Mode">1</a>].</p>
<p align="center"><img src="scaling/layer2scaling-landscape/sources/OSI_Model.png" width="770" /></p>
<p>Analogous to the OSI layers for communication, in blockchain technology, decentralized Layer 2 protocols, also commonly 
referred to as Layer 2 scaling, refers to transaction throughput scaling solutions. Decentralized Layer 2 
protocols run on top of the main blockchain (off-chain), while preserving the attributes of the main blockchain 
(e.g. crypto-economic consensus). Instead of each transaction, only the result of a number of transactions is embedded 
on-chain [<a href="https://www.microsoft.com/en-us/microsoft-365/blog/2018/02/12/decentralized-digital-identities-and-blockchain-the-future-as-we-see-it/" title="Decentralized Digital Identities and 
Block Chain - The Future as We See It">2</a>].</p>
<p align="center"><img src="scaling/layer2scaling-landscape/sources/layer2scaling.png" width="620" /></p>
<p>Also:</p>
<ul>
<li>
<p>Does every transaction need every parent blockchain node in the world to verify it?</p>
</li>
<li>
<p>Would I be willing to have (temporary) lower security guarantees for most of my day-to-day transactions if I could get 
them validated (whatever we take that to mean) near-instantly?</p>
</li>
</ul>
<p>If you can answer &quot;no&quot; and &quot;yes&quot;, then you're looking for a Layer 2 scaling solution.</p>
<h2><a class="header" href="#how-will-this-be-applicable-to-tari" id="how-will-this-be-applicable-to-tari">How will this be Applicable to Tari?</a></h2>
<p>Tari is a high-throughput protocol that will need to handle real-world transaction volumes. For example, Big Neon, the 
initial business application to be built on top of the Tari blockchain, requires high-volume transactions in a short 
time, especially when tickets sales open and when tickets will be redeemed at an event. Imagine filling an 85,000 seat 
stadium with 72 entrance queues on match days. Serialized real-world scanning boils down to approximately 500 tickets in four minutes, 
or approximately two spectators allowed access per second per queue.</p>
<p>This would be impossible to do with parent blockchain scaling solutions.</p>
<h2><a class="header" href="#layer-2-scaling-current-initiatives" id="layer-2-scaling-current-initiatives">Layer 2 Scaling Current Initiatives</a></h2>
<h3><a class="header" href="#micropayment-channels" id="micropayment-channels">Micropayment Channels</a></h3>
<p><em>What are they?</em></p>
<p>A micropayment channel is a class of techniques designed to allow users to make multiple Bitcoin transactions without 
committing all of the transactions to the Bitcoin blockchain. In a typical payment channel, only two transactions are 
added to the blockchain, but an unlimited or nearly unlimited number of payments can be made between the participants [<a href="https://en.bitcoin.it/wiki/Payment_channels" title="Payment Channels">10</a>].</p>
<p>Several channel designs have been proposed or implemented over the years, including:</p>
<ul>
<li>Nakamoto high-frequency transactions; </li>
<li>Spillman-style payment channels; </li>
<li>CLTV-style payment channels;</li>
<li>Poon-Dryja payment channels; </li>
<li>Decker-Wattenhofer duplex payment channels; </li>
<li>Decker-Russell-Osuntokun eltoo channels; </li>
<li>Hashed Time-Locked Contracts (HTLCs).</li>
</ul>
<p>With specific focus on Hashed Time-Locked Contracts:
This technique can allow payments to be securely routed across multiple payment channels. HTLCs are integral to the 
design of more advanced payment channels such as those used by the 
<a href="scaling/layer2scaling-landscape/../../protocols/lightning-network-for-dummies/sources/PITCHME.link.html">Lightning Network</a>. </p>
<p>The Lightning Network is a second-layer payment protocol that operates on top of a blockchain. It enables instant 
transactions between participating nodes. The Lightning Network features a peer-to-peer system for making micropayments 
of digital cryptocurrency through a network of bidirectional payment channels without delegating custody of funds and 
minimizing the trust of third parties [<a href="https://en.wikipedia.org/wiki/Lightning_Network" title="Lightning Network">11</a>]. </p>
<p>Normal use of the Lightning Network consists of opening a payment channel by committing a funding transaction to the 
relevant blockchain. This is followed by making any number of Lightning transactions that update the tentative 
distribution of the channel's funds without broadcasting to the blockchain; and optionally followed by closing the 
payment channel by broadcasting the final version of the transaction to distribute the channel's funds. </p>
<p align="center"><img src="scaling/layer2scaling-landscape/sources/bitcoin-lightning-network-basic.png" width="920" /></p>
<p><em>Who uses them?</em></p>
<p>The Lightning Network is spreading across the cryptocurrency landscape. It was originally designed for Bitcoin. However, 
Litecoin, Zcash, Ethereum and Ripple are just a few of the many cryptocurrencies planning to implement or test some 
form of the network [<a href="https://www.coindesk.com/bitcoin-isnt-crypto-adding-lightning-tech-now/" title="Bitcoin Isn't the Only Crypto 
Adding Lightning Tech Now">12</a>].</p>
<p><em>Strengths</em></p>
<ul>
<li>Micropayment channels are one of the leading solutions that have been presented to scale Bitcoin, which do not require 
a change to the underlying protocol.</li>
<li>Transactions are processed instantly, the account balances of the nodes are updated, and the money is immediately 
accessible to the new owner.</li>
<li>Transaction fees are a fraction of the transaction cost [<a href="https://cryptoverze.com/what-is-bitcoin-lightning-network/" title="What is Bitcoin Lightning Network? And How Does it Work?">13</a>]. </li>
</ul>
<p><em>Weaknesses</em></p>
<ul>
<li>Micropayment channels are not suitable for making bulk payment, as the intermediate nodes in the multichannel payment 
network may not be loaded with money to move the funds along. </li>
<li>Recipients cannot receive money unless their node is connected and online at the time of the transaction.
At the time of writing (July 2018), channels were only bilateral. </li>
</ul>
<p><em>Opportunities</em></p>
<p>Opportunities are fewer than expected, as Tari's ticketing use case requires many fast transactions with many parties, 
and not many fast transactions with a single party. Non-fungible assets must be &quot;broadcasted&quot;, but state channels are 
private between two parties.</p>
<h3><a class="header" href="#state-channels" id="state-channels">State Channels</a></h3>
<p><em>What are they?</em></p>
<p>State channels are the more general form of micropayment channels. They can be used not only for payments, but for any 
arbitrary &quot;state update&quot; on a blockchain, such as changes inside a smart contract [<a href="https://medium.com/l4-media/making-sense-of-ethereums-layer-2-scaling-solutions-state-channels-plasma-and-truebit-22cb40dcc2f4" title="Making Sense of Ethereum's 
Layer 2 Scaling Solutions: 
State Channels, Plasma, and Truebit">16</a>].</p>
<p>State channels allow multiple transactions to be made within off-chain agreements with very fast processing, and the 
final settlement on-chain. They keep the operation mode of blockchain protocol, but change the way it is used so as to 
deal with the challenge of scalability.</p>
<p>Any change of state within a state channel requires explicit cryptographic consent from all parties designated as 
&quot;interested&quot; in that part of the state [<a href="https://counterfactual.com/statechannels" title="Counterfactual: Generalized State Channels">19</a>].</p>
<p><em>Who uses them?</em></p>
<p><strong>On Ethereum:</strong></p>
<ul>
<li>
<p>Raiden Network ([<a href="https://medium.com/l4-media/making-sense-of-ethereums-layer-2-scaling-solutions-state-channels-plasma-and-truebit-22cb40dcc2f4" title="Making Sense of Ethereum's 
Layer 2 Scaling Solutions: 
State Channels, Plasma, and Truebit">16</a>], [<a href="https://raiden.network/101.html" title="What is the Raiden Network?">21</a>])</p>
<ul>
<li>Uses state channels to research state channel technology, define protocols and develop reference implementations.</li>
<li>State channels work with any ERC20-compatible token.</li>
<li>State updates between two parties are done via digitally signed and hash-locked transfers as the consensus 
mechanism, called balance proofs, which are also secured by a time-out. These can be settled on the Ethereum 
blockchain at any time. Raiden Network uses HTLCs in exactly the same manner as the Lightning Network. </li>
</ul>
</li>
</ul>
<p align="center"><img src="scaling/layer2scaling-landscape/sources/Raiden.png" width="470" /></p>
<ul>
<li>
<p>Counterfactual ([<a href="https://medium.com/l4-media/making-sense-of-ethereums-layer-2-scaling-solutions-state-channels-plasma-and-truebit-22cb40dcc2f4" title="Making Sense of Ethereum's 
Layer 2 Scaling Solutions: 
State Channels, Plasma, and Truebit">16</a>], [<a href="https://counterfactual.com/statechannels" title="Counterfactual: Generalized State Channels">19</a>], [<a href="https://medium.com/statechannels/counterfactual-generalized-state-channels-on-ethereum-d38a36d25fc6" title="Counterfactual: Generalized State Channels on Ethereum">31</a>])</p>
<ul>
<li>Uses state channels as a generalized framework for the integration of native state channels into Ethereum-based 
decentralized applications.</li>
<li>A generalized state channel generalized framework is one where state is deposited once, and is then used afterwards 
by any application or set of applications.</li>
<li>Counterfactual instantiation means to instantiate a contract without actually deploying it on-chain. It is achieved 
by making users sign and share commitments to the multisig wallet.</li>
<li>When a contract is counterfactually instantiated, all parties in the channel act as though it has been deployed, 
even though it has not.</li>
<li>A global registry is introduced. This is an on-chain contract that maps unique deterministic addresses for any 
Counterfactual contract to actual on-chain deployed addresses. The hashing function used to produce the deterministic 
address can be any function that takes into account the bytecode, its owner (i.e. the multisig wallet address), and a 
unique identifier.</li>
<li>A typical Counterfactual state channel is composed of counterfactually instantiated objects.</li>
</ul>
</li>
</ul>
<p align="center"><img src="scaling/layer2scaling-landscape/sources/Counterfactual.png" width="900" /></p>
<ul>
<li>
<p>Funfair ([<a href="https://medium.com/l4-media/making-sense-of-ethereums-layer-2-scaling-solutions-state-channels-plasma-and-truebit-22cb40dcc2f4" title="Making Sense of Ethereum's 
Layer 2 Scaling Solutions: 
State Channels, Plasma, and Truebit">16</a>], [<a href="https://funfair.io/state-channels-in-disguise" title="State Channels in Disguise?">23</a>], [<a href="https://funfair.io/wp-content/uploads/FunFair-Technical-White-Paper.pdf" title="FunFair Technology Roadmap and Discussion">32</a>])</p>
<ul>
<li>Uses state channels as a decentralized slot machine gambling platform, but still using centralized server-based 
random number generation.</li>
<li>Instantiates a normal &quot;Raiden-like&quot; state channel (called <em>fate channel</em>) between the player and the casino. Final 
states are submitted to blockchain after the betting game is concluded.</li>
<li>Investigating the use of threshold cryptography such as Boneh-Lynn-Shacham (BLS) signature schemes to enable truly 
secure random number generation by a group of participants.</li>
</ul>
</li>
</ul>
<p><strong>On NEO:</strong></p>
<p>Trinity ([<a href="https://www.investinblockchain.com/trinity-protocol" title="Trinity Protocol: The Scaling Solution 
of the Future?">3</a>], [<a href="https://trinity.tech" title="Trinity: Universal Off-chain Scaling Solution">17</a>], [<a href="https://trinity.tech/#/writepaper" title="Trinity White Paper: Universal 
Off-chain Scaling Solution">18</a>])</p>
<ul>
<li>Trinity is an open-source network protocol based on NEP-5 smart contracts.</li>
<li>Trinity for NEO is the same as the Raiden Network for Ethereum.</li>
<li>Trinity uses the same consensus mechanism as the Raiden network.</li>
<li>A new token, TNC, has been introduced to fund the Trinity network, but NEO, NEP-5 and TNC tokens are supported.</li>
</ul>
<p><em>Strengths</em></p>
<ul>
<li>Allows payments and changes to smart contracts.</li>
<li>State channels have strong privacy properties. Everything is happening &quot;inside&quot; a channel between participants.</li>
<li>State channels have instant finality. As soon as both parties sign a state update, it can be considered final.</li>
</ul>
<p><em>Weaknesses</em></p>
<p>State channels rely on availability; both parties must be online.</p>
<p><em>Opportunities</em></p>
<p>Opportunities are fewer than expected, as Tari's ticketing use case requires many fast transactions with many parties, 
and not many fast transactions with a single party. Non-fungible assets must be &quot;broadcasted&quot;, but state channels are 
private between two parties.</p>
<h3><a class="header" href="#off-chain-matching-engines" id="off-chain-matching-engines">Off-chain Matching Engines</a></h3>
<p><em>What are they?</em></p>
<p>Orders are matched off-chain in a matching engine and fulfilled on-chain. This allows complex orders, supports 
cross-chain transfers, and maintains a public record of orders as well as a deterministic specification of behavior. 
Off-chain matching engines make use of a token representation smart contract that converts global assets into smart 
contract tokens and vice versa [<a href="https://nash.io/pdfs/whitepaper_v2.pdf" title="NEX: A High Performance Decentralized Trade and Payment Platform">5</a>].</p>
<p><em>Who uses them?</em></p>
<ul>
<li>
<p>Neon Exchange (NEX) ( [<a href="https://nash.io/pdfs/whitepaper_v2.pdf" title="NEX: A High Performance Decentralized Trade and Payment Platform">5</a>], [<a href="https://nash.io" title="NEX/Nash website">35</a>])</p>
<ul>
<li>NEX uses a NEO decentralized application (dApp) with tokens.</li>
<li>Initial support is planned for NEO, ETH, NEP5 and ERC20 tokens.</li>
<li>Cross-chain support is planned for trading BTC, LTC and RPX on NEX.</li>
<li>The NEX off-chain matching engine will be scalable, distributed, fault-tolerant, and function continuously without 
downtime.</li>
<li>Consensus is achieved using cryptographically signed requests; publicly specified deterministic off-chain matching 
engine algorithms; and public ledgers of transactions and reward for foul play. The trade method of the exchange smart 
contract will only accept orders signed by a private key held by the matching engine.</li>
<li>The matching engine matches the orders and submits them to the respective blockchain smart contract for execution.</li>
<li>A single invocation transaction on NEO can contain many smart contract calls. Batch commit of matched orders in one 
on-chain transaction is possible.</li>
</ul>
<p align="center"><img src="scaling/layer2scaling-landscape/sources/NEX-matching-engine.png" width="350" /></p>
</li>
<li>
<p>0x ([<a href="https://0xproject.com/" title="0x Protocol Website">33</a>], [<a href="https://0xproject.com/pdfs/0x_white_paper.pdf" title="0x: An open protocol for decentralized exchange on the Ethereum blockchain">34</a>])</p>
<ul>
<li>An Ethereum ERC20-based smart contract token (ZRX).</li>
<li>Provides an open-source protocol to exchange ERC20-compliant tokens on the Ethereum blockchain using off-chain 
matching engines in the form of dApps (<em>Relayers</em>) that facilitate transactions between <em>Makers</em> and <em>Takers</em>.</li>
<li>Off-chain order relay + on-chain settlement.</li>
<li><em>Maker</em> chooses <em>Relayer</em>, specifies token exchange rate, expiration time, fees to satisfy <em>Relayer's</em> fee schedule, 
and signs order with a private key.</li>
<li>Consensus is governed with the publicly available DEX smart contract: addresses, token balances, token exchange, 
fees, signatures, order status and final transfer.</li>
</ul>
<p align="center"><img src="scaling/layer2scaling-landscape/sources/0xSequence.png" width="620" /></p>
</li>
</ul>
<p><em>Strengths</em></p>
<ul>
<li>
<p>Performance {<em>NEX</em>, <em>0x</em>}:</p>
<ul>
<li>off-chain request/order;</li>
<li>off-chain matching.</li>
</ul>
</li>
<li>
<p>NEX-specific:</p>
<ul>
<li>batched on-chain commits;</li>
<li>cross-chain transfers;</li>
<li>support of national currencies;</li>
<li>public JavaScript Object Notation (JSON) Application Programmers Interface (API) and web extension API for 
third-party applications to trade tokens;</li>
<li>development environment - <em><strong>Elixir on top of Erlang</strong></em> to enable scalable, distributed, and fault-tolerant matching 
engine;</li>
<li>Cure53 full security audit on web extension, NEX tokens will be regulated as registered European securities.</li>
</ul>
</li>
<li>
<p>0x-specific:</p>
<ul>
<li>open-source protocol to enable creation of independent off-chain dApp matching engines (<em>Relayers</em>);</li>
<li>totally transparent matching of orders with no single point of control
<ul>
<li>maker's order only enters a Relayer's order book if fee schedule is adhered to,</li>
<li>exchange can only happen if a Taker is willing to accept;</li>
</ul>
</li>
<li>consensus and settlement governed by the publicly available DEX smart contract.</li>
</ul>
</li>
</ul>
<p><em>Weaknesses</em></p>
<ul>
<li>
<p>At the time of writing (July 2018), both NEX and 0x were still in development.</p>
</li>
<li>
<p>NEX-specific:</p>
<ul>
<li>a certain level of trust is required, similar to a traditional exchange;</li>
<li>closed liquidity pool.</li>
</ul>
</li>
<li>
<p>0x-specific:</p>
<ul>
<li>a trusted Token Registry will be required to verify ERC20 token addresses and exchange rates;</li>
<li>front-running transactions and transaction collisions possible, more development needed ([<a href="https://blog.0xproject.com/front-running-griefing-and-the-perils-of-virtual-settlement-part-1-8554ab283e97" title="Front-running, Griefing 
and the Perils of Virtual 
Settlement (Part 1)">36</a>], [<a href="https://blog.0xproject.com/front-running-griefing-and-the-perils-of-virtual-settlement-part-2-921b00109e21" title="Front-running, Griefing 
and the Perils of Virtual 
Settlement (Part 2)">37</a>]);</li>
<li>batch processing ability unknown.</li>
</ul>
</li>
</ul>
<p><em>Opportunities</em></p>
<p>Matching engines in general have opportunities for Tari; the specific scheme is to be investigated further.</p>
<h3><a class="header" href="#masternodes" id="masternodes">Masternodes</a></h3>
<p><em>What are they?</em></p>
<p>A masternode is a server on a decentralized network. It is utilized to complete unique functions in ways ordinary mining 
nodes cannot, e.g. features such as direct send, instant transactions and private transactions. Because of their 
increased capabilities, masternodes typically require an investment in order to run. Masternode operators are 
incentivized and are rewarded by earning portions of block rewards in the cryptocurrency they are facilitating. 
Masternodes will get the standard return on their stakes, but will also be entitled to a portion of the transaction fees, 
allowing for a greater return on investment (ROI) ([<a href="https://cointelegraph.com/news/the-rise-of-masternodes-might-soon-be-followed-by-the-creation-of-servicenodes" title="The Rise of Masternodes Might 
Soon be Followed by the Creation 
of Servicenodes">7</a>], [<a href="https://medium.com/dash-for-newbies/what-the-heck-is-a-dash-masternode-and-how-do-i-get-one-56e24121417e" title="What the Heck is a DASH Masternode 
and How Do I get One">9</a>]).</p>
<ul>
<li>Dash Example [<a href="http://dashmasternode.org/what-is-a-masternode" title="What is a Masternode?">30</a>]. Dash was the first cryptocurrency to implement the masternode model in its protocol. Under what 
Dash calls its proof of service algorithm, a second-tier network of masternodes exists alongside a first-tier network 
of miners to achieve distributed consensus on the blockchain. This two-tiered system ensures that proof of service and 
proof of work perform symbiotic maintenance of Dash's network. Dash masternodes also enable a decentralized governance 
system that allows node operators to vote on important developments within the blockchain. A masternode for Dash 
requires a stake of 1,000 DASH. Dash and the miners each have 45% of the block rewards. The other 10% goes to the 
blockchain's treasury fund. Operators are in charge of voting on proposals for how these funds will be allocated to 
improve the network.</li>
<li>Dash Deterministic Ordering. A special deterministic algorithm is used to create a pseudorandom ordering of the 
masternodes. By using the hash from the proof-of-work for each block, security of this functionality is provided by 
the mining network. </li>
<li>Dash Trustless Quorums. The Dash masternode network is trustless, where no single entity can control the outcome. 
N pseudorandom masternodes (Quorum A) are selected from the total pool to act as an oracle for 
N pseudorandom masternodes (Quorum B) that are selected to perform the actual task. Quorum A nodes are 
the nodes that are the closest, mathematically, to the current block hash, while Quorum B nodes are the furthest. 
This process is repeated for each new block in the blockchain.</li>
<li>Dash Proof of Service. Bad actors could also run masternodes. To reduce the possibility of bad acting, nodes must ping 
the rest of the network to ensure they remain active. All masternode verification is done randomly via the Quorum 
system by the masternode network itself. Approximately 1% of the network is verified each block. This results in the 
entire masternode network being verified approximately six times per day. Six consecutive violations result in the 
deactivation of a masternode.</li>
</ul>
<p><em>Who uses them?</em></p>
<p>Block, Bata, Crown, Chaincoin, Dash, Diamond, ION, Monetary Unit, Neutron, PIVX, Vcash and XtraBytes [<a href="https://blockonomi.com/masternode-guide/" title="What are Masternodes?- Beginner's Guide">8</a>].</p>
<p><em>Strengths</em></p>
<p>Masternodes:</p>
<ul>
<li>help to sustain and take care of the ecosystem and can protect blockchains from network attacks;</li>
<li>can perform decentralized governance of miners by having the power to reject or orphan blocks if 
required ([<a href="https://coincentral.com/what-are-masternodes-an-introduction-and-guide/" title="What are Masternodes? 
An Introduction and Guide">22</a>], [<a href="http://dashmasternode.org/what-is-a-masternode" title="What is a Masternode?">30</a>]);</li>
<li>can support decentralized exchanges by overseeing transactions and offering fiat currency gateways;</li>
<li>can be used to facilitate smart contracts such as instant transactions, anonymous transactions and 
decentralized payment processor;</li>
<li>can facilitate a decentralized marketplace such as the blockchain equivalent of peer-run commerce sites 
such as eBay [<a href="https://coincentral.com/what-are-masternodes-an-introduction-and-guide/" title="What are Masternodes? 
An Introduction and Guide">22</a>];</li>
<li>compensate for Proof of Work's limitations - they avoid mining centralization and consume less energy [<a href="https://coincentral.com/what-are-masternodes-an-introduction-and-guide/" title="What are Masternodes? 
An Introduction and Guide">22</a>];</li>
<li>promise enhanced stability and network loyalty, as larger dividends and high initial investment costs 
make it less likely that operators will abandon their position in the network [<a href="https://coincentral.com/what-are-masternodes-an-introduction-and-guide/" title="What are Masternodes? 
An Introduction and Guide">22</a>].</li>
</ul>
<p><em>Weaknesses</em></p>
<ul>
<li>Maintaining masternodes can be a long and arduous process.</li>
<li>ROI is not guaranteed and is inconsistent. In some applications, Masternodes only get rewarded if they mine a block 
and if they are randomly chosen to get paid.</li>
<li>In general, a masternode's IP address is publicized and thus open to attacks.</li>
</ul>
<p><em>Opportunities</em></p>
<ul>
<li>Masternodes do not have a specific standard or protocol; many different implementations exist. If the Tari protocol 
employs Masternodes, they can be used to facilitate smart contracts off-chain and to enhance the security of the primary 
blockchain.</li>
<li>Masternodes increase the incentives for people to be involved with Tari.</li>
</ul>
<h3><a class="header" href="#plasma" id="plasma">Plasma</a></h3>
<p><em>What is it?</em></p>
<p>Plasma blockchains are a chain within a blockchain, with state transitions enforced by bonded (time to exit) fraud 
proofs (block header hashes) submitted on the root chain. Plasma enables management of a tiered blockchain without a full 
persistent record of the ledger on the root blockchain, and without giving custodial trust to any third party. The fraud 
proofs enforce an interactive protocol of rapid fund withdrawals in case of foul play such as block withholding, and in 
cases where bad actors in a lower-level tier want to commit blocks to the root chain without broadcasting this to the 
higher-level tiers [<a href="http://plasma.io/plasma.pdf" title="Plasma: Scalable Autonomous Smart Contracts">4</a>].</p>
<p align="center"><img src="scaling/layer2scaling-landscape/sources/Plasma-example-01.png" width="750" /></p>
<p>Plasma is a framework for incentivized and enforced execution of smart contracts, scalable to a significant amount of 
state updates per second, enabling the root blockchain to be able to represent a significant amount of dApps, each 
employing its own blockchain in a tree format [<a href="http://plasma.io/plasma.pdf" title="Plasma: Scalable Autonomous Smart Contracts">4</a>].</p>
<p>Plasma relies on two key parts, namely reframing all blockchain computations into a set of MapReduce functions, and an 
optional method to do Proof of Stake (PoS) token bonding on top of existing blockchains (enforced in an on-chain smart 
contract). Nakamoto Consensus incentives discourage block withholding or other Byzantine behavior. If a chain is 
Byzantine, it has the option of going to any of its parents (including the root blockchain) to continue operation or 
exit with the current committed state [<a href="http://plasma.io/plasma.pdf" title="Plasma: Scalable Autonomous Smart Contracts">4</a>].</p>
<p align="center"><img src="scaling/layer2scaling-landscape/sources/Plasma-example.png" width="750" /></p>
<p>MapReduce is a programming model and an associated implementation for processing and generating large data sets. Users 
specify a map function that processes a key/value pair to generate a set of intermediate key/value pairs, and a reduce 
function that merges all intermediate values associated with the same intermediate key [<a href="https://storage.googleapis.com/pub-tools-public-publication-data/pdf/16cb30b4b92fd4989b8619a61752a2387c6dd474.pdf" title="MapReduce: Simplified Data 
Processing on Large Clusters">38</a>]. The Plasma MapReduce 
includes commitments on data to computation as input in the map phase, and includes a merkleized proof-of-state 
transition in the reduce step when returning the result [<a href="http://plasma.io/plasma.pdf" title="Plasma: Scalable Autonomous Smart Contracts">4</a>].</p>
<p><em>Who uses it?</em></p>
<ul>
<li>Loom Network, using Delegated Proof of Stake (DPoS) consensus and validation, enabling scalable Application Specific 
Side Chains (DAppChains), running on top of Ethereum ([<a href="http://plasma.io/plasma.pdf" title="Plasma: Scalable Autonomous Smart Contracts">4</a>], [<a href="https://medium.com/loom-network/everything-you-need-to-know-about-loom-network-all-in-one-place-updated-regularly-64742bd839fe" title="Everything You Need to 
Know About Loom Network, All In 
One Place (Updated Regularly)">15</a>]).</li>
<li>OMG Network (OmiseGO), using PoS consensus and validation, a Plasma blockchain scaling solution for finance running on 
top of Ethereum ([<a href="https://cdn.omise.co/omg/whitepaper.pdf" title="OmiseGO: Decentralized Exchange 
and Payments Platform">6</a>], [<a href="https://omisego.network/" title="OmiseGO">14</a>]).</li>
</ul>
<p><em>Strengths</em></p>
<ul>
<li>Not all participants need to be online to update state.</li>
<li>Participants do not need a record of entry on the parent blockchain to enable their participation in a Plasma 
blockchain.</li>
<li>Minimal data is needed on the parent blockchain to confirm transactions when constructing Plasma blockchains in a tree 
format.</li>
<li>Private blockchain networks can be constructed, enforced by the root blockchain. Transactions may occur on a local 
private blockchain and have financial activity bonded by a public parent blockchain.</li>
<li>Rapid exit strategies in case of foul play.</li>
</ul>
<p><em>Weaknesses</em></p>
<p>At the time of writing (July 2018), Plasma still needed to be proven on other networks apart from Ethereum.</p>
<p><em>Opportunities</em></p>
<ul>
<li>Has opportunities for Tari as a Layer 2 scaling solution.</li>
<li><em>Possibility to create a Tari ticketing Plasma dAppChain running of Monero without creating a Tari-specific root 
blockchain?</em> 
<strong>Note:</strong> This will make the Tari blockchain dependent on another blockchain.</li>
<li>The Loom Network's Software Development Kit (SDK) makes it extremely easy for anyone to create a new Plasma blockchain. 
In less than a year, a number of successful and diverse dAppChains have launched. <em>The next one could easily be for 
ticket sales...</em></li>
</ul>
<h3><a class="header" href="#truebit" id="truebit">TrueBit</a></h3>
<p><em>What is it?</em></p>
<p>TrueBit is a protocol that provides security and scalability by enabling trustless smart contracts to perform and 
offload complex computations. This makes it different from state channels and Plasma, which are more useful for 
increasing the total transaction throughput of the Ethereum blockchain. TrueBit relies on solvers (akin to miners), who 
have to stake their deposits in a smart contract, solve computation and, if correct, get their deposit back. If the 
computation is incorrect, the solver loses their deposit. TrueBit uses an economic mechanism called the &quot;verification 
game&quot;, where an incentive is created for other parties, called <em>challengers,</em> to check the solvers' work ([<a href="https://medium.com/l4-media/making-sense-of-ethereums-layer-2-scaling-solutions-state-channels-plasma-and-truebit-22cb40dcc2f4" title="Making Sense of Ethereum's 
Layer 2 Scaling Solutions: 
State Channels, Plasma, and Truebit">16</a>], 
[<a href="http://people.cs.uchicago.edu/%7Eteutsch/papers/truebit.pdf" title="A Scalable Verification Solution 
for Block Chains">40</a>], [<a href="https://truebit.io" title="TruBit Website">43</a>]).</p>
<p align="center"><img src="scaling/layer2scaling-landscape/sources/TrueBit_Diagram.png" width="600" /></p>
<p><em>Who uses it?</em></p>
<p>Golem cites TrueBit as a verification mechanism for its forthcoming outsourced computation network LivePeer, a video 
streaming platform ([<a href="https://golem.network/crowdfunding/Golemwhitepaper.pdf" title="The Golem WhitePaper (Future Integrations)">39</a>], [<a href="https://medium.com/livepeer-blog/livepeers-path-to-decentralization-a9267fd16532" title="Livepeer's Path to Decentralization">41</a>], [<a href="https://golem.network" title="Golem Website">42</a>]).</p>
<p><em>Strengths</em></p>
<ul>
<li>Outsourced computation - anyone in the world can post a computational task, and anyone else can receive a reward for 
completing it [<a href="http://people.cs.uchicago.edu/%7Eteutsch/papers/truebit.pdf" title="A Scalable Verification Solution 
for Block Chains">40</a>].</li>
<li>Scalable - by decoupling verification for miners into a separate protocol, TrueBit can achieve high transaction 
throughput without facing a Verifier's Dilemma [<a href="http://people.cs.uchicago.edu/%7Eteutsch/papers/truebit.pdf" title="A Scalable Verification Solution 
for Block Chains">40</a>].</li>
</ul>
<p><em>Weaknesses</em></p>
<p>At the time of writing (July 2018), TrueBit had not yet been fully tested. </p>
<p><em>Opportunities</em></p>
<p>Nothing at the moment as, Tari would not be doing heavy/complex computation, at least not in the short term.</p>
<h3><a class="header" href="#tumblebit" id="tumblebit">TumbleBit</a></h3>
<p><em>What is it?</em></p>
<p>The TumbleBit protocol was invented at the Boston University. It is a unidirectional, unlinkable payment hub that is 
fully compatible with the Bitcoin protocol. TumbleBit allows parties to make fast, anonymous, off-chain payments through 
an untrusted intermediary called the Tumbler. No-one, not even the Tumbler, can tell which payer paid which payee during 
a TumbleBit epoch, i.e. a time period of significance.</p>
<p>Two modes of operation are supported:</p>
<ul>
<li>a classic mixing/tumbling/washing mode; and</li>
<li>a fully-fledged payment hub mode.</li>
</ul>
<p>TumbleBit consists of two interleaved fair-exchange protocols that rely on the  Rivest–Shamir–Adleman (RSA) 
cryptosystem's blinding properties to prevent bad acting from either users or Tumblers, and to ensure anonymity. These protocols are:</p>
<ul>
<li>RSA-Puzzle-Solver Protocol; and</li>
<li>Puzzle-Promise Protocol.</li>
</ul>
<p>TumbleBit also supports anonymizing through Tor to ensure that the Tumbler server can operate as a hidden service 
([<a href="https://eprint.iacr.org/2013/881.pdf" title="GHOST: Secure High-rate Transaction Processing in Bitcoin">87</a>], [<a href="http://fc15.ifca.ai/preproceedings/paper_101.pdf" title="Inclusive Blockchain Protocols">88</a>], [<a href="https://eprint.iacr.org/2016/1159.pdf" title="SPECTRE: Serialization of Proof-of-work Events: Confirming Transactions via Recursive Elections">94</a>], [<a href="https://docs.wixstatic.com/ugd/242600_92372943016c47ecb2e94b2fc07876d6.pdf" title="PHANTOM: A Scalable BlockDAG Protocol">95</a>], [<a href="https://www.daglabs.com" title="DAGLabs Website">96</a>]).</p>
<p align="center"><img src="scaling/layer2scaling-landscape/./sources/TumbleBitOverview.png" width="600" /></p>
<p>TumbleBit combines off-chain cryptographic computations with standard on-chain Bitcoin scripting functionalities to 
realize smart contracts [<a href="http://networkcultures.org/unlikeus/resources/articles/what-is-a-federated-network" title="Beyond Distributed and Decentralized: what is a federated network?">97</a>] that are not dependent on Segwit. The most important Bitcoin functionality used here 
includes hashing conditions, signing conditions, conditional execution, 2‑of‑2 multi-signatures and timelocking [<a href="http://fc15.ifca.ai/preproceedings/paper_101.pdf" title="Inclusive Blockchain Protocols">88</a>].</p>
<p><em>Who does it?</em></p>
<p>The Boston University provided a proof-of-concept and reference implementation alongside the white paper [<a href="https://www.iota.org/" title="IOTA Website">90</a>]. 
NTumbleBit [<a href="https://nano.org/en" title="Digital Currency for the Real World – the fast and free way to pay for everything in life">91</a>] is being developed as a C# production implementation of the TumbleBit protocol that at the time of 
writing (July 2018) was being deployed by Stratis with its Breeze implementation [<a href="https://byteball.org/" title="Byteball">92</a>], at alpha/experimental release level in TestNet.</p>
<p><em>NTumbleBit will be a cross-platform framework, server and client for the TumbleBit payment scheme. TumbleBit is 
separated into two modes, tumbler mode and payment hub mode. The tumbler mode improves transaction fungibility and 
offers risk free unlinkable transactions. Payment hub mode is a way of making off-chain payments possible without 
requiring implementations like Segwit or the lightning network.</em> [<a href="http://www.cs.huji.ac.il/%7Eyoni_sompo/pubs/16/SPECTRE_complete.pdf" title="SPECTRE: A Fast and Scalable Cryptocurrency Protocol">89</a>]</p>
<p><em>Strengths</em></p>
<ul>
<li>Anonymity properties. TumbleBit provides unlinkability without the need to trust the Tumbler service, i.e. untrusted 
intermediary [<a href="http://fc15.ifca.ai/preproceedings/paper_101.pdf" title="Inclusive Blockchain Protocols">88</a>].</li>
<li>Denial of Service (DoS) and Sybil protection. &quot;TumbleBit uses transaction fees to resist DoS and Sybil attacks.&quot; [<a href="http://fc15.ifca.ai/preproceedings/paper_101.pdf" title="Inclusive Blockchain Protocols">88</a>]</li>
<li>Balance. &quot;The system should not be exploited to print new money or steal money, even when parties collude.&quot; [<a href="http://fc15.ifca.ai/preproceedings/paper_101.pdf" title="Inclusive Blockchain Protocols">88</a>]</li>
<li>As a classic tumbler. TumbleBit can also be used as a classic Bitcoin tumbler [<a href="http://fc15.ifca.ai/preproceedings/paper_101.pdf" title="Inclusive Blockchain Protocols">88</a>].</li>
<li>Bitcoin compatibility. TumbleBit is fully compatible with the Bitcoin protocol [<a href="http://fc15.ifca.ai/preproceedings/paper_101.pdf" title="Inclusive Blockchain Protocols">88</a>].</li>
<li>Scalability. Each TumbleBit user only needs to interact with the Tumbler and the corresponding transaction party; this 
lack of coordination between all TumbleBit users makes scalability possible for the tumbler mode [<a href="http://fc15.ifca.ai/preproceedings/paper_101.pdf" title="Inclusive Blockchain Protocols">88</a>].</li>
<li>Batch processing. TumbleBit  supports one-to-one, many-to-one, one-to-many and many-to-many transactions in payment 
hub mode [<a href="http://fc15.ifca.ai/preproceedings/paper_101.pdf" title="Inclusive Blockchain Protocols">88</a>].</li>
<li>Masternode compatibility. The TumbleBit protocol can be fully implemented as a service in a Masternode. &quot;The Breeze 
Wallet is now fully capable of providing enhanced privacy to bitcoin transactions through a secure connection. Utilizing 
Breeze Servers that are preregistered on the network using a secure, trustless registration mechanism that is resistant 
to manipulation and censorship.&quot; ([<a href="https://byteball.org/" title="Byteball">92</a>], [<a href="https://medium.com/@avivzohar/the-spectre-protocol-7dbbebb707b" title="SPECTRE: Serialization of Proof-of-work Events, Confirming Transactions via Recursive Elections">93</a>], [<a href="https://towardsdatascience.com/federated-byzantine-agreement-24ec57bf36e0" title="Federated Byzantine Agreement">98</a>])</li>
<li>Nearly production ready. The NTumbleBit and Breeze implementations have gained TestNet status.</li>
</ul>
<p><em>Weaknesses</em></p>
<ul>
<li>Privacy is not 100% proven. Payees have better privacy than the payers, and theoretically collusion involving payees 
and the Tumbler can exist to discover the identity of the payer [<a href="https://counterparty.io/docs/faq" title="Counterparty Documentation: Frequently Asked Questions">99</a>].</li>
<li>The Tumbler service is not distributed. More work needs to be done to ensure a persistent transaction state in case a 
Tumbler server goes down.</li>
<li>Equal denominations are required. The TumbleBit protocol can only support a common denominator unit value [<a href="http://fc15.ifca.ai/preproceedings/paper_101.pdf" title="Inclusive Blockchain Protocols">88</a>].</li>
</ul>
<p><em>Opportunities</em></p>
<p>TumbleBit has benefits for Tari as a trustless Masternode matching/batch processing engine with strong privacy features.</p>
<h3><a class="header" href="#counterparty" id="counterparty">Counterparty</a></h3>
<p><em>What is it?</em></p>
<p>Counterparty is NOT a blockchain. Counterparty is a token protocol released in January 2014 that operates on Bitcoin. 
It has a fully functional Decentralized Exchange (DEX), as well as several hardcoded smart contracts defined that 
include contracts for difference and binary options (&quot;bets&quot;). To operate, Counterparty utilizes &quot;embedded consensus&quot;, 
which means that a Counterparty transaction is created and embedded into a Bitcoin transaction, using encoding such as 
1-of-3 multi-signature (multisig), Pay to Script Hash (P2SH) or Pay To Public Key Hash (P2PKH). Counterparty nodes, i.e. 
nodes that run both <code>bitcoind</code> and the <code>counterparty-server</code> applications, will receive Bitcoin transactions as normal 
(from <code>bitcoind</code>). The <code>counterparty-server</code> will then scan each, and decode and parse any embedded Counterparty 
transactions it finds. In effect, Counterparty is a ledger within the larger Bitcoin ledger, and the functioning of 
embedded consensus can be thought of as similar to the fitting of one Russian stacking doll inside another ([<a href="https://github.com/CounterpartyXCP/Documentation/blob/master/Basics/FAQ-SmartContracts.md" title="CounterpartyXCP/Documentation/Smart Contracts/EVM FAQ">73</a>], 
[<a href="https://medium.com/@droplister/counterparty-development-101-2f4d9b0c8df3" title="Counterparty Development 101">74</a>], [<a href="https://counterparty.io" title="Counterparty Website">75</a>]).</p>
<p>Embedded consensus also means that the nodes maintain identical ledgers without using a separate peer-to-peer network, 
solely using the Bitcoin blockchain for all communication (i.e. timestamping, transaction ordering and transaction 
propagation). Unlike Bitcoin, which has the concept of both a soft fork and a hard fork, a change to the protocol or 
&quot;consensus&quot; code of Counterparty always has the potential to create a hard fork. In practice, this means that each 
Counterparty node must run the same version of <code>counterparty-server</code> (or at least the same minor version, e.g. the 
&quot;3&quot; in 2.3.0) so that the protocol code matches up across all nodes ([<a href="https://counterparty.io/docs/faq" title="Counterparty Documentation: Frequently Asked Questions">99</a>], [<a href="https://counterparty.io/docs/protocol_specification" title="Counterparty Documentation: Protocol Specification">100</a>]).</p>
<p>Unlike Bitcoin's UTXO model, the Counterparty token protocol utilizes an accounts system where each Bitcoin address is 
an account, and Counterparty credit and debit transactions for a specific token type affect account balances of that 
token for that given address. The decentralized exchange allows for low-friction exchanging of different tokens between 
addresses, utilizing the concept of &quot;orders&quot;, which are individual transactions made by Counterparty clients, and 
&quot;order matches&quot;, which the Counterparty protocol itself will generate as it parses new orders that overlap existing 
active orders in the system. It is the Counterparty protocol code itself that manages the escrow of tokens when an 
order is created, the exchange of tokens between two addresses that have overlapping orders, and the release of those 
assets from escrow post-exchange.</p>
<p>Counterparty uses its own token, XCP, which was created through a &quot;proof of burn&quot; process during January 2014 [<a href="https://counterparty.io/news/why-proof-of-burn" title="Counterparty News: Why Proof-of-Burn">101</a>]. 
In that month, over 2,000 bitcoins were destroyed by various individuals sending them to an unspendable address on the 
Bitcoin network (<code>1CounterpartyXXXXXXXXXXXXXXXUWLpVr</code>), which caused the Counterparty protocol to award the sending 
address with a corresponding amount of XCP. XCP is used for payment of asset creation fees, collateral for contracts 
for difference/binary options, and often as a base token in decentralized exchange transactions (largely due to the 
complexities of using Bitcoin (BTC) in such trades).</p>
<p align="center"><img src="scaling/layer2scaling-landscape/./sources/CounterpartyStack.png" width="500" /></p>
<p>Support for the Ethereum Virtual Machine (EVM) was implemented, but never included on the MainNet version [<a href="https://github.com/CounterpartyXCP/Documentation/blob/master/Basics/FAQ-SmartContracts.md" title="CounterpartyXCP/Documentation/Smart Contracts/EVM FAQ">73</a>]. With 
the Counterparty EVM implementation, all published Counterparty smart contracts “live” at Bitcoin addresses that start 
with a <code>C</code>. Counterparty is used to broadcast an <code>execute</code> transaction to call a specific function or method in the 
smart contract code. Once an execution transaction is confirmed by a Bitcoin miner, the Counterparty federated nodes 
will receive the request and execute that method. The contract state is modified as the smart contract code executes 
and is stored in the Counterparty database [<a href="https://counterparty.io/docs/faq" title="Counterparty Documentation: Frequently Asked Questions">99</a>].</p>
<p>General consensus is that a <em>federated network</em> is a <em>distributed network of centralized networks</em>. The Ripple 
blockchain implements a Federated Byzantine Agreement (FBA) consensus mechanism. Federated sidechains implements a 
security protocol using a trusted federation of mutually distrusting functionaries/notaries. Counterparty utilizes a 
&quot;full stack&quot; packaging system for its components and all dependencies, called the &quot;federated node&quot; system. However, 
this meaning refers to federated in the general definition, i.e. &quot;set up as a single centralized unit within which each 
state or division keeps some internal autonomy&quot; ([<a href="http://networkcultures.org/unlikeus/resources/articles/what-is-a-federated-network" title="Beyond Distributed and Decentralized: what is a federated network?">97</a>], [<a href="https://towardsdatascience.com/federated-byzantine-agreement-24ec57bf36e0" title="Federated Byzantine Agreement">98</a>], [<a href="https://blockstream.com/sidechains.pdf" title="Enabling Blockchain Innovations with Pegged Sidechains">71</a>]).</p>
<p><em>Who uses it?</em></p>
<p>The most notable projects built on top of Counterparty are <a href="https://www.ageofchains.com">Age of Chains</a>, 
<a href="http://spacepirate.io">Age of Rust</a>, <a href="https://www.augmentorsgame.com/">Augmentors</a>, <a href="http://authparty.io/">Authparty</a>, 
<a href="https://bitcorns.com/">Bitcorns</a>, <a href="http://blockfreight.com/">Blockfreight™</a>, 
<a href="http://www.blocksafefoundation.com">Blocksafe</a>, <a href="http://btcpaymarket.com">BTCpaymarket.com</a>, <a href="http://coindaddy.io">CoinDaddy</a>, 
<a href="https://coval.readme.io">COVAL</a>, <a href="http://foldingcoin.net/">FoldingCoin</a>, <a href="https://www.footballcoin.io/">FootballCoin</a>, 
<a href="http://getgems.org/#/">GetGems</a>, 
<a href="https://indiesquare.me/">IndieBoard</a>, <a href="https://letstalkbitcoin.com/">LTBCoin - Letstalkbitcoin.com</a>, 
<a href="https://mafiawars.io/">Mafia Wars</a>, <a href="https://nvo.io/">NVO</a>, <a href="https://proofofvisit.com/">Proof of Visit</a>, 
<a href="http://rarepepe.party">Rarepepe.party</a>, <a href="http://mandelduck.com/sarutobiisland/">SaruTobi Island</a>, 
<a href="http://www.spellsofgenesis.com">Spells of Genesis</a>, <a href="https://mandelduck.com/#portfolio">Takara</a>, 
<a href="https://www.thescarabexperiment.org/">The Scarab Experiment</a>, <a href="https://token.fm/">Token.FM</a>, 
<a href="http://tokenly.com/">Tokenly</a>, <a href="https://topcoin.com/">TopCoin</a> and <a href="https://XCPDEX.COM">XCP DEX</a> [<a href="https://counterparty.io" title="Counterparty Website">75</a>]. In the past, 
projects such as <a href="https://storj.io/">Storj</a> and <a href="https://counterparty.io/news/swarm-crowdfunding/">SWARM</a> 
also built on Counterparty. </p>
<p>COVAL is being developed with the primary purpose of moving value using “off-chain” methods. It uses its own set of node 
runners to manage various &quot;off-chain&quot; distributed ledgers and ledger assigned wallets to implement an extended 
transaction value system, whereby tokens as well as containers of tokens can be securely transacted. Scaling within the 
COVAL ecosystem is thus achievable, because it is not only reliant on the Counterparty federated nodes to execute smart 
contracts [<a href="https://coval.readme.io/docs" title="COVAL Website">76</a>].</p>
<p><em>Strengths</em></p>
<ul>
<li>Counterparty provides a simple way to add &quot;Layer 2&quot; functionality, i.e. hard-coded smart contracts, to an already 
existing blockchain implementation that supports basic data embedding.</li>
<li>Counterparty's embedded consensus model utilizes &quot;permissionless innovation&quot;, meaning that even the Bitcoin core 
developers could not stop the use of the protocol layer without seriously crippling the network.</li>
</ul>
<p><em>Weaknesses</em></p>
<ul>
<li>Embedded consensus requires lockstep upgrades from network nodes to avoid forks.</li>
<li>Embedded consensus imposes limitations on the ability of the secondary layer to interact with the primary layer's 
token. Counterparty was not able to manipulate BTC balances or otherwise directly utilize BTC.</li>
<li>With embedded consensus, nodes maintain identical ledgers without using a peer-to-peer network. One could claim that 
this hampers the flexibility of the protocol. It also limits the speed of the protocol to the speed of the underlying 
blockchain.</li>
</ul>
<p><em>Opportunities</em></p>
<ul>
<li>Nodes can implement improved consensus models such as Federated Byzantine Agreement [<a href="https://towardsdatascience.com/federated-byzantine-agreement-24ec57bf36e0" title="Federated Byzantine Agreement">98</a>].</li>
<li>Refer to <a href="scaling/layer2scaling-landscape/layer2scaling-survey.html#scriptless-scripts">Scriptless Scripts</a>.</li>
</ul>
<h3><a class="header" href="#2-way-pegged-secondary-blockchains" id="2-way-pegged-secondary-blockchains">2-way Pegged Secondary Blockchains</a></h3>
<p><em>What are they?</em></p>
<p>A 2-way peg (2WP) allows the &quot;transfer&quot; of BTC from the main Bitcoin blockchain to a secondary blockchain and vice 
versa at a fixed rate by making use of an appropriate security protocol. The &quot;transfer&quot; actually involves BTC being 
locked on the main Bitcoin blockchain and unlocked/made available on the secondary blockchain. The 2WP promise is 
concluded when an equivalent number of tokens on the secondary blockchain are locked (in the secondary blockchain) so 
that the original bitcoins can be unlocked ([<a href="https://www.rsk.co/blog/sidechains-drivechains-and-rsk-2-way-peg-design" title="Sidechains, Drivechains, and RSK 2-Way Peg Design">65</a>], [<a href="https://blockstream.com/sidechains.pdf" title="Enabling Blockchain Innovations with Pegged Sidechains">71</a>]).</p>
<ul>
<li>Sidechain: When the security protocol is implemented using Simplified Payment Verification (SPV) proofs - blockchain 
transaction verification without downloading the entire blockchain, the secondary blockchain is referred to as a 
Sidechain [<a href="https://www.rsk.co/blog/sidechains-drivechains-and-rsk-2-way-peg-design" title="Sidechains, Drivechains, and RSK 2-Way Peg Design">65</a>].</li>
<li>Drivechain: When the security protocol is implemented by giving custody of the BTC to miners - where miners vote when 
to unlock BTC and where to send them, the secondary blockchain is referred to as a Drivechain. In this scheme, the 
miners will sign the block header using a Dynamic Membership Multiparty Signature (DMMS) ([<a href="https://www.rsk.co/blog/sidechains-drivechains-and-rsk-2-way-peg-design" title="Sidechains, Drivechains, and RSK 2-Way Peg Design">65</a>], [<a href="https://blockstream.com/sidechains.pdf" title="Enabling Blockchain Innovations with Pegged Sidechains">71</a>]).</li>
<li>Federated Peg/Sidechain: When the security protocol is implemented by having a trusted federation of mutually 
distrusting functionaries/notaries, the secondary blockchain is referred to as a Federated Peg/Sidechain. In this 
scheme, the DMMS is replaced with a traditional multi-signature scheme ([<a href="https://www.rsk.co/blog/sidechains-drivechains-and-rsk-2-way-peg-design" title="Sidechains, Drivechains, and RSK 2-Way Peg Design">65</a>], [<a href="https://blockstream.com/sidechains.pdf" title="Enabling Blockchain Innovations with Pegged Sidechains">71</a>]).</li>
<li>Hybrid Sidechain-Drivechain-Federated Peg: When the security protocol is implemented by SPV proofs going to the 
secondary blockchain and dynamic mixture of miner DMMS and functionaries/notaries multi-signatures going back to the 
main Bitcoin blockchain, the secondary blockchain is referred to as a Hybrid Sidechain-Drivechain-Federated Peg 
([<a href="https://www.rsk.co/blog/sidechains-drivechains-and-rsk-2-way-peg-design" title="Sidechains, Drivechains, and RSK 2-Way Peg Design">65</a>], [<a href="https://blockstream.com/sidechains.pdf" title="Enabling Blockchain Innovations with Pegged Sidechains">71</a>], [<a href="https://blockstream.com/strong-federations.pdf" title="Strong Federations: An Interoperable Blockchain Solution to Centralized Third Party Risks">72</a>]).</li>
</ul>
<p>The following figure shows an example of a 2WP Bitcoin secondary blockchain using a Hybrid Sidechain-Drivechain-Federated 
Peg security protocol [<a href="https://www.rsk.co/blog/sidechains-drivechains-and-rsk-2-way-peg-design" title="Sidechains, Drivechains, and RSK 2-Way Peg Design">65</a>]: </p>
<p align="center"><img src="scaling/layer2scaling-landscape/./sources/RSK_HybridSideDriveChain.png" width="550" /></p>
<p>BTC on the main Bitcoin blockchain are locked by using a P2SH transaction, where BTC can be sent to a script hash 
instead of a public key hash. To unlock the BTC in the P2SH transaction, the recipient must provide a script matching 
the script hash and data, which makes the script evaluate to true [<a href="https://en.bitcoin.it/wiki/Pay_to_script_hash" title="Pay to Script Hash">66</a>].</p>
<p><em>Who does them?</em></p>
<ul>
<li>RSK (formerly Rootstock) is a 2WP Bitcoin secondary blockchain using a hybrid sidechain-drivechain security protocol. 
RSK is scalable up to 100 transactions per second (Tx/s) and provides a second-layer scaling solution for Bitcoin, 
as it can relieve on-chain Bitcoin transactions ([<a href="https://counterparty.io/docs/protocol_specification" title="Counterparty Documentation: Protocol Specification">100</a>], [<a href="https://counterparty.io/news/why-proof-of-burn" title="Counterparty News: Why Proof-of-Burn">101</a>], [<a href="http://www.hashcash.org/papers/dagger.html" title="Dagger: A Memory-Hard to Compute, Memory-Easy to Verify Scrypt Alternative">102</a>]).</li>
<li>Hivemind (formerly Truthcoin) is implementing a Peer-to-Peer Oracle Protocol that absorbs accurate data into a 
blockchain so that Bitcoin users can speculate in Prediction Markets [<a href="http://bitcoinhivemind.com" title="Hivemind Website">67</a>].</li>
<li>Blockstream is implementing a Federated Sidechain called Liquid, with the functionaries/notaries being made up of 
participating exchanges and Bitcoin businesses [<a href="https://blockstream.com/strong-federations.pdf" title="Strong Federations: An Interoperable Blockchain Solution to Centralized Third Party Risks">72</a>].</li>
</ul>
<p align="center"><img src="scaling/layer2scaling-landscape/./sources/Blockstream-Federated-Sidechain.png" width="800" /></p>
<p><em>Strengths</em></p>
<ul>
<li>Permissionless innovation: Anyone can create a new blockchain project that uses the underlying strengths of the main 
Bitcoin blockchain, using real BTC as the currency [<a href="http://www.drivechain.info" title="Drivechain: Enabling Bitcoin Sidechain">63</a>].</li>
<li>New features: Sidechains/Drivechains can be used to test or implement new features without risk to the main Bitcoin 
blockchain or without having to change its protocol, such as Schnorr signatures and zero-knowledge proofs ([<a href="http://www.drivechain.info" title="Drivechain: Enabling Bitcoin Sidechain">63</a>], [<a href="http://drivechains.org/what-are-drivechains/what-does-it-enable" title="Drivechains: What do they Enable? Cloud 3.0 Services Smart Contracts and Scalability">68</a>]).</li>
<li>Chains-as-a-Service (CaaS): It is possible to create a CaaS with data storage 2WP secondary blockchains [<a href="http://drivechains.org/what-are-drivechains/what-does-it-enable" title="Drivechains: What do they Enable? Cloud 3.0 Services Smart Contracts and Scalability">68</a>].</li>
<li>Smart Contracts: 2WP secondary blockchains make it easier to implement smart contracts [<a href="http://drivechains.org/what-are-drivechains/what-does-it-enable" title="Drivechains: What do they Enable? Cloud 3.0 Services Smart Contracts and Scalability">68</a>].</li>
<li>Scalability: 2WP secondary blockchains can support larger block sizes and more transactions per second, thus scaling 
the Bitcoin main blockchain [<a href="http://drivechains.org/what-are-drivechains/what-does-it-enable" title="Drivechains: What do they Enable? Cloud 3.0 Services Smart Contracts and Scalability">68</a>].</li>
</ul>
<p><em>Weaknesses</em></p>
<ul>
<li>Security: Transferring BTC back into the main Bitcoin blockchain is not secure enough and can be manipulated because 
Bitcoin does not support SPV from 2WP secondary blockchains [<a href="http://www.truthcoin.info/blog/drivechain" title="Drivechain - The Simple Two Way Peg">64</a>].</li>
<li>51% attacks: 2WP secondary blockchains are hugely dependent on merged mining. Mining power centralization and 
51% attacks are thus a real threat, as demonstrated for Namecoin and Huntercoin (refer to <a href="scaling/layer2scaling-landscape/../../merged-mining/merged-mining-scene/MergedMiningIntroduction.html">Merged Mining Introduction</a>).</li>
<li>The DMMS provided by mining is not very secure for small systems, while the trust of the federation/notaries is 
riskier for large systems [<a href="https://blockstream.com/sidechains.pdf" title="Enabling Blockchain Innovations with Pegged Sidechains">71</a>].</li>
</ul>
<p><em>Opportunities</em></p>
<p>2WP secondary blockchains may present interesting opportunities to scale multiple payments that would be associated with 
multiple non-fungible assets living on a secondary layer. 
However, take care with privacy and security of funds as well as with transferring funds into and out of the 2WP 
secondary blockchains.</p>
<h3><a class="header" href="#lumino" id="lumino">Lumino</a></h3>
<p><em>What is it?</em></p>
<p>Lumino Transaction Compression Protocol (LTCP) is a technique for transaction compression that allows the processing of 
a higher volume of transactions, but the storing of much less information. The Lumino Network is a Lightning-like 
extension of the RSK platform that uses LTCP. Delta (difference) compression of selected fields of transactions from the 
same owner is done by using aggregate signing of previous transactions so that previous signatures can be disposed of 
[<a href="https://web.archive.org/web/20170810043640/https://pdfs.semanticscholar.org/3b23/7cc60c1b9650e260318d33bec471b8202d5e.pdf" title="Hashimoto: I/O Bound Proof of Work">103</a>].</p>
<p>Each transaction contains a set of persistent fields called the Persistent Transaction Information (PTI) and a compound 
record of user transaction data called the SigRec. A Lumino block stores two Merkle trees: one containing all PTIs; and 
the other containing all transaction IDs (hash of the signed SigRec). This second Merkle tree is conceptually similar to 
the Segwit witness tree, thus forming the witness part. Docking is the process where SicRec and signature data can be 
pruned from the blockchain if valid linked PTI information exists [<a href="https://web.archive.org/web/20170810043640/https://pdfs.semanticscholar.org/3b23/7cc60c1b9650e260318d33bec471b8202d5e.pdf" title="Hashimoto: I/O Bound Proof of Work">103</a>].</p>
<p align="center"><img src="scaling/layer2scaling-landscape/./sources/LuminoDataPruning.png" width="650" /></p>
<p><em>Who does it?</em></p>
<p>RSK, which was newly launched on MainNet in January 2018. The Lumino Network must still be launched in TestNet 
([<a href="https://cryptonewsmonitor.com/2017/11/11/bitcoin-based-ethereum-rival-rsk-set-to-launch-next-month" title="Bitcoin-based Ethereum Rival RSK Set to Launch Next Month">61</a>], [<a href="https://media.rsk.co/" title="RSK Blog Website">62</a>]).</p>
<p><em>Strengths</em></p>
<p>The Lumino Network promises high efficiency in pruning the RSK blockchain.</p>
<p><em>Weaknesses</em></p>
<ul>
<li>The Lumino Network has not yet been released. </li>
<li>Details about how the Lumino Network will handle payment channels were not decisive in the white paper [<a href="https://web.archive.org/web/20170810043640/https://pdfs.semanticscholar.org/3b23/7cc60c1b9650e260318d33bec471b8202d5e.pdf" title="Hashimoto: I/O Bound Proof of Work">103</a>].</li>
</ul>
<p><em>Opportunities</em></p>
<p>LTCP pruning may be beneficial to Tari.</p>
<h3><a class="header" href="#scriptless-scripts" id="scriptless-scripts">Scriptless Scripts</a></h3>
<p><em>What is it?</em></p>
<p><em>Scriptless Scripts</em> was coined and invented by mathematician Andrew Poelstra. It entails offering scripting 
functionality without actual scripts on the blockchain to implement smart contracts. At the time of writing (July 2018) 
it can only work on the Mimblewimble blockchain and makes use of a specific Schnorr signature scheme [<a href="https://github.com/sipa/bips/blob/bip-schnorr/bip-schnorr.mediawiki" title="bip-schnorr.mediawiki">81</a>] that allows 
for signature aggregation, mathematically combining several signatures into a single signature, without having to prove 
Knowledge of Secret Keys (KOSK). This is known as the <em>plain public-key model</em>, where the only requirement is that each 
potential signer has a public key. The KOSK scheme requires that users prove knowledge (or possession) of the secret key 
during public key registration with a certification authority, and is one way to generically prevent rogue-key 
attacks ([<a href="https://blockstream.com/2018/01/23/musig-key-aggregation-schnorr-signatures.html" title="Key Aggregation for Schnorr Signatures">78</a>], [<a href="https://eprint.iacr.org/2018/068.pdf" title="Simple Schnorr Multi-signatures with Applications to Bitcoin">79</a>]).</p>
<p>Signature aggregation properties sought here are ([<a href="https://blockstream.com/2018/01/23/musig-key-aggregation-schnorr-signatures.html" title="Key Aggregation for Schnorr Signatures">78</a>], [<a href="https://eprint.iacr.org/2018/068.pdf" title="Simple Schnorr Multi-signatures with Applications to Bitcoin">79</a>]):</p>
<ul>
<li>must be provably secure in the <em>plain public-key model</em>;</li>
<li>must satisfy the normal Schnorr equation, whereby the resulting signature can be written as a function of a combination 
of the public keys; </li>
<li>must allow for Interactive Aggregate Signatures (IAS), where the signers are required to cooperate;</li>
<li>must allow for Non-interactive Aggregate Signatures (NAS), where the aggregation can be done by anyone;</li>
<li>must allow each signer to sign the same message;</li>
<li>must allow each signer to sign their own message.</li>
</ul>
<p>This is different to a normal multi-signature scheme where one message is signed by all.</p>
<p>Let's say Alice and Bob each needs to provide half a Schnorr signature for a transaction, whereby Alice promises to 
reveal a secret to Bob in exchange for one crypto coin. Alice can calculate the difference between her half Schnorr 
signature and the Schnorr signature of the secret (adaptor signature) and hand it over to Bob. Bob then has the ability 
to verify the correctness of the adaptor signature without knowing the original signatures. Bob can then provide his 
half Schnorr signature to Alice so she can broadcast the full Schnorr signature to claim the crypto coin. By 
broadcasting the full Schnorr signature, Bob has access to Alice's half Schnorr signature and he can then calculate the 
Schnorr signature of the secret because he already knows the adaptor signature, thereby claiming his prize. This is also 
known as Zero-Knowledge Contingent payments ([<a href="https://bitcoinmagazine.com/articles/scriptless-scripts-how-bitcoin-can-support-smart-contracts-without-smart-contracts" title="Scriptless Scripts: How Bitcoin Can Support Smart Contracts Without Smart Contracts">77</a>], [<a href="https://download.wpsoftware.net/bitcoin/wizardry/mw-slides/2017-03-mit-bitcoin-expo/slides.pdf" title="Scriptless Scripts">80</a>]).</p>
<p><em>Who does it?</em></p>
<p><a href="https://grin-tech.org/">grin-tech.org</a></p>
<p>Mimblewimble is being cited by Andrew Poelstra as being the ultimate <em>Scriptless Script</em> [<a href="https://download.wpsoftware.net/bitcoin/wizardry/mw-slides/2017-03-mit-bitcoin-expo/slides.pdf" title="Scriptless Scripts">80</a>].</p>
<p align="center"><img src="scaling/layer2scaling-landscape/./sources/Mimblewimble.png" width="500" /></p>
<p><em>Strengths</em></p>
<ul>
<li>Data savings. Signature aggregation provides data compression on the blockchain.</li>
<li>Privacy. Nothing about the Scriptless Script smart contract, other than the settlement transaction, is ever recorded 
on the blockchain. No one will ever know that an underlying smart contract was executed.</li>
<li>Multiplicity. Multiple digital assets can be transferred between two parties in a single settlement transaction.</li>
<li>Implicit scalability. Scalability on the blockchain is achieved by virtue of compressing multiple transactions into a 
single settlement transaction. Transactions are only broadcast to the blockchain once all preconditions are met.</li>
</ul>
<p><em>Weaknesses</em></p>
<p>Recent work by Maxwell et al. ([<a href="https://blockstream.com/2018/01/23/musig-key-aggregation-schnorr-signatures.html" title="Key Aggregation for Schnorr Signatures">78</a>], [<a href="https://eprint.iacr.org/2018/068.pdf" title="Simple Schnorr Multi-signatures with Applications to Bitcoin">79</a>]) showed that a naive implementation of Schnorr multi-signatures that 
satisfies key aggregation is not secure, and that the Bellare and Neven (BN) Schnorr signature scheme loses the key 
aggregation property in order to gain security in the plain public-key model. They proposed a new Schnorr-based 
multi-signature scheme with key aggregation called MuSig, which is provably secure in the <em>plain public-key model</em>. 
It has the same key and signature size as standard Schnorr signatures. The joint signature can be verified in exactly 
the same way as a standard Schnorr signature with respect to a single “aggregated” public-key, which can be computed 
from the individual public keys of the signers. Note that the case of interactive signature aggregation where each 
signer signs their own message must still be proven by a complete security analysis.</p>
<p><em>Opportunities</em></p>
<p>Tari plans to implement the Mimblewimble blockchain and should implement the <em>Scriptless Script</em>s together with the 
MuSig Schnorr signature scheme. However, this in itself will not provide the Layer 2 scaling performance that will be 
required. Big Neon, the initial 
business application to be built on top of the Tari blockchain, requires to &quot;facilitate 500 tickets in 4 minutes&quot;, i.e. 
approximately two spectators allowed access every second, with negligible latency. </p>
<p>The Mimblewimble <em>Scriptless Script</em>s could be combined with a federated node (or specialized masternode), similar to 
that being developed by Counterparty. The secrets that are revealed by virtue of the MuSig Schnorr signatures can 
instantiate normal smart contracts inside the federated node, with the final consolidated state update being written 
back to the blockchain after the event.</p>
<h3><a class="header" href="#directed-acyclic-graph-dag-derivative-protocols" id="directed-acyclic-graph-dag-derivative-protocols">Directed Acyclic Graph (DAG) Derivative Protocols</a></h3>
<p><em>What is it?</em></p>
<p>In mathematics and computer science, a Directed Acyclic Graph (DAG) is a finite directed graph with no directed cycles. 
A directed graph is acyclic if and only if it has a topological ordering, i.e. for every directed edge <em>uv</em> from vertex 
<em>u</em> to vertex <em>v</em>, <em>u</em> comes before <em>v</em> in the ordering (age) [<a href="https://en.wikipedia.org/wiki/Directed_acyclic_graph" title="Directed Acyclic Graph">85</a>]. </p>
<p align="center"><img src="scaling/layer2scaling-landscape/./sources/DAG.png" width="400" /></p>
<p>DAGs in blockchain were first proposed as the GHOST protocol ([<a href="https://eprint.iacr.org/2013/881.pdf" title="GHOST: Secure High-rate Transaction Processing in Bitcoin">87</a>], [<a href="http://fc15.ifca.ai/preproceedings/paper_101.pdf" title="Inclusive Blockchain Protocols">88</a>]), a version of which is implemented in 
Ethereum as the Ethash PoW algorithm (based on Dagger-Hashimoto ([<a href="http://www.hashcash.org/papers/dagger.html" title="Dagger: A Memory-Hard to Compute, Memory-Easy to Verify Scrypt Alternative">102</a>], [<a href="https://web.archive.org/web/20170810043640/https://pdfs.semanticscholar.org/3b23/7cc60c1b9650e260318d33bec471b8202d5e.pdf" title="Hashimoto: I/O Bound Proof of Work">103</a>])). Then Braiding ([<a href="https://scalingbitcoin.org/hongkong2015/presentations/DAY2/2_breaking_the_chain_1_mcelrath.pdf" title="Braiding the Blockchain">83</a>], [<a href="https://rawgit.com/mcelrath/braidcoin/master/Braid%2BExamples.html" title="Braid Examples">84</a>]), 
Jute [<a href="https://scalingbitcoin.org/milan2016/presentations/D2%20-%209%20-%20David%20Vorick.pdf" title="Braiding Techniques to Improve Security and Scaling">86</a>], SPECTRE [<a href="http://www.cs.huji.ac.il/%7Eyoni_sompo/pubs/16/SPECTRE_complete.pdf" title="SPECTRE: A Fast and Scalable Cryptocurrency Protocol">89</a>] and PHANTOM [<a href="https://docs.wixstatic.com/ugd/242600_92372943016c47ecb2e94b2fc07876d6.pdf" title="PHANTOM: A Scalable BlockDAG Protocol">95</a>] were presented. The principle of DAG in blockchain is to present a way 
to include traditional off-chain blocks into the ledger, which is governed by mathematical rules. A parent that is 
simultaneously an ancestor of another parent is disallowed:</p>
<p align="center"><img src="scaling/layer2scaling-landscape/./sources/DAGTopologicalOrdering.png" width="550" /></p>
<p>The main problems to be solved by the DAG derivative protocols are:</p>
<ol>
<li>inclusion of orphaned blocks (decrease the negative effect of slow propagation); and</li>
<li>mitigation against selfish mining attacks.</li>
</ol>
<p>The underlying concept is still in the research and exploration phase [<a href="https://bitcoinmagazine.com/articles/if-there-is-an-answer-to-selfish-mining-braiding-could-be-it-1482876153" title="If There is an Answer to Selfish Mining, Braiding could be It">82</a>].</p>
<p align="center"><img src="scaling/layer2scaling-landscape/./sources/GHOST.png" width="550" /></p>
<p>In most DAG derivative protocols, blocks containing conflicting transactions, i.e. conflicting blocks, are not orphaned.
A subsequent block is built on top of both of the conflicting blocks, but the conflicting transactions themselves are 
thrown out while processing the chain. SPECTRE, for one, provides a scheme whereby blocks vote to decide which 
transactions are robustly accepted, robustly rejected or stay in an indefinite “pending” state in case of conflicts. 
Both conflicting blocks become part of the shared history, and both conflicting blocks earn their respective miners a 
block reward ([<a href="https://bitcoinmagazine.com/articles/if-there-is-an-answer-to-selfish-mining-braiding-could-be-it-1482876153" title="If There is an Answer to Selfish Mining, Braiding could be It">82</a>], [<a href="https://medium.com/@avivzohar/the-spectre-protocol-7dbbebb707b" title="SPECTRE: Serialization of Proof-of-work Events, Confirming Transactions via Recursive Elections">93</a>], [<a href="https://eprint.iacr.org/2016/1159.pdf" title="SPECTRE: Serialization of Proof-of-work Events: Confirming Transactions via Recursive Elections">94</a>]).</p>
<p><strong>Note:</strong> Braiding requires that parents and siblings may not contain conflicting transactions.</p>
<p align="center"><img src="scaling/layer2scaling-landscape/./sources/SPECTRE.png" width="750" /></p>
<p>Inclusive (DAG derivative) protocols that integrate the contents of traditional off-chain blocks into the ledger result 
in incentives for behavior changes by the nodes, which leads to an increased throughput, and a better payoff for weak 
miners [<a href="http://fc15.ifca.ai/preproceedings/paper_101.pdf" title="Inclusive Blockchain Protocols">88</a>].</p>
<p align="center"><img src="scaling/layer2scaling-landscape/./sources/InclusiveProtocolDAG.png" width="550" /></p>
<p>DAG derivative protocols are not Layer 2 Scaling solutions, but they offer significant scaling of the primary blockchain.</p>
<p><em>Who does it?</em></p>
<ul>
<li>
<p>The School of Engineering and Computer Science, The Hebrew University of Jerusalem ([<a href="https://eprint.iacr.org/2013/881.pdf" title="GHOST: Secure High-rate Transaction Processing in Bitcoin">87</a>], [<a href="http://fc15.ifca.ai/preproceedings/paper_101.pdf" title="Inclusive Blockchain Protocols">88</a>], [<a href="http://www.cs.huji.ac.il/%7Eyoni_sompo/pubs/16/SPECTRE_complete.pdf" title="SPECTRE: A Fast and Scalable Cryptocurrency Protocol">89</a>], [<a href="https://medium.com/@avivzohar/the-spectre-protocol-7dbbebb707b" title="SPECTRE: Serialization of Proof-of-work Events, Confirming Transactions via Recursive Elections">93</a>], [<a href="https://eprint.iacr.org/2016/1159.pdf" title="SPECTRE: Serialization of Proof-of-work Events: Confirming Transactions via Recursive Elections">94</a>])</p>
<ul>
<li>GHOST, SPECTRE, PHANTOM</li>
</ul>
</li>
<li>
<p>DAGlabs [<a href="https://www.daglabs.com" title="DAGLabs Website">96</a>] (<strong>Note:</strong> This is the commercial development chapter.)</p>
<ul>
<li>SPECTRE, PHANTOM
<ul>
<li>SPECTRE provides high throughput and fast confirmation times. Its DAG structure represents an abstract vote 
regarding the order between each pair of blocks, but this pairwise ordering may not be extendable to a full linear 
ordering due to possible Condorcet cycles.</li>
<li>PHANTOM provides a linear ordering over the blocks of the DAG and can support consensus regarding any general 
computation (smart contracts), which SPECTRE cannot. In order for a computation or contract to be processed 
correctly and consistently, the full order of events in the ledger is required, particularly the order of inputs to 
the contract. However, PHANTOM’s confirmation times are much slower than those in SPECTRE.</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Ethereum as the Ethash PoW algorithm that has been adapted from GHOST</p>
</li>
<li>
<p>[Dr. Bob McElrath] ([<a href="https://scalingbitcoin.org/hongkong2015/presentations/DAY2/2_breaking_the_chain_1_mcelrath.pdf" title="Braiding the Blockchain">83</a>], [<a href="https://rawgit.com/mcelrath/braidcoin/master/Braid%2BExamples.html" title="Braid Examples">84</a>])</p>
<ul>
<li>Brading</li>
</ul>
</li>
<li>
<p>David Vorick [<a href="https://scalingbitcoin.org/milan2016/presentations/D2%20-%209%20-%20David%20Vorick.pdf" title="Braiding Techniques to Improve Security and Scaling">86</a>]</p>
<ul>
<li>Jute</li>
</ul>
</li>
<li>
<p>Crypto currencies:</p>
<ul>
<li>IOTA [<a href="https://www.iota.org/" title="IOTA Website">90</a>] </li>
<li>Nano [<a href="https://nano.org/en" title="Digital Currency for the Real World – the fast and free way to pay for everything in life">91</a>]</li>
<li>Byteball [<a href="https://byteball.org/" title="Byteball">92</a>]</li>
</ul>
</li>
</ul>
<p><em>Strengths</em></p>
<ul>
<li>Layer 1 scaling: increased transaction throughput on the main blockchain.</li>
<li>Fairness: better payoff for weak miners.</li>
<li>Decentralization mitigation: weaker miners also get profits.</li>
<li>Transaction confirmation times: confirmation times of several seconds (SPECTRE).</li>
<li>Smart contracts: support smart contracts (PHANTOM).</li>
</ul>
<p><em>Weaknesses</em></p>
<ul>
<li>Still not proven 100%, development continuing.</li>
<li>The DAG derivative protocols differ on important aspects such as miner payment schemes, security models, support for 
smart contracts, and confirmation times. Thus, all DAG derivative protocols are not created equal - beware!</li>
</ul>
<p><em>Opportunities</em></p>
<p>Opportunities exist for Tari in applying the basic DAG principles to make a 51% attack harder by virtue of fairness and 
miner decentralization resistance. Choosing the correct DAG derivative protocol can also significantly improve Layer 1 
scaling.</p>
<h2><a class="header" href="#observations" id="observations">Observations</a></h2>
<ul>
<li>Further investigation into the more promising Layer 2 scaling solutions and technologies is required to verify 
alignment, applicability and usability.</li>
<li>Although not all technologies covered here are Layer 2 Scaling solutions, the strengths should be considered as building 
blocks for the Tari protocol.</li>
</ul>
<h2><a class="header" href="#references-12" id="references-12">References</a></h2>
<p>[<a href="https://en.wikipedia.org/wiki/OSI_model" title="OSI Mode">1</a>] &quot;OSI Mode&quot; [online]. Available: <a href="https://en.wikipedia.org/wiki/OSI_model">https://en.wikipedia.org/wiki/OSI_model</a>. Date accessed: 2018‑06‑07.</p>
<p>[<a href="https://www.microsoft.com/en-us/microsoft-365/blog/2018/02/12/decentralized-digital-identities-and-blockchain-the-future-as-we-see-it/" title="Decentralized Digital Identities and 
Block Chain - The Future as We See It">2</a>] &quot;Decentralized Digital Identities and Block Chain - The Future as We See It&quot; [online]. Available: <a href="https://www.microsoft.com/en-us/microsoft-365/blog/2018/02/12/decentralized-digital-identities-and-blockchain-the-future-as-we-see-it/">https://www.microsoft.com/en-us/microsoft-365/blog/2018/02/12/decentralized-digital-identities-and-blockchain-the-future-as-we-see-it/</a>. 
Date accessed: 2018‑06‑07.</p>
<p>[<a href="https://www.investinblockchain.com/trinity-protocol" title="Trinity Protocol: The Scaling Solution 
of the Future?">3</a>] &quot;Trinity Protocol: The Scaling Solution of the Future?&quot; [Online.] Available: <a href="https://www.investinblockchain.com/trinity-protocol">https://www.investinblockchain.com/trinity-protocol</a>.
Date accessed: 2018‑06‑08.</p>
<p>[<a href="http://plasma.io/plasma.pdf" title="Plasma: Scalable Autonomous Smart Contracts">4</a>] J. Poon and V. Buterin, &quot;Plasma: Scalable Autonomous Smart Contracts&quot; [online]. Available: 
<a href="http://plasma.io/plasma.pdf">http://plasma.io/plasma.pdf</a>. 
Date accessed: 2018‑06‑14.</p>
<p>[<a href="https://nash.io/pdfs/whitepaper_v2.pdf" title="NEX: A High Performance Decentralized Trade and Payment Platform">5</a>] &quot;NEX: A High Performance Decentralized Trade and Payment Platform&quot; [online]. Available: 
<a href="https://nash.io/pdfs/whitepaper_v2.pdf">https://nash.io/pdfs/whitepaper_v2.pdf</a>. 
Date accessed: 2018‑06‑11.</p>
<p>[<a href="https://cdn.omise.co/omg/whitepaper.pdf" title="OmiseGO: Decentralized Exchange 
and Payments Platform">6</a>] J. Poon and OmiseGO Team, &quot;OmiseGO: Decentralized Exchange and Payments Platform&quot; [online]. 
Available: <a href="https://cdn.omise.co/omg/whitepaper.pdf">https://cdn.omise.co/omg/whitepaper.pdf</a>. Date accessed: 2018‑06‑14.</p>
<p>[<a href="https://cointelegraph.com/news/the-rise-of-masternodes-might-soon-be-followed-by-the-creation-of-servicenodes" title="The Rise of Masternodes Might 
Soon be Followed by the Creation 
of Servicenodes">7</a>] &quot;The Rise of Masternodes Might Soon be Followed by the Creation of Servicenodes&quot; [online]. Available: <a href="https://cointelegraph.com/news/the-rise-of-masternodes-might-soon-be-followed-by-the-creation-of-servicenodes">https://cointelegraph.com/news/the-rise-of-masternodes-might-soon-be-followed-by-the-creation-of-servicenodes</a>. Date 
accessed: 2018‑06‑13.</p>
<p>[<a href="https://blockonomi.com/masternode-guide/" title="What are Masternodes?- Beginner's Guide">8</a>] &quot;What are Masternodes?- Beginner's Guide&quot; [online]. Available: <a href="https://blockonomi.com/masternode-guide/">https://blockonomi.com/masternode-guide/</a>. Date 
accessed: 2018‑06‑14.</p>
<p>[<a href="https://medium.com/dash-for-newbies/what-the-heck-is-a-dash-masternode-and-how-do-i-get-one-56e24121417e" title="What the Heck is a DASH Masternode 
and How Do I get One">9</a>] &quot;What the Heck is a DASH Masternode and How Do I get One&quot; [online]. Available: <a href="https://medium.com/dash-for-newbies/what-the-heck-is-a-dash-masternode-and-how-do-i-get-one-56e24121417e">https://medium.com/dash-for-newbies/what-the-heck-is-a-dash-masternode-and-how-do-i-get-one-56e24121417e</a>. Date 
accessed: 2018‑06‑14.</p>
<p>[<a href="https://en.bitcoin.it/wiki/Payment_channels" title="Payment Channels">10</a>] &quot;Payment Channels&quot; (online). Available: <a href="https://en.bitcoin.it/wiki/Payment_channels">https://en.bitcoin.it/wiki/Payment_channels</a>. Date accessed: 
2018‑06‑14.</p>
<p>[<a href="https://en.wikipedia.org/wiki/Lightning_Network" title="Lightning Network">11</a>] &quot;Lightning Network&quot; (online). Available: <a href="https://en.wikipedia.org/wiki/Lightning_Network">https://en.wikipedia.org/wiki/Lightning_Network</a>. Date accessed: 
2018‑06‑14.</p>
<p>[<a href="https://www.coindesk.com/bitcoin-isnt-crypto-adding-lightning-tech-now/" title="Bitcoin Isn't the Only Crypto 
Adding Lightning Tech Now">12</a>] &quot;Bitcoin Isn't the Only Crypto Adding Lightning Tech Now&quot; [online]. 
Available: <a href="https://www.coindesk.com/bitcoin-isnt-crypto-adding-lightning-tech-now/">https://www.coindesk.com/bitcoin-isnt-crypto-adding-lightning-tech-now/</a>. Date accessed: 
2018‑06‑14.</p>
<p>[<a href="https://cryptoverze.com/what-is-bitcoin-lightning-network/" title="What is Bitcoin Lightning Network? And How Does it Work?">13</a>] &quot;What is Bitcoin Lightning Network? And How Does it Work?&quot; [Online.] 
Available: <a href="https://cryptoverze.com/what-is-bitcoin-lightning-network/">https://cryptoverze.com/what-is-bitcoin-lightning-network/</a>. Date accessed: 2018‑06‑14.</p>
<p>[<a href="https://omisego.network/" title="OmiseGO">14</a>] &quot;OmiseGO&quot; [online]. Available: <a href="https://omisego.network/">https://omisego.network/</a>. Date accessed: 2018‑06‑14.</p>
<p>[<a href="https://medium.com/loom-network/everything-you-need-to-know-about-loom-network-all-in-one-place-updated-regularly-64742bd839fe" title="Everything You Need to 
Know About Loom Network, All In 
One Place (Updated Regularly)">15</a>] &quot;Everything You Need to Know About Loom Network, All In One Place (Updated Regularly)&quot; [online]. Available: 
<a href="https://medium.com/loom-network/everything-you-need-to-know-about-loom-network-all-in-one-place-updated-regularly-64742bd839fe">https://medium.com/loom-network/everything-you-need-to-know-about-loom-network-all-in-one-place-updated-regularly-64742bd839fe</a>. 
Date accessed: 2018‑06‑14.</p>
<p>[<a href="https://medium.com/l4-media/making-sense-of-ethereums-layer-2-scaling-solutions-state-channels-plasma-and-truebit-22cb40dcc2f4" title="Making Sense of Ethereum's 
Layer 2 Scaling Solutions: 
State Channels, Plasma, and Truebit">16</a>] &quot;Making Sense of Ethereum's Layer 2 Scaling Solutions: State Channels, Plasma, and Truebit&quot; [online]. Available: 
<a href="https://medium.com/l4-media/making-sense-of-ethereums-layer-2-scaling-solutions-state-channels-plasma-and-truebit-22cb40dcc2f4">https://medium.com/l4-media/making-sense-of-ethereums-layer-2-scaling-solutions-state-channels-plasma-and-truebit-22cb40dcc2f4</a>. 
Date accessed: 2018‑06‑14.</p>
<p>[<a href="https://trinity.tech" title="Trinity: Universal Off-chain Scaling Solution">17</a>] &quot;Trinity: Universal Off-chain Scaling Solution&quot; [online]. Available: <a href="https://trinity.tech">https://trinity.tech</a>. Date accessed: 
2018‑06‑14.</p>
<p>[<a href="https://trinity.tech/#/writepaper" title="Trinity White Paper: Universal 
Off-chain Scaling Solution">18</a>] &quot;Trinity White Paper: Universal Off-chain Scaling Solution&quot; [online]. Available: <a href="https://trinity.tech/#/writepaper">https://trinity.tech/#/writepaper</a>. 
Date accessed: 2018‑06‑14.</p>
<p>[<a href="https://counterfactual.com/statechannels" title="Counterfactual: Generalized State Channels">19</a>] J. Coleman, L. Horne, and L. Xuanji, &quot;Counterfactual: Generalized State Channels&quot; [online]. 
Available at: <a href="https://counterfactual.com/statechannels">https://counterfactual.com/statechannels</a> and <a href="https://l4.ventures/papers/statechannels.pdf">https://l4.ventures/papers/statechannels.pdf</a>. Date accessed: 
2018‑06‑15.</p>
<p>[<a href="https://raiden.network/" title="The Raiden Network">20</a>] &quot;The Raiden Network&quot; [online]. Available: <a href="https://raiden.network/">https://raiden.network/</a>. Date accessed: 2018‑06‑15.</p>
<p>[<a href="https://raiden.network/101.html" title="What is the Raiden Network?">21</a>] &quot;What is the Raiden Network?&quot; [Online.] Available: <a href="https://raiden.network/101.html">https://raiden.network/101.html</a>. Date accessed: 
2018‑06‑15.</p>
<p>[<a href="https://coincentral.com/what-are-masternodes-an-introduction-and-guide/" title="What are Masternodes? 
An Introduction and Guide">22</a>] &quot;What are Masternodes? An Introduction and Guide&quot; [online]. Available: 
<a href="https://coincentral.com/what-are-masternodes-an-introduction-and-guide/">https://coincentral.com/what-are-masternodes-an-introduction-and-guide/</a>. 
Date accessed: 2018‑06‑15.</p>
<p>[<a href="https://funfair.io/state-channels-in-disguise" title="State Channels in Disguise?">23</a>] &quot;State Channels in Disguise?&quot; [Online.] Available: <a href="https://funfair.io/state-channels-in-disguise">https://funfair.io/state-channels-in-disguise</a>. Date 
accessed: 2018‑06‑15.</p>
<p>[<a href="https://worldpaymentsreport.com/" title="World Payments Report 2017, © 2017
Capgemini and BNP Paribas">24</a>] &quot;World Payments Report 2017, © 2017 Capgemini and BNP Paribas&quot; [online]. Available: 
<a href="https://www.worldpaymentsreport.com">https://www.worldpaymentsreport.com</a>. 
Date accessed: 2018‑06‑20.</p>
<p>[<a href="https://usa.visa.com/visa-everywhere/innovation/contactless-payments-around-the-globe.html" title="VISA">25</a>] &quot;VISA&quot; [online]. Available: <a href="https://usa.visa.com/visa-everywhere/innovation/contactless-payments-around-the-globe.html">https://usa.visa.com/visa-everywhere/innovation/contactless-payments-around-the-globe.html</a>. 
Date accessed: 2018‑06‑20.</p>
<p>[<a href="https://usa.visa.com/dam/VCOM/download/corporate/media/visanet-technology/visa-net-fact-sheet.pdf" title="VisaNet Fact Sheet 2017 Q4">26</a>] &quot;VisaNet Fact Sheet 2017 Q4&quot; [online]. Available: <a href="https://usa.visa.com/dam/VCOM/download/corporate/media/visanet-technology/visa-net-fact-sheet.pdf">https://usa.visa.com/dam/VCOM/download/corporate/media/visanet-technology/visa-net-fact-sheet.pdf</a>. 
Date accessed: 2018‑06‑20.</p>
<p>[<a href="https://bitcoin.stackexchange.com/questions/59408/with-100-segwit-transactions-what-would-be-the-max-number-of-transaction-confi" title="With 100% segwit transactions, 
what would be the max number of 
transaction confirmation possible 
on a block?">27</a>] &quot;With 100% segwit transactions, what would be the max number of transaction confirmation possible on a block?&quot; [Online.] 
Available: <a href="https://bitcoin.stackexchange.com/questions/59408/with-100-segwit-transactions-what-would-be-the-max-number-of-transaction-confi">https://bitcoin.stackexchange.com/questions/59408/with-100-segwit-transactions-what-would-be-the-max-number-of-transaction-confi</a>. 
Date accessed: 2018‑06‑21.</p>
<p>[<a href="https://bitsonblocks.net/2016/10/02/a-gentle-introduction-to-ethereum/" title="A Gentle Introduction to Ethereum">28</a>]: &quot;A Gentle Introduction to Ethereum&quot; [online]. Available: <a href="https://bitsonblocks.net/2016/10/02/a-gentle-introduction-to-ethereum/">https://bitsonblocks.net/2016/10/02/a-gentle-introduction-to-ethereum/</a>. 
Date accessed: 2018‑06‑21.</p>
<p>[<a href="https://ethereum.stackexchange.com/questions/30175/what-is-the-size-bytes-of-a-simple-ethereum-transaction-versus-a-bitcoin-trans?rq=1" title="What is the size (bytes) of 
a simple Ethereum transaction 
versus a Bitcoin transaction?">29</a>] &quot;What is the size (bytes) of a simple Ethereum transaction versus a Bitcoin transaction?&quot; [Online.] Available: 
<a href="https://ethereum.stackexchange.com/questions/30175/what-is-the-size-bytes-of-a-simple-ethereum-transaction-versus-a-bitcoin-trans?rq=1">https://ethereum.stackexchange.com/questions/30175/what-is-the-size-bytes-of-a-simple-ethereum-transaction-versus-a-bitcoin-trans?rq=1</a>. 
Date accessed: 2018‑06‑21.</p>
<p>[<a href="http://dashmasternode.org/what-is-a-masternode" title="What is a Masternode?">30</a>] &quot;What is a Masternode?&quot; [Online.] Available at: <a href="http://dashmasternode.org/what-is-a-masternode">http://dashmasternode.org/what-is-a-masternode</a>. Date accessed: 
2018‑06‑14.</p>
<p>[<a href="https://medium.com/statechannels/counterfactual-generalized-state-channels-on-ethereum-d38a36d25fc6" title="Counterfactual: Generalized State Channels on Ethereum">31</a>] &quot;Counterfactual: Generalized State Channels on Ethereum&quot; [online]. Available: 
<a href="https://medium.com/statechannels/counterfactual-generalized-state-channels-on-ethereum-d38a36d25fc6">https://medium.com/statechannels/counterfactual-generalized-state-channels-on-ethereum-d38a36d25fc6</a>. Date accessed: 
2018‑06‑26.</p>
<p>[<a href="https://funfair.io/wp-content/uploads/FunFair-Technical-White-Paper.pdf" title="FunFair Technology Roadmap and Discussion">32</a>] J. Longley and O. Hopton, &quot;FunFair Technology Roadmap and Discussion&quot; [online]. 
Available: <a href="https://funfair.io/wp-content/uploads/FunFair-Technical-White-Paper.pdf">https://funfair.io/wp-content/uploads/FunFair-Technical-White-Paper.pdf</a>. Date accessed: 2018‑06‑27.</p>
<p>[<a href="https://0xproject.com/" title="0x Protocol Website">33</a>] &quot;0x Protocol Website&quot; [online]. Available: <a href="https://0xproject.com/">https://0xproject.com/</a>. Date accessed: 2018‑06‑28.</p>
<p>[<a href="https://0xproject.com/pdfs/0x_white_paper.pdf" title="0x: An open protocol for decentralized exchange on the Ethereum blockchain">34</a>] &quot;0x: An open protocol for decentralized exchange on the Ethereum blockchain&quot; [online]. 
Available: <a href="https://0xproject.com/pdfs/0x_white_paper.pdf">https://0xproject.com/pdfs/0x_white_paper.pdf</a>. Date accessed: 2018‑06‑28.</p>
<p>[<a href="https://nash.io" title="NEX/Nash website">35</a>] &quot;NEX/Nash website&quot; [online]. Available: <a href="https://nash.io">https://nash.io</a>. Date accessed: 2018‑06‑28.</p>
<p>[<a href="https://blog.0xproject.com/front-running-griefing-and-the-perils-of-virtual-settlement-part-1-8554ab283e97" title="Front-running, Griefing 
and the Perils of Virtual 
Settlement (Part 1)">36</a>] &quot;Front-running, Griefing and the Perils of Virtual Settlement (Part 1)&quot; [online]. Available: <a href="https://blog.0xproject.com/front-running-griefing-and-the-perils-of-virtual-settlement-part-1-8554ab283e97">https://blog.0xproject.com/front-running-griefing-and-the-perils-of-virtual-settlement-part-1-8554ab283e97</a>. Date 
accessed: 2018‑06‑29.</p>
<p>[<a href="https://blog.0xproject.com/front-running-griefing-and-the-perils-of-virtual-settlement-part-2-921b00109e21" title="Front-running, Griefing 
and the Perils of Virtual 
Settlement (Part 2)">37</a>] &quot;Front-running, Griefing and the Perils of Virtual Settlement (Part 2)&quot; [online]. Available: <a href="https://blog.0xproject.com/front-running-griefing-and-the-perils-of-virtual-settlement-part-2-921b00109e21">https://blog.0xproject.com/front-running-griefing-and-the-perils-of-virtual-settlement-part-2-921b00109e21</a>. Date 
accessed: 2018‑06‑29.</p>
<p>[<a href="https://storage.googleapis.com/pub-tools-public-publication-data/pdf/16cb30b4b92fd4989b8619a61752a2387c6dd474.pdf" title="MapReduce: Simplified Data 
Processing on Large Clusters">38</a>] &quot;MapReduce: Simplified Data Processing on Large Clusters&quot; [online]. Available: <a href="https://storage.googleapis.com/pub-tools-public-publication-data/pdf/16cb30b4b92fd4989b8619a61752a2387c6dd474.pdf">https://storage.googleapis.com/pub-tools-public-publication-data/pdf/16cb30b4b92fd4989b8619a61752a2387c6dd474.pdf</a>. Date 
accessed: 2018‑07‑02.</p>
<p>[<a href="https://golem.network/crowdfunding/Golemwhitepaper.pdf" title="The Golem WhitePaper (Future Integrations)">39</a>] &quot;The Golem WhitePaper (Future Integrations)&quot; [online]. Available: <a href="https://golem.network/crowdfunding/Golemwhitepaper.pdf">https://golem.network/crowdfunding/Golemwhitepaper.pdf</a>. 
Date accessed: 2018‑06‑22.</p>
<p>[<a href="http://people.cs.uchicago.edu/%7Eteutsch/papers/truebit.pdf" title="A Scalable Verification Solution 
for Block Chains">40</a>] J. Teutsch, and C. Reitwiessner, &quot;A Scalable Verification Solution for Block Chains&quot; [online]. 
Available: <a href="http://people.cs.uchicago.edu/%7Eteutsch/papers/truebit.pdf">http://people.cs.uchicago.edu/~teutsch/papers/truebit.pdf</a>. Date accessed: 2018‑06‑22.</p>
<p>[<a href="https://medium.com/livepeer-blog/livepeers-path-to-decentralization-a9267fd16532" title="Livepeer's Path to Decentralization">41</a>] &quot;Livepeer's Path to Decentralization&quot; [online]. Available: <a href="https://medium.com/livepeer-blog/livepeers-path-to-decentralization-a9267fd16532">https://medium.com/livepeer-blog/livepeers-path-to-decentralization-a9267fd16532</a>. 
Date accessed: 2018‑06‑22.</p>
<p>[<a href="https://golem.network" title="Golem Website">42</a>] &quot;Golem Website&quot; [online]. Available: <a href="https://golem.network">https://golem.network</a>. Date accessed: 2018‑06‑22.</p>
<p>[<a href="https://truebit.io" title="TruBit Website">43</a>] &quot;TruBit Website&quot; [online]. Available: <a href="https://truebit.io">https://truebit.io</a>. Date accessed: 2018‑06‑22.</p>
<p>[<a href="http://cs-people.bu.edu/heilman/tumblebit" title="TumbleBit: An Untrusted Bitcoin-compatible Anonymous Payment Hub">44</a>] &quot;TumbleBit: An Untrusted Bitcoin-compatible Anonymous Payment Hub&quot; [online]. Available: 
<a href="http://cs-people.bu.edu/heilman/tumblebit">http://cs-people.bu.edu/heilman/tumblebit</a>. Date accessed: 2018‑07‑12.</p>
<p>[<a href="https://eprint.iacr.org/2016/575.pdf" title="TumbleBit: An Untrusted Bitcoin-compatible Anonymous Payment Hub">45</a>] E. Heilman, L. AlShenibr, F. Baldimtsi, A. Scafuro and S. Goldberg, &quot;TumbleBit: An Untrusted Bitcoin-compatible 
Anonymous Payment Hub&quot; [online].Available: <a href="https://eprint.iacr.org/2016/575.pdf">https://eprint.iacr.org/2016/575.pdf</a>. Date accessed: 2018‑07‑08.</p>
<p>[<a href="https://medium.com/@Stratisplatform/anonymous-transactions-coming-to-stratis-fced3f5abc2e" title="Anonymous Transactions Coming to Stratis">46</a>] &quot;Anonymous Transactions Coming to Stratis&quot; [online]. Available: 
<a href="https://medium.com/@Stratisplatform/anonymous-transactions-coming-to-stratis-fced3f5abc2e">https://medium.com/@Stratisplatform/anonymous-transactions-coming-to-stratis-fced3f5abc2e</a>. 
Date accessed: 2018‑07‑08.</p>
<p>[<a href="https://github.com/BUSEC/TumbleBit" title="TumbleBit Proof of Concept GitHub Repository">47</a>] &quot;TumbleBit Proof of Concept GitHub Repository&quot; [online]. Available: <a href="https://github.com/BUSEC/TumbleBit">https://github.com/BUSEC/TumbleBit</a>. 
Date accessed: 2018‑07‑08.</p>
<p>[<a href="https://github.com/nTumbleBit/nTumbleBit" title="NTumbleBit GitHub Repository">48</a>] &quot;NTumbleBit GitHub Repository&quot; [online]. Available: <a href="https://github.com/nTumbleBit/nTumbleBit">https://github.com/nTumbleBit/nTumbleBit</a>. 
Date accessed: 2018‑07‑12.</p>
<p>[<a href="https://stratisplatform.com/2017/07/17/breeze-tumblebit-server-experimental-release" title="Breeze Tumblebit Server Experimental Release">49</a>] &quot;Breeze Tumblebit Server Experimental Release&quot; [online]. Available: 
<a href="https://stratisplatform.com/2017/07/17/breeze-tumblebit-server-experimental-release">https://stratisplatform.com/2017/07/17/breeze-tumblebit-server-experimental-release</a>. Date accessed: 2018‑07‑12.</p>
<p>[<a href="https://stratisplatform.com/2017/09/20/breeze-wallet-with-breeze-privacy-protocol-dev-update" title="Breeze Wallet with Breeze Privacy Protocol">50</a>] &quot;Breeze Wallet with Breeze Privacy Protocol (Dev. Update)&quot; [online]. Available: 
<a href="https://stratisplatform.com/2017/09/20/breeze-wallet-with-breeze-privacy-protocol-dev-update">https://stratisplatform.com/2017/09/20/breeze-wallet-with-breeze-privacy-protocol-dev-update</a>. 
Date accessed: 2018‑07‑12.</p>
<p>[<a href="https://eprint.iacr.org/2016/056.pdf" title="Blindly Signed Contracts - Anonymous On-chain and Off-chain Bitcoin Transactions">51</a>] E. Heilman,  F. Baldimtsi and S. Goldberg, &quot;Blindly Signed Contracts - Anonymous On-chain and Off-chain Bitcoin 
Transactions&quot; [online]. Available: <a href="https://eprint.iacr.org/2016/056.pdf">https://eprint.iacr.org/2016/056.pdf</a>. Date accessed: 2018‑07‑12.</p>
<p>[<a href="https://www.youtube.com/watch?v=8BLWUUPfh2Q&amp;feature=youtu.be&amp;t=1h3m10s" title="TumbleBit: An Untrusted Bitcoin-compatible Anonymous Payment Hub">52</a>] E. Heilman and L. AlShenibr, &quot;TumbleBit: An Untrusted Bitcoin-compatible Anonymous Payment Hub - 
08 October  2016&quot;, in Conference: <em>Scaling Bitcoin 2016 Milan</em>. Available: 
<a href="https://www.youtube.com/watch?v=8BLWUUPfh2Q&amp;feature=youtu.be&amp;t=1h3m10s">https://www.youtube.com/watch?v=8BLWUUPfh2Q&amp;feature=youtu.be&amp;t=1h3m10s</a>. Date accessed: 2018‑07‑13.</p>
<p>[<a href="https://bitcoinmagazine.com/articles/better-bitcoin-privacy-scalability-developers-are-making-tumblebit-reality" title="Better Bitcoin Privacy, Scalability: Developers Making TumbleBit a Reality">53</a>] &quot;Better Bitcoin Privacy, Scalability: Developers Making TumbleBit a Reality&quot; [online]. Available: 
<a href="https://bitcoinmagazine.com/articles/better-bitcoin-privacy-scalability-developers-are-making-tumblebit-reality">https://bitcoinmagazine.com/articles/better-bitcoin-privacy-scalability-developers-are-making-tumblebit-reality</a>. 
Date accessed: 2018‑07‑13.</p>
<p>[<a href="https://en.bitcoin.it/wiki/Contract" title="Bitcoinwiki: Contract">54</a>] Bitcoinwiki: &quot;Contract&quot; [online]. Available: <a href="https://en.bitcoin.it/wiki/Contract">https://en.bitcoin.it/wiki/Contract</a>. 
Date accessed: 2018‑07‑13.</p>
<p>[<a href="https://stratisplatform.com/2017/08/10/bitcoin-privacy-tumblebit-integrated-into-breeze" title="Bitcoin Privacy is a Breeze: TumbleBit Successfully Integrated Into Breeze">55</a>] &quot;Bitcoin Privacy is a Breeze: TumbleBit Successfully Integrated Into Breeze&quot; [online]. Available: 
<a href="https://stratisplatform.com/2017/08/10/bitcoin-privacy-tumblebit-integrated-into-breeze">https://stratisplatform.com/2017/08/10/bitcoin-privacy-tumblebit-integrated-into-breeze</a>. Date accessed: 2018-07‑13.</p>
<p>[<a href="https://www.bitcoinmarketinsider.com/tumblebit-wallet-reaches-one-step-forward" title="TumbleBit Wallet Reaches One Step Forward">56</a>] &quot;TumbleBit Wallet Reaches One Step Forward&quot; [online]. Available: 
<a href="https://www.bitcoinmarketinsider.com/tumblebit-wallet-reaches-one-step-forward">https://www.bitcoinmarketinsider.com/tumblebit-wallet-reaches-one-step-forward</a>. Date accessed: 2018‑07‑13.</p>
<p>[<a href="https://www.ethnews.com/a-survey-of-second-layer-solutions-for-blockchain-scaling-part-1" title="A Survey of Second Layer Solutions for Blockchain Scaling Part 1">57</a>] &quot;A Survey of Second Layer Solutions for Blockchain Scaling Part 1&quot; [online]. Available: 
<a href="https://www.ethnews.com/a-survey-of-second-layer-solutions-for-blockchain-scaling-part-1">https://www.ethnews.com/a-survey-of-second-layer-solutions-for-blockchain-scaling-part-1</a>. 
Date accessed: 2018‑07‑16.</p>
<p>[<a href="https://lunyr.com/article/Second-Layer_Scaling" title="Second-layer Scaling">58</a>] &quot;Second-layer Scaling&quot; [online]. Available: <a href="https://lunyr.com/article/Second-Layer_Scaling">https://lunyr.com/article/Second-Layer_Scaling</a>. 
Date accessed: 2018‑07‑16.</p>
<p>[<a href="https://www.rsk.co" title="RSK Website">59</a>] &quot;RSK Website&quot; [online]. Available: <a href="https://www.rsk.co">https://www.rsk.co</a>. Date accessed: 2018‑07‑16.</p>
<p>[<a href="https://uploads.strikinglycdn.com/files/ec5278f8-218c-407a-af3c-ab71a910246d/LuminoTransactionCompressionProtocolLTCP.pdf" title="Lumino Transaction Compression Protocol (LTCP)">60</a>] S. D. Lerner, &quot;Lumino Transaction Compression Protocol (LTCP)&quot; [online]. Available: 
<a href="https://uploads.strikinglycdn.com/files/ec5278f8-218c-407a-af3c-ab71a910246d/LuminoTransactionCompressionProtocolLTCP.pdf">https://uploads.strikinglycdn.com/files/ec5278f8-218c-407a-af3c-ab71a910246d/LuminoTransactionCompressionProtocolLTCP.pdf</a>. 
Date accessed: 2018‑07‑16.</p>
<p>[<a href="https://cryptonewsmonitor.com/2017/11/11/bitcoin-based-ethereum-rival-rsk-set-to-launch-next-month" title="Bitcoin-based Ethereum Rival RSK Set to Launch Next Month">61</a>] &quot;Bitcoin-based Ethereum Rival RSK Set to Launch Next Month&quot; [online]. Available: 
<a href="https://cryptonewsmonitor.com/2017/11/11/bitcoin-based-ethereum-rival-rsk-set-to-launch-next-month">https://cryptonewsmonitor.com/2017/11/11/bitcoin-based-ethereum-rival-rsk-set-to-launch-next-month</a>. 
Date accessed: 2018‑07‑16.</p>
<p>[<a href="https://media.rsk.co/" title="RSK Blog Website">62</a>] &quot;RSK Blog Website&quot; [online]. Available:  <a href="https://media.rsk.co/">https://media.rsk.co/</a>. Date accessed: 2018‑07‑16.</p>
<p>[<a href="http://www.drivechain.info" title="Drivechain: Enabling Bitcoin Sidechain">63</a>] &quot;Drivechain: Enabling Bitcoin Sidechain&quot; [online]. Available: <a href="http://www.drivechain.info">http://www.drivechain.info</a>. 
Date accessed: 2018‑07‑17.</p>
<p>[<a href="http://www.truthcoin.info/blog/drivechain" title="Drivechain - The Simple Two Way Peg">64</a>] &quot;Drivechain - The Simple Two Way Peg&quot; [online]. Available: <a href="http://www.truthcoin.info/blog/drivechain">http://www.truthcoin.info/blog/drivechain</a>. 
Date accessed: 2018‑07‑17.</p>
<p>[<a href="https://www.rsk.co/blog/sidechains-drivechains-and-rsk-2-way-peg-design" title="Sidechains, Drivechains, and RSK 2-Way Peg Design">65</a>] &quot;Sidechains, Drivechains, and RSK 2-Way Peg Design&quot; [online]. Available: 
<a href="https://www.rsk.co/blog/sidechains-drivechains-and-rsk-2-way-peg-design">https://www.rsk.co/blog/sidechains-drivechains-and-rsk-2-way-peg-design</a> or 
<a href="https://uploads.strikinglycdn.com/files/27311e59-0832-49b5-ab0e-2b0a73899561/Drivechains_Sidechains_and_Hybrid_2-way_peg_Designs_R9.pdf">https://uploads.strikinglycdn.com/files/27311e59-0832-49b5-ab0e-2b0a73899561/Drivechains_Sidechains_and_Hybrid_2-way_peg_Designs_R9.pdf</a>. 
Date accessed: 2018‑07‑18.</p>
<p>[<a href="https://en.bitcoin.it/wiki/Pay_to_script_hash" title="Pay to Script Hash">66</a>] &quot;Pay to Script Hash&quot; [online]. Available: <a href="https://en.bitcoin.it/wiki/Pay_to_script_hash">https://en.bitcoin.it/wiki/Pay_to_script_hash</a>. 
Date accessed: 2018‑07‑18.</p>
<p>[<a href="http://bitcoinhivemind.com" title="Hivemind Website">67</a>] Hivemind Website [online]. Available: <a href="http://bitcoinhivemind.com">http://bitcoinhivemind.com</a>. Date accessed: 2018‑07‑18.</p>
<p>[<a href="http://drivechains.org/what-are-drivechains/what-does-it-enable" title="Drivechains: What do they Enable? Cloud 3.0 Services Smart Contracts and Scalability">68</a>] &quot;Drivechains: What do they Enable? Cloud 3.0 Services Smart Contracts and Scalability&quot; [online]. Available: 
<a href="http://drivechains.org/what-are-drivechains/what-does-it-enable">http://drivechains.org/what-are-drivechains/what-does-it-enable</a>. Date accessed: 2018‑07‑19.</p>
<p>[<a href="https://bitcoinmagazine.com/articles/bloq-s-paul-sztorc-on-the-main-benefits-of-sidechains-1463417446" title="Bloq’s Paul Sztorc on the 4 Main Benefits of Sidechains">69</a>] &quot;Bloq’s Paul Sztorc on the 4 Main Benefits of Sidechains&quot; [online]. Available: 
<a href="https://bitcoinmagazine.com/articles/bloq-s-paul-sztorc-on-the-main-benefits-of-sidechains-1463417446">https://bitcoinmagazine.com/articles/bloq-s-paul-sztorc-on-the-main-benefits-of-sidechains-1463417446</a>. 
Date accessed: 2018‑07‑19.</p>
<p>[<a href="https://blockstream.com/technology" title="Blockstream Website [online]">70</a>] Blockstream Website [online]. Available: <a href="https://blockstream.com/technology">https://blockstream.com/technology</a>. Date accessed: 2018‑07‑19.</p>
<p>[<a href="https://blockstream.com/sidechains.pdf" title="Enabling Blockchain Innovations with Pegged Sidechains">71</a>] A. Back, M. Corallo, L. Dashjr, M. Friedenbach, G. Maxwell, A. Miller, A. Poelstra, J. Timón and P. Wuille, 
2014-10-22. &quot;Enabling Blockchain Innovations with Pegged Sidechains&quot; [online]. Available: 
<a href="https://blockstream.com/sidechains.pdf">https://blockstream.com/sidechains.pdf</a>. Date accessed: 2018‑07‑19.</p>
<p>[<a href="https://blockstream.com/strong-federations.pdf" title="Strong Federations: An Interoperable Blockchain Solution to Centralized Third Party Risks">72</a>] J. Dilley, A. Poelstra, J. Wilkins, M. Piekarska, B. Gorlick and M. Friedenbachet, &quot;Strong Federations: An 
Interoperable Blockchain Solution to Centralized Third Party Risks&quot; [online]. Available: 
<a href="https://blockstream.com/strong-federations.pdf">https://blockstream.com/strong-federations.pdf</a>. Date accessed: 2018‑07‑19.</p>
<p>[<a href="https://github.com/CounterpartyXCP/Documentation/blob/master/Basics/FAQ-SmartContracts.md" title="CounterpartyXCP/Documentation/Smart Contracts/EVM FAQ">73</a>] &quot;CounterpartyXCP/Documentation/Smart Contracts/EVM FAQ&quot; [online]. Available: 
<a href="https://github.com/CounterpartyXCP/Documentation/blob/master/Basics/FAQ-SmartContracts.md">https://github.com/CounterpartyXCP/Documentation/blob/master/Basics/FAQ-SmartContracts.md</a>. 
Date accessed: 2018‑07‑23.</p>
<p>[<a href="https://medium.com/@droplister/counterparty-development-101-2f4d9b0c8df3" title="Counterparty Development 101">74</a>] &quot;Counterparty Development 101&quot; [online]. Available: 
<a href="https://medium.com/@droplister/counterparty-development-101-2f4d9b0c8df3">https://medium.com/@droplister/counterparty-development-101-2f4d9b0c8df3</a>. Date accessed: 2018‑07‑23.</p>
<p>[<a href="https://counterparty.io" title="Counterparty Website">75</a>]  &quot;Counterparty Website&quot; [online]. Available: <a href="https://counterparty.io">https://counterparty.io</a>. Date accessed: 2018‑07‑24.</p>
<p>[<a href="https://coval.readme.io/docs" title="COVAL Website">76</a>] &quot;COVAL Website&quot; [online]. Available: <a href="https://coval.readme.io/docs">https://coval.readme.io/docs</a>. Date accessed: 2018‑07‑24.</p>
<p>[<a href="https://bitcoinmagazine.com/articles/scriptless-scripts-how-bitcoin-can-support-smart-contracts-without-smart-contracts" title="Scriptless Scripts: How Bitcoin Can Support Smart Contracts Without Smart Contracts">77</a>] &quot;Scriptless Scripts: How Bitcoin Can Support Smart Contracts Without Smart Contracts&quot; [online]. Available: 
<a href="https://bitcoinmagazine.com/articles/scriptless-scripts-how-bitcoin-can-support-smart-contracts-without-smart-contracts">https://bitcoinmagazine.com/articles/scriptless-scripts-how-bitcoin-can-support-smart-contracts-without-smart-contracts</a>. 
Date accessed: 2018‑07-24.</p>
<p>[<a href="https://blockstream.com/2018/01/23/musig-key-aggregation-schnorr-signatures.html" title="Key Aggregation for Schnorr Signatures">78</a>] &quot;Key Aggregation for Schnorr Signatures&quot; [online]. Available: 
<a href="https://blockstream.com/2018/01/23/musig-key-aggregation-schnorr-signatures.html">https://blockstream.com/2018/01/23/musig-key-aggregation-schnorr-signatures.html</a>. Date accessed: 2018‑07‑24.</p>
<p>[<a href="https://eprint.iacr.org/2018/068.pdf" title="Simple Schnorr Multi-signatures with Applications to Bitcoin">79</a>] G. Maxwell, A. Poelstra, Y. Seurin and P. Wuille, &quot;Simple Schnorr Multi-signatures with Applications to Bitcoin&quot; 
[online]. Available: 20 May 2018, <a href="https://eprint.iacr.org/2018/068.pdf">https://eprint.iacr.org/2018/068.pdf</a>. Date accessed: 2018‑07‑24.</p>
<p>[<a href="https://download.wpsoftware.net/bitcoin/wizardry/mw-slides/2017-03-mit-bitcoin-expo/slides.pdf" title="Scriptless Scripts">80</a>] A. Poelstra, 4 March 2017, &quot;Scriptless Scripts&quot; [online]. Available: 
<a href="https://download.wpsoftware.net/bitcoin/wizardry/mw-slides/2017-03-mit-bitcoin-expo/slides.pdf">https://download.wpsoftware.net/bitcoin/wizardry/mw-slides/2017-03-mit-bitcoin-expo/slides.pdf</a>. 
Date accessed: 2018‑07‑24.</p>
<p>[<a href="https://github.com/sipa/bips/blob/bip-schnorr/bip-schnorr.mediawiki" title="bip-schnorr.mediawiki">81</a>] &quot;bip-schnorr.mediawiki&quot; [online]. Available: <a href="https://github.com/sipa/bips/blob/bip-schnorr/bip-schnorr.mediawiki">https://github.com/sipa/bips/blob/bip-schnorr/bip-schnorr.mediawiki</a>. 
Date accessed: 2018‑07‑26.</p>
<p>[<a href="https://bitcoinmagazine.com/articles/if-there-is-an-answer-to-selfish-mining-braiding-could-be-it-1482876153" title="If There is an Answer to Selfish Mining, Braiding could be It">82</a>] &quot;If There is an Answer to Selfish Mining, Braiding could be It&quot; [online]. Available: 
<a href="https://bitcoinmagazine.com/articles/if-there-is-an-answer-to-selfish-mining-braiding-could-be-it-1482876153">https://bitcoinmagazine.com/articles/if-there-is-an-answer-to-selfish-mining-braiding-could-be-it-1482876153</a>. 
Date accessed: 2018‑07‑27.</p>
<p>[<a href="https://scalingbitcoin.org/hongkong2015/presentations/DAY2/2_breaking_the_chain_1_mcelrath.pdf" title="Braiding the Blockchain">83</a>] B. McElrath, &quot;Braiding the Blockchain&quot;, in Conference: <em>Scaling Bitcoin, Hong Kong, 7 Dec 2015</em> [online]. 
Available: <a href="https://scalingbitcoin.org/hongkong2015/presentations/DAY2/2_breaking_the_chain_1_mcelrath.pdf">https://scalingbitcoin.org/hongkong2015/presentations/DAY2/2_breaking_the_chain_1_mcelrath.pdf</a>. 
Date accessed: 2018‑07‑27.</p>
<p>[<a href="https://rawgit.com/mcelrath/braidcoin/master/Braid%2BExamples.html" title="Braid Examples">84</a>] &quot;Braid Examples&quot; [online]. Available: <a href="https://rawgit.com/mcelrath/braidcoin/master/Braid%2BExamples.html">https://rawgit.com/mcelrath/braidcoin/master/Braid%2BExamples.html</a>. 
Date accessed: 2018‑07‑27.</p>
<p>[<a href="https://en.wikipedia.org/wiki/Directed_acyclic_graph" title="Directed Acyclic Graph">85</a>] &quot;Directed Acyclic Graph&quot; [online]. Available: <a href="https://en.wikipedia.org/wiki/Directed_acyclic_graph">https://en.wikipedia.org/wiki/Directed_acyclic_graph</a>. 
Date accessed: 2018‑07‑30.</p>
<p>[<a href="https://scalingbitcoin.org/milan2016/presentations/D2%20-%209%20-%20David%20Vorick.pdf" title="Braiding Techniques to Improve Security and Scaling">86</a>] &quot;Braiding Techniques to Improve Security and Scaling&quot; [online]. Available: 
<a href="https://scalingbitcoin.org/milan2016/presentations/D2%20-%209%20-%20David%20Vorick.pdf">https://scalingbitcoin.org/milan2016/presentations/D2%20-%209%20-%20David%20Vorick.pdf</a>. 
Date accessed: 2018‑07‑30.</p>
<p>[<a href="https://eprint.iacr.org/2013/881.pdf" title="GHOST: Secure High-rate Transaction Processing in Bitcoin">87</a>] Y. Sompolinsky and A. Zohar, &quot;GHOST: Secure High-rate Transaction Processing in Bitcoin&quot; [online]. Available: 
<a href="https://eprint.iacr.org/2013/881.pdf">https://eprint.iacr.org/2013/881.pdf</a>. Date accessed: 2018‑07‑30.</p>
<p>[<a href="http://fc15.ifca.ai/preproceedings/paper_101.pdf" title="Inclusive Blockchain Protocols">88</a>] Y. Lewenberg, Y. Sompolinsky and A. Zohar, &quot;Inclusive Blockchain Protocols&quot; [online]. Available: 
<a href="http://fc15.ifca.ai/preproceedings/paper_101.pdf">http://fc15.ifca.ai/preproceedings/paper_101.pdf</a>. Date accessed: 2018‑07‑30.</p>
<p>[<a href="http://www.cs.huji.ac.il/%7Eyoni_sompo/pubs/16/SPECTRE_complete.pdf" title="SPECTRE: A Fast and Scalable Cryptocurrency Protocol">89</a>] Y. Sompolinsky, Y. Lewenberg and A. Zohar, &quot;SPECTRE: A Fast and Scalable Cryptocurrency Protocol&quot; [online]. 
Available: <a href="http://www.cs.huji.ac.il/%7Eyoni_sompo/pubs/16/SPECTRE_complete.pdf">http://www.cs.huji.ac.il/~yoni_sompo/pubs/16/SPECTRE_complete.pdf</a>. Date accessed: 2018‑07‑30.</p>
<p>[<a href="https://www.iota.org/" title="IOTA Website">90</a>] &quot;IOTA Website&quot; [online]. Available: <a href="https://www.iota.org/">https://www.iota.org/</a>. Date accessed: 2018‑07‑30.</p>
<p>[<a href="https://nano.org/en" title="Digital Currency for the Real World – the fast and free way to pay for everything in life">91</a>] NANO: &quot;Digital Currency for the Real World – the fast and free way to pay for everything in life&quot; [online]. 
Available: <a href="https://nano.org/en">https://nano.org/en</a>. Date accessed: 2018‑07‑30.</p>
<p>[<a href="https://byteball.org/" title="Byteball">92</a>] &quot;Byteball&quot; [online]. Available: <a href="https://byteball.org/">https://byteball.org/</a>. Date accessed: 2018‑07‑30.</p>
<p>[<a href="https://medium.com/@avivzohar/the-spectre-protocol-7dbbebb707b" title="SPECTRE: Serialization of Proof-of-work Events, Confirming Transactions via Recursive Elections">93</a>] &quot;SPECTRE: Serialization of Proof-of-work Events, Confirming Transactions via Recursive Elections&quot; [online]. 
Available: <a href="https://medium.com/@avivzohar/the-spectre-protocol-7dbbebb707b">https://medium.com/@avivzohar/the-spectre-protocol-7dbbebb707b</a>. Date accessed: 2018‑07‑30.</p>
<p>[<a href="https://eprint.iacr.org/2016/1159.pdf" title="SPECTRE: Serialization of Proof-of-work Events: Confirming Transactions via Recursive Elections">94</a>] Y. Sompolinsky, Y. Lewenberg and A. Zohar, &quot;SPECTRE: Serialization of Proof-of-work Events: Confirming 
Transactions via Recursive Elections&quot; [online]. Available: <a href="https://eprint.iacr.org/2016/1159.pdf">https://eprint.iacr.org/2016/1159.pdf</a>. 
Date accessed: 2018‑07‑30.</p>
<p>[<a href="https://docs.wixstatic.com/ugd/242600_92372943016c47ecb2e94b2fc07876d6.pdf" title="PHANTOM: A Scalable BlockDAG Protocol">95</a>] Y. Sompolinsky and A. Zohar, &quot;PHANTOM: A Scalable BlockDAG Protocol&quot; [online]. Available: 
<a href="https://docs.wixstatic.com/ugd/242600_92372943016c47ecb2e94b2fc07876d6.pdf">https://docs.wixstatic.com/ugd/242600_92372943016c47ecb2e94b2fc07876d6.pdf</a>. Date accessed: 2018‑07‑30.</p>
<p>[<a href="https://www.daglabs.com" title="DAGLabs Website">96</a>] &quot;DAGLabs Website&quot; [online]. Available: <a href="https://www.daglabs.com">https://www.daglabs.com</a>. Date accessed: 2018‑07‑30.</p>
<p>[<a href="http://networkcultures.org/unlikeus/resources/articles/what-is-a-federated-network" title="Beyond Distributed and Decentralized: what is a federated network?">97</a>] &quot;Beyond Distributed and Decentralized: what is a federated network?&quot; [Online.] Available: 
<a href="http://networkcultures.org/unlikeus/resources/articles/what-is-a-federated-network">http://networkcultures.org/unlikeus/resources/articles/what-is-a-federated-network</a>. Date accessed: 2018‑08‑13.</p>
<p>[<a href="https://towardsdatascience.com/federated-byzantine-agreement-24ec57bf36e0" title="Federated Byzantine Agreement">98</a>] &quot;Federated Byzantine Agreement&quot; [online]. Available: 
<a href="https://towardsdatascience.com/federated-byzantine-agreement-24ec57bf36e0">https://towardsdatascience.com/federated-byzantine-agreement-24ec57bf36e0</a>. Date accessed: 2018‑08‑13.</p>
<p>[<a href="https://counterparty.io/docs/faq" title="Counterparty Documentation: Frequently Asked Questions">99</a>] &quot;Counterparty Documentation: Frequently Asked Questions&quot; [online]. Available: <a href="https://counterparty.io/docs/faq">https://counterparty.io/docs/faq</a>. 
Date accessed: 2018‑09‑14.</p>
<p>[<a href="https://counterparty.io/docs/protocol_specification" title="Counterparty Documentation: Protocol Specification">100</a>] &quot;Counterparty Documentation: Protocol Specification&quot; [online]. Available: 
<a href="https://counterparty.io/docs/protocol_specification">https://counterparty.io/docs/protocol_specification</a>. Date accessed: 2018‑09‑14.</p>
<p>[<a href="https://counterparty.io/news/why-proof-of-burn" title="Counterparty News: Why Proof-of-Burn">101</a>] &quot;Counterparty News: Why Proof-of-Burn, March 23, 2014&quot; [online]. Available: 
<a href="https://counterparty.io/news/why-proof-of-burn">https://counterparty.io/news/why-proof-of-burn</a>. Date accessed: 2018‑09‑14.</p>
<p>[<a href="http://www.hashcash.org/papers/dagger.html" title="Dagger: A Memory-Hard to Compute, Memory-Easy to Verify Scrypt Alternative">102</a>] V. Buterin, &quot;Dagger: A Memory-Hard to Compute, Memory-Easy to Verify Scrypt Alternative&quot; [online]. Available: 
<a href="http://www.hashcash.org/papers/dagger.html">http://www.hashcash.org/papers/dagger.html</a>. Date accessed: 2019‑02‑12.</p>
<p>[<a href="https://web.archive.org/web/20170810043640/https://pdfs.semanticscholar.org/3b23/7cc60c1b9650e260318d33bec471b8202d5e.pdf" title="Hashimoto: I/O Bound Proof of Work">103</a>] T. Dryja, &quot;Hashimoto: I/O Bound Proof of Work&quot; [online]. Available: 
<a href="https://web.archive.org/web/20170810043640/https://pdfs.semanticscholar.org/3b23/7cc60c1b9650e260318d33bec471b8202d5e.pdf">https://web.archive.org/web/20170810043640/https://pdfs.semanticscholar.org/3b23/7cc60c1b9650e260318d33bec471b8202d5e.pdf</a>. 
Date accessed: 2019‑02‑12.</p>
<h2><a class="header" href="#contributors-8" id="contributors-8">Contributors</a></h2>
<ul>
<li><a href="https://github.com/hansieodendaal">https://github.com/hansieodendaal</a></li>
<li><a href="https://github.com/Kevoulee">https://github.com/Kevoulee</a></li>
<li><a href="https://github.com/ksloven">https://github.com/ksloven</a></li>
<li><a href="https://github.com/robby-dermody">https://github.com/robby-dermody</a></li>
<li><a href="https://github.com/anselld">https://github.com/anselld</a></li>
</ul>
<h1><a class="header" href="#layer-2-scaling---executive-summary" id="layer-2-scaling---executive-summary">Layer 2 Scaling - Executive Summary</a></h1>
<iframe width=750 height=600 src="https://gitpitch.com/tari-labs/tari-university/master?p=/src/scaling/executive-summary#/"></iframe>
<h3><a class="header" href="#having-trouble-viewing-this-presentation-2" id="having-trouble-viewing-this-presentation-2">Having trouble viewing this presentation?</a></h3>
<p>View it in a <a href="https://gitpitch.com/tari-labs/tari-university/master?p=/src/scaling/executive-summary#/">separate window</a>.</p>
<h1><a class="header" href="#directed-acyclic-graphs" id="directed-acyclic-graphs">Directed Acyclic Graphs</a></h1>
<ul>
<li><a href="scaling/directed-acyclic-graphs/DAGs.html#background">Background</a></li>
<li><a href="scaling/directed-acyclic-graphs/DAGs.html#braiding-the-blockchain">Braiding the Blockchain</a>
<ul>
<li><a href="scaling/directed-acyclic-graphs/DAGs.html#summary">Summary</a></li>
<li><a href="scaling/directed-acyclic-graphs/DAGs.html#video">Video</a></li>
<li><a href="scaling/directed-acyclic-graphs/DAGs.html#slides">Slides</a></li>
</ul>
</li>
<li><a href="scaling/directed-acyclic-graphs/DAGs.html#ghost-dag">GHOST-DAG</a>
<ul>
<li><a href="scaling/directed-acyclic-graphs/DAGs.html#summary-1">Summary</a></li>
<li><a href="scaling/directed-acyclic-graphs/DAGs.html#video-1">Video</a></li>
<li><a href="scaling/directed-acyclic-graphs/DAGs.html#slides-1">Slides</a></li>
</ul>
</li>
<li><a href="scaling/directed-acyclic-graphs/DAGs.html#spectre">SPECTRE</a>
<ul>
<li><a href="scaling/directed-acyclic-graphs/DAGs.html#summary-2">Summary</a></li>
<li><a href="scaling/directed-acyclic-graphs/DAGs.html#video-2">Video</a></li>
</ul>
</li>
<li><a href="scaling/directed-acyclic-graphs/DAGs.html#phantom">PHANTOM</a>
<ul>
<li><a href="scaling/directed-acyclic-graphs/DAGs.html#summary-3">Summary</a></li>
<li><a href="scaling/directed-acyclic-graphs/DAGs.html#video-3">Video</a></li>
</ul>
</li>
</ul>
<h2><a class="header" href="#background-9" id="background-9">Background</a></h2>
<p>The principle of 
<a href="scaling/directed-acyclic-graphs/../layer2scaling-landscape/layer2scaling-survey.html#directed-acyclic-graph-dag-derivative-protocols">Directed Acyclic Graphs</a> 
(DAGs) in blockchain is to present a way to include traditional off-chain blocks into the ledger, which is governed by 
mathematical rules. The main problems to be solved by the DAG derivative protocols are:</p>
<ol>
<li>inclusion of orphaned blocks (decrease the negative effect of slow propagation); and</li>
<li>mitigation against selfish mining attacks.</li>
</ol>
<h2><a class="header" href="#braiding-the-blockchain" id="braiding-the-blockchain">Braiding the Blockchain</a></h2>
<div>
  <p style="float: left;">
    <img src="scaling/directed-acyclic-graphs/sources/bob_mcelrath.png" width="90" />
  </p>
  <p>
    <br>
    &nbsp;&nbsp;&nbsp;&nbsp;<strong>Dr. Bob McElrath</strong><br>
    &nbsp;&nbsp;&nbsp;&nbsp;Ph.D. Theoretical Physics
    <br>
    <br>
  </p>
</div>
<h3><a class="header" href="#summary-9" id="summary-9">Summary</a></h3>
<p><em>&quot;Braiding the Blockchain&quot;</em> by Dr. Bob McElrath, Scaling Bitcoin, Hong Kong, December 2015.</p>
<p>This talk discusses the motivation for using Directed Acyclic Graphs (DAGs), which are orphaned blocks, throughput and more 
inclusive mining. New terms are defined to make DAGs applicable to blockchain, as it needs to be more specific: Braid vs. 
DAG, Bead vs. block, Sibling and Incest.</p>
<p>The Braid approach:</p>
<ul>
<li>incentivizes miners to quickly transmit beads;</li>
<li>prohibits parents from containing conflicting transactions (unlike GHOST or SPECTRE);</li>
<li>constructs beads to be valid Bitcoin blocks if they meet the difficulty target.</li>
</ul>
<h3><a class="header" href="#video-5" id="video-5">Video</a></h3>
<p><strong>Note:</strong> Transcripts are available <a href="https://diyhpl.us/wiki/transcripts/scalingbitcoin/hong-kong/braiding-the-blockchain/">here</a>.</p>
<iframe width="750" height="600" src="https://www.youtube.com/embed/8IlZ80mPWfE" frameborder="0" 
allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<h3><a class="header" href="#slides-2" id="slides-2">Slides</a></h3>
<p><embed src="https://hongkong2015.scalingbitcoin.org/files/presentations/DAY2/2_breaking_the_chain_1_mcelrath.pdf" 
type="application/pdf" width="750" height="600" /></p>
<br>
<h2><a class="header" href="#ghost-dag" id="ghost-dag">GHOST-DAG</a></h2>
<div>
  <p style="float: left;">
    <img src="scaling/directed-acyclic-graphs/sources/aviv_zohar.png" width="90" />
  </p>
  <p>
    <br>
    &nbsp;&nbsp;&nbsp;&nbsp;<strong>Aviv Zohar</strong><br>
    &nbsp;&nbsp;&nbsp;&nbsp;Prof. at The Hebrew University and Chief Scientist @ QED-it
    <br>
    <br>
  </p>
</div>
<h3><a class="header" href="#summary-10" id="summary-10">Summary</a></h3>
<p><em>&quot;The GHOST-DAG Protocol&quot;</em> by Yonatan Sompolinsky, Scaling Bitcoin, Tokyo, October 2018.</p>
<p>This talk discusses the goal going from chain to DAG being to get an ordering of the blocks
that does not change when time between blocks approaches block propagation time; and security that does not break at 
higher throughputs. Terms introduced here are <em>Anticone</em> (the view of the DAG a block sees in the past and the future) 
and $k​$-cluster (a set of blocks with an <em>Anticone</em> at most $k​$). The protocol also makes use of a greedy algorithm in 
order to find the optimal $k​$-cluster at each step as it attempts to find the overall optimal $k​$-cluster.</p>
<h3><a class="header" href="#video-6" id="video-6">Video</a></h3>
<p><strong>Notes:</strong></p>
<ul>
<li>Start watching at 30min or open the video in a separate tab <a href="https://youtu.be/3Hksieg5GdM?t=1791">here</a>.</li>
<li>Transcripts are available <a href="http://diyhpl.us/wiki/transcripts/scalingbitcoin/tokyo-2018/ghostdag/">here</a>.</li>
</ul>
<iframe width="750" height="600" src="https://www.youtube.com/embed/3Hksieg5GdM" frameborder="0" allow="accelerometer; 
autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<h3><a class="header" href="#slides-3" id="slides-3">Slides</a></h3>
<p><embed src="https://tokyo2018.scalingbitcoin.org/files/Day2/the-ghost-dag-protocol.pdf" 
type="application/pdf" width="750" height="600" /></p>
<br>
<h2><a class="header" href="#spectre" id="spectre">SPECTRE</a></h2>
<div>
  <p style="float: left;">
    <img src="scaling/directed-acyclic-graphs/sources/aviv_zohar.png" width="90" />
  </p>
  <p>
    <br>
    &nbsp;&nbsp;&nbsp;&nbsp;<strong>Aviv Zohar</strong><br>
    &nbsp;&nbsp;&nbsp;&nbsp;Prof. at The Hebrew University and Chief Scientist @ QED-it
    <br>
    <br>
  </p>
</div>
<h3><a class="header" href="#summary-11" id="summary-11">Summary</a></h3>
<p><em>&quot;Scalability II - GHOST/SPECTRE&quot;</em> by Dr. Aviv Zohar, Technion Summer School on Decentralized Cryptocurrencies and 
Blockchains, 2017.</p>
<p>This talk discusses the application of DAGs in the SPECTRE protocol. Three insights into the Bitcoin protocol are 
shared: DAGs are more powerful; Bitcoin is related to voting; and amplification. These are discussed in relation to 
SPECTRE, while properties sought are consistency, safety and weak liveness. Voting outcomes are strongly rejected, 
strongly accepted or pending.</p>
<h3><a class="header" href="#video-7" id="video-7">Video</a></h3>
<iframe width="750" height="600" src="https://www.youtube.com/embed/5mEaBXl3BMM" frameborder="0" allow="accelerometer; 
autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<br>
<h2><a class="header" href="#phantom" id="phantom">PHANTOM</a></h2>
<div>
  <p style="float: left;">
    <img src="scaling/directed-acyclic-graphs/sources/yonatan_ompolinsky.png" width="90" />
  </p>
  <p>
    <br>
    &nbsp;&nbsp;&nbsp;&nbsp;<strong>Yonatan Sompolinsky</strong><br>
    &nbsp;&nbsp;&nbsp;&nbsp;Founding Scientist, Daglabs
    <br>
    <br>
  </p>
</div>
<h3><a class="header" href="#summary-12" id="summary-12">Summary</a></h3>
<p>&quot;&quot;BlockDAG Protocols - SPECTRE, PHANTOM&quot;* by Yonatan Sompolinsky,  Blockchain Protocol Analysis and Security 
Engineering, Stanford, 2018.</p>
<p>This talk introduces the BlockDAG protocol PHANTOM, and motivates it by virtue of blockchains not being able to scale 
and BlockDAGs being a generalization of blockchains. The mining protocol references all tips in the DAG (as opposed to 
the tip of the longest chain) and also publishes all mined blocks as soon as possible (similar to Bitcoin). Blocks 
honestly created (i.e. honest blocks) will only be unconnected if they were created at approximately the same time. 
PHANTOM's goal is to recognize honest $k$-clusters, order the blocks within and disregard the rest.</p>
<h3><a class="header" href="#video-8" id="video-8">Video</a></h3>
<iframe width="750" height="600" src="https://www.youtube.com/embed/57DCYtk0lWI" frameborder="0" allow="accelerometer; 
autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<h1><a class="header" href="#laser-beam" id="laser-beam">Laser Beam</a></h1>
<ul>
<li><a href="scaling/laser-beam/MainReport.html#introduction">Introduction</a></li>
<li><a href="scaling/laser-beam/MainReport.html#detail-scheme">Detail Scheme</a>
<ul>
<li><a href="scaling/laser-beam/MainReport.html#funding-transaction">Funding Transaction</a></li>
<li><a href="scaling/laser-beam/MainReport.html#refund-procedure">Refund Procedure</a>
<ul>
<li><a href="scaling/laser-beam/MainReport.html#alice---part-1">Alice - Part 1</a></li>
<li><a href="scaling/laser-beam/MainReport.html#bob---part-1">Bob - Part 1</a></li>
<li><a href="scaling/laser-beam/MainReport.html#alice---part-2">Alice - Part 2</a></li>
<li><a href="scaling/laser-beam/MainReport.html#bob---part-2">Bob - Part 2</a></li>
</ul>
</li>
<li><a href="scaling/laser-beam/MainReport.html#revoke-previous-refund">Revoke Previous Refund</a></li>
<li><a href="scaling/laser-beam/MainReport.html#punishment-transaction">Punishment Transaction</a></li>
<li><a href="scaling/laser-beam/MainReport.html#channel-closure">Channel Closure</a></li>
</ul>
</li>
<li><a href="scaling/laser-beam/MainReport.html#conclusions-observations-and-recommendations">Conclusions, Observations and Recommendations</a></li>
<li><a href="scaling/laser-beam/MainReport.html#appendices">Appendices</a>
<ul>
<li><a href="scaling/laser-beam/MainReport.html#appendix-a-notation-used">Appendix A: Notation Used</a></li>
</ul>
</li>
<li><a href="scaling/laser-beam/MainReport.html#references">References</a></li>
<li><a href="scaling/laser-beam/MainReport.html#contributors">Contributors</a></li>
</ul>
<h2><a class="header" href="#introduction-8" id="introduction-8">Introduction</a></h2>
<p>Proof-of-Work (PoW) blockchains are notoriously slow, as transactions need to be a number of blocks in the past to be 
confirmed, and have poor scalability properties. A payment channel 
is a class of techniques designed to allow two or more parties to make multiple blockchain transactions, without 
committing all of the transactions to the blockchain. Resulting funds can be committed back to the blockchain. Payment 
channels allow multiple transactions to be made within off-chain agreements. They keep the operation mode of the 
blockchain protocol, but change the way in which it is used in order to deal with the challenge of scalability [<a href="https://tlu.tarilabs.com/scaling/layer2scaling-landscape/layer2scaling-survey.html" title="Layer 2 Scaling Survey - 
Tari Labs University">1</a>].</p>
<p>The <a href="scaling/laser-beam/../../protocols/lightning-network-for-dummies/sources/PITCHME.link.html">Lightning Network</a> is a second-layer payment 
protocol that was originally designed for Bitcoin, and which enables instant transactions between participating nodes. 
It features a peer-to-peer system for making micropayments through a network of bidirectional payment channels. The 
Lightning Network's dispute mechanism requires all users to constantly watch the blockchain for fraud. Various mainnet 
implementations that support Bitcoin exist and, with small tweaks, some of them are also able to support Litecoin 
([<a href="http://lightning.network/lightning-network-paper.pdf" title="The Bitcoin Lightning Network: 
Scalable Off-Chain Instant Payments">2</a>], [<a href="https://github.com/lightningnetwork/lightning-rfc" title="GitHub: lightningnetwork/lightning-rfc: 
Lightning Network Specifications">3</a>], [<a href="https://coinut.com/blog/whats-the-situation-of-litecoins-lightning-network-now" title="What is the situation of Litecoin's 
Lightning Network now?">4</a>], [<a href="https://suredbits.com/lightning-101-for-exchanges-overview/" title="Lightning 101 for Exchanges">10</a>]).</p>
<p>Laser Beam is an adaptation of the Lightning Network for the <a href="scaling/laser-beam/../../protocols/mimblewimble-1/MainReport.html">Mimblewimble</a> 
protocol, to be implemented for Beam ([<a href="https://github.com/BeamMW/beam/wiki/Lightning-Network" title="GitHub: Lightning Network - 
BeamMW/beam Wiki">5</a>], [<a href="https://docs.beam.mw/Beam_lightning_network_position_paper.pdf" title="Beam - Lightning network 
position paper. (v 1.0)">6</a>], [<a href="https://github.com/fjahr/lightning-mw" title="GitHub: fjahr/lightning-mw, 
Lightning Network Specifications">7</a>]). At the time of writing of this report (November 2019), 
the specifications were far advanced, but still work in progress. Beam has a working demonstration in its mainnet 
repository, which at this stage demonstrates off-chain transactions in a single channel between two parties [<a href="https://github.com/BeamMW/beam/tree/master/node/laser_beam_demo" title="GitHub: beam/node/laser_beam_demo 
at master - BeamMW/beam">8</a>]. 
According to the Request for Comment (RFC) documents, Beam plans to 
implement routing across different payment channels in the Lightning Network style.</p>
<h2><a class="header" href="#detail-scheme" id="detail-scheme">Detail Scheme</a></h2>
<p>Beam's version of a multisignature (MultiSig) is actually a $2\text{-of-}2$ multiparty Unspent Transaction Output (UTXO), 
where each party keeps its share of the blinding factor of the Pedersen commitment, 
$C(v,k_{1}+k_{2})=\Big(vH+(k_{1}+k_{2})G\Big)$, secret. (Refer to <a href="scaling/laser-beam/MainReport.html#appendix-a-notation-used">Appendix A</a> for notation 
used.) The multiparty commitment is accompanied by a single multiparty Bulletproof range proof, similar to that employed 
by <a href="scaling/laser-beam/../../protocols/mimblewimble-mp-bp-utxo/MainReport.html#utilizing-grins-shared-bulletproof-computation">Grin</a>, 
where the individual shares of the blinding factor are used to create the combined range proof [<a href="https://github.com/BeamMW/beam/blob/mainnet/core/ecc_bulletproof.cpp" title="GitHub: beam/ecc_bulletproof.cpp 
at mainnet - BeamMW/beam">9</a>].</p>
<p>In the equations that follow Alice's and Bob's contributions are denoted by subscripts $_{a}$ and $_{b}$ respectively; 
$f$ is the fee and $\mathcal{X}$ is the excess. Note that blinding factors denoted by $\hat{k}$, $k^{\prime}$ and 
$k^{\prime\prime}$, and values denoted by $v^{\prime}$ and $v^{\prime\prime}$, have a special purpose, discussed later, 
so that $\hat{k}_{N_{a}} \neq k_{N_{a}} \neq k^{\prime} \neq k^{\prime\prime}_{N_{a}}$ and $v_{N_{a}} 
\neq v^{\prime}_{N_{a}} \neq v^{\prime\prime}_{N_{a}}$. </p>
<h3><a class="header" href="#funding-transaction" id="funding-transaction">Funding Transaction</a></h3>
<p>The parties collaborate to create the multiparty UTXO (i.e. commitment and associated multiparty range proof), combined 
on‑chain funding transaction (Figure 1) and an initial refund transaction for each party (off‑chain). All refund 
transactions have a relative time lock in their kernel, referencing the kernel of the original combined funding 
transaction, which has to be confirmed on the blockchain.</p>
<p align="center"><img src="scaling/laser-beam/sources/refund_procedure_01.png" width="700" /></p>
<div align="center"><b>Figure&nbsp;1: Laser Beam Funding for Round (N)</b></div>
<p>The initial funding transaction between Alice and Bob is depicted in (1). The lock height in the signature challenge 
corresponds to the current blockchain height. Input commitment values and blinding factors are identified by superscript 
$^{\prime\prime}$.</p>
<p>$$
\begin{aligned}
-\text{Inputs}(0)+\text{MultiSig}(0)+\text{fee} 
&amp;= \text{Excess}(0) \\
-\Big((v^{\prime\prime}_{0_{a}}H+k^{\prime\prime}_{0_{a}}G)+(v^{\prime\prime}_{0_{b}}H+k^{\prime\prime}_{0_{b}}G)\Big)+\Big(v_{0}H+(k_{0_{a}}+k_{0_{b}})G\Big)+fH 
&amp;= \mathcal{X}_{0}
\end{aligned}
\tag{1}
$$</p>
<p>Alice and Bob also need to set up their own respective refund transactions so they can be compensated should the channel 
never be used; this is performed via a refund procedure. A refund procedure (off‑chain) consists of four parts, whereby 
each user creates two transactions: one kept partially secret (discussed below) and the other shared. Each partially 
secret transaction creates a different intermediate multiparty UTXO, which is then used as input in two shared 
transactions, to spending the same set of outputs to each participant.</p>
<p>All consecutive refund procedures work in exactly the same way. In the equations that follow, double subscripts 
$_{AA}$, $_{AB}$, $_{BA}$ and $_{BB}$ have the following meaning: the first letter and the second letter indicate 
who controls the transaction and who created the value, respectively. Capitalized use of $R$ and $P$ denotes public 
nonce and public blinding factor respectively. The $N_{\text{th}}$ refund procedure is as follows:</p>
<h3><a class="header" href="#refund-procedure" id="refund-procedure">Refund Procedure</a></h3>
<h4><a class="header" href="#alice---part-1" id="alice---part-1">Alice - Part 1</a></h4>
<p align="center"><img src="scaling/laser-beam/sources/refund_procedure_02.png" width="700" /></p>
<div align="center"><b>Figure&nbsp;2: Laser Beam Refund Part 1 for Round (N)</b></div>
<p>Alice and Bob set up Alice's intermediate MultiSig funding transaction (Figure 2), spending the original funding 
MultiSig UTXO. The lock height $h_{N}$ corresponds to the current blockchain height. </p>
<p>$$
\begin{aligned}
-\text{MultiSig}(0)+\text{MultiSig}(N)_{A}+\text{fee} 
&amp; =\text{Excess}(N)_{A1} \\
-\Big(v_{0}H+(k_{0_{a}}+k_{0_{b}})G\Big) + \Big((v_{0}-f)H+(\hat{k}_{N_{a}}+k_{N_{b}})G\Big) + fH 
&amp;= \mathcal{X}_{N_{A1}} 
\end{aligned}
\tag{2}
$$</p>
<p>They collaborate to create $\text{MultiSig}(N)_{A}$, its Bulletproof range proof, the signature challenge and Bob's 
portion of the signature, $s_{N_{AB1}}$. Alice does not share the final kernel and thus keeps her part of the 
aggregated signature, $s_{N_{AA1}}$, hidden.</p>
<p>$$
\begin{aligned}
\mathcal{X}_{N_{A1}} &amp;= (-k_{0_{a}}+\hat{k}_{N_{a}})G+(-k_{0_{b}}+k_{N_{b}})G \\ 
&amp;= P_{N_{AA1}}+P_{N_{AB1}}
\end{aligned}
\tag{3}
$$</p>
<p>$$
\begin{aligned}
\text{Challenge:}\quad\mathcal{H}(R_{N_{AA1}}+R_{N_{AB1}}\parallel P_{N_{AA1}}+P_{N_{AB1}}\parallel 
f\parallel h_{N}) 
\end{aligned}
\tag{4}
$$</p>
<p>$$
\begin{aligned}
\text{Final signature tuple, kept secret:}\quad(s_{N_{AA1}}+s_{N_{AB1}},R_{N_{AA1}}+R_{N_{AB1}}) 
\end{aligned}
\tag{5}
$$</p>
<p>$$
\begin{aligned}
\text{Kernel of this transaction:}\quad\mathcal{K}_{N_{AA1}} 
\end{aligned}
\tag{6}
$$</p>
<h4><a class="header" href="#bob---part-1" id="bob---part-1">Bob - Part 1</a></h4>
<p>Alice and Bob set up Bob's intermediate MultiSig funding transaction (Figure 2), also spending the original funding 
MultiSig UTXO. The lock height $h_{N}$ again corresponds to the current blockchain height.</p>
<p>$$
\begin{aligned}
-\text{MultiSig}(0)+\text{MultiSig}(N)_{B}+\text{fee} 
&amp; =\text{Excess}(N)_{B1} \\
-\Big(v_{0}H+(k_{0_{a}}+k_{0_{b}})G\Big) + \Big((v_{0}-f)H+(k_{N_{a}}+\hat{k}_{N_{b}})G\Big) + fH 
&amp;= \mathcal{X}_{N_{B1}}
\end{aligned}
\tag{7}
$$</p>
<p>They collaborate to create $\text{MultiSig}(N)_{A}$, its Bulletproof range proof, the signature challenge and Alice's 
portion of the signature. Bob does not share the final kernel and thus keeps his part of the aggregated signature 
hidden.</p>
<p>$$
\begin{aligned}
\mathcal{X}_{N_{B1}} &amp;= (-k_{0_{a}}+k_{N_{a}})G+(-k_{0_{b}}+\hat{k}_{N_{b}})G \\ 
&amp;= P_{N_{BA1}}+P_{N_{BB1}}
\end{aligned}
\tag{8}
$$</p>
<p>$$
\begin{aligned}
\text{Challenge:}\quad\mathcal{H}(R_{N_{BA1}}+R_{N_{BB1}}\parallel P_{N_{BA1}}+P_{N_{BB1}}\parallel 
f\parallel h_{N}) 
\end{aligned}
\tag{9}
$$</p>
<p>$$
\begin{aligned}
\text{Final signature tuple, kept secret:}\quad(s_{N_{BA1}}+s_{N_{BB1}},R_{N_{BA1}}+R_{N_{BB1}}) 
\end{aligned}
\tag{10}
$$</p>
<p>$$
\begin{aligned}
\text{Kernel of this transaction:}\quad\mathcal{K}_{N_{BB1}} 
\end{aligned}
\tag{11}
$$</p>
<h4><a class="header" href="#alice---part-2" id="alice---part-2">Alice - Part 2</a></h4>
<p align="center"><img src="scaling/laser-beam/sources/refund_procedure_03.png" width="700" /></p>
<div align="center"><b>Figure&nbsp;3: Laser Beam Refund Part 2 for Round (N)</b></div>
<p>Alice and Bob set up a refund transaction (Figure 3), which Alice controls, with the same relative time lock 
$h_{rel}$ to the intermediate funding transaction's kernel, $\mathcal{K}_{N_{AA1}}$. Output commitment values and 
blinding factors are identified by superscript $^{\prime}$.</p>
<p>$$
\begin{aligned}
-\text{MultiSig}(N)_{A}+\text{Outputs}(N)+\text{fee}
&amp; =\text{Excess}(N)_{A2} \\
-\Big((v_{0}-f)H+(\hat{k}_{N_{a}}+k_{N_{b}})G\Big)+\Big((v_{N_{a}}^{\prime}H+k_{N_{a}}^{\prime}G)+(v_{N_{b}}^
{\prime}H+k_{N_{b}}^{\prime}G)\Big)+fH
&amp;=\mathcal{X}_{N_{A2}}  \\
\end{aligned}
\tag{12}
$$</p>
<p>They collaborate to create the challenge and the aggregated signature. Because the final kernel 
$\mathcal{K}_{N_{AA1}}$ is kept secret, only its hash is shared. Alice shares this transaction's final kernel with 
Bob. The signature challenge is determined as follows:</p>
<p>$$
\begin{aligned}
\mathcal{X}_{N_{A2}} &amp;= (-\hat{k}_{N_{a}}+k_{N_{a}}^{\prime})G + (-k_{N_{b}}+k_{N_{b}}^{\prime})G \\
&amp;= P_{N_{AA2}}+P_{N_{AB2}} \\
\end{aligned}
\tag{13}
$$</p>
<p>$$
\begin{aligned}
\text{Challenge:}\quad\mathcal{H}(R_{N_{AA2}}+R_{N_{AB2}}\parallel P_{N_{AA2}}+P_{N_{AB2}}\parallel f
\parallel\mathcal{H}(\mathcal{K}_{N_{AA1}})\parallel h_{rel})
\end{aligned}
\tag{14}
$$</p>
<h4><a class="header" href="#bob---part-2" id="bob---part-2">Bob - Part 2</a></h4>
<p>Alice and Bob set up a refund transaction (Figure 3), which Bob controls, with a relative time lock $h_{rel}$ to 
the intermediate funding transaction's kernel, $\mathcal{K}_{N_{BB1}}$. Output commitment values and blinding factors 
are identified by superscript $^{\prime}$.</p>
<p>$$
\begin{aligned}
-\text{MultiSig}(N)_{B}+\text{Outputs}(N)+\text{fee}
&amp; =\text{Excess}(N)_{B2} \\
-\Big((v_{0}-f)H+(k_{N_{a}}+\hat{k}_{N_{b}})G\Big)+\Big((v_{N_{a}}^{\prime}H+k_{N_{a}}^{\prime}G)+(v_{N_{b}}^
{\prime}H+k_{N_{b}}^{\prime}G)\Big)+fH
&amp;=\mathcal{X}_{N_{B2}} \\
\end{aligned}
\tag{15}
$$</p>
<p>They collaborate to create the challenge and the aggregated signature. Because the final kernel 
$\mathcal{K}_{N_{BB1}}$ is kept secret, only its hash is shared. Bob shares this transaction's final kernel with 
Alice. The signature challenge is determined as follows:</p>
<p>$$
\begin{aligned}
\mathcal{X}_{N_{B2}} &amp;= (-k_{N_{a}}+k_{N_{a}}^{\prime})G + (-\hat{k}_{N_{b}}+k_{N_{b}}^{\prime})G \\
&amp;= P_{N_{BA2}}+P_{N_{BB2}}
\end{aligned}
\tag{16}
$$</p>
<p>$$
\begin{aligned}
\text{Challenge:}\quad\mathcal{H}(R_{N_{BA2}}+R_{N_{BB2}}\parallel P_{N_{BA2}}+P_{N_{BB2}}\parallel f
\parallel\mathcal{H}(\mathcal{K}_{N_{BB1}})\parallel h_{rel})
\end{aligned}
\tag{17}
$$</p>
<h3><a class="header" href="#revoke-previous-refund" id="revoke-previous-refund">Revoke Previous Refund</a></h3>
<p>Whenever the individual balances in the channel change, a new refund procedure is negotiated, revoking previous 
agreements (Figure 4). </p>
<p align="center"><img src="scaling/laser-beam/sources/refund_procedure_04.png" width="700" /></p>
<div align="center"><b>Figure&nbsp;4: Laser Beam Revoke for Round (N)</b></div>
<p>Revoking refund transactions involves revealing blinding factor shares for the intermediate multiparty UTXOs, thereby 
nullifying their further use. After the four parts of the refund procedure have been concluded successfully, the 
previous round's blinding factor shares $\hat{k}_{(N-1)}$  are revealed to each other, in order to revoke the previous 
agreement.</p>
<p>Alice:</p>
<p>$$
\begin{aligned}
\text{MultiSig}(N-1)_{A}:\quad\Big((v_{0}-f)H+(\hat{k}_{(N-1)_{a}}+k_{(N-1)_{b}})G\Big) 
&amp; \quad &amp; \lbrace\text{Alice's commitment}\rbrace \\
\hat{k}_{(N-1)_{a}} 
&amp; \quad &amp; \lbrace\text{Alice shares with Bob}\rbrace \\
\end{aligned}
\tag{18}
$$</p>
<p>Bob:</p>
<p>$$
\begin{aligned}
\text{MultiSig}(N-1)_{B}:\quad\Big((v_{0}-f)H+(k_{(N-1)_{a}}+\hat{k}_{(N-1)_{b}})G\Big) 
&amp; \quad &amp; \lbrace\text{Bob's commitment}\rbrace \\
\hat{k}_{(N-1)_{b}} 
&amp; \quad &amp; \lbrace\text{Bob shares with Alice}\rbrace 
\end{aligned}
\tag{19}
$$</p>
<p>Note that although the kernels for transactions (2) and (10) were kept secret, when the Bulletproof range proofs for 
$\text{MultiSig}(N-1)_{A}$ and  $\text{MultiSig}(N-1)_{B}$ were constructed, resultant values of those MultiSig 
Pedersen commitments were revealed to the counterparty. Each of them is thus able to verify the counterparty's blinding 
factor share by constructing the counterparty's MultiSig Pedersen commitment.</p>
<p>Alice verifies:</p>
<p>$$
\begin{aligned}<br />
\Big((v_{0}-f)H+(k_{(N-1)_{a}}+\hat{k}_{(N-1)_{b}})G\Big) \overset{?}{=} C(v_{0}-f,\ k_{(N-1)_{a}}+
\hat{k}_{(N-1)_{b}})
\end{aligned}
\tag{20}
$$</p>
<p>Bob verifies:</p>
<p>$$
\begin{aligned}
\Big((v_{0}-f)H+(\hat{k}_{(N-1)_{a}}+k_{(N-1)_{b}})G\Big) \overset{?}{=} C(v_{0}-f,\ \hat{k}_{(N-1)_{a}}+
k_{(N-1)_{b}})
\end{aligned}
\tag{21}
$$</p>
<p>Although each party will now have its counterparty's blinding factor share in the counterparty's intermediate multiparty 
UTXO, they will still not be able to spend it, because the corresponding transaction kernel is still kept secret by the 
counterparty. The previous round's corresponding transaction (2) or (10), with a fully signed transaction kernel, was 
never published on the blockchain.</p>
<h3><a class="header" href="#punishment-transaction" id="punishment-transaction">Punishment Transaction</a></h3>
<p>If a counterparty decides to broadcast a revoked set of refund transactions, and if the honest party is actively 
monitoring the blockchain and able to detect the attempted foul play, a punishment transaction can immediately be 
constructed before the relative time lock $h_{rel}$ expires. Whenever any of the counterparty's intermediate multiparty 
UTXOs, $\text{MultiSig}(N-m)\ \text{for}\ 0&lt;m&lt;N$, becomes available in the blockchain, the honest party can spend all 
the funds to its own output, because it knows the total blinding factor and the counterparty does not.</p>
<h3><a class="header" href="#channel-closure" id="channel-closure">Channel Closure</a></h3>
<p>Whenever the parties agree to a channel closure, the original on‑chain multiparty UTXO, $\text{MultiSig}(0)$, is spent 
to their respective outputs in a collaborative transaction. In the event of a single party deciding to close the channel 
unilaterally for whatever reason, its latest refund transaction is broadcast, effectively closing the channel. In either
case, the parties have to wait for the relative time lock $h_{rel}$ to expire before being able to claim their funds.</p>
<p>Opening a channel requires one collaborative funding transaction on the blockchain. Closing a channel involves each 
party broadcasting its respective portion of the refund transaction to the blockchain, or collaborating to broadcast a 
single settlement transaction. A round-trip open channel, multiple off‑chain spending and close channel thus involves, 
at most, three on‑chain transactions.</p>
<h2><a class="header" href="#conclusions-observations-and-recommendations-5" id="conclusions-observations-and-recommendations-5">Conclusions, Observations and Recommendations</a></h2>
<ol>
<li>
<p>MultiSig</p>
<p>The Laser Beam MultiSig corresponds to a Mimblewimble $2-of-2$ Multiparty Bulletproof UTXO, as described 
<a href="scaling/laser-beam/../../protocols/mimblewimble-mp-bp-utxo/MainReport.html#mimblewimble--ntext-of-n--multiparty-bulletproof-utxo">here</a>. 
There is more than one method for creating the MultiSig's associated Bulletproof range proof, and utilizing the 
<a href="scaling/laser-beam/../../protocols/mimblewimble-mp-bp-utxo/MainReport.html#creating-the-multiparty-bulletproof-range-proof">Bulletproofs MPC Protocol</a> 
will enable wallet reconstruction. It may also make information sharing, while constructing the Bulletproof range 
proof, more secure.</p>
</li>
<li>
<p>Linked Transactions</p>
<p>Part 2 of the refund procedure requires a kernel with a relative time lock to the kernel of its corresponding 
part 1 refund procedure, when those kernels are not yet available in the base layer, as well as a different, 
non-similar, signature challenge. Metadata about the linked transaction kernel and non-similar signature challenge 
creation must therefore be embedded within part 2 refund transaction kernels.</p>
</li>
<li>
<p>Refund Procedure</p>
<p>In the event that for round $N$, Alice or Bob decides to stop negotiations after their respective part 1 has 
been concluded and that transaction has been broadcast, the result would be that funding UTXO, $\text{MultiSig}(0)$, 
would be replaced by the respective $\text{MultiSig}(N)$. The channel will still be open. However, it also cannot be 
spent unilaterally, as the blinding factor is shared. Any new updates of the channel will then need to be based on 
$\text{MultiSig}(N)$ as the funding UTXO. Note that this cannot happen if the counterparties construct transactions 
for part 1 and part 2, conclude part 2 by signing it, and only then sign part 1.</p>
<p>In the event that for round $N$, Alice or Bob decides to stop negotiations after their respective part 1 and 
part 2 have been concluded and those transactions have been broadcast, it will effectively be a channel closure.</p>
</li>
<li>
<p>Revoke Attack Vector</p>
<p>When revoking the previous refund  $(N-1)$, Alice can get hold of Bob's blinding factor share $\hat{k}_{(N-1)_{b}}$ 
(19), and after verifying that it is correct (20), refuse to give up her blinding factor share. This will leave 
Alice with the ability to broadcast any of refund transactions $(N-1)$ and $N$, without fear of Bob broadcasting a 
punishment transaction. Bob, on the other hand, will only be able to broadcast refund transaction $N$.</p>
</li>
</ol>
<h2><a class="header" href="#appendices-4" id="appendices-4">Appendices</a></h2>
<h3><a class="header" href="#appendix-a-notation-used" id="appendix-a-notation-used">Appendix A: Notation Used</a></h3>
<ul>
<li>
<p>Let $p$ be a large prime number, $\mathbb{Z}_{p}$ denote the ring of integers $\mathrm{mod} \text{ } p$, and 
$\mathbb{F}_{p}$ be the group of elliptic curve points.</p>
</li>
<li>
<p>Let $G\in\mathbb{F}_{p}$ be a random generator point (base point) and let $H\in\mathbb{F}_{p}$ be specially chosen 
so that the value $x_{H}$ to satisfy $H=x_{H}G$ cannot be found, except if the Elliptic Curve Discrete Logarithm 
Problem (ECDLP) is solved.</p>
</li>
<li>
<p>Let commitment to value $v\in\mathbb{Z}_{p}$ be determined by calculating $C(v,k)=(vH+kG)$, which is called the 
Elliptic Curve Pedersen Commitment (Pedersen Commitment), with $k\in\mathbb{Z}_{p}$ (the blinding factor) a random 
value.</p>
</li>
<li>
<p>Let scalar multiplication be depicted by $\cdot$, e.g. $e\cdot(vH+kG)=e\cdot vH+e\cdot kG$.</p>
</li>
</ul>
<h2><a class="header" href="#references-13" id="references-13">References</a></h2>
<p>[<a href="https://tlu.tarilabs.com/scaling/layer2scaling-landscape/layer2scaling-survey.html" title="Layer 2 Scaling Survey - 
Tari Labs University">1</a>] J. A. Odendaal, &quot;Layer 2 Scaling Survey - Tari Labs University&quot; [online]. Available: 
<a href="https://tlu.tarilabs.com/scaling/layer2scaling-landscape/layer2scaling-survey.html">https://tlu.tarilabs.com/scaling/layer2scaling-landscape/layer2scaling-survey.html</a>. Date accessed: 2019‑10‑06.</p>
<p>[<a href="http://lightning.network/lightning-network-paper.pdf" title="The Bitcoin Lightning Network: 
Scalable Off-Chain Instant Payments">2</a>] J. Poon, T. Dryja (2016). &quot;The Bitcoin Lightning Network: Scalable Off-Chain Instant Payments&quot; [online].&quot; Available: 
<a href="http://lightning.network/lightning-network-paper.pdf">http://lightning.network/lightning-network-paper.pdf</a>. Date accessed: 2019‑07‑04.</p>
<p>[<a href="https://github.com/lightningnetwork/lightning-rfc" title="GitHub: lightningnetwork/lightning-rfc: 
Lightning Network Specifications">3</a>] &quot;GitHub: lightningnetwork/lightning-rfc: Lightning Network Specifications&quot; [online]. Available: 
<a href="https://github.com/lightningnetwork/lightning-rfc">https://github.com/lightningnetwork/lightning-rfc</a>. Date accessed: 2019‑07‑04.</p>
<p>[<a href="https://coinut.com/blog/whats-the-situation-of-litecoins-lightning-network-now" title="What is the situation of Litecoin's 
Lightning Network now?">4</a>] X. Wang, &quot;What is the situation of Litecoin's Lightning Network now?&quot; [online]. Available: 
<a href="https://coinut.com/blog/whats-the-situation-of-litecoins-lightning-network-now">https://coinut.com/blog/whats-the-situation-of-litecoins-lightning-network-now</a>. Date accessed: 2019‑09‑11.</p>
<p>[<a href="https://github.com/BeamMW/beam/wiki/Lightning-Network" title="GitHub: Lightning Network - 
BeamMW/beam Wiki">5</a>] The Beam Team, &quot;GitHub: Lightning Network - BeamMW/beam Wiki&quot; [online]. Available: 
<a href="https://github.com/BeamMW/beam/wiki/Lightning-Network">https://github.com/BeamMW/beam/wiki/Lightning-Network</a>. Date accessed: 2019‑07‑05.</p>
<p>[<a href="https://docs.beam.mw/Beam_lightning_network_position_paper.pdf" title="Beam - Lightning network 
position paper. (v 1.0)">6</a>] F. Jahr, &quot;Beam - Lightning Network Position Paper. (v 1.0)&quot; [online]. Available: 
<a href="https://docs.beam.mw/Beam_lightning_network_position_paper.pdf">https://docs.beam.mw/Beam_lightning_network_position_paper.pdf</a>. Date accessed: 2019‑07‑04.</p>
<p>[<a href="https://github.com/fjahr/lightning-mw" title="GitHub: fjahr/lightning-mw, 
Lightning Network Specifications">7</a>] F. Jahr, &quot;GitHub: fjahr/lightning-mw, Lightning Network Specifications&quot; [online]. Available: 
<a href="https://github.com/fjahr/lightning-mw">https://github.com/fjahr/lightning-mw</a>. Date accessed: 2019‑07‑04.</p>
<p>[<a href="https://github.com/BeamMW/beam/tree/master/node/laser_beam_demo" title="GitHub: beam/node/laser_beam_demo 
at master - BeamMW/beam">8</a>] The Beam Team, &quot;GitHub: beam/node/laser_beam_demo at master - BeamMW/beam&quot; [online]. Available: 
<a href="https://github.com/BeamMW/beam/tree/master/node/laser_beam_demo">https://github.com/BeamMW/beam/tree/master/node/laser_beam_demo</a>. Date accessed: 2019‑07‑05.</p>
<p>[<a href="https://github.com/BeamMW/beam/blob/mainnet/core/ecc_bulletproof.cpp" title="GitHub: beam/ecc_bulletproof.cpp 
at mainnet - BeamMW/beam">9</a>] The Beam Team, &quot;GitHub: beam/ecc_bulletproof.cpp at mainnet - BeamMW/beam&quot; [online]. Available: 
<a href="https://github.com/BeamMW/beam/blob/mainnet/core/ecc_bulletproof.cpp">https://github.com/BeamMW/beam/blob/mainnet/core/ecc_bulletproof.cpp</a>. Date accessed: 2019‑07‑05.</p>
<p>[<a href="https://suredbits.com/lightning-101-for-exchanges-overview/" title="Lightning 101 for Exchanges">10</a>] D. Smith, N. Kohen, and C. Stewart, “Lightning 101 for Exchanges” [online]. Available: 
<a href="https://suredbits.com/lightning-101-for-exchanges-overview">https://suredbits.com/lightning-101-for-exchanges-overview</a>. Date accessed: 2019‑11‑06.</p>
<h2><a class="header" href="#contributors-9" id="contributors-9">Contributors</a></h2>
<ul>
<li><a href="https://github.com/hansieodendaal">https://github.com/hansieodendaal</a></li>
<li><a href="https://github.com/anselld">https://github.com/anselld</a></li>
<li><a href="https://github.com/SWvheerden">https://github.com/SWvheerden</a></li>
<li><a href="https://github.com/Empiech007">https://github.com/Empiech007</a></li>
<li><a href="https://github.com/mikethetike">https://github.com/mikethetike</a></li>
</ul>
<h1><a class="header" href="#merged-mining" id="merged-mining">Merged Mining</a></h1>
<h2><a class="header" href="#purpose-3" id="purpose-3">Purpose</a></h2>
<p>The purpose of merged mining is to allow the mining of more than one cryptocurrency without necessitating additional 
Proof-of-Work effort (PoW) [<a href="https://www.researchgate.net/publication/319647721_Merged_Mining_Curse_or_Cure" title="Merged Mining">1</a>].</p>
<h2><a class="header" href="#definitions-3" id="definitions-3">Definitions</a></h2>
<ul>
<li>
<p>From <strong>BitcoinWiki</strong>: Merged mining is the act of using work done on another block chain (the Parent) on one or more Auxiliary block chains and to accept it as valid on its own chain, using Auxiliary Proof-of-Work (AuxPoW), which is the relationship between two block chains for one to trust the other's work as their own. The Parent block chain does not need to be aware of the AuxPoW logic as blocks submitted to it are still valid blocks [<a href="https://en.bitcoin.it/wiki/Merged_mining_specification" title="Merged Mining Specification">2</a>].</p>
</li>
<li>
<p>From <strong>CryptoCompare</strong>: Merged mining is the process of allowing two different crypto currencies based on the same algorithm to be mined simultaneously. This allows low hash powered crypto currencies to increase the hashing power behind their network by bootstrapping onto more popular crypto currencies [<a href="https://www.cryptocompare.com/mining/guides/what-is-merged-mining-bitcoin-namecoin-litecoin-dogecoin/" title="What is Merged Mining – 
Bitcoin &amp; Namecoin – 
Litecoin &amp; Dogecoin?">3</a>].</p>
</li>
</ul>
<h2><a class="header" href="#references-14" id="references-14">References</a></h2>
<p>[<a href="https://www.researchgate.net/publication/319647721_Merged_Mining_Curse_or_Cure" title="Merged Mining">1</a>] &quot;Merged Mining&quot; [online]. Conference Paper.
Available: <a href="https://www.researchgate.net/publication/319647721_Merged_Mining_Curse_or_Cure">https://www.researchgate.net/publication/319647721_Merged_Mining_Curse_or_Cure</a>. Date accessed: 2019‑06‑10.</p>
<p>[<a href="https://en.bitcoin.it/wiki/Merged_mining_specification" title="Merged Mining Specification">2</a>] BitcoinWiki: &quot;Merged Mining Specification&quot; [online]. 
Available: <a href="https://en.bitcoin.it/wiki/Merged_mining_specification">https://en.bitcoin.it/wiki/Merged_mining_specification</a>. 
Date accessed: 2019‑06‑10.</p>
<p>[<a href="https://www.cryptocompare.com/mining/guides/what-is-merged-mining-bitcoin-namecoin-litecoin-dogecoin/" title="What is Merged Mining – 
Bitcoin &amp; Namecoin – 
Litecoin &amp; Dogecoin?">3</a>] CryptoCompare: &quot;What is merged mining – Bitcoin &amp; Namecoin – Litecoin &amp; Dogecoin?&quot; [online]. 
Available: <a href="https://www.cryptocompare.com/mining/guides/what-is-merged-mining-bitcoin-namecoin-litecoin-dogecoin/">https://www.cryptocompare.com/mining/guides/what-is-merged-mining-bitcoin-namecoin-litecoin-dogecoin/</a>. 
Date accessed: 2019‑06‑10.</p>
<h1><a class="header" href="#merged-mining-introduction" id="merged-mining-introduction">Merged Mining Introduction</a></h1>
<ul>
<li><a href="merged-mining/merged-mining-scene/MergedMiningIntroduction.html#what-is-merged-mining">What is Merged Mining?</a></li>
<li><a href="merged-mining/merged-mining-scene/MergedMiningIntroduction.html#merged-mining-with-multiple-auxiliary-chains">Merged Mining with Multiple Auxiliary Chains</a></li>
<li><a href="merged-mining/merged-mining-scene/MergedMiningIntroduction.html#merged-mining---interesting-facts-and-case-studies">Merged Mining - Interesting Facts and Case Studies</a>
<ul>
<li><a href="merged-mining/merged-mining-scene/MergedMiningIntroduction.html#namecoin-307-with-bitcoin-1">Namecoin (#307) with Bitcoin (#1)</a></li>
<li><a href="merged-mining/merged-mining-scene/MergedMiningIntroduction.html#dogecoin-37-with-litecoin-6">Dogecoin (#37) with Litecoin (#6)</a></li>
<li><a href="merged-mining/merged-mining-scene/MergedMiningIntroduction.html#huntercoin-779-with-bitcoin-1-or-litecoin-6">Huntercoin (#779) with Bitcoin (#1) or Litecoin (#6)</a></li>
<li><a href="merged-mining/merged-mining-scene/MergedMiningIntroduction.html#myriad-510-with-bitcoin-1-or-litecoin-6">Myriad (#510) with Bitcoin (#1) or Litecoin (#6)</a></li>
<li><a href="merged-mining/merged-mining-scene/MergedMiningIntroduction.html#monero-12digitalnote-166--fantomcoin-1068">Monero (#12)/DigitalNote (#166) + FantomCoin (#1068)</a></li>
<li><a href="merged-mining/merged-mining-scene/MergedMiningIntroduction.html#some-statistics">Some Statistics</a></li>
<li><a href="merged-mining/merged-mining-scene/MergedMiningIntroduction.html#observations">Observations</a></li>
</ul>
</li>
<li><a href="merged-mining/merged-mining-scene/MergedMiningIntroduction.html#attack-vectors">Attack Vectors</a>
<ul>
<li><a href="merged-mining/merged-mining-scene/MergedMiningIntroduction.html#attack-vectors">51% Attacks</a></li>
<li><a href="merged-mining/merged-mining-scene/MergedMiningIntroduction.html#double-proof">Double Proof</a></li>
<li><a href="merged-mining/merged-mining-scene/MergedMiningIntroduction.html#analysis-of-mining-power-centralization-issues">Analysis of Mining Power Centralization Issues</a></li>
<li><a href="merged-mining/merged-mining-scene/MergedMiningIntroduction.html#introduction-of-new-attack-vectors">Introduction of New Attack Vectors </a></li>
</ul>
</li>
<li><a href="merged-mining/merged-mining-scene/MergedMiningIntroduction.html#references">References</a></li>
<li><a href="merged-mining/merged-mining-scene/MergedMiningIntroduction.html#contributors">Contributors</a></li>
</ul>
<h2><a class="header" href="#what-is-merged-mining" id="what-is-merged-mining">What is Merged Mining?</a></h2>
<p>Merged mining is the act of using work done on another blockchain (the Parent) on one or more than one Auxiliary 
blockchain and to accept it as valid on its own chain, using Auxiliary Proof-of-Work (AuxPoW), which is the relationship 
between two blockchains for one to trust the other's work as their own. The Parent blockchain does not need to be aware 
of the AuxPoW logic, as blocks submitted to it are still valid blocks [<a href="https://en.bitcoin.it/wiki/Merged_mining_specification" title="Merged Mining Specification">1</a>].</p>
<p>As an example, the structure of merged mined blocks in Namecoin and Bitcoin is shown here [<a href="http://repositum.tuwien.ac.at/obvutwhs/download/pdf/2315652" title="Merged Mining: Analysis of 
Effects and Implications">25</a>]:</p>
<p align="center"><img src="merged-mining/merged-mining-scene/sources/MergedMiningIntro01.png" width="700" /></p>
<p>A transaction set is assembled for both blockchains. The hash of the AuxPoW block header is then inserted in the &quot;free&quot; 
bytes region (coinbase field) of the coinbase transaction and submitted to the Parent blockchain's Proof-of-Work (PoW). 
If the merge miner solves the block at the difficulty level of either blockchain or both blockchains, the respective 
block(s) are reassembled with the completed PoW and submitted to the correct blockchain. In the case of the Auxiliary 
blockchain, the Parent's block hash, Merkle tree branch and coinbase transaction are inserted in the Auxiliary block's 
AuxPoW header. This is to prove that enough work that meets the difficulty level of the Auxiliary blockchain was done 
on the Parent blockchain ([<a href="https://en.bitcoin.it/wiki/Merged_mining_specification" title="Merged Mining Specification">1</a>], [<a href="https://bitcoin.stackexchange.com/questions/273/how-does-merged-mining-work" title="How does Merged Mining Work?">2</a>], [<a href="http://repositum.tuwien.ac.at/obvutwhs/download/pdf/2315652" title="Merged Mining: Analysis of 
Effects and Implications">25</a>]).</p>
<p>The propagation of Parent and Auxiliary blocks is totally independent and only governed by each chain's difficulty level. 
As an example, the following diagram shows how this can play out in practice with Namecoin and Bitcoin when the Parent 
difficulty (D<sub>BTC</sub>) is more than the Auxiliary difficulty (D<sub>NMC</sub>). Note that <em>BTC block 2'</em> did not 
become part of the Parent blockchain propagation.</p>
<p align="center"><img src="merged-mining/merged-mining-scene/./sources/MergedMiningIntro02.png" width="1100" /></p>
<h2><a class="header" href="#merged-mining-with-multiple-auxiliary-chains" id="merged-mining-with-multiple-auxiliary-chains">Merged Mining with Multiple Auxiliary Chains</a></h2>
<p>A miner can use a single Parent to perform merged mining on multiple Auxiliary blockchains. The Merkle tree root of a 
Merkle tree that contains the block hashes of the Auxiliary blocks as leaves must then be inserted in the Parent's 
coinbase field as shown in the following diagram. To prevent double spending attacks, each Auxiliary blockchain must 
specify a unique ID that can be used to derive the leaf of the Merkle tree where the respective block hash must be 
located [<a href="http://repositum.tuwien.ac.at/obvutwhs/download/pdf/2315652" title="Merged Mining: Analysis of 
Effects and Implications">25</a>].</p>
<p align="center"><img src="merged-mining/merged-mining-scene/./sources/MergedMiningIntro03.png" width="750" /></p>
<h2><a class="header" href="#merged-mining---interesting-facts-and-case-studies" id="merged-mining---interesting-facts-and-case-studies">Merged Mining - Interesting Facts and Case Studies</a></h2>
<h3><a class="header" href="#namecoin-307-with-bitcoin-1" id="namecoin-307-with-bitcoin-1">Namecoin (#307) with Bitcoin (#1)</a></h3>
<ul>
<li>Namecoin, the first fork of Bitcoin, introduced merged mining with Bitcoin [<a href="https://en.bitcoin.it/wiki/Merged_mining_specification" title="Merged Mining Specification">1</a>] from block 19,200 onwards [<a href="https://github.com/namecoin/wiki/blob/master/Merged-Mining.mediawiki" title="Merged-Mining.mediawiki">3</a>]. At 
the time of writing (May 2018), the block height of Namecoin was greater than 400,500 [<a href="https://bchain.info/NMC" title="Bchain.info - Blockchain Explorer (NMC)">4</a>].</li>
<li>Over the five-day period from 23 May 2018 to 27 May 2018, only 226 out of 752 blocks posted 
transaction values over 
and above the block reward of 25 NMC, with an average transaction value of 159.231 NMC including the block reward. [<a href="https://bchain.info/NMC" title="Bchain.info - Blockchain Explorer (NMC)">4</a>]</li>
<li>Slush Pool merged mining Namecoin with Bitcoin rewards all miners with BTC equivalent to NMC via an external exchange 
service [<a href="https://slushpool.com/help/first-aid/faq-merged-mining" title="SlushPool Merged Mining">5</a>].</li>
<li>P2pool, Multipool, Slush Pool, Eligius and F2pool are cited as top Namecoin merged mining pools [<a href="https://www.prooworld.com/namecoin/best-namecoin-mining-pools" title="5 Best Namecoin Mining Pools 
of 2018 (Comparison)">6</a>].</li>
</ul>
<table><thead><tr><th>@ 2018-05-30</th><th>Bitcoin [<a href="https://bitinfocharts.com" title="BitInfoCharts">16</a>]</th><th>Namecoin [<a href="https://bitinfocharts.com" title="BitInfoCharts">16</a>]</th><th>Ratio</th></tr></thead><tbody>
<tr><td>Block time target (s)</td><td>600</td><td>600</td><td>100.00%</td></tr>
<tr><td>Hash rate (Ehash/s)</td><td>31.705</td><td>21.814</td><td>68.80%</td></tr>
<tr><td>Blocks count</td><td>525,064</td><td>400,794</td><td>76.33%</td></tr>
</tbody></table>
<h3><a class="header" href="#dogecoin-37-with-litecoin-6" id="dogecoin-37-with-litecoin-6">Dogecoin (#37) with Litecoin (#6)</a></h3>
<ul>
<li>Dogecoin introduced merged mining with Litecoin [<a href="https://www.reddit.com/r/dogecoin/comments/22niq9/merged_mining_amafaq" title="Merged Mining AMA/FAQ">8</a>] from block 371,337 onwards [<a href="merged-mining/merged-mining-scene/ESThttps://www.reddit.com/r/dogecoin/comments/2fyxg1/the_forkening_is_happening_at_900am_est_a_couple" title="The Forkening is Happening at ~9:00AM">9</a>]. At the time of writing 
(May 2018), the block height of Dogecoin was greater than 2,240,000 [<a href="https://dogechain.info" title="Dogecoin Blockchain Explorer">10</a>].</li>
<li>Many in the Dogecoin user community believe merged mining with Litecoin saved Dogecoin from a 51% attack [<a href="https://www.reddit.com/r/dogecoin/comments/22niq9/merged_mining_amafaq" title="Merged Mining AMA/FAQ">8</a>].</li>
</ul>
<table><thead><tr><th>@ 2018-05-30</th><th>Litecoin [<a href="https://bitinfocharts.com" title="BitInfoCharts">16</a>]</th><th>Dogecoin [<a href="https://bitinfocharts.com" title="BitInfoCharts">16</a>]</th><th>Ratio</th></tr></thead><tbody>
<tr><td>Block time target (s)</td><td>150</td><td>60</td><td>40.00%</td></tr>
<tr><td>Hash rate (Thash/s)</td><td>311.188</td><td>235.552</td><td>75.69%</td></tr>
<tr><td>Blocks count</td><td>1,430,517</td><td>2,241,120</td><td>156.67%</td></tr>
</tbody></table>
<h3><a class="header" href="#huntercoin-779-with-bitcoin-1-or-litecoin-6" id="huntercoin-779-with-bitcoin-1-or-litecoin-6">Huntercoin (#779) with Bitcoin (#1) or Litecoin (#6)</a></h3>
<ul>
<li>Huntercoin was released as a live experimental test to see how blockchain technology could handle full-on game 
worlds [<a href="http://huntercoin.org" title="Huntercoin: A Blockchain based 
Game World">22</a>].</li>
<li>Huntercoin was originally designed to be supported for only one year, but development and support will continue [<a href="http://huntercoin.org" title="Huntercoin: A Blockchain based 
Game World">22</a>].</li>
<li>Players are awarded coins for gaming, thus the world's first human mineable cryptocurrency.</li>
<li>Coin distribution: 10 coins per block, nine for the game world and one for the miners [<a href="http://huntercoin.org" title="Huntercoin: A Blockchain based 
Game World">22</a>].</li>
</ul>
<table><thead><tr><th>@ 2018-06-01</th><th>Huntercoin</th></tr></thead><tbody>
<tr><td>Block time target (s)</td><td>120</td></tr>
<tr><td>blockchain size (GB)</td><td>17</td></tr>
<tr><td>Pruned blockchain size (GB)</td><td>0.5</td></tr>
<tr><td>Blocks count</td><td>2,291,060</td></tr>
<tr><td>PoW algorithm (for merged mining)</td><td>SHA256, Scrypt</td></tr>
</tbody></table>
<h3><a class="header" href="#myriad-510-with-bitcoin-1-or-litecoin-6" id="myriad-510-with-bitcoin-1-or-litecoin-6">Myriad (#510) with Bitcoin (#1) or Litecoin (#6)</a></h3>
<ul>
<li>Myriad is the first currency to support five PoW algorithms and claims its multi-PoW algorithm approach offers 
exceptional 51% resistance [<a href="http://myriadcoin.org" title="Myriad: A Coin for Everyone">23</a>].</li>
<li>Myriad introduced merged mining from block 1,402,791 onwards [<a href="https://eprint.iacr.org/2017/791.pdf" title="Merged Mining: Curse or Cure?">24</a>].</li>
</ul>
<table><thead><tr><th>@ 2018-06-01</th><th>Myriad</th></tr></thead><tbody>
<tr><td>Block time target (s)</td><td>60</td></tr>
<tr><td>blockchain size (GB)</td><td>2.095</td></tr>
<tr><td>Blocks count</td><td>2,442,829</td></tr>
<tr><td>PoW algorithm (for merged mining)</td><td>SHA256d, Scrypt</td></tr>
<tr><td>PoW algorithm (others)</td><td>Myr-Groestl, Skein, Yescrypt</td></tr>
</tbody></table>
<ul>
<li>
<p>Some solved multi-PoW block examples follow:</p>
<ul>
<li><img src="merged-mining/merged-mining-scene/./sources/Myriad-1.png" alt="Myriad-1" /></li>
<li><img src="merged-mining/merged-mining-scene/./sources/Myriad-2.png" alt="Myriad-2" /></li>
<li><img src="merged-mining/merged-mining-scene/./sources/Myriad-3.png" alt="Myriad-3" /></li>
</ul>
</li>
</ul>
<h3><a class="header" href="#monero-12digitalnote-166--fantomcoin-1068" id="monero-12digitalnote-166--fantomcoin-1068">Monero (#12)/DigitalNote (#166) + FantomCoin (#1068)</a></h3>
<ul>
<li>FantamCoin was the first CryptoNote-based coin to develop merged mining with Monero, but was abandoned until 
DigitalNote developers became interested in merged mining with Monero and revived FantamCoin in October 2016 
([<a href="https://minergate.com/blog/merged-mining-with-monero" title="Merged Mining with Monero">17</a>], [<a href="https://bitcointalk.org/index.php?topic=1082745.msg16615346#msg16615346" title="NN DigitalNote |XDN| - ICCO Announce - NEWS">18</a>], [<a href="https://github.com/xdn-project" title="DigitalNote xdn-project">19</a>]).</li>
</ul>
<pre><code class="language-text"> FantamCoin Release notes 2.0.0
 - Fantomcoin 2.0 by XDN-project, major FCN update to the latest
   cryptonotefoundation codebase 
 - New FCN+XMR merged merged mining 
 - Default block size - 100Kb
 
 DigitalNote Release notes 4.0.0-beta
 - EmPoWering XDN network security with merged mining with any CryptoNote 
   cryptocurrency
 - Second step to the PoA with the new type of PoW merged mining blocks
</code></pre>
<ul>
<li>DigitalNote and FantomCoin merged mining with Monero are now stuck with the recent CryptoNight-based Monero forks 
such as Monero Classic and Monero Original after Monero's recent hard fork to CryptoNight v7. 
(Refer to <a href="merged-mining/merged-mining-scene/MergedMiningIntroduction.html#attack-vectors">Attack Vectors</a>.)</li>
</ul>
<table><thead><tr><th>@ 2018-05-31</th><th>Monero [<a href="https://bitinfocharts.com" title="BitInfoCharts">16</a>]</th><th>DigitalNote [<a href="https://bitinfocharts.com" title="BitInfoCharts">16</a>]</th><th>Ratio</th></tr></thead><tbody>
<tr><td>Block time target (s)</td><td>120</td><td>240</td><td>200.00%</td></tr>
<tr><td>Hash rate (Mhash/s)</td><td>410.804</td><td>13.86</td><td>3.37%</td></tr>
<tr><td>Blocks count</td><td>1,583,869</td><td>660,075</td><td>41.67%</td></tr>
</tbody></table>
<table><thead><tr><th>@ 2018-05-31</th><th>Monero [<a href="https://bitinfocharts.com" title="BitInfoCharts">16</a>]</th><th>FantomCoin [<a href="https://bitinfocharts.com" title="BitInfoCharts">16</a>]</th><th>Ratio</th></tr></thead><tbody>
<tr><td>Block time target (s)</td><td>120</td><td>60</td><td>50.00%</td></tr>
<tr><td>Hash rate (Mhash/s)</td><td>410.804</td><td>19.29</td><td>4.70%</td></tr>
<tr><td>Blocks count</td><td>1,583,869</td><td>2,126,079</td><td>134.23%</td></tr>
</tbody></table>
<h3><a class="header" href="#some-statistics" id="some-statistics">Some Statistics</a></h3>
<p>Merge-mined blocks in some cryptocurrencies on 18 June 2017 [<a href="https://eprint.iacr.org/2017/791.pdf" title="Merged Mining: Curse or Cure?">24</a>]:</p>
<p align="center"><img src="merged-mining/merged-mining-scene/./sources/MergedMiningStats-1.png" width="350" /></p>
<h3><a class="header" href="#observations-1" id="observations-1">Observations</a></h3>
<ul>
<li>The Auxiliary blockchain's target block times can be smaller than, equal to or larger than the Parent blockchain.</li>
<li>The Auxiliary blockchain's hash rate is generally smaller than, but of the same order of magnitude as that of, the 
Parent blockchain.</li>
<li>A multi-PoW algorithm approach may further enhance 51% resistance.</li>
</ul>
<h2><a class="header" href="#attack-vectors" id="attack-vectors">Attack Vectors</a></h2>
<h3><a class="header" href="#51-attacks" id="51-attacks">51% Attacks</a></h3>
<ul>
<li>
<p>51% attacks are real and relevant today. Bitcoin Gold (rank #28 @ 2018‑05‑29) and Verge (rank #33 @ 2018‑05‑29) 
suffered recent attacks with double spend transactions following ([<a href="https://www.ccn.com/bitcoin-gold-hit-by-double-spend-attack-exchanges-lose-millions" title="Bitcoin Gold Hit by Double 
Spend Attack, Exchanges Lose Millions">11</a>], [<a href="https://www.ccn.com/privacy-coin-verge-succumbs-to-51-attack-again" title="Privacy Coin Verge Succumbs 
to 51% Attack [Again]">12</a>]).</p>
</li>
<li>
<p>In a conservative analysis, successful attacks on PoW cryptocurrencies are more likely when dishonest entities control 
more than 25% of the total mining power [<a href="https://eprint.iacr.org/2017/791.pdf" title="Merged Mining: Curse or Cure?">24</a>].</p>
</li>
<li>
<p>Tari tokens are envisaged to be merged mined with Monero [<a href="https://www.tari.com" title="Tari Official Website">13</a>]. The Monero blockchain security is therefore important 
to the Tari blockchain. </p>
</li>
<li>
<p>Monero recently (6 April 2018) introduced a hard fork with upgraded PoW algorithm CryptoNight v7 at block height 
1,546,000 to maintain its Application Specific Integrated Circuit (ASIC) resistance and hence guard against 51% attacks. 
The Monero team proposes changes to their PoW every scheduled fork (i.e. every six months) ([<a href="https://www.ccn.com/monero-hard-forks-to-maintain-asic-resistance-but-classic-hopes-to-spoil-the-party" title="Monero Hard Forks to 
Maintain ASIC Resistance, but 
‘Classic’ Hopes to Spoil the Party">14</a>], [<a href="https://getmonero.org/2018/02/11/pow-change-and-key-reuse.html" title="PoW Change and Key Reuse">15</a>]).</p>
</li>
<li>
<p>An interesting question arises regarding what needs to happen to the Tari blockchain if the Monero blockchain is hard 
forked. Since the CryptoNight v7 hard fork, the network hash rate for Monero hovers around approximately 500MH/s, 
whereas in the two months immediately prior it was approximately 1,000MH/s [<a href="https://chainradar.com/xmr/chart" title="Monero Charts">20</a>](https://chainradar.com/xmr/chart). 
Thus 50% of the hash power can be ascribed to ASICS and botnet miners.</p>
</li>
</ul>
<p><img src="merged-mining/merged-mining-scene/./sources/MoneroHashRate.png" alt="MoneroHashRate" /></p>
<p>NiceHash statistics for CryptoNight v7 [<a href="https://www.nicehash.com/algorithm/cryptonightv7" title="Nicehash Statistics for 
CryptoNight v7">21</a>] show a lag of two days for approximately 100,600 miners to get up to speed 
with providing the new hashing power after the Monero hard fork.</p>
<p align="center"><img src="merged-mining/merged-mining-scene/./sources/CryptoNight-v7.png" width="750" /></p>
<p>The Tari blockchain will have to fork together with or just after a scheduled Monero fork. The Tari blockchain will be 
vulnerable to ASIC miners until it has been forked.</p>
<h3><a class="header" href="#double-proof" id="double-proof">Double Proof</a></h3>
<ul>
<li>A miner could cheat the PoW system by putting more than one Auxiliary block header into one Parent block [<a href="https://en.bitcoin.it/wiki/Alternative_chain#Protecting_against_double_proof" title="Alternative Chain">7</a>]. </li>
<li>Multiple Auxiliary blocks could be competing for the same PoW, and could subject your Auxiliary blockchain to 
nothing-at-stake attacks if the chain is forked, maliciously or by accident, with consequent attempts to reverse 
transactions ([<a href="https://en.bitcoin.it/wiki/Alternative_chain#Protecting_against_double_proof" title="Alternative Chain">7</a>], [<a href="https://github.com/ethereum/wiki/wiki/Problems" title="Problems - Consensus - 8. 
Proof of Stake">26</a>]).</li>
<li>More than one Auxiliary blockchain will be merge-mined with Monero.</li>
</ul>
<h3><a class="header" href="#analysis-of-mining-power-centralization-issues" id="analysis-of-mining-power-centralization-issues">Analysis of Mining Power Centralization Issues</a></h3>
<p>With reference to [<a href="https://eprint.iacr.org/2017/791.pdf" title="Merged Mining: Curse or Cure?">24</a>] and [<a href="http://repositum.tuwien.ac.at/obvutwhs/download/pdf/2315652" title="Merged Mining: Analysis of 
Effects and Implications">25</a>]:</p>
<ul>
<li>In Namecoin, F2Pool reached and maintained a majority of the mining power for prolonged periods.</li>
<li>Litecoin has experienced slight centralization since mid-2014, caused by Clevermining and F2Pool, among others.</li>
<li>In Dogecoin, F2Pool was responsible for generating more than 33% of the blocks per day for significant periods, even 
exceeding the 50% threshold around the end of 2016.</li>
<li>Huntercoin was instantly dominated by F2Pool and remained in this state until mid-2016.</li>
<li>Myriadcoin appears to have experienced only a moderate impact. Multi-merge-mined blockchains allow for more than one 
parent cryptocurrency and have a greater chance of acquiring a higher difficulty per PoW algorithm than the respective 
parent blockchain.</li>
<li>Distribution of overall percentage of days below or above the centralization indicator thresholds on 18 June 2017 was 
as follows:</li>
</ul>
<p align="center"><img src="merged-mining/merged-mining-scene/./sources/MergedMiningStats-2.png" width="350" /></p>
<h3><a class="header" href="#introduction-of-new-attack-vectors" id="introduction-of-new-attack-vectors">Introduction of New Attack Vectors</a></h3>
<p>With reference to [<a href="https://eprint.iacr.org/2017/791.pdf" title="Merged Mining: Curse or Cure?">24</a>] and [<a href="http://repositum.tuwien.ac.at/obvutwhs/download/pdf/2315652" title="Merged Mining: Analysis of 
Effects and Implications">25</a>]:</p>
<ul>
<li>Miners can generate blocks for the merge-mined child blockchains at almost no additional cost, enabling attacks 
without risking financial losses.</li>
<li>Merged mining as an attack vector works both ways, as parent cryptocurrencies cannot easily prevent being merge-mined 
by auxiliary blockchains.</li>
<li>Merged mining can increase the hash rate of auxiliary blockchains, but it is not conclusively successful as a 
bootstrapping technique.</li>
<li>Empirical evidence suggests that only a small number of mining pools are involved in merged mining, and they enjoy 
block shares beyond the desired security and decentralization goals.</li>
</ul>
<h2><a class="header" href="#references-15" id="references-15">References</a></h2>
<p>[<a href="https://en.bitcoin.it/wiki/Merged_mining_specification" title="Merged Mining Specification">1</a>] &quot;Merged Mining Specification&quot; [online).
Available: <a href="https://en.bitcoin.it/wiki/Merged_mining_specification">https://en.bitcoin.it/wiki/Merged_mining_specification</a>. Date accessed: 2018‑05‑28.</p>
<p>[<a href="https://bitcoin.stackexchange.com/questions/273/how-does-merged-mining-work" title="How does Merged Mining Work?">2</a>] &quot;How does Merged Mining Work?&quot; [Online.]
Available: <a href="https://bitcoin.stackexchange.com/questions/273/how-does-merged-mining-work">https://bitcoin.stackexchange.com/questions/273/how-does-merged-mining-work</a>. Date accessed: 
2018‑05‑28.</p>
<p>[<a href="https://github.com/namecoin/wiki/blob/master/Merged-Mining.mediawiki" title="Merged-Mining.mediawiki">3</a>] &quot;Merged-Mining.mediawiki&quot; [online].
Available: <a href="https://github.com/namecoin/wiki/blob/master/Merged-Mining.mediawiki">https://github.com/namecoin/wiki/blob/master/Merged-Mining.mediawiki</a>. Date accessed: 2018‑05‑28.</p>
<p>[<a href="https://bchain.info/NMC" title="Bchain.info - Blockchain Explorer (NMC)">4</a>] &quot;Bchain.info - Blockchain Explorer (NMC)&quot; [online].
Available: <a href="https://bchain.info/NMC">https://bchain.info/NMC</a>. Date accessed: 2018‑05‑28.</p>
<p>[<a href="https://slushpool.com/help/first-aid/faq-merged-mining" title="SlushPool Merged Mining">5</a>] &quot;SlushPool Merged Mining&quot; [online].
Available: <a href="https://slushpool.com/help/first-aid/faq-merged-mining">https://slushpool.com/help/first-aid/faq-merged-mining</a>. Date accessed: 2018‑05‑28.</p>
<p>[<a href="https://www.prooworld.com/namecoin/best-namecoin-mining-pools" title="5 Best Namecoin Mining Pools 
of 2018 (Comparison)">6</a>] &quot;5 Best Namecoin Mining Pools of 2018 (Comparison)&quot; [online].
Available: <a href="https://www.prooworld.com/namecoin/best-namecoin-mining-pools">https://www.prooworld.com/namecoin/best-namecoin-mining-pools</a>. Date accessed: 2018‑05‑28.</p>
<p>[<a href="https://en.bitcoin.it/wiki/Alternative_chain#Protecting_against_double_proof" title="Alternative Chain">7</a>] &quot;Alternative Chain&quot; [online].
Available: <a href="https://en.bitcoin.it/wiki/Alternative_chain#Protecting_against_double_proof">https://en.bitcoin.it/wiki/Alternative_chain#Protecting_against_double_proof</a>. Date accessed: 2018‑05‑28.</p>
<p>[<a href="https://www.reddit.com/r/dogecoin/comments/22niq9/merged_mining_amafaq" title="Merged Mining AMA/FAQ">8</a>] &quot;Merged Mining AMA/FAQ&quot; [online].
Available: <a href="https://www.reddit.com/r/dogecoin/comments/22niq9/merged_mining_amafaq">https://www.reddit.com/r/dogecoin/comments/22niq9/merged_mining_amafaq</a>. Date accessed: 2018‑05‑29.</p>
<p>[<a href="merged-mining/merged-mining-scene/ESThttps://www.reddit.com/r/dogecoin/comments/2fyxg1/the_forkening_is_happening_at_900am_est_a_couple" title="The Forkening is Happening at ~9:00AM">9</a>] &quot;The Forkening is Happening at ~9:00AM EST&quot; [online].
Available: <a href="https://www.reddit.com/r/dogecoin/comments/2fyxg1/the_forkening_is_happening_at_900am_est_a_couple">https://www.reddit.com/r/dogecoin/comments/2fyxg1/the_forkening_is_happening_at_900am_est_a_couple</a>. 
Date accessed: 2018‑05‑29.</p>
<p>[<a href="https://dogechain.info" title="Dogecoin Blockchain Explorer">10</a>] &quot;Dogecoin Blockchain Explorer&quot; [online].
Available: <a href="https://dogechain.info">https://dogechain.info</a>.  Date accessed: 2018‑05‑29.</p>
<p>[<a href="https://www.ccn.com/bitcoin-gold-hit-by-double-spend-attack-exchanges-lose-millions" title="Bitcoin Gold Hit by Double 
Spend Attack, Exchanges Lose Millions">11</a>] &quot;Bitcoin Gold Hit by Double Spend Attack, Exchanges Lose Millions&quot; [online].
Available: <a href="https://www.ccn.com/bitcoin-gold-hit-by-double-spend-attack-exchanges-lose-millions">https://www.ccn.com/bitcoin-gold-hit-by-double-spend-attack-exchanges-lose-millions</a>. Date accessed: 
2018‑05‑29.</p>
<p>[<a href="https://www.ccn.com/privacy-coin-verge-succumbs-to-51-attack-again" title="Privacy Coin Verge Succumbs 
to 51% Attack [Again]">12</a>] &quot;Privacy Coin Verge Succumbs to 51% Attack&quot; [Again]. [Online.]
Available: <a href="https://www.ccn.com/privacy-coin-verge-succumbs-to-51-attack-again">https://www.ccn.com/privacy-coin-verge-succumbs-to-51-attack-again</a>. Date accessed: 2018‑05‑29.</p>
<p>[<a href="https://www.tari.com" title="Tari Official Website">13</a>] &quot;Tari Official Website&quot; [online].
Available: <a href="https://www.tari.com">https://www.tari.com</a>. Date accessed: 2018‑05‑29.</p>
<p>[<a href="https://www.ccn.com/monero-hard-forks-to-maintain-asic-resistance-but-classic-hopes-to-spoil-the-party" title="Monero Hard Forks to 
Maintain ASIC Resistance, but 
‘Classic’ Hopes to Spoil the Party">14</a>] &quot;Monero Hard Forks to Maintain ASIC Resistance, but ‘Classic’ Hopes to Spoil the Party&quot; [online].
Available: <a href="https://www.ccn.com/monero-hard-forks-to-maintain-asic-resistance-but-classic-hopes-to-spoil-the-party">https://www.ccn.com/monero-hard-forks-to-maintain-asic-resistance-but-classic-hopes-to-spoil-the-party</a>. 
Date accessed: 2018‑05‑29.</p>
<p>[<a href="https://getmonero.org/2018/02/11/pow-change-and-key-reuse.html" title="PoW Change and Key Reuse">15</a>] &quot;PoW Change and Key Reuse&quot; [online].
Available: <a href="https://getmonero.org/2018/02/11/pow-change-and-key-reuse.html">https://getmonero.org/2018/02/11/pow-change-and-key-reuse.html</a>. Date accessed: 2018‑05‑29.</p>
<p>[<a href="https://bitinfocharts.com" title="BitInfoCharts">16</a>] &quot;BitInfoCharts&quot; [online].
Available: <a href="https://bitinfocharts.com">https://bitinfocharts.com</a>. Date accessed: 2018‑05‑30.</p>
<p>[<a href="https://minergate.com/blog/merged-mining-with-monero" title="Merged Mining with Monero">17</a>] &quot;Merged Mining with Monero&quot; [online].
Available: <a href="https://minergate.com/blog/merged-mining-with-monero">https://minergate.com/blog/merged-mining-with-monero</a>. Date accessed: 2018‑05‑30.</p>
<p>[<a href="https://bitcointalk.org/index.php?topic=1082745.msg16615346#msg16615346" title="NN DigitalNote |XDN| - ICCO Announce - NEWS">18</a>] &quot;ANN DigitalNote |XDN| - ICCO Announce - NEWS&quot; [online].
Available: <a href="https://bitcointalk.org/index.php?topic=1082745.msg16615346#msg16615346">https://bitcointalk.org/index.php?topic=1082745.msg16615346#msg16615346</a>. Date accessed: 2018‑05‑31.</p>
<p>[<a href="https://github.com/xdn-project" title="DigitalNote xdn-project">19</a>] &quot;DigitalNote xdn-project&quot; [online].
Available: <a href="https://github.com/xdn-project">https://github.com/xdn-project</a>. Date accessed: 2018‑05‑31.</p>
<p>[<a href="https://chainradar.com/xmr/chart" title="Monero Charts">20</a>] &quot;Monero Charts&quot; [online].
Available: <a href="https://chainradar.com/xmr/chart">https://chainradar.com/xmr/chart</a>. Date accessed: 2018‑05‑31.</p>
<p>[<a href="https://www.nicehash.com/algorithm/cryptonightv7" title="Nicehash Statistics for 
CryptoNight v7">21</a>] &quot;Nicehash Statistics for CryptoNight v7&quot; [online].
Available: <a href="https://www.nicehash.com/algorithm/cryptonightv7">https://www.nicehash.com/algorithm/cryptonightv7</a>. Date accessed: 2018‑05‑31.</p>
<p>[<a href="http://huntercoin.org" title="Huntercoin: A Blockchain based 
Game World">22</a>] &quot;Huntercoin: A Blockchain based Game World&quot; [online].
Available: <a href="http://huntercoin.org">http://huntercoin.org</a>. Date accessed: 2018‑06‑01.</p>
<p>[<a href="http://myriadcoin.org" title="Myriad: A Coin for Everyone">23</a>] &quot;Myriad: A Coin for Everyone&quot; [online].
Available: <a href="http://myriadcoin.org">http://myriadcoin.org</a>. Date accessed: 2018‑06‑01.</p>
<p>[<a href="https://eprint.iacr.org/2017/791.pdf" title="Merged Mining: Curse or Cure?">24</a>] &quot;Merged Mining: Curse or Cure?&quot; [Online.]
Available: <a href="https://eprint.iacr.org/2017/791.pdf">https://eprint.iacr.org/2017/791.pdf</a>. Date accessed: 2019‑02‑12. </p>
<p>[<a href="http://repositum.tuwien.ac.at/obvutwhs/download/pdf/2315652" title="Merged Mining: Analysis of 
Effects and Implications">25</a>] Merged Mining: Analysis of Effects and Implications [online]. Available: <a href="http://repositum.tuwien.ac.at/obvutwhs/download/pdf/2315652">http://repositum.tuwien.ac.at/obvutwhs/download/pdf/2315652</a>. 
Date accessed: 2019‑02‑12. </p>
<p>[<a href="https://github.com/ethereum/wiki/wiki/Problems" title="Problems - Consensus - 8. 
Proof of Stake">26</a>] &quot;Problems - Consensus - 8. Proof of Stake&quot; [online]. Available: <a href="https://github.com/ethereum/wiki/wiki/Problems">https://github.com/ethereum/wiki/wiki/Problems</a>. 
Date accessed: 2018‑06‑05.</p>
<h2><a class="header" href="#contributors-10" id="contributors-10">Contributors</a></h2>
<ul>
<li><a href="https://github.com/hansieodendaal">https://github.com/hansieodendaal</a></li>
<li><a href="https://github.com/CjS77">https://github.com/CjS77</a></li>
<li><a href="https://github.com/anselld">https://github.com/anselld</a></li>
</ul>
<h1><a class="header" href="#digital-assets" id="digital-assets">Digital Assets</a></h1>
<h2><a class="header" href="#purpose-4" id="purpose-4">Purpose</a></h2>
<p>&quot;All digital assets provide value, but not all digital assets are valued equally&quot; [<a href="https://merlinone.com/what-is-a-digital-asset/" title="What Exactly is a Digital 
Asset &amp; How to Get the 
Most Value from Them?">1</a>].</p>
<h2><a class="header" href="#definitions-4" id="definitions-4">Definitions</a></h2>
<h3><a class="header" href="#digital-assets-1" id="digital-assets-1">Digital Assets</a></h3>
<ul>
<li>
<p>From <strong>Simplicable</strong>: A digital asset is something that has value and can be owned but has no physical presence [<a href="https://simplicable.com/new/digital-asset" title="11 Examples of 
Digital Assets">2</a>]. </p>
</li>
<li>
<p>From <strong>The Digital Beyond</strong>: A digital asset is content that is stored in digital form or an online account, owned by an individual. The associated 
digital data are classified as intangible, personal property, as long as they stay digital, otherwise they quickly 
become tangible personal property [<a href="http://www.thedigitalbeyond.com/2011/09/a-working-definition-of-digital-assets/" title="A Working Definition of Digital Assets">3</a>].</p>
</li>
<li>
<p>From <strong>Wikipedia</strong>: A digital asset, in essence, is anything that exists in a binary format and comes with the right to use. Data that do 
not possess that right are not considered assets. Digital assets come in many forms and may be stored on many types of 
digital appliances which are, or will be in existence once technology progresses to accommodate for the conception of 
new modalities which would be able to carry digital assets; notwithstanding the proprietorship of the physical device 
onto which the digital asset is located [<a href="https://en.wikipedia.org/wiki/Digital_asset" title="Digital Asset">4</a>].</p>
</li>
</ul>
<h3><a class="header" href="#non-fungible-tokens" id="non-fungible-tokens">Non-fungible Tokens</a></h3>
<ul>
<li>
<p>From <strong>Wikipedia</strong>: A non-fungible token (NFT) is a special type of cryptographic token which represents something unique; non-fungible 
tokens are thus not interchangeable. This is in contrast to cryptocurrencies like Bitcoin, and many network or utility 
tokens that are fungible in nature. NFTs are used to create verifiable digital scarcity, for example in several 
specific applications that require unique digital items like crypto-collectibles and crypto-gaming [<a href="https://en.wikipedia.org/wiki/Non-fungible_token" title="Non-fungible Token">5</a>].</p>
</li>
<li>
<p>From <strong>BTC Manager</strong>: Non-fungible tokens (NFTs) are blockchain tokens that are designed to be distinguishable from each other. Using unique 
metadata, avatars, individual token IDs, and custody chains, NFTs are created to ensure that no two NFT tokens are 
identical. This is because they exist to store information rather than value, unlike their fungible counterparts [<a href="https://btcmanager.com/non-fungible-tokens/" title="Non-fungible Tokens: 
What Are They?">6</a>].</p>
</li>
</ul>
<h2><a class="header" href="#references-16" id="references-16">References</a></h2>
<p>[<a href="https://merlinone.com/what-is-a-digital-asset/" title="What Exactly is a Digital 
Asset &amp; How to Get the 
Most Value from Them?">1</a>] &quot;What Exactly is a Digital Asset &amp; How to Get the Most Value from Them?&quot; [Online.] 
Available: <a href="https://merlinone.com/what-is-a-digital-asset/">https://merlinone.com/what-is-a-digital-asset/</a>. Date accessed: 2019‑06‑10.</p>
<p>[<a href="https://simplicable.com/new/digital-asset" title="11 Examples of 
Digital Assets">2</a>] &quot;11 Examples of Digital Assets&quot; [online]. 
Available: <a href="https://simplicable.com/new/digital-asset">https://simplicable.com/new/digital-asset</a>. 
Date accessed: 2019‑06‑10.</p>
<p>[<a href="http://www.thedigitalbeyond.com/2011/09/a-working-definition-of-digital-assets/" title="A Working Definition of Digital Assets">3</a>] J. Romano, &quot;A Working Definition of Digital Assets&quot; [online]. The Digital Beyond. Available: <a href="http://www.thedigitalbeyond.com/2011/09/a-working-definition-of-digital-assets/">http://www.thedigitalbeyond.com/2011/09/a-working-definition-of-digital-assets/</a>. Date accessed: 2019‑06‑10.</p>
<p>[<a href="https://en.wikipedia.org/wiki/Digital_asset" title="Digital Asset">4</a>] Wikipedia: &quot;Digital Asset&quot; [online]. 
Available: <a href="https://en.wikipedia.org/wiki/Digital_asset">https://en.wikipedia.org/wiki/Digital_asset</a>. 
Date accessed: 2019‑06‑10.</p>
<p>[<a href="https://en.wikipedia.org/wiki/Non-fungible_token" title="Non-fungible Token">5</a>] Wikipedia: &quot;Non-fungible Token&quot; [online]. 
Available: <a href="https://en.wikipedia.org/wiki/Non-fungible_token">https://en.wikipedia.org/wiki/Non-fungible_token</a>. 
Date accessed: 2019‑06‑10.</p>
<p>[<a href="https://btcmanager.com/non-fungible-tokens/" title="Non-fungible Tokens: 
What Are They?">6</a>] BTC Manager: &quot;Non-fungible Tokens: What Are They?&quot; [Online.] 
Available: <a href="https://btcmanager.com/non-fungible-tokens/">https://btcmanager.com/non-fungible-tokens/</a>. 
Date accessed: 2019‑06‑10.</p>
<h1><a class="header" href="#application-of-howey-to-blockchain-network-token-sales" id="application-of-howey-to-blockchain-network-token-sales"><strong>Application of <em>Howey</em> to Blockchain Network Token Sales</strong></a></h1>
<ul>
<li><a href="digital-assets/howey-application-to-blockchain/MainReport.html#introduction">Introduction</a></li>
<li><a href="digital-assets/howey-application-to-blockchain/MainReport.html#what-is-a-security">What is a Security?</a></li>
<li><a href="digital-assets/howey-application-to-blockchain/MainReport.html#what-is-an-investment-contract-ie-howey-test">What is an Investment Contract (i.e. <em>Howey</em> Test)?</a></li>
<li><a href="digital-assets/howey-application-to-blockchain/MainReport.html#fourth-prong-of-howey-test---efforts-of-others">Fourth Prong of Howey Test - Efforts of Others</a></li>
<li><a href="digital-assets/howey-application-to-blockchain/MainReport.html#decentralization-consumptive-purpose-and-priming-purchasers-expectations">Decentralization, Consumptive Purpose and Priming Purchasers' Expectations</a>
<ul>
<li><a href="digital-assets/howey-application-to-blockchain/MainReport.html#background">Background</a></li>
<li><a href="digital-assets/howey-application-to-blockchain/MainReport.html#decentralization">Decentralization</a></li>
<li><a href="digital-assets/howey-application-to-blockchain/MainReport.html#consumptive-purpose">Consumptive Purpose</a></li>
<li><a href="digital-assets/howey-application-to-blockchain/MainReport.html#priming-purchasers-expectations">Priming Purchasers' Expectations</a></li>
</ul>
</li>
<li><a href="digital-assets/howey-application-to-blockchain/MainReport.html#conclusion">Conclusion</a></li>
<li><a href="digital-assets/howey-application-to-blockchain/MainReport.html#footnotes">Footnotes</a></li>
<li><a href="digital-assets/howey-application-to-blockchain/MainReport.html#references">References</a></li>
<li><a href="digital-assets/howey-application-to-blockchain/MainReport.html#contributors">Contributors</a></li>
</ul>
<h2><a class="header" href="#introduction-9" id="introduction-9">Introduction</a></h2>
<p>Many blockchain networks use, or intend to use, cryptographic tokens (&quot;tokens&quot; or &quot;digital assets&quot;) for various 
purposes. These purposes include an incentive for network participants to contribute computing power to the network; 
or to gain access to certain goods, services or other network functionality. Some promoters of such a network sell 
tokens, or the right to receive tokens once the network has launched. They then use the sales proceeds to finance 
development and maintenance of the networks.</p>
<p>The U.S. Securities and Exchange Commission (SEC) has determined that many of the token offerings and sales over the 
past few years have been in violation of federal securities laws. In some cases, the SEC has taken action against the 
promoters of the offerings.</p>
<p>Refer to the following Orders under the Order Instituting Cease-and-Desist Proceedings Pursuant to [<a href="https://www.loc.gov/item/uscode1934-001015002a/" title="U.S. Congress. United States Code: 
Securities Act of, 15 U.S.C. 
§§ 77a-77mm 1934.">1</a>, Section 8A]:</p>
<ul>
<li>Making Findings, and Imposing a Cease-and-Desist Order against Munchee Inc. (the <em>Munchee</em> Order);</li>
<li>Making Findings, and Imposing Penalties and a Cease-and-Desist Order against CarrierEQ, Inc., 
D/B/A/ Airfox (the <em>Airfox</em> Order);</li>
<li>Making Findings, and Imposing Penalties and a Cease-and-Desist Order against Paragon Coin, Inc. (the <em>Paragon</em> Order); and</li>
<li>Making Findings, and Imposing a Cease-and-Desist Order against GladiusNetwork LLC (the <em>Gladius</em> Order).</li>
</ul>
<p>In each case, the SEC's decision to take action has been underpinned by its determination that the digital assets that 
were offered and sold were securities pursuant to Section 2(a)(1) of the Securities Act of 1933 - the &quot;Securities Act&quot; 
or &quot;Act&quot; [<a href="https://www.loc.gov/item/uscode1934-001015002a/" title="U.S. Congress. United States Code: 
Securities Act of, 15 U.S.C. 
§§ 77a-77mm 1934.">1</a>]. Under [<a href="https://www.loc.gov/item/uscode1934-001015002a/" title="U.S. Congress. United States Code: 
Securities Act of, 15 U.S.C. 
§§ 77a-77mm 1934.">1</a>, Section 5], it is generally unlawful for any person, directly or indirectly, to offer or 
sell a security without complying with the registration requirement of Section 5, unless the securities offering 
qualifies for an exemption from registration. </p>
<p>The sanctions for a violation of [<a href="https://www.loc.gov/item/uscode1934-001015002a/" title="U.S. Congress. United States Code: 
Securities Act of, 15 U.S.C. 
§§ 77a-77mm 1934.">1</a>, Section 5] can be significant. They include a preliminary and permanent 
injunction; rescission; disgorgement; prejudgment interest; and civil money penalties. It is important that those 
seeking to promote token offerings and sales do so only after ensuring that the tokens to be sold are not securities 
under [<a href="https://www.loc.gov/item/uscode1934-001015002a/" title="U.S. Congress. United States Code: 
Securities Act of, 15 U.S.C. 
§§ 77a-77mm 1934.">1</a>], or that the offering, if it involves securities, complies with [<a href="https://www.loc.gov/item/uscode1934-001015002a/" title="U.S. Congress. United States Code: 
Securities Act of, 15 U.S.C. 
§§ 77a-77mm 1934.">1</a>, Section 5], or otherwise qualifies for 
an exemption from registration thereunder. </p>
<p>While the Securities Act [<a href="https://www.loc.gov/item/uscode1934-001015002a/" title="U.S. Congress. United States Code: 
Securities Act of, 15 U.S.C. 
§§ 77a-77mm 1934.">1</a>]; relevant case law and administrative proceedings; as well as guidance and statements of 
the SEC and its officials shed much light on many of the considerations involved in an analysis of whether a given 
digital asset is a security, the facts and circumstances relating to each token, token offering and sale are typically 
quite unique. Many who seek to undertake token offerings and sales struggle to achieve clarity regarding whether such 
offerings and sales must be registered under [<a href="https://www.loc.gov/item/uscode1934-001015002a/" title="U.S. Congress. United States Code: 
Securities Act of, 15 U.S.C. 
§§ 77a-77mm 1934.">1</a>], or have to fit within an exemption from the Act's registration 
requirements. As a result, there is significant regulatory uncertainty surrounding the offering and sale of tokens. </p>
<p>The Commission recognizes the need for more guidance in this area and continues to assist those seeking to achieve a 
greater understanding of whether the U.S. federal securities laws apply to the offer or sale of a particular digital 
asset. This report: </p>
<ul>
<li>
<p>Reviews [<a href="https://www.sec.gov/corpfin/framework-investment-contract-analysis-digital-assets" title="Framework for 'Investment Contract'
Analysis of Digital Assets.">2</a>] (the &quot;Framework&quot;, which was recently published by the SEC's Strategic Hub for Innovation and Financial 
Technology, along with previous statements by William Hinman, the Director of the SEC's Division of Corporation Finance. 
<strong>Note:</strong> &quot;The Framework&quot; represents the views of SEC Staff. It is not a rule, regulation or statement of the SEC, and 
it is not binding on the Divisions of the SEC or the SEC itself.</p>
</li>
<li>
<p>Explains how [<a href="https://www.sec.gov/corpfin/framework-investment-contract-analysis-digital-assets" title="Framework for 'Investment Contract'
Analysis of Digital Assets.">2</a>] is indicative of the SEC's approach to applying the investment contract test laid out in [<a href="https://www.loc.gov/item/uscode1964-003015002b/" title="U.S. Congress. United States Code: 
Securities Exchanges, 15 U.S.C. 
§§ 78a-78jj. 1964.">3</a>] to 
digital assets. The SEC adopted this test, commonly referred to as the <em>Howey</em> test [<a href="https://en.wikipedia.org/wiki/SEC_v._W._J._Howey_Co." title="SEC v. W. J. Howey Co., 
328 U.S. 293 (1946).">4</a>], and has applied the test in 
subsequent actions involving digital assets.<sup><a href="digital-assets/howey-application-to-blockchain/MainReport.html#footnote_1" title="For examples, refer to paragraph 32 of the *Munchee* Order 
and paragraph 21 of the *Airfox* Order and accompanying text...'">f1</a></sup> <strong>Note:</strong> [<a href="https://www.loc.gov/item/uscode1964-003015002b/" title="U.S. Congress. United States Code: 
Securities Exchanges, 15 U.S.C. 
§§ 78a-78jj. 1964.">3</a>, Section 21(a)] authorizes the 
SEC to investigate violations of the federal securities laws and, in its discretion, to &quot;publish information concerning 
any such violations&quot;. The Report does not constitute an adjudication of any fact or issue, nor does it make any findings 
of violations by any individual or entity. </p>
</li>
</ul>
<p>In particular, this report examines some of the SEC Staff's statements relating to the fourth prong of the <em>Howey</em> test, 
i.e. the &quot;efforts of others&quot;, and discusses factors for promoters of token offerings to consider when assessing whether 
a token purchaser may have a reasonable expectation of earning profits from the significant efforts of others. It 
should be noted that this report is in no way intended to constitute or be relied upon as legal advice, or to substitute 
for obtaining competent legal advice from an experienced attorney.</p>
<h2><a class="header" href="#what-is-a-security" id="what-is-a-security">What is a Security?</a></h2>
<p>Section 2(a)(1) of the Securities Act [<a href="https://www.loc.gov/item/uscode1934-001015002a/" title="U.S. Congress. United States Code: 
Securities Act of, 15 U.S.C. 
§§ 77a-77mm 1934.">1</a>] defines a security as follows:</p>
<blockquote>
<p>The term &quot;security&quot; means any note, stock, treasury stock, security future, security-based swap, bond, debenture, 
evidence of indebtedness, certificate of interest or participation in any profit-sharing agreement, collateral-trust 
certificate, preorganization certificate or subscription, transferable share, investment contract, voting-trust 
certificate, certificate of deposit for a security, fractional undivided interest in oil, gas, or other mineral rights, 
any put, call, straddle, option, or privilege on any security, certificate of deposit, or group or index of securities 
(including any interest therein or based on the value thereof), or any put, call, straddle, option, or privilege entered 
into on a national securities exchange relating to foreign currency, or, in general, any interest or instrument commonly 
known as a &quot;security&quot;, or any certificate of interest or participation in, temporary or interim certificate for, receipt 
for, guarantee of, or warrant or right to subscribe to or purchase, any of the foregoing.</p>
</blockquote>
<p>While blockchain network tokens (as well as a wide variety of other instruments) are not explicitly included in the 
definition of &quot;security&quot; under the Act, courts have abstracted the common elements of an &quot;investment contract&quot;, which is 
included in the definition of &quot;security&quot; under Section 2(a)(1) (and Section 3(a)(10) of the Exchange Act of 1934, which 
is contained in [<a href="https://www.loc.gov/item/uscode1964-003015002b/" title="U.S. Congress. United States Code: 
Securities Exchanges, 15 U.S.C. 
§§ 78a-78jj. 1964.">3</a>]), to establish a &quot;flexible rather than a static principle, one that is capable of adaptation to 
meet the countless and variable schemes devised by those who seek the use of the money of others on the promise of 
profits&quot; [<a href="https://www.loc.gov/item/uscode1964-003015002b/" title="U.S. Congress. United States Code: 
Securities Exchanges, 15 U.S.C. 
§§ 78a-78jj. 1964.">3</a>, paragraph 299].</p>
<p>Accordingly, a determination of whether an instrument not specifically enumerated under Section 2(a)(1) of the Act may 
be deemed to be a security that implicates the federal securities laws must include an analysis of whether it is an 
investment contract under <em>Howey</em>.</p>
<h2><a class="header" href="#what-is-an-investment-contract-ie-howey-test" id="what-is-an-investment-contract-ie-howey-test">What is an Investment Contract (i.e. <em>Howey</em> Test)?</a></h2>
<p><em>Howey</em> (and its progeny) established the framework of a four-part test to determine whether an instrument is an 
investment contract and therefore a security subject to the U.S. federal securities laws. <em>Howey</em> provides that an 
investment contract exists if there is: </p>
<ol>
<li>an <strong>investment of money</strong>;</li>
<li>into a <strong>common enterprise</strong>;</li>
<li>with a <strong>reasonable expectation of profits</strong>;</li>
<li>derived from the entrepreneurial or managerial <strong>efforts of others</strong>.</li>
</ol>
<p>For an instrument to be an investment contract, each element of the <em>Howey</em> test must be met. If any element of the test 
is not met, the instrument is not an investment contract.</p>
<h2><a class="header" href="#fourth-prong-of-howey-test---efforts-of-others" id="fourth-prong-of-howey-test---efforts-of-others">Fourth Prong of Howey Test - Efforts of Others</a></h2>
<p>While the &quot;efforts of others&quot; prong of the <em>Howey</em> test is, at some level, no more important in an application of 
<em>Howey</em> than any of the other prongs, it is frequently the prong on which the most uncertainty hangs. The &quot;efforts of 
others&quot; is often the focus when it comes to public blockchain networks. This is because the decentralization of control 
that many such projects seek to foster prompts the following question: do the kind and degree of the existing 
decentralization mean that any expectation of profits token purchasers may have does not come from the efforts of others for 
purposes of <em>Howey</em>? The determination that token purchasers reasonably expected profits to come from the efforts of a 
centralized (or at least coordinated) person or group has been central in the SEC's findings that the tokens were 
securities in each of the recent SEC enforcement actions relating to token offerings and 
sales.<sup><a href="digital-assets/howey-application-to-blockchain/MainReport.html#footnote_1" title="For examples, refer to paragraph 32 of the *Munchee* Order 
and paragraph 21 of the *Airfox* Order and accompanying text...'">f1</a></sup></p>
<h2><a class="header" href="#decentralization-consumptive-purpose-and-priming-purchasers-expectations" id="decentralization-consumptive-purpose-and-priming-purchasers-expectations">Decentralization, Consumptive Purpose and Priming Purchasers' Expectations</a></h2>
<h3><a class="header" href="#background-10" id="background-10">Background</a></h3>
<p>On 14 June 2018, Hinman delivered a speech<sup><a href="digital-assets/howey-application-to-blockchain/MainReport.html#footnote_2" title="William Hinman, Director of the Division of Corp. Fin., SEC...">f2</a></sup> addressing whether &quot;a digital asset that was 
originally offered in a securities offering [can] ever later be sold in a manner that does not constitute an offering of 
a security&quot;, and noted two cases where he believed this was indeed possible:</p>
<ul>
<li>
<p>&quot;where there is no longer any central enterprise being invested in&quot;, e.g. purchases of the digital assets related to a 
decentralized enterprise or network; and</p>
</li>
<li>
<p>&quot;where the digital asset is sold only to be used to purchase a good or service available through the network on which 
it was created&quot;, e.g. purchases of digital assets for a consumptive purpose. </p>
</li>
</ul>
<p>He posed a set of six questions directly related to the application of the &quot;efforts of others&quot; prong of the Howey test 
to offerings and sales of digital assets:</p>
<blockquote>
<ol>
<li>
<p>Is there a person or group that has sponsored or promoted the creation and sale of the digital asset, the efforts 
of whom play a significant role in the development and maintenance of the asset and its potential increase in value?</p>
</li>
<li>
<p>Has this person or group retained a stake or other interest in the digital asset such that it would be motivated to 
expend efforts to cause an increase in value in the digital asset? Would purchasers reasonably believe such efforts will 
be undertaken and may result in a return on their investment in the digital asset?</p>
</li>
<li>
<p>Has the promoter raised an amount of funds in excess of what may be needed to establish a functional network, and, 
if so, has it indicated how those funds may be used to support the value of the tokens or to increase the value of the 
enterprise? Does the promoter continue to expend funds from proceeds or operations to enhance the functionality and/or 
value of the system within which the tokens operate?</p>
</li>
<li>
<p>Are purchasers 'investing', that is seeking a return? In that regard, is the instrument marketed and sold to the 
general public instead of to potential users of the network for a price that reasonably correlates with the market value 
of the good or service in the network?</p>
</li>
<li>
<p>Does application of the Securities Act protections make sense? Is there a person or entity others are relying on 
that plays a key role in the profit-making of the enterprise such that disclosure of their activities and plans would be 
important to investors? Do informational asymmetries exist between the promoters and potential purchasers/investors in 
the digital asset?</p>
</li>
<li>
<p>Do persons or entities other than the promoter exercise governance rights or meaningful influence?</p>
</li>
</ol>
</blockquote>
<p>(He also posed a separate set of seven questions exploring &quot;contractual or technical ways to structure digital assets so 
they function more like a consumer item and less like a security&quot;).</p>
<p>Hinman noted that these questions are useful to consider when assessing the facts and circumstances surrounding 
offerings and sales of digital assets to determine &quot;whether a third party - be it a person, entity or coordinated group 
of actors - drives the expectation of a return&quot;. If such a party does drive an expectation of a return on a purchased 
digital asset, i.e. priming purchasers' expectations, there is a greater likelihood that the asset will be deemed to 
be an investment contract and therefore a security.</p>
<p>In the Framework [<a href="https://www.sec.gov/corpfin/framework-investment-contract-analysis-digital-assets" title="Framework for 'Investment Contract'
Analysis of Digital Assets.">2</a>], the SEC Staff similarly focuses attention on whether a purchaser of a digital asset has a 
reasonable expectation of profits derived from the efforts of others. These three themes: decentralization, consumptive 
purpose and priming purchasers' expectations, provide useful context for much of its discussion. The following offers 
for consideration select implications of the Framework's [<a href="https://www.sec.gov/corpfin/framework-investment-contract-analysis-digital-assets" title="Framework for 'Investment Contract'
Analysis of Digital Assets.">2</a>] guidance and Hinman's speech, as industry 
participants seek a greater understanding of whether or not a digital asset is a security. </p>
<h3><a class="header" href="#decentralization" id="decentralization"><strong>Decentralization</strong></a></h3>
<p>The Framework [<a href="https://www.sec.gov/corpfin/framework-investment-contract-analysis-digital-assets" title="Framework for 'Investment Contract'
Analysis of Digital Assets.">2</a>] reinforces that the degree and nature of a promoter's involvement will have a bearing on the <em>Howey</em> 
analysis. The facts and circumstances relating to a promoter are key. If a promoter does not play a significant role in 
the &quot;development, improvement (or enhancement), operation, or promotion of the network&quot; [<a href="https://www.sec.gov/corpfin/framework-investment-contract-analysis-digital-assets" title="Framework for 'Investment Contract'
Analysis of Digital Assets.">2</a>, Section 3] underlying the 
tokens, it cuts against finding the &quot;efforts of others&quot; prong has been met. A promoter may seek to play a more 
limited role in these areas. Or, along similar lines, influence over the &quot;essential tasks and responsibilities&quot; of the 
network may be widely dispersed, i.e. decentralized, among many unaffiliated network stakeholders so that there is no 
identifiable &quot;person or group&quot; that continues to play a significant role, especially as compared to the role that the 
dispersed stakeholders play [<a href="https://www.sec.gov/corpfin/framework-investment-contract-analysis-digital-assets" title="Framework for 'Investment Contract'
Analysis of Digital Assets.">2</a>, Section 4]<sup><a href="digital-assets/howey-application-to-blockchain/MainReport.html#footnote_3" title="This section states that it is more likely that the purchaser of
a digital asset is relying on the efforts of others if...">f3</a></sup>. </p>
<p>The SEC has placed particular attention on promoter efforts to impact a token's supply and/or demand and has also 
focused on a promoter's efforts to use the proceeds from a token offering to create an ecosystem that will drive demand 
for the tokens once the network is functional.<sup><a href="digital-assets/howey-application-to-blockchain/MainReport.html#footnote_1" title="For examples, refer to paragraph 32 of the *Munchee* Order 
and paragraph 21 of the *Airfox* Order and accompanying text...'">f1</a></sup> Further, the SEC has singled out promoter 
efforts to maintain a token's price by intervening in the buying and selling of tokens, separate from developing and 
maintaining the underlying network. </p>
<p>Further, the SEC's Senior Advisor for Digital Assets, Valerie Szczepanik, noted promoter efforts in this area may 
implicate U.S. securities law, recently stating she has &quot;seen stablecoins that purport to control price through some 
kind of pricing mechanism… controlled through supply and demand in some way to keep the price within a certain band&quot;, 
and &quot;[W]here there is one central party controlling the price fluctuation over time, [that] might be getting into the 
land of securities&quot; [<a href="https://decryptmedia.com/5940/secs-crypto-czar-stablecoins-might-be-violating-securities-lawsquot" title="Stablecoins might be 
Violating Securities Laws">6</a>].</p>
<p>In contrast to the kinds of efforts that meet <em>Howey</em>'s fourth prong, to the extent that a token's value is driven by 
market forces (supply and demand conditions), it suggests that the value of the token is attributable to factors other 
than the promoter's efforts. This is assuming that the promoter does not put some mechanism in place to manage token 
supply or demand in order to maintain a token's price. </p>
<p>In addition, decentralization of control calls into question whether the application of the Securities Act [<a href="https://www.loc.gov/item/uscode1934-001015002a/" title="U.S. Congress. United States Code: 
Securities Act of, 15 U.S.C. 
§§ 77a-77mm 1934.">1</a>] makes 
sense to begin with. A main purpose of [<a href="https://www.loc.gov/item/uscode1934-001015002a/" title="U.S. Congress. United States Code: 
Securities Act of, 15 U.S.C. 
§§ 77a-77mm 1934.">1</a>] is to ensure that securities issuers &quot;tell the public the truth about 
their businesses, the securities they are selling, and the risks involved in investing&quot; [<a href="https://www.sec.gov/Article/whatwedo.html" title="U.S. Securities and Exchange 
Commission, What We Do">5</a>]. Typically, the issuer 
of a security plays a key role in the success of the enterprise. Investors rely on the experience, judgment and skill of 
the enterprise's management team and board of directors to drive profits. The disclosure requirements of [<a href="https://www.loc.gov/item/uscode1934-001015002a/" title="U.S. Congress. United States Code: 
Securities Act of, 15 U.S.C. 
§§ 77a-77mm 1934.">1</a>] focus 
primarily on issuers of securities. A decentralized network, where no central person or entity plays a key role, 
however, challenges both identification of a party who should be subject to the disclosure obligations of [<a href="https://www.loc.gov/item/uscode1934-001015002a/" title="U.S. Congress. United States Code: 
Securities Act of, 15 U.S.C. 
§§ 77a-77mm 1934.">1</a>], and the 
information expected to be disclosed. Indeed, speaking about Bitcoin, Hinman acknowledged as much, stating he &quot;[does] 
not see a central third party whose efforts are a key determining factor in the enterprise. The network on which Bitcoin 
functions is operational and appears to have been decentralized for some time. Applying the disclosure regime of the 
federal securities laws to the offer and resale of Bitcoin would seem to add little value&quot;. Decentralization ultimately 
invokes consideration of whether application of [<a href="https://www.loc.gov/item/uscode1934-001015002a/" title="U.S. Congress. United States Code: 
Securities Act of, 15 U.S.C. 
§§ 77a-77mm 1934.">1</a>] truly serves its purpose. as well as the practical realities of 
how doing so would even work. </p>
<h3><a class="header" href="#consumptive-purpose" id="consumptive-purpose">Consumptive Purpose</a></h3>
<p>Token purchasers who plan to use their tokens to access a network's functionality typically are not speculating that 
the tokens will increase in value. The finding that a token was offered to potential purchasers in a manner inconsistent 
with a consumptive purpose has been a factor in several of the SEC's recent orders, for example:</p>
<ul>
<li>
<p>From paragraph 18 of the <em>Munchee</em> Order [<a href="https://www.loc.gov/item/uscode1934-001015002a/" title="U.S. Congress. United States Code: 
Securities Act of, 15 U.S.C. 
§§ 77a-77mm 1934.">1</a>, Section 8A]: &quot;[The] marketing did not use the Munchee App or otherwise 
specifically target current users of the Munchee App to promote how purchasing MUN tokens might let them qualify for 
higher tiers and bigger payments on future reviews... Instead, Munchee and its agents promoted the MUN token offering in 
forums aimed at people interested in investing in Bitcoin and other digital assets&quot;).</p>
</li>
<li>
<p>From paragraph 16 of the <em>Airfox</em> Order [<a href="https://www.loc.gov/item/uscode1934-001015002a/" title="U.S. Congress. United States Code: 
Securities Act of, 15 U.S.C. 
§§ 77a-77mm 1934.">1</a>, Section 8A]: &quot;AirFox primarily aimed its promotional efforts for the 
initial coin offering at digital token investors rather than anticipated users of AirTokens&quot;).</p>
</li>
</ul>
<p>Accordingly, a promoter may seek to limit the offering and sale of tokens to prospective network users. A promoter may 
also seek to ensure that, in both its content and intended audience, the marketing, and other communication related to 
the token offering, is consistent with consumption being the reason for purchasing tokens. The SEC Staff has indicated 
that the argument that purchasers are acquiring tokens for consumption will be stronger once the network is functional 
and tokens can actually be used to purchase goods or access services through the network. </p>
<p>For example:</p>
<ul>
<li>
<p>Reference [<a href="https://www.sec.gov/corpfin/framework-investment-contract-analysis-digital-assets" title="Framework for 'Investment Contract'
Analysis of Digital Assets.">2</a>, Section 9] states that it is less likely the <em>Howey</em> test is met if various characteristics are 
present, including &quot;[h]olders of the digital asset are immediately able to use it for its intended functionality on the 
network&quot;).</p>
</li>
<li>
<p>Paragraph 7 of the <em>Airfox</em> Order [<a href="https://www.loc.gov/item/uscode1934-001015002a/" title="U.S. Congress. United States Code: 
Securities Act of, 15 U.S.C. 
§§ 77a-77mm 1934.">1</a>, Section 8A] states &quot;The terms of AirFox's initial coin offering purported to 
require purchasers to agree that they were buying AirTokens for their utility as a medium of exchange for mobile airtime, 
and not as an investment or a security. At the time of the ICO, this functionality was not available… Despite the 
reference to AirTokens as a medium of exchange, at the time of the ICO, investors purchased AirTokens based upon 
anticipation that the value of the tokens would rise through AirFox's future managerial and entrepreneurial efforts.&quot;</p>
</li>
</ul>
<p>Promoters may also consider whether &quot;restrictions on the transferability of the digital asset are consistent with the 
asset's use and not facilitating a speculative market&quot; [<a href="https://www.sec.gov/corpfin/framework-investment-contract-analysis-digital-assets" title="Framework for 'Investment Contract'
Analysis of Digital Assets.">2</a>, Section 10]. </p>
<h3><a class="header" href="#priming-purchasers-expectations" id="priming-purchasers-expectations">Priming Purchasers' Expectations</a></h3>
<p>The SEC has given much attention to whether token purchasers were led to expect that the promoter would make efforts to 
increase token value. In this respect, in bringing enforcement actions, the SEC has highlighted statements made by 
promoters that specifically tout the opportunity to profit from purchasing a token.</p>
<p>For example, from paragraph 17 of the <em>Munchee</em> Order [<a href="https://www.loc.gov/item/uscode1934-001015002a/" title="U.S. Congress. United States Code: 
Securities Act of, 15 U.S.C. 
§§ 77a-77mm 1934.">1</a>, Section 8A]:</p>
<blockquote>
<p>Munchee made public statements or endorsed other people's public statements that touted the opportunity to profit. 
For example… Munchee created a public posting on Facebook, linked to a third-party YouTube video, and wrote '199% GAINS 
on MUN token at ICO price! Sign up for PRE‑SALE NOW!' The linked video featured a person who said 'Today we are going 
to talk about Munchee. Munchee is a crazy ICO… Pretty much, if you get into it early enough, you'll probably most likely 
get a return on it.' This person… 'speculate[d]' that a \$1,000 investment could create a $94,000 return.</p>
</blockquote>
<p>Promotional statements explaining that tokens would be listed on digital asset exchanges for secondary trading also draw 
attention. Refer to the following examples. </p>
<ul>
<li>
<p>From paragraph 13 of the <em>Munchee</em> Order [<a href="https://www.loc.gov/item/uscode1934-001015002a/" title="U.S. Congress. United States Code: 
Securities Act of, 15 U.S.C. 
§§ 77a-77mm 1934.">1</a>, Section 8A]: Munchee stated it would work to ensure that MUN holders 
would be able to sell their MUN tokens on secondary markets, saying that &quot;Munchee will ensure that MUN token is available 
on a number of exchanges in varying jurisdictions to ensure that this is an option for all token-holders.&quot;);</p>
</li>
<li>
<p>From paragraph 22 of the <em>Gladius</em> Order [<a href="https://www.loc.gov/item/uscode1934-001015002a/" title="U.S. Congress. United States Code: 
Securities Act of, 15 U.S.C. 
§§ 77a-77mm 1934.">1</a>, Section 8A]: During and following the offering, Gladius attempted to 
make GLA Tokens available for trading on major digital asset trading platforms. On Gladius Web Pages, Gladius principals 
and agents stated that &quot;[w]e've been approached by some of the largest exchanges, they're very interested,&quot; and 
represented that the GLA Token would be available to trade on 'major' trading platforms after the ICO.</p>
</li>
<li>
<p>From [<a href="https://www.sec.gov/corpfin/framework-investment-contract-analysis-digital-assets" title="Framework for 'Investment Contract'
Analysis of Digital Assets.">2</a>, page 5], which states that it is more likely that there is a reasonable expectation of profit if various 
characteristics are present, including if the digital asset is marketed using &quot;[t]he availability of a market for the 
trading of the digital asset, particularly where the [promoter] implicitly or explicitly promises to create or otherwise 
support a trading market for the digital asset&quot;.</p>
</li>
</ul>
<p>Secondary trading on exchanges provides token holders an alternative to using the token on the network and, especially 
when facilitated and highlighted by the promoter, can support a finding of investment intent for token purchasers, i.e. 
buying with an eye on reselling for a profit instead of consuming goods or services through the network. </p>
<p>The Framework [<a href="https://www.sec.gov/corpfin/framework-investment-contract-analysis-digital-assets" title="Framework for 'Investment Contract'
Analysis of Digital Assets.">2</a>, Section 6] states that it is more likely there is a reasonable expectation of profit if various 
characteristics are present, including if &quot;the digital asset is offered broadly to potential purchasers as compared to 
being targeted to expected users of the goods or services or those who have a need for the functionality of the 
network&quot;, and/or &quot;[t]he digital asset is offered and purchased in quantities indicative of investment intent instead of 
quantities indicative of a user of the network&quot;. </p>
<p>The Framework [<a href="https://www.sec.gov/corpfin/framework-investment-contract-analysis-digital-assets" title="Framework for 'Investment Contract'
Analysis of Digital Assets.">2</a>] also notes that purchasers may have an expectation that the promoter will &quot;undertake efforts to 
promote its own interests and enhance the value of the network or digital assets&quot; [<a href="https://www.sec.gov/corpfin/framework-investment-contract-analysis-digital-assets" title="Framework for 'Investment Contract'
Analysis of Digital Assets.">2</a>, Section 5]. Token purchasers who 
are not aware of the promoter's interest in the network's success, such as through the promoter having retained a stake 
in the tokens, should not have any reason to expect the promoter to undertake any efforts to drive token value in order 
to increase its own profits. </p>
<h2><a class="header" href="#conclusion" id="conclusion"><strong>Conclusion</strong></a></h2>
<p>Parties seeking to undertake offerings and sales of tokens in compliance with U.S. securities laws may look to the 
various actions and statements of the SEC for guidance as to whether the token is a security under the Act. As tokens 
are not specifically enumerated under the definition of &quot;security&quot;, the analysis hinges on the application of the 
<em>Howey</em> test to determine if the token is an &quot;investment contract&quot; under the Act, and therefore a security. The 
decentralization of control many public blockchain projects seek to foster places <em>Howey</em>'s &quot;efforts of others&quot; prong 
as a key area of focus. Questions regarding the application of this prong generally relate to:</p>
<ul>
<li>decentralization of the enterprise underlying the tokens;</li>
<li>consumptive purpose of token purchasers; and</li>
<li>whether token purchasers were led to have an expectation that the promoter would take efforts to drive token value.</li>
</ul>
<p>This report has offered insight into some of the factors that promoters of token offerings may consider in assessing 
whether the kind and degree of decentralization that exists means that any expectation of profits token purchasers may 
have does not come from the efforts of others. It is also indicative of the SEC's approach to evaluating the offer and 
sale of digital assets.</p>
<h2><a class="header" href="#footnotes" id="footnotes">Footnotes</a></h2>
<p><strong>f1:</strong>   <a name="footnote_1"> </a>For examples, refer to paragraph 32 of the <em>Munchee</em> Order and 
paragraph 21 of the <em>Airfox</em> Order and accompanying text. <br>
<strong>Paragraph 32 of <em>Munchee</em> Order:</strong> &quot;MUN token 
purchasers had a reasonable expectation of profits from their investment in the Munchee enterprise. The proceeds of the 
MUN token offering were intended to be used by Munchee to build an &quot;ecosystem&quot; that would create demand for MUN tokens 
and make MUN tokens more valuable&quot;.<br> <strong>Paragraph 21 of <em>Airfox</em> Order:</strong> &quot;AirFox told investors that the company 
would improve the AirFox App, add new functionality, enter into agreements with third-party telecommunication companies, 
and take other steps to encourage the use of AirTokens and foster the growth of the ecosystem. Investors reasonably 
expected they would profit from the success of AirFox's efforts to grow the ecosystem and the concomitant rise in the 
value of AirTokens&quot;.</p>
<p><strong>f2:</strong>   <a name="footnote_2"> </a>William Hinman, Director of the Division of Corp. Fin., SEC, Remarks 
at the Yahoo Finance All Markets Summit: Crypto: Digital Asset Transactions: When Howey Met Gary (Plastic) (14 June 2018).</p>
<p><strong>f3:</strong>   <a name="footnote_3"> </a>Reference [<a href="https://www.sec.gov/corpfin/framework-investment-contract-analysis-digital-assets" title="Framework for 'Investment Contract'
Analysis of Digital Assets.">2</a>, Section 4] states that it is more likely that the 
purchaser of a digital asset is relying on the efforts of others if various characteristics are present. This includes 
&quot;[t]here are essential tasks or responsibilities performed and expected to be performed by [a promoter], rather than an 
unaffiliated, dispersed community of network users&quot;.</p>
<h2><a class="header" href="#references-17" id="references-17">References</a></h2>
<p>[<a href="https://www.loc.gov/item/uscode1934-001015002a/" title="U.S. Congress. United States Code: 
Securities Act of, 15 U.S.C. 
§§ 77a-77mm 1934.">1</a>] &quot;U.S. Congress. United States Code: Securities Act of, 15 U.S.C. §§  77a-77mm 1934&quot; [online]. 
Available: <a href="https://www.loc.gov/item/uscode1934-001015002a/">https://www.loc.gov/item/uscode1934-001015002a/</a>. Date accessed: 2019‑03‑07.</p>
<p>[<a href="https://www.sec.gov/corpfin/framework-investment-contract-analysis-digital-assets" title="Framework for 'Investment Contract'
Analysis of Digital Assets.">2</a>] &quot;Framework for 'Investment Contract' Analysis of Digital Assets&quot; [online].
Available: <a href="https://www.sec.gov/corpfin/framework-investment-contract-analysis-digital-assets">https://www.sec.gov/corpfin/framework-investment-contract-analysis-digital-assets</a>&gt;. Date accessed: 
2019‑03‑10.</p>
<p>[<a href="https://www.loc.gov/item/uscode1964-003015002b/" title="U.S. Congress. United States Code: 
Securities Exchanges, 15 U.S.C. 
§§ 78a-78jj. 1964.">3</a>] &quot;U.S. Congress. United States Code: Securities Exchanges, 15 U.S.C. §§ 78a-78jj, 1964&quot; [online].
Available: <a href="https://www.loc.gov/item/uscode1964-003015002b/">https://www.loc.gov/item/uscode1964-003015002b/</a>. Date accessed: 2019‑03‑07.</p>
<p>[<a href="https://en.wikipedia.org/wiki/SEC_v._W._J._Howey_Co." title="SEC v. W. J. Howey Co., 
328 U.S. 293 (1946).">4</a>] &quot;SEC v. W. J. Howey Co., 328 U.S. 293 (1946)&quot; [online]. Available: <a href="https://en.wikipedia.org/wiki/SEC_v._W._J._Howey_Co.)">https://en.wikipedia.org/wiki/SEC_v._W._J._Howey_Co.)</a>.
Date accessed: 2019‑04‑05. </p>
<p>[<a href="https://www.sec.gov/Article/whatwedo.html" title="U.S. Securities and Exchange 
Commission, What We Do">5</a>] &quot;U.S. Securities and Exchange Commission, What We Do&quot; [online]. Available: <a href="https://www.sec.gov/Article/whatwedo.html">https://www.sec.gov/Article/whatwedo.html</a>. 
Date accessed: 2018‑03‑07.</p>
<p>[<a href="https://decryptmedia.com/5940/secs-crypto-czar-stablecoins-might-be-violating-securities-lawsquot" title="Stablecoins might be 
Violating Securities Laws">6</a>] Guillermo Jimenez, SEC's Crypto Czar: &quot;Stablecoins might be Violating Securities Laws&quot;, Decrypt (2019) [online]. 
Available: <a href="https://decryptmedia.com/5940/secs-crypto-czar-stablecoins-might-be-violating-securities-laws">https://decryptmedia.com/5940/secs-crypto-czar-stablecoins-might-be-violating-securities-laws</a>.
Date accessed: 2019‑03‑19.</p>
<h2><a class="header" href="#contributors-11" id="contributors-11">Contributors</a></h2>
<ul>
<li><a href="https://github.com/willacy">https://github.com/willacy</a></li>
<li><a href="https://github.com/hansieodendaal">https://github.com/hansieodendaal</a></li>
<li><a href="https://github.com/anselld">https://github.com/anselld</a></li>
</ul>
<h1><a class="header" href="#non-fungible-tokens-1" id="non-fungible-tokens-1">Non-Fungible Tokens</a></h1>
<iframe width=750 height=600 src="https://gitpitch.com/tari-labs/tari-university/master?p=/src/digital-assets/nft-landscape-1#/"></iframe>
<h3><a class="header" href="#having-trouble-viewing-this-presentation-3" id="having-trouble-viewing-this-presentation-3">Having trouble viewing this presentation?</a></h3>
<p>View it in a <a href="https://gitpitch.com/tari-labs/tari-university/master?p=/src/digital-assets/nft-landscape-1#/">separate window</a>.</p>
<h1><a class="header" href="#confidential-assets" id="confidential-assets">Confidential Assets</a></h1>
<ul>
<li><a href="digital-assets/confidential-assets/MainReport.html#introduction">Introduction</a></li>
<li><a href="digital-assets/confidential-assets/MainReport.html#preliminaries">Preliminaries</a></li>
<li><a href="digital-assets/confidential-assets/MainReport.html#basis-of-confidential-assets">Basis of Confidential Assets</a>
<ul>
<li><a href="digital-assets/confidential-assets/MainReport.html#confidential-transactions">Confidential Transactions</a></li>
<li><a href="digital-assets/confidential-assets/MainReport.html#asset-commitments-and-surjection-proofs">Asset Commitments and Surjection Proofs</a></li>
<li><a href="digital-assets/confidential-assets/MainReport.html#confidential-asset-scheme">Confidential Asset Scheme</a>
<ul>
<li><a href="digital-assets/confidential-assets/MainReport.html#asset-transactions">Asset Transactions</a></li>
<li><a href="digital-assets/confidential-assets/MainReport.html#asset-issuance">Asset Issuance</a></li>
<li><a href="digital-assets/confidential-assets/MainReport.html#asset-reissuance">Asset Reissuance</a></li>
<li><a href="digital-assets/confidential-assets/MainReport.html#flexibility">Flexibility</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="digital-assets/confidential-assets/MainReport.html#confidential-asset-implementations">Confidential Asset Implementations</a>
<ul>
<li><a href="digital-assets/confidential-assets/MainReport.html#elements-project">Elements Project</a></li>
<li><a href="digital-assets/confidential-assets/MainReport.html#chain-core-confidential-assets">Chain Core Confidential Assets</a></li>
<li><a href="digital-assets/confidential-assets/MainReport.html#cloak">Cloak</a></li>
</ul>
</li>
<li><a href="digital-assets/confidential-assets/MainReport.html#conclusions-observations-and-recommendations">Conclusions, Observations and Recommendations</a></li>
<li><a href="digital-assets/confidential-assets/MainReport.html#references">References</a></li>
<li><a href="digital-assets/confidential-assets/MainReport.html#appendices">Appendices</a>
<ul>
<li><a href="digital-assets/confidential-assets/MainReport.html#appendix-a-definition-of-terms">Appendix A: Definition of Terms</a></li>
<li><a href="digital-assets/confidential-assets/MainReport.html#appendix-b-ricardian-contracts-vs-smart-contracts">Appendix B: Ricardian Contracts vs. Smart Contracts</a></li>
</ul>
</li>
<li><a href="digital-assets/confidential-assets/MainReport.html#contributors">Contributors</a></li>
</ul>
<h2><a class="header" href="#introduction-10" id="introduction-10">Introduction</a></h2>
<p>Confidential assets, in the context of blockchain technology and blockchain-based cryptocurrencies, can have different 
meanings to different audiences, and can also be something totally different or unique depending on the use case. They 
are a special type of digital asset and inherit all its properties, except that they are also confidential. Confidential 
assets 
therefore have value, can be owned but have no physical presence. The confidentiality aspect implies that the amount of 
assets owned, as well as the asset type that was transacted in, can be confidential. A further classification can be made 
with regard to whether they are fungible (interchangeable) or non-fungible (unique, not interchangeable). Confidential 
assets can only exist in the form of a cryptographic token or derivative thereof that is also cryptographically secure, 
at least under the Discrete Logarithmic Problem<sup><a href="digital-assets/confidential-assets/MainReport.html#dlp" title="In the mathematics of real 
numbers, the logarithm log_b(a) 
is a number x such that ...">def</a></sup> (DLP) assumption. </p>
<p>The basis of confidential assets is confidential transactions as proposed by Maxwell [<a href="https://people.xiph.org/%7Egreg/confidential_values.txt" title="Confidential Transactions Write up,
G. Maxwell">4</a>] and Poelstra et al. [<a href="https://github.com/AdamISZ/ConfidentialTransactionsDoc/blob/master/essayonCT.pdf" title="An Investigation into Confidential Transactions, 
A. Gibson, 
July 2018">5</a>], 
where the amounts transferred are kept visible only to participants in the transaction (and those they designate). 
Confidential transactions succeed in making the transaction amounts private, while still preserving the ability of the 
public blockchain network to verify that the ledger entries and Unspent Transaction Output (UTXO) set still add up. All 
amounts in the UTXO set are blinded, while preserving public verifiability. Poelstra et al. [<a href="https://github.com/AdamISZ/ConfidentialTransactionsDoc/blob/master/essayonCT.pdf" title="An Investigation into Confidential Transactions, 
A. Gibson, 
July 2018">5</a>] showed how the asset 
types can also be blinded in conjunction with the output amounts. Multiple asset types can be accommodated within 
single transactions on the same blockchain.</p>
<p>This report investigates confidential assets as a natural progression of confidential transactions. </p>
<h2><a class="header" href="#preliminaries-1" id="preliminaries-1">Preliminaries</a></h2>
<p>This section gives the general notation of mathematical expressions when specifically referenced in the report. 
This notation is 
important pre-knowledge for the remainder of the report.</p>
<ul>
<li>Let $ p ​$ be a large prime number.</li>
<li>Let $ \mathbb G $ denote a cyclic group of prime order $ p $. </li>
<li>Let $ \mathbb Z_p $ denote the ring of integers $ modulo \mspace{4mu} p $.</li>
<li>Let $ \mathbb F_p $ be a group of elliptic curve points over a finite (prime) field.</li>
<li>All references to Pedersen Commitment will imply Elliptic Curve Pedersen Commitment.</li>
</ul>
<h2><a class="header" href="#basis-of-confidential-assets" id="basis-of-confidential-assets">Basis of Confidential Assets</a></h2>
<p>Confidential transactions, asset commitments and Asset Surjection Proofs (ASPs) are really the basis of confidential 
assets. These concepts are discussed in the following sections.</p>
<h3><a class="header" href="#confidential-transactions" id="confidential-transactions">Confidential Transactions</a></h3>
<p>Confidential transactions are made confidential by replacing each explicit UTXO with a homomorphic commitment, such as
a <a href="digital-assets/confidential-assets/../../cryptography/bulletproofs-protocols/MainReport.html#pedersen-commitments-and-elliptic-curve-pedersen-commitments">Pedersen Commitment</a>, 
and made robust against overflow and inflation attacks by using efficient zero-knowledge range proofs, such as a <a href="digital-assets/confidential-assets/../../cryptography/bulletproofs-and-mimblewimble/MainReport.html#how-do-bulletproofs-work">Bulletproof</a> [<a href="https://blockstream.com/bitcoin17-final41.pdf" title="Confidential Assets,
A. Poelstra et al.,
Blockstream">1</a>].</p>
<p>Range proofs provide proof that a secret value, which has been encrypted or committed to, lies in a certain interval. 
They prevent any numbers coming near the magnitude of a large prime, say $ 2^{256} $, that can cause wraparound when 
adding a small number, e.g. proof that a number $ x \in [0,2^{64} - 1] $.</p>
<p>Pedersen Commitments are perfectly hiding (an attacker with infinite computing power cannot tell what amount has been 
committed to) and computationally binding (no efficient algorithm running in a practical amount of time can produce 
fake commitments, except with small probability). The Elliptic Curve Pedersen Commitment to value $ x \in \mathbb Z_p $ 
has the following form:</p>
<p>$$
C(x,r) = xH + rG
\tag{1}
$$</p>
<p>where $ r \in  \mathbb Z_p $ is a random blinding factor, $ G \in  \mathbb F_p $ is a random generator point and 
$ H \in  \mathbb F_p $ is specially chosen so that the value $ x_H $ satisfying $ H = x_H G $ cannot be found, except 
if the Elliptic Curve DLP<sup><a href="digital-assets/confidential-assets/MainReport.html#dlp" title="In the mathematics of real 
numbers, the logarithm log_b(a) 
is a number x such that ...">def</a></sup> (ECDLP) is solved. The number $ H $ is what is known as a Nothing Up 
My Sleeve (NUMS) number. With secp256k1, the value of $ H $ is the SHA256 hash of a simple encoding of the  $ x $-coordinate 
of the generator point $ G $. The Pedersen Commitment scheme is implemented with three 
algorithms: <code>Setup()</code> to set up the commitment parameters $ G $ and $ H $; <code>Commit()</code> to commit 
to the message $ x $ using the commitment parameters $ r $, $ H $ and $ G $; and <code>Open()</code> to open and verify 
the commitment ([<a href="https://github.com/AdamISZ/ConfidentialTransactionsDoc/blob/master/essayonCT.pdf" title="An Investigation into Confidential Transactions, 
A. Gibson, 
July 2018">5</a>], [<a href="https://hackage.haskell.org/package/pedersen-commitment" title="Pedersen-commitment: An Implementation
of Pedersen Commitment Schemes">6</a>], [<a href="http://cryptonite.info/files/HMBC.pdf" title="Homomorphic Mini-blockchain Scheme, 
B. Franca, 
April 2015">7</a>], [<a href="http://orbilu.uni.lu/bitstream/10993/33705/1/MSPN2017.pdf" title="Efficient Implementation of Pedersen 
Commitments Using Twisted Edwards Curves, 
C. Franck and J. Großschädl, 
University of Luxembourg">8</a>]).</p>
<p><a href="digital-assets/confidential-assets/../../protocols/mimblewimble-1/MainReport.html">Mimblewimble</a> ([<a href="http://diyhpl.us/%7Ebryan/papers2/bitcoin/mimblewimble-andytoshi-draft-2016-10-20.pdf" title="Mimblewimble, 
A. Poelstra, 
October 2016">9</a>], [<a href="https://www.weusecoins.com/mimble-wimble-andrew-poelstra" title="Mimblewimble Explained,
A. Poelstra, 
November 2016">10</a>]) is based on and achieves 
confidentiality using these confidential transaction primitives. If confidentiality is not sought, inputs may be given 
as explicit amounts, in which case the homomorphic commitment to the given amount will have a blinding factor $ r = 0 ​$.</p>
<h3><a class="header" href="#asset-commitments-and-surjection-proofs" id="asset-commitments-and-surjection-proofs">Asset Commitments and Surjection Proofs</a></h3>
<p>The different assets need to be identified and transacted with in a confidential manner, and proven to not be 
inflationary. This is made possible by using asset commitments and ASPs ([<a href="https://blockstream.com/bitcoin17-final41.pdf" title="Confidential Assets,
A. Poelstra et al.,
Blockstream">1</a>], [<a href="https://elementsproject.org/features/issued-assets/investigation" title="Issued Assets - Investigation, 
Principal Investigator: Andrew Poelstra, 
Elements by Blockstream">14</a>]).</p>
<p>Given some unique asset description $ A $, the associated asset tag $ H_A \in \mathbb G $ is calculated using the 
Pedersen Commitment function <code>Setup()</code> using $ A $ as auxiliary input. (Selection of $ A $ is discussed 
in <a href="digital-assets/confidential-assets/MainReport.html#asset-issuance">Asset Issuance</a>.) Consider a transaction with two inputs and two outputs involving two distinct 
asset types $ A $ and $ B $:</p>
<p>$$
\begin{aligned}
in_A = x_1H_A + r_{A_1}G \mspace{15mu} \mathrm{,} \mspace{15mu} out_A = x_2H_A + r_{A_2}G \\
in_B = y_1H_B + r_{B_1}G \mspace{15mu} \mathrm{,} \mspace{15mu} out_B = y_2H_B + r_{B_2}G
\end{aligned}
\tag{2}
$$</p>
<p>In the equations that follow, a commitment to the value of $ 0 $ will be denoted by $ (\mathbf{0}) $, i.e. 
$C(0,r) = 0H + rG = (\mathbf{0})$. For relation (2) to hold, the sum of the outputs minus the sum of the inputs must be 
a commitment to the value of $ 0 $:</p>
<p>$$
\begin{aligned}
(out_A + out_B) - (in_A + in_B) = (\mathbf{0}) \\
(x_2H_A + r_{A_2}G) + (y_2H_B + r_{B_2}G) - (x_1H_A + r_{A_1}G) - (y_1H_B + r_{B_1}G) = (\mathbf{0}) \\
(r_{A_2} + r_{B_2} - r_{A_1} - r_{B_1})G + (x_2 - x_1)H_A + (y_2 - y_1)H_B = (\mathbf{0})
\end{aligned}
\tag{3}
$$</p>
<p>Since $ H_A $ and $ H_B $ are both NUMS asset tags, the only way relation (3) can hold is if the total input and 
output amounts of asset $ A $ are equal and if the same is true for asset $ B $. This concept can be extended to an 
unlimited amount of distinct asset types, as long as each asset tag can be a unique NUMS generator. The problem with 
relation (3) is that the asset type of each output is publicly visible, thus the assets that were transacted in are 
not confidential. This can be solved by replacing each asset tag with a blinded version of itself. The asset commitment 
to asset tag $ H_A $ (blinded asset tag) is then defined as the point</p>
<p>$$
H_{0_A} = H_A + rG
\tag{4}
$$</p>
<p>Blinding of the asset tag is necessary to make transactions in the asset, i.e. which asset was transacted in, 
confidential. The blinded asset tag $ H_{0_A} $ will then be used in place of the generator $ H $ in the Pedersen 
Commitments. Such Pedersen Commitments thus commit to the committed amount as well as to the underlying asset tag. 
Inspecting the Pedersen Commitment, it is evident that a commitment to the value $ x_1 $ using the blinded asset 
tag $  H_{0_A}  $ is also a commitment to the same value using the asset tag $  H_A  $:</p>
<p>$$
x_1H_{0_A} + r_{A_1}G = x_1(H_A + rG) + r_{A_1}G = x_1H_A + (r_{A_1} + x_1r)G
\tag{5}
$$</p>
<p>Using blinded asset tags, the transaction in relation (2) then becomes:</p>
<p>$$
\begin{aligned}
in_A = x_1H_{0_A} + r_{A_1}G \mspace{15mu} \mathrm{,} \mspace{15mu} out_A = x_2H_{0_A} + r_{A_2}G \\
in_B = y_1H_{0_B} + r_{B_1}G \mspace{15mu} \mathrm{,} \mspace{15mu} out_B = y_2H_{0_B} + r_{B_2}G
\end{aligned}
\tag{6}
$$</p>
<p>Correspondingly, the zero sum rule translates to:</p>
<p>$$
\begin{aligned}
(out_A + out_B) - (in_A + in_B) = (\mathbf{0}) \\
(x_2H_{0_A} + r_{A_2}G) + (y_2H_{0_B} + r_{B_2}G) - (x_1H_{0_A} + r_{A_1}G) - (y_1H_{0_B} + r_{B_1}G) = (\mathbf{0}) \\
(r_{A_2} + r_{B_2} - r_{A_1} - r_{B_1})G + (x_2 - x_1)H_{0_A} + (y_2 - y_1)H_{0_B} = (\mathbf{0})
\end{aligned}
\tag{7}
$$</p>
<p>However, using only the sum to zero rule, it is still possible to introduce negative amounts of an asset type. Consider 
blinded asset tag</p>
<p>$$
H_{0_A} = -H_A + rG
\tag{8}
$$</p>
<p>Any amount of blinded asset tag $  H_{0_A}  $ will correspond to a negative amount of asset $ A $, thereby inflating its 
supply. To solve this problem, an ASP is introduced, which is a cryptographic proof. In mathematics, a surjection 
function simply means that for every element $ y $ in the codomain $ Y $ of function $ f $, there is at least one 
element $ x $ in the domain $ X $ of function $ f $ such that $ f(x) = y$. </p>
<p>An ASP scheme provides a proof $ \pi ​$ for a set of input asset commitments $ [ H_i  ] ^n_{i=1} ​$, an output 
commitment $ H = H_{\hat i} + rG ​$ for $  \hat i = 1 \mspace{3mu} , \mspace{3mu} . . . \mspace{3mu} , \mspace{3mu} n  ​$ 
and blinding factor $ r ​$. It proves that every output asset type is the same as some input asset type, while blinding 
which outputs correspond to which inputs. Such a proof $ \pi ​$ is secure if it is a zero-knowledge proof of knowledge 
for the blinding factor $ r ​$. Let $  H_{0_{A1}}  ​$ and $  H_{0_{A2}}  ​$ be blinded asset tags that commit to the same 
asset tag $  H_A  ​$:</p>
<p>$$
H_{0_{A1}} = H_A + r_1G \mspace{15mu} \mathrm{and} \mspace{15mu} H_{0_{A2}} = H_A + r_2G
\tag{9}
$$</p>
<p>Then</p>
<p>$$
H_{0_{A1}} - H_{0_{A2}} = (H_A + r_1G) - (H_A + r_2G) = (r_1 - r_2)G
\tag{10}
$$</p>
<p>will be a signature key with secret key $ r_1 - r_2 $. Thus for an $ n $ distinct multiple asset type transaction, 
differences can be calculated between each output and all inputs, e.g. $ (out_A - in_A) ,  (out_A - in_B)  \mspace{3mu} ,
\mspace{3mu} . . . \mspace{3mu} , \mspace{3mu}  (out_A - in_n) $, and so on for all outputs. This has the form of a 
ring signature, and if $ out_A  $ has the same asset tag as one of the inputs, the transaction signer will know the 
secret key corresponding to one of these differences, and be able to produce the ring signature. The ASP is based on 
the <em>Back-Maxwell</em> range proof (refer to Definition 9 of [<a href="https://blockstream.com/bitcoin17-final41.pdf" title="Confidential Assets,
A. Poelstra et al.,
Blockstream">1</a>]), which uses a variation of Borromean ring signatures [<a href="http://diyhpl.us/%7Ebryan/papers2/bitcoin/Borromean%20ring%20signatures.pdf" title="Borromean Ring Signatures (2015), 
G. Maxwell and A. Poelstra">18</a>]. 
The Borromean ring signature, in turn, is a variant of the Abe-Ohkubo-Suzuki (AOS) ring signature [<a href="https://www.iacr.org/cryptodb/archive/2002/ASIACRYPT/50/50.pdf" title="1-out-of-n Signatures from a Variety of Keys, 
M. Abe, M. Ohkubo and K. Suzuki">19</a>]. An AOS ASP 
computes a ring signature that is equal to the proof $ \pi $ as follows:</p>
<ul>
<li>Calculate $ n $ differences $ H - H_{\hat i } $ for $  \hat i = 1 \mspace{3mu} , \mspace{3mu} . . . \mspace{3mu} , 
\mspace{3mu} n  $, one of which will be equal to the blinding factor $ r $.</li>
<li>Calculate a ring signature $ S $ of an empty message using the $ n $ differences. </li>
</ul>
<p>The resulting ring signature $ S $ is equal to the proof $ \pi $, and the ASP consists of this ring signature 
$ S ​$ ([<a href="https://blockstream.com/bitcoin17-final41.pdf" title="Confidential Assets,
A. Poelstra et al.,
Blockstream">1</a>], [<a href="https://elementsproject.org/features/issued-assets/investigation" title="Issued Assets - Investigation, 
Principal Investigator: Andrew Poelstra, 
Elements by Blockstream">14</a>]).</p>
<h2><a class="header" href="#confidential-asset-scheme" id="confidential-asset-scheme">Confidential Asset Scheme</a></h2>
<p>Using the building blocks discussed in <a href="digital-assets/confidential-assets/MainReport.html#basis-of-confidential-assets">Basis of Confidential Assets</a>, asset 
issuance, asset transactions and asset re-issuance can be performed in a confidential manner.</p>
<h3><a class="header" href="#asset-transactions" id="asset-transactions">Asset Transactions</a></h3>
<p>Confidential assets propose a scheme where multiple non-interchangeable asset types can be supported within a single 
transaction. This all happens within one blockchain and can theoretically improve the value of the blockchain by 
offering a service to more users. It can also enable extended functionality such as base layer atomic asset trades. The 
latter implies Alice can offer Bob $ 100 $ of asset type $ A $ for $ 50 $ of asset type $ B ​$ in a single transaction, 
both participants using a single wallet. In this case, no relationship between output asset types can be established or 
inferred, because all asset tags are blinded. Privacy can be increased, as the blinded asset types bring another 
dimension that needs to be unraveled in order to obtain user identity and transaction data by not having multiple 
single-asset transactions. Such a confidential asset scheme simplifies verification and complexity, and reduces on-chain 
data. It also prohibits censorship of transactions involving specific asset types, and blinds assets with low 
transaction volume where users could be identified very easily [<a href="https://blockstream.com/bitcoin17-final41.pdf" title="Confidential Assets,
A. Poelstra et al.,
Blockstream">1</a>].</p>
<p>Assets originate in asset-issuance inputs, which take the place of coinbase transactions in confidential transactions. 
The asset type to pay fees must be revealed in each transaction, but in practice, all fees could be paid in only one 
asset type, thus preserving privacy. Payment authorization is achieved by means of the input signatures. A confidential 
asset transaction consists of the following data:</p>
<ul>
<li>
<p>A list of inputs, each of which can have one of the following forms:</p>
<ul>
<li>a reference to an output of another transaction, with a signature using that output's verification key; or</li>
<li>an asset issuance input, which has an explicit amount and asset tag.</li>
</ul>
</li>
<li>
<p>A list of outputs that contains:</p>
<ul>
<li>a signature verification key;</li>
<li>an asset commitment $ H_0 $ with an ASP from all input asset commitments to $ H_0 $;</li>
<li>Pedersen commitment to an amount using generator $ H_0 $ in place of $ H $, with the associated <em>Back-Maxwell</em> 
range proof.</li>
</ul>
</li>
<li>
<p>A fee, listed explicitly as $ { (f_i , H_i) }_{i=1}^n $, where $ f_i $ is a non-negative scalar amount denominated 
in the asset with tag $ H_i $. </p>
</li>
</ul>
<p>Every output has a range proof and ASP associated with it, which are proofs of knowledge of the Pedersen commitment 
opening information and asset commitment blinding factor. Every range proof can be considered as being with respect to 
the underlying asset tag $ H_A ​$, rather than the asset commitment $ H_0 ​$. The confidential transaction is restricted 
to only inputs and outputs with asset tag $ H_A ​$, except that output commitments minus input commitments minus fee sum 
to a commitment to $ 0 ​$ instead of to the point $ 0 ​$ itself [<a href="https://blockstream.com/bitcoin17-final41.pdf" title="Confidential Assets,
A. Poelstra et al.,
Blockstream">1</a>].</p>
<p>However, confidential assets come at an additional data cost. For a transaction with $ m $ outputs and $ n $ inputs, in 
relation to the units of space used for confidential transactions, the asset commitment has size $ 1$, the ASP has size 
$ n + 1 $ and the entire transaction therefore has size $ m(n + 2) $ [<a href="https://blockstream.com/bitcoin17-final41.pdf" title="Confidential Assets,
A. Poelstra et al.,
Blockstream">1</a>].</p>
<h3><a class="header" href="#asset-issuance" id="asset-issuance">Asset Issuance</a></h3>
<p>It is important to ensure that any auxiliary input $ A $ used to create asset tag $ H_A \in \mathbb G $ only be used 
once to prevent inflation by means of many independent issuances. Associating a maximum of one issuance with the 
spending of a specific UTXO can ensure this uniqueness property. Poelstra et al. [<a href="https://github.com/AdamISZ/ConfidentialTransactionsDoc/blob/master/essayonCT.pdf" title="An Investigation into Confidential Transactions, 
A. Gibson, 
July 2018">5</a>] suggest the use of a Ricardian 
contract [<a href="http://iang.org/papers/ricardian_contract.html" title="The Ricardian Contract, 
First IEEE International Workshop on 
Electronic Contracting.
IEEE (2004), 
I. Grigg">11</a>] to be hashed together with the reference to the UTXO being spent. This hash can then be used to 
generate the auxiliary input $ A $ as follows. Let $I $ be the input being spent (an unambiguous reference to a 
specific UTXO used to create the asset), let $ \widehat {RC} $ be the issuer-specified Ricardian contract, then the 
asset entropy $ E $ is defined as </p>
<p>$$
E = \mathrm {Hash} ( \mathrm {Hash} (I) \parallel \mathrm {Hash} (\widehat {RC}))
\tag{11}
$$</p>
<p>The auxiliary input $ A $ is then defined as </p>
<p>$$
A = \mathrm {Hash} ( E \parallel 0)
\tag{12}
$$</p>
<p>Note that a Ricardian contract $ \widehat {RC} $ is not crucial for entropy $ E $ generation, as some other unique NUMS 
value could have been used in its stead, but only suggested. Ricardian contracts warrant a bit more explanation and are 
discussed in <a href="digital-assets/confidential-assets/MainReport.html#appendix-b-ricardian-contracts-vs-smart-contracts">Appendix B</a>.</p>
<p>Every non-coinbase transaction input can have up to one new asset issuance associated with it. An asset issuance (or 
asset definition) transaction input then consists of the UTXO being spent, the Ricardian contract, either an initial 
issuance explicit value or a Pedersen commitment, a range proof and a Boolean field indicating whether reissuance is 
allowed ([<a href="https://blockstream.com/bitcoin17-final41.pdf" title="Confidential Assets,
A. Poelstra et al.,
Blockstream">1</a>], [<a href="https://elementsproject.org/features/issued-assets" title="Issued Assets - You can Issue your 
own Confidential Assets on Elements, 
Elements by Blockstream">13</a>]).</p>
<h3><a class="header" href="#asset-reissuance" id="asset-reissuance">Asset Reissuance</a></h3>
<p>The confidential asset scheme allows the asset owner to later increase or decrease the amount of the asset in 
circulation, given that an asset reissuance token is generated together with the initial asset issuance. Given an asset 
entropy $ E $, the asset reissuance capability is the element (asset tag) $ H_{\hat A} \in \mathbb G $ obtained using 
an alternative auxiliary input $ \hat A $ defined as</p>
<p>$$
\hat A = \mathrm {Hash} ( E \parallel 1)
\tag{13}
$$</p>
<p>The resulting asset tag $ H_{\hat A} \in \mathbb G $ is linked to its reissuance capability, and the asset owner can 
assert their reissuance right by revealing the blinding factor $ r $ for the reissuance capability along with the 
original asset entropy $ E $. An asset reissuance (or asset definition) transaction input then consists of the spend 
of a UTXO containing an asset reissuance capability, the original asset entropy, the blinding factor for the asset 
commitment of the UTXO being spent, either an explicit reissuance amount or Pedersen commitment and a range proof [<a href="https://blockstream.com/bitcoin17-final41.pdf" title="Confidential Assets,
A. Poelstra et al.,
Blockstream">1</a>].</p>
<p>The same mechanism can be used to manage capabilities for other restricted operations, e.g. to decrease issuance, 
to destroy the asset, or to make the commitment generator the hash of a script that validates the spending transaction. 
It is also possible to change the name of the default asset that is created upon blockchain initialization and the 
default asset used to pay fees on the network ([<a href="https://blockstream.com/bitcoin17-final41.pdf" title="Confidential Assets,
A. Poelstra et al.,
Blockstream">1</a>], [<a href="https://elementsproject.org/features/issued-assets" title="Issued Assets - You can Issue your 
own Confidential Assets on Elements, 
Elements by Blockstream">13</a>]).</p>
<h3><a class="header" href="#flexibility" id="flexibility">Flexibility</a></h3>
<p>ASPs prove that the asset commitments associated with outputs commit to legitimately issued asset tags. This feature 
allows compatible blockchains to support indefinitely many asset types, which may be added after the chain has been 
defined. There is room to adapt this scheme for optimal trade-off between ASP data size and privacy by introducing a 
global dynamic list of assets, whereby each transaction selects a subset of asset tags for the corresponding ASPs [<a href="https://blockstream.com/bitcoin17-final41.pdf" title="Confidential Assets,
A. Poelstra et al.,
Blockstream">1</a>].</p>
<p>If all the asset tags are defined at the instantiation of the blockchain, this will be compatible with the 
<a href="digital-assets/confidential-assets/../../protocols/mimblewimble-1/MainReport.html">Mimblewimble</a> protocol. The range proofs used for the 
development of this scheme were based on the Back-Maxwell range proof scheme (refer to Definition 9 of [<a href="https://blockstream.com/bitcoin17-final41.pdf" title="Confidential Assets,
A. Poelstra et al.,
Blockstream">1</a>]). Poelstra 
et al. [<a href="https://blockstream.com/bitcoin17-final41.pdf" title="Confidential Assets,
A. Poelstra et al.,
Blockstream">1</a>] suggest more efficient range proofs, ASPs and use of aggregate range proofs. It is thus an open question 
whether Bulletproofs could fulfill this requirement.</p>
<h2><a class="header" href="#confidential-asset-implementations" id="confidential-asset-implementations">Confidential Asset Implementations</a></h2>
<p>Three independent implementations of confidential assets are summarized here. The first two implementations closely 
resemble the theoretical description given in [<a href="https://blockstream.com/bitcoin17-final41.pdf" title="Confidential Assets,
A. Poelstra et al.,
Blockstream">1</a>], with the last implementation adding Bulletproofs' functionality to 
confidential assets.</p>
<h3><a class="header" href="#elements-project" id="elements-project">Elements Project</a></h3>
<p>Elements [<a href="https://elementsproject.org/" title="Elements by Blockstream">31</a>] is an open source, sidechain-capable blockchain platform, providing access to 
advanced features such as Confidential Transactions and Issued Assets in <code>Github: ElementsProject/elements</code> [<a href="https://github.com/ElementsProject/elements" title="Github: ElementsProject/elements">16</a>]. 
It allows digitizable collectables, reward points and attested assets (e.g. gold coins) to be realized on a 
blockchain. The main idea behind Elements is to serve as a research platform and testbed for changes to the Bitcoin 
protocol. The Elements project's implementation of confidential assets is called Issued Assets ([<a href="https://elementsproject.org/features/issued-assets" title="Issued Assets - You can Issue your 
own Confidential Assets on Elements, 
Elements by Blockstream">13</a>], [<a href="https://elementsproject.org/features/issued-assets/investigation" title="Issued Assets - Investigation, 
Principal Investigator: Andrew Poelstra, 
Elements by Blockstream">14</a>], [<a href="https://elementsproject.org/elements-code-tutorial/issuing-assets" title="Elements Code Tutorial - Issuing your own Assets, 
Elements by Blockstream">15</a>]) 
and is based on its formal publication in [<a href="https://blockstream.com/bitcoin17-final41.pdf" title="Confidential Assets,
A. Poelstra et al.,
Blockstream">1</a>]. </p>
<p>The Elements project hosts a working demonstration (shown in <a href="digital-assets/confidential-assets/MainReport.html#fig_eca">Figure 2</a>) of confidential asset transfers 
involving five parties in <code>Github: ElementsProject/confidential-assets-demo</code> [<a href="https://github.com/ElementsProject/confidential-assets-demo" title="ElementsProject/confidential-assets-demo">17</a>]. The demonstration depicts a scenario 
where a coffee shop owner, <em>Dave,</em> charges a customer, <em>Alice,</em> for coffee in an asset called MELON. <em>Alice</em> does not hold 
enough MELON and needs to convert some AIRSKY into MELON, making use of an exchange operated by <em>Charlie</em>. The coffee 
shop owner, <em>Dave,</em> has a competitor, <em>Bob</em>, who is trying to gather information about <em>Dave's</em> sales. Due to the 
blockchain's confidential transactions and assets features, he will not be able to see anything useful by processing 
transactions on the blockchain. <em>Fred</em> is a miner and does not care about the detail of the transactions, but he makes 
blocks on the blockchain when transactions enter his miner mempool. The demonstration also includes generating the 
different types of assets.</p>
<p align="center"><a name="fig_eca"> </a><img src="digital-assets/confidential-assets/sources/elements-tx-example.png" width="650" /></p>
<p align="center"><b>Figure&nbsp;2: Elements Confidential Assets Transfer Demonstration 
[<a href="https://github.com/ElementsProject/confidential-assets-demo" 
title="ElementsProject/confidential-assets-demo">17</a>]</b></p>
<h3><a class="header" href="#chain-core-confidential-assets" id="chain-core-confidential-assets">Chain Core Confidential Assets</a></h3>
<p>Chain Core [<a href="https://chain.com/docs/1.2/core/get-started/introduction" title="Chain Core">20</a>] is a shared, multi-asset, cryptographic ledger, designed for enterprise financial infrastructure. It 
supports the coexistence and interoperability of multiple types of assets on the same network in their Confidential 
Assets framework. Chain Core is based on [<a href="https://blockstream.com/bitcoin17-final41.pdf" title="Confidential Assets,
A. Poelstra et al.,
Blockstream">1</a>], and available as an open source project in <code>Github: chain/chain</code> [<a href="https://github.com/chain/chain" title="Github: chain/chain">21</a>], 
which has been archived. It has been succeeded by Sequence, a ledger-as-a-service project, which enables secure 
tracking and transfer of balances in a token format ([<a href="https://chain.com/sequence" title="Chain: Sequence">22</a>], [<a href="https://dashboard.seq.com/docs" title="Sequence Documentation">23</a>]). Sequence offers a free plan for up to 
1,000,000 transactions per month.</p>
<p>Chain Core implements all native features as defined in [<a href="https://blockstream.com/bitcoin17-final41.pdf" title="Confidential Assets,
A. Poelstra et al.,
Blockstream">1</a>]. It was also working towards implementing ElGamal 
commitments into Chain Core to make its Confidential Assets framework quantum secure, but it is unclear if this 
effort was concluded at the time the project was archived ([<a href="https://blog.chain.com/hidden-in-plain-sight-transacting-privately-on-a-blockchain-835ab75c01cb" title="Hidden in Plain Sight: 
Transacting Privately on a Blockchain - 
Introducing Confidential Assets in the Chain Protocol
O. Andreev">24</a>], [<a href="https://blog.chain.com/preparing-for-a-quantum-future-45535b316314" title="Blockchains in a Quantum Future - 
Protecting Against Post-Quantum 
Attacks on Cryptography">25</a>]).</p>
<h3><a class="header" href="#cloak" id="cloak">Cloak</a></h3>
<p>Chain/Interstellar [<a href="https://interstellar.com" title="Inter/stellar Website">26</a>] introduced Cloak [<a href="https://github.com/interstellar/spacesuit/blob/master/spec.md" title="Github: interstellar/spacesuit/spec.md">29</a>], a redesign of Chain Core's Confidential Assets framework to make use 
of Bulletproof range proofs [<a href="https://medium.com/interstellar/programmable-constraint-systems-for-bulletproofs-365b9feb92f7" title="Programmable Constraint Systems for Bulletproofs,
Interstellar,
C. Yun">27</a>]. It is available as an open source project in <code>Github: interstellar/spacesuit</code> [<a href="https://github.com/interstellar/spacesuit/blob/master/spec.md" title="Github: interstellar/spacesuit">28</a>]. 
Cloak is all about confidential asset transactions, called cloaked transactions, which exchange values of different 
asset types, called flavors. The protocol ensures that values are not transmuted to any other asset types, that 
quantities do not overflow, and that both quantities and asset types are kept secret. </p>
<p>A traditional Bulletproofs implementation converts an arithmetic circuit into a Rank-1 Constraint System (R1CS); 
Cloak bypasses arithmetic circuits and provides an Application Programmers Interface (API) for building a 
<a href="digital-assets/confidential-assets/../../cryptography/bulletproofs-protocols/MainReport.html#evolving-bulletproof-protocols">constraint system</a> directly. 
The R1CS API consists of a hierarchy of task-specific “gadgets”, and is used by the <em>Prover</em> and <em>Verifier</em> alike to 
allocate variables and define constraints. Cloak uses a collection of gadgets such as “shuffle”, “merge”, “split” and 
“range proof” to build a constraint system for cloaked transactions. All transactions of the same size are 
indistinguishable, because the layout of all the gadgets is only determined by the number of inputs and outputs.</p>
<p>At the time of writing this report, the Cloak development was still ongoing.</p>
<h2><a class="header" href="#conclusions-observations-and-recommendations-6" id="conclusions-observations-and-recommendations-6">Conclusions, Observations and Recommendations</a></h2>
<ul>
<li>
<p>The idea to embed a Ricardian contract in the asset tag creation as suggested by Poelstra et al. [<a href="https://blockstream.com/bitcoin17-final41.pdf" title="Confidential Assets,
A. Poelstra et al.,
Blockstream">1</a>] warrants more 
investigation for a new confidential blockchain protocol such as Tari. Ricardian contracts could be used in asset 
generation in the probable second layer.</p>
</li>
<li>
<p>Asset commitments and ASPs are important cryptographic primitives for confidential asset transactions.</p>
</li>
<li>
<p>The Elements project implemented a range of useful confidential asset framework features and should be critically 
assessed for usability in a probable Tari second layer.</p>
</li>
<li>
<p>Cloak has the potential to take confidential assets implementation to the next level in efficiency and should be 
closely monitored. Interstellar is in the process of fully implementing and extending Bulletproofs for use in confidential 
assets.</p>
</li>
<li>
<p>If confidential assets are to be implemented in a Mimblewimble blockchain, all asset tags must be defined at their
instantiation, otherwise they will not be compatible. </p>
</li>
</ul>
<h2><a class="header" href="#references-18" id="references-18">References</a></h2>
<p>[<a href="https://blockstream.com/bitcoin17-final41.pdf" title="Confidential Assets,
A. Poelstra et al.,
Blockstream">1</a>] A. Poelstra, A. Back, M. Friedenbach, G. Maxwell and P, Wuille, &quot;Confidential Assets&quot;, Blockstream [online]. 
Available: <a href="https://blockstream.com/bitcoin17-final41.pdf">https://blockstream.com/bitcoin17-final41.pdf</a>. Date accessed: 2018‑12‑25.</p>
<p>[<a href="https://en.wikipedia.org/wiki/Discrete_logarithm" title="Wikipedia: Discrete Logarithm">2</a>] Wikipedia: &quot;Discrete Logarithm&quot; [online]. Available: <a href="https://en.wikipedia.org/wiki/Discrete_logarithm">https://en.wikipedia.org/wiki/Discrete_logarithm</a>. 
Date accessed: 2018‑12‑20.</p>
<p>[<a href="http://www.semper.org/sirene/publ/SaSt_01.dh-et-al.long.pdf" title="Assumptions Related to Discrete Logarithms: 
Why Subtleties Make a Real Difference, 
A. Sadeghi et al.">3</a>] A. Sadeghi and M. Steiner, &quot;Assumptions Related to Discrete Logarithms: Why Subtleties Make a Real Difference&quot; 
[online]. Available: <a href="http://www.semper.org/sirene/publ/SaSt_01.dh-et-al.long.pdf">http://www.semper.org/sirene/publ/SaSt_01.dh-et-al.long.pdf</a>. Date accessed: 2018‑12‑24.</p>
<p>[<a href="https://people.xiph.org/%7Egreg/confidential_values.txt" title="Confidential Transactions Write up,
G. Maxwell">4</a>] G. Maxwell, &quot;Confidential Transactions Write up&quot; [online]. 
Available: <a href="https://people.xiph.org/%7Egreg/confidential_values.txt">https://people.xiph.org/~greg/confidential_values.txt</a>. Date accessed: 2018‑12‑10.</p>
<p>[<a href="https://github.com/AdamISZ/ConfidentialTransactionsDoc/blob/master/essayonCT.pdf" title="An Investigation into Confidential Transactions, 
A. Gibson, 
July 2018">5</a>] A. Gibson, &quot;An Investigation into Confidential Transactions&quot;, July 2018 [online]. 
Available: <a href="https://github.com/AdamISZ/ConfidentialTransactionsDoc/blob/master/essayonCT.pdf">https://github.com/AdamISZ/ConfidentialTransactionsDoc/blob/master/essayonCT.pdf</a>. 
Date accessed: 2018‑12‑22.</p>
<p>[<a href="https://hackage.haskell.org/package/pedersen-commitment" title="Pedersen-commitment: An Implementation
of Pedersen Commitment Schemes">6</a>] Pedersen-commitment: An Implementation of Pedersen Commitment Schemes [online]. 
Available: <a href="https://hackage.haskell.org/package/pedersen-commitment">https://hackage.haskell.org/package/pedersen-commitment</a>. Date accessed: 2018‑12‑25.</p>
<p>[<a href="http://cryptonite.info/files/HMBC.pdf" title="Homomorphic Mini-blockchain Scheme, 
B. Franca, 
April 2015">7</a>] B. Franca, &quot;Homomorphic Mini-blockchain Scheme&quot;, April 2015 [online]. 
Available: <a href="http://cryptonite.info/files/HMBC.pdf">http://cryptonite.info/files/HMBC.pdf</a>. Date accessed: 2018‑12‑22.</p>
<p>[<a href="http://orbilu.uni.lu/bitstream/10993/33705/1/MSPN2017.pdf" title="Efficient Implementation of Pedersen 
Commitments Using Twisted Edwards Curves, 
C. Franck and J. Großschädl, 
University of Luxembourg">8</a>] C. Franck and J. Großschädl, &quot;Efficient Implementation of Pedersen Commitments Using Twisted Edwards Curves&quot;, 
University of Luxembourg [online]. Available: <a href="http://orbilu.uni.lu/bitstream/10993/33705/1/MSPN2017.pdf">http://orbilu.uni.lu/bitstream/10993/33705/1/MSPN2017.pdf</a>. 
Date accessed: 2018‑12‑22.</p>
<p>[<a href="http://diyhpl.us/%7Ebryan/papers2/bitcoin/mimblewimble-andytoshi-draft-2016-10-20.pdf" title="Mimblewimble, 
A. Poelstra, 
October 2016">9</a>] A. Poelstra, &quot;Mimblewimble&quot;, October 2016 [online]. 
Available: <a href="http://diyhpl.us/%7Ebryan/papers2/bitcoin/mimblewimble-andytoshi-draft-2016-10-20.pdf">http://diyhpl.us/~bryan/papers2/bitcoin/mimblewimble-andytoshi-draft-2016-10-20.pdf</a>. 
Date accessed: 2018‑12‑13.</p>
<p>[<a href="https://www.weusecoins.com/mimble-wimble-andrew-poelstra" title="Mimblewimble Explained,
A. Poelstra, 
November 2016">10</a>] A. Poelstra, &quot;Mimblewimble Explained&quot;, November 2016 [online]. 
Available: <a href="https://www.weusecoins.com/mimble-wimble-andrew-poelstra/">https://www.weusecoins.com/mimble-wimble-andrew-poelstra/</a>. 
Date accessed: 2018‑12‑10.</p>
<p>[<a href="http://iang.org/papers/ricardian_contract.html" title="The Ricardian Contract, 
First IEEE International Workshop on 
Electronic Contracting.
IEEE (2004), 
I. Grigg">11</a>] I. Grigg, &quot;The Ricardian Contract&quot;, <em>First IEEE International Workshop on Electronic Contracting.</em> IEEE (2004) 
[online]. Available: <a href="http://iang.org/papers/ricardian_contract.html">http://iang.org/papers/ricardian_contract.html</a>. Date accessed: 2018‑12‑13.</p>
<p>[<a href="https://www.elinext.com/industries/financial/trends/smart-vs-ricardian-contracts/" title="Smart vs. Ricardian Contracts: 
What’s the Difference?, 
D. Koteshov, 
February 2018">12</a>] D. Koteshov, &quot;Smart vs. Ricardian Contracts: What’s the Difference?&quot; February 2018 [online]. Available: 
<a href="https://www.elinext.com/industries/financial/trends/smart-vs-ricardian-contracts/">https://www.elinext.com/industries/financial/trends/smart-vs-ricardian-contracts/</a>. Date accessed: 2018‑12‑13.</p>
<p>[<a href="https://elementsproject.org/features/issued-assets" title="Issued Assets - You can Issue your 
own Confidential Assets on Elements, 
Elements by Blockstream">13</a>] Elements by Blockstream: &quot;Issued Assets - You can Issue your own Confidential Assets on Elements&quot;<br />
[online]. Available: <a href="https://elementsproject.org/features/issued-assets">https://elementsproject.org/features/issued-assets</a>. Date accessed: 2018‑12‑14.</p>
<p>[<a href="https://elementsproject.org/features/issued-assets/investigation" title="Issued Assets - Investigation, 
Principal Investigator: Andrew Poelstra, 
Elements by Blockstream">14</a>] Elements by Blockstream: &quot;Issued Assets - Investigation, Principal Investigator: Andrew Poelstra&quot; [online]. 
Available: <a href="https://elementsproject.org/features/issued-assets/investigation">https://elementsproject.org/features/issued-assets/investigation</a>. Date accessed: 2018‑12‑14.</p>
<p>[<a href="https://elementsproject.org/elements-code-tutorial/issuing-assets" title="Elements Code Tutorial - Issuing your own Assets, 
Elements by Blockstream">15</a>] Elements by Blockstream: &quot;Elements Code Tutorial - Issuing your own Assets&quot; [online].
Available: <a href="https://elementsproject.org/elements-code-tutorial/issuing-assets">https://elementsproject.org/elements-code-tutorial/issuing-assets</a>. Date accessed: 2018‑12‑14.</p>
<p>[<a href="https://github.com/ElementsProject/elements" title="Github: ElementsProject/elements">16</a>] Github: ElementsProject/elements [online]. Available: <a href="https://github.com/ElementsProject/elements">https://github.com/ElementsProject/elements</a>. 
Date accessed: 2018‑12‑18.</p>
<p>[<a href="https://github.com/ElementsProject/confidential-assets-demo" title="ElementsProject/confidential-assets-demo">17</a>] Github: ElementsProject/confidential-assets-demo [online]. 
Available: <a href="https://github.com/ElementsProject/confidential-assets-demo">https://github.com/ElementsProject/confidential-assets-demo</a>. Date accessed: 2018‑12‑18.</p>
<p>[<a href="http://diyhpl.us/%7Ebryan/papers2/bitcoin/Borromean%20ring%20signatures.pdf" title="Borromean Ring Signatures (2015), 
G. Maxwell and A. Poelstra">18</a>] G. Maxwell and A. Poelstra, &quot;Borromean Ring Signatures&quot; (2015) [online]. 
Available: <a href="http://diyhpl.us/%7Ebryan/papers2/bitcoin/Borromean%20ring%20signatures.pdf">http://diyhpl.us/~bryan/papers2/bitcoin/Borromean%20ring%20signatures.pdf</a>. Date accessed: 2018‑12‑18.</p>
<p>[<a href="https://www.iacr.org/cryptodb/archive/2002/ASIACRYPT/50/50.pdf" title="1-out-of-n Signatures from a Variety of Keys, 
M. Abe, M. Ohkubo and K. Suzuki">19</a>] M. Abe, M. Ohkubo and K. Suzuki, &quot;1-out-of-n Signatures from a Variety of Keys&quot; [online]. 
Available: <a href="https://www.iacr.org/cryptodb/archive/2002/ASIACRYPT/50/50.pdf">https://www.iacr.org/cryptodb/archive/2002/ASIACRYPT/50/50.pdf</a>. Date accessed: 2018‑12‑18.</p>
<p>[<a href="https://chain.com/docs/1.2/core/get-started/introduction" title="Chain Core">20</a>] Chain Core [online]. Available: <a href="https://chain.com/docs/1.2/core/get-started/introduction">https://chain.com/docs/1.2/core/get-started/introduction</a>. 
Date accessed: 2018‑12‑18.</p>
<p>[<a href="https://github.com/chain/chain" title="Github: chain/chain">21</a>] Github: chain/chain [online]. Available: <a href="https://github.com/chain/chain">https://github.com/chain/chain</a>. Date accessed: 2018‑12‑18.</p>
<p>[<a href="https://chain.com/sequence" title="Chain: Sequence">22</a>] Chain: &quot;Sequence&quot; [online]. Available: <a href="https://chain.com/sequence">https://chain.com/sequence</a>. Date accessed: 2018‑12‑18.</p>
<p>[<a href="https://dashboard.seq.com/docs" title="Sequence Documentation">23</a>] Sequence Documentation [online]. Available: <a href="https://dashboard.seq.com/docs">https://dashboard.seq.com/docs</a>. Date accessed: 2018‑12‑18.</p>
<p>[<a href="https://blog.chain.com/hidden-in-plain-sight-transacting-privately-on-a-blockchain-835ab75c01cb" title="Hidden in Plain Sight: 
Transacting Privately on a Blockchain - 
Introducing Confidential Assets in the Chain Protocol
O. Andreev">24</a>] O Andreev: &quot;Hidden in Plain Sight: Transacting Privately on a Blockchain - Introducing Confidential Assets in the Chain 
Protocol&quot;, Chain [online]. 
Available: <a href="https://blog.chain.com/hidden-in-plain-sight-transacting-privately-on-a-blockchain-835ab75c01cb">https://blog.chain.com/hidden-in-plain-sight-transacting-privately-on-a-blockchain-835ab75c01cb</a>. 
Date accessed: 2018‑12‑18.</p>
<p>[<a href="https://blog.chain.com/preparing-for-a-quantum-future-45535b316314" title="Blockchains in a Quantum Future - 
Protecting Against Post-Quantum 
Attacks on Cryptography">25</a>] Blockchains in a Quantum Future - Protecting Against Post-Quantum Attacks on Cryptography [online]. 
Available: <a href="https://blog.chain.com/preparing-for-a-quantum-future-45535b316314">https://blog.chain.com/preparing-for-a-quantum-future-45535b316314</a>. Date accessed: 2018‑12‑18.</p>
<p>[<a href="https://interstellar.com" title="Inter/stellar Website">26</a>] Inter/stellar website [online]. Available: <a href="https://interstellar.com">https://interstellar.com</a>. Date accessed: 2018‑12‑22.</p>
<p>[<a href="https://medium.com/interstellar/programmable-constraint-systems-for-bulletproofs-365b9feb92f7" title="Programmable Constraint Systems for Bulletproofs,
Interstellar,
C. Yun">27</a>] C. Yun, &quot;Programmable Constraint Systems for Bulletproofs&quot; [online]. Available: 
<a href="https://medium.com/interstellar/programmable-constraint-systems-for-bulletproofs-365b9feb92f7">https://medium.com/interstellar/programmable-constraint-systems-for-bulletproofs-365b9feb92f7</a>. 
Date accessed: 2018‑12‑22.</p>
<p>[<a href="https://github.com/interstellar/spacesuit/blob/master/spec.md" title="Github: interstellar/spacesuit">28</a>] Github: interstellar/spacesuit [online]. 
Available: <a href="https://github.com/interstellar/spacesuit/blob/master/spec.md">https://github.com/interstellar/spacesuit/blob/master/spec.md</a>. 
Date accessed: 2018‑12‑18.</p>
<p>[<a href="https://github.com/interstellar/spacesuit/blob/master/spec.md" title="Github: interstellar/spacesuit/spec.md">29</a>] Github: interstellar/spacesuit/spec.md [online]. 
Available: <a href="https://github.com/interstellar/spacesuit/blob/master/spec.md">https://github.com/interstellar/spacesuit/blob/master/spec.md</a>. Date accessed: 2018‑12‑18.</p>
<p>[<a href="https://en.wikipedia.org/wiki/Ricardian_contract" title="Wikipedia: Ricardian Contract">30</a>] Wikipedia: &quot;Ricardian Contract&quot; [online]. Available: <a href="https://en.wikipedia.org/wiki/Ricardian_contract">https://en.wikipedia.org/wiki/Ricardian_contract</a>.
Date accessed: 2018‑12‑21.</p>
<p>[<a href="https://elementsproject.org/" title="Elements by Blockstream">31</a>] Wikipedia: &quot;Elements by Blockstream&quot; [online]. Available: <a href="https://elementsproject.org">https://elementsproject.org</a>. 
Date accessed: 2018‑12‑21.</p>
<h2><a class="header" href="#appendices-5" id="appendices-5">Appendices</a></h2>
<h3><a class="header" href="#appendix-a-definition-of-terms-3" id="appendix-a-definition-of-terms-3">Appendix A: Definition of Terms</a></h3>
<p>Definitions of terms presented here are high level and general in nature. Full mathematical definitions are available 
in the cited references. </p>
<ul>
<li><strong>Discrete Logarithm/Discrete Logarithm Problem (DLP):</strong><a name="dlp"> </a>In the mathematics of real 
numbers, the logarithm $ \log_b^a $ is a number $ x $ such that $ b^x=a $, for given numbers $ a $ and $ b $. 
Analogously, in any group $ G $, powers $ b^k $ can be defined for all integers $ k $, and the discrete logarithm 
$ \log_ba $ is an integer $ k $ such that $ b^k=a $. Algorithms in public-key cryptography base their security on the 
assumption that the discrete logarithm problem over carefully chosen cyclic finite groups and cyclic subgroups of 
elliptic curves over finite fields has no efficient solution ([<a href="https://en.wikipedia.org/wiki/Discrete_logarithm" title="Wikipedia: Discrete Logarithm">2</a>], [<a href="http://www.semper.org/sirene/publ/SaSt_01.dh-et-al.long.pdf" title="Assumptions Related to Discrete Logarithms: 
Why Subtleties Make a Real Difference, 
A. Sadeghi et al.">3</a>]).</li>
</ul>
<h3><a class="header" href="#appendix-b-ricardian-contracts-vs-smart-contracts" id="appendix-b-ricardian-contracts-vs-smart-contracts">Appendix B: Ricardian Contracts vs. Smart Contracts</a></h3>
<p>A <strong>Ricardian contract</strong> is “a digital contract that deﬁnes the terms and conditions of an interaction, between two or 
more peers, that is cryptographically signed and veriﬁed, being both human and machine readable and digitally 
signed” [<a href="https://www.elinext.com/industries/financial/trends/smart-vs-ricardian-contracts/" title="Smart vs. Ricardian Contracts: 
What’s the Difference?, 
D. Koteshov, 
February 2018">12</a>]. With a Ricardian contract, the information from the legal document is placed in a format that can be 
read and executed by software. The cryptographic identification offers high levels of security. The main properties of 
a Ricardian contract are (also refer to <a href="digital-assets/confidential-assets/MainReport.html#fig_rc">Figure 1</a>):</p>
<ul>
<li>human readable;</li>
<li>document is printable;</li>
<li>program parsable;</li>
<li>all forms (displayed, printed and parsed) are manifestly equivalent;</li>
<li>signed by issuer;</li>
<li>can be identified securely, where security means that any attempts to change the linkage between a reference and the 
contract are impractical.</li>
</ul>
<p align="center"><a name="fig_rc"> </a><img src="digital-assets/confidential-assets/sources/ricardian_contract.png" width="690" /></p>
<p align="center"><b>Figure&nbsp;1: Bowtie Diagram of a Ricardian Contract 
[<a href="https://www.elinext.com/industries/financial/trends/smart-vs-ricardian-contracts" title="Smart vs. 
Ricardian Contracts: 
What’s the Difference?, 
Koteshov D., 
February 2018">12</a>]</b></p>
<p>Ricardian contracts are robust (due to identification by cryptographic hash functions), transparent (due to readable 
text for legal prose) and efficient (due to computer markup language to extract essential information [<a href="https://en.wikipedia.org/wiki/Ricardian_contract" title="Wikipedia: Ricardian Contract">30</a>].</p>
<p>A <strong>smart contract</strong> is “a computerized transaction protocol that executes the terms of a contract. The general objectives 
are to satisfy common contractual conditions” [<a href="https://www.elinext.com/industries/financial/trends/smart-vs-ricardian-contracts/" title="Smart vs. Ricardian Contracts: 
What’s the Difference?, 
D. Koteshov, 
February 2018">12</a>].  With smart contracts, digital assets can be exchanged in a 
transparent and non-conflicting way. They provide trust. The main properties of a smart contract are:</p>
<ul>
<li>self-executing (it doesn't run unless someone initiates it);</li>
<li>immutable;</li>
<li>self-verifying;</li>
<li>auto-enforcing;</li>
<li>cost saving;</li>
<li>removes third parties or escrow agents.</li>
</ul>
<p>It is possible to implement a Ricardian contract as a smart contract, but not in all instances. A smart contract is a 
pre-agreed digital agreement that can be executed automatically. A Ricardian contract records “intentions” and “actions” 
of a particular contract, no matter if it has been executed or not. Hashes of Ricardian contracts can refer to 
documents or executable code ([<a href="https://www.elinext.com/industries/financial/trends/smart-vs-ricardian-contracts/" title="Smart vs. Ricardian Contracts: 
What’s the Difference?, 
D. Koteshov, 
February 2018">12</a>], [<a href="https://en.wikipedia.org/wiki/Ricardian_contract" title="Wikipedia: Ricardian Contract">30</a>]).</p>
<p>The Ricardian contract design pattern has been implemented in several projects and is free of any intellectual property 
restrictions [<a href="https://en.wikipedia.org/wiki/Ricardian_contract" title="Wikipedia: Ricardian Contract">30</a>].</p>
<h2><a class="header" href="#contributors-12" id="contributors-12">Contributors</a></h2>
<ul>
<li><a href="https://github.com/hansieodendaal">https://github.com/hansieodendaal</a></li>
<li><a href="https://github.com/philipr-za">https://github.com/philipr-za</a></li>
<li><a href="https://github.com/neonknight64">https://github.com/neonknight64</a></li>
<li><a href="https://github.com/anselld">https://github.com/anselld</a></li>
</ul>
<h1><a class="header" href="#blockchain-related-protocols" id="blockchain-related-protocols">Blockchain-related Protocols</a></h1>
<h2><a class="header" href="#purpose-5" id="purpose-5">Purpose</a></h2>
<p>Users often take blockchain protocols for granted when analyzing the potential of a cryptocurrency. The different 
blockchain protocols used can play a prominent role in the success of a cryptocurrency [<a href="https://cryptomaniaks.com/blockchain-protocols-list-explained" title="A List of Blockchain 
Protocols - Explained 
and Compared">1</a>].</p>
<h2><a class="header" href="#definitions-5" id="definitions-5">Definitions</a></h2>
<ul>
<li>
<p>From <strong>Wikipedia - 1</strong>: A blockchain is a growing list of records, 
called blocks, which are linked using cryptography. Each block contains a cryptographic hash of the previous block, a 
time stamp, and transaction data (generally represented as a Merkle tree root hash) [<a href="https://en.wikipedia.org/wiki/Blockchain" title="Blockchain">2</a>].</p>
</li>
<li>
<p>From <strong>Wikipedia - 2</strong>: A security protocol 
(cryptographic protocol or encryption protocol) is an abstract or concrete protocol that performs a security-related 
function and applies cryptographic methods, often as sequences of cryptographic primitives. A protocol describes how the 
algorithms should be used. A sufficiently detailed protocol includes details about data structures and representations, 
at which point it can be used to implement multiple, interoperable versions of a program [<a href="https://en.wikipedia.org/wiki/Cryptographic_protocol" title="Cryptographic Protocol">3</a>].</p>
</li>
<li>
<p>From <strong>Market Protocol</strong>:
A protocol can be seen as a methodology agreed upon by two or more parties that establish a common set of rules that<br />
they can agree upon so as to enter into a binding agreement. Protocols are therefore the set of rules that govern the 
network. Blockchain protocols usually include rules about consensus, transaction validation and network participation [<a href="https://en.wikipedia.org/wiki/Digital_asset" title="Blockchain Crash Course: 
Protocols, dApps, APIs 
and DEXs">4</a>].</p>
</li>
<li>
<p>From <strong>Encyclopaedia Britannica</strong>: Protocol, 
in computer science, is a set of rules or procedures for transmitting data between electronic devices, such as computers. 
In order for computers to exchange information, there must be a preexisting agreement as to how the information will be 
structured and how each side will send and receive it. Without a protocol, a transmitting computer, for example, could be 
sending its data in eight-bit packets while the receiving computer might expect the data in 16-bit packets [<a href="https://www.britannica.com/technology/protocol-computer-science" title="Protocol - 
Computer Science">5</a>].</p>
</li>
</ul>
<h2><a class="header" href="#references-19" id="references-19">References</a></h2>
<p>[<a href="https://cryptomaniaks.com/blockchain-protocols-list-explained" title="A List of Blockchain 
Protocols - Explained 
and Compared">1</a>] &quot;A List of Blockchain Protocols - Explained and Compared&quot; [online]. 
Available: <a href="https://cryptomaniaks.com/blockchain-protocols-list-explained">https://cryptomaniaks.com/blockchain-protocols-list-explained</a>. Date accessed: 2019‑06‑11.</p>
<p>[<a href="https://en.wikipedia.org/wiki/Blockchain" title="Blockchain">2</a>] Wikipedia: &quot;Blockchain&quot; [online]. 
Available: <a href="https://en.wikipedia.org/wiki/Blockchain">https://en.wikipedia.org/wiki/Blockchain</a>. 
Date accessed: 2019‑06‑10.</p>
<p>[<a href="https://en.wikipedia.org/wiki/Cryptographic_protocol" title="Cryptographic Protocol">3</a>] Wikipedia: &quot;Cryptographic Protocol&quot; [online]. Available: <a href="https://en.wikipedia.org/wiki/Cryptographic_protocol">https://en.wikipedia.org/wiki/Cryptographic_protocol</a>. 
Date accessed: 2019‑06‑11.</p>
<p>[<a href="https://en.wikipedia.org/wiki/Digital_asset" title="Blockchain Crash Course: 
Protocols, dApps, APIs 
and DEXs">4</a>] L. Jovanovic, &quot;Blockchain Crash Course: Protocols, dApps, APIs and DEXs&quot; [online]. <em>MARKET Protocol</em>. 
Available: <a href="https://en.wikipedia.org/wiki/Digital_asset">https://en.wikipedia.org/wiki/Digital_asset</a>. 
Date accessed: 2019‑06‑11.</p>
<p>[<a href="https://www.britannica.com/technology/protocol-computer-science" title="Protocol - 
Computer Science">5</a>] &quot;Protocol - Computer Science&quot; [online]. <em>Encyclopaedia Britannica</em>.
Available: <a href="https://www.britannica.com/technology/protocol-computer-science">https://www.britannica.com/technology/protocol-computer-science</a>. 
Date accessed: 2019‑06‑11.</p>
<h1><a class="header" href="#mimblewimble-1" id="mimblewimble-1">Mimblewimble</a></h1>
<div class="note warning">
<p>This presentation contains somewhat outdated content. Whilst the description here follows the original Mimblewimble
paper pretty closely, it no longer precisely describes how Mimblewimble transactions are implemented in say, Grin or
Tari.</p>
<p>The presentation is left here as is since it offers a pretty gentle introduction to the math involved, and it may be
instructive to see how things used to be before you head off to read <a href="protocols/mimblewimble-1/sources/../MainReport.html">a more detailed and
up-to-date account</a>.</p>
</div>
<iframe width=750 height=600 src="https://gitpitch.com/tari-labs/tari-university/master?p=/src/protocols/mimblewimble-1#/"></iframe>
<h3><a class="header" href="#having-trouble-viewing-this-presentation-4" id="having-trouble-viewing-this-presentation-4">Having trouble viewing this presentation?</a></h3>
<p>View it in a <a href="https://gitpitch.com/tari-labs/tari-university/master?p=/src/protocols/mimblewimble-1#/">separate window</a>.</p>
<h1><a class="header" href="#mimblewimble-transactions-explained" id="mimblewimble-transactions-explained">Mimblewimble Transactions Explained</a></h1>
<ul>
<li><a href="protocols/mimblewimble-1/MainReport.html#high-level-overview">High-level Overview</a></li>
<li><a href="protocols/mimblewimble-1/MainReport.html#transactions-explained">Transactions Explained</a>
<ul>
<li><a href="protocols/mimblewimble-1/MainReport.html#basic-transaction">Basic Transaction</a></li>
<li><a href="protocols/mimblewimble-1/MainReport.html#blinding-factors">Blinding Factors</a></li>
<li><a href="protocols/mimblewimble-1/MainReport.html#alice-prepares-a-transaction">Alice Prepares a Transaction</a></li>
<li><a href="protocols/mimblewimble-1/MainReport.html#bob-prepares-his-response">Bob Prepares his Response</a></li>
<li><a href="protocols/mimblewimble-1/MainReport.html#alice-completes-and-broadcasts-the-transaction">Alice Completes and Broadcasts the Transaction</a></li>
</ul>
</li>
<li><a href="protocols/mimblewimble-1/MainReport.html#transaction-verification-and-propagation">Transaction Verification and Propagation</a></li>
<li><a href="protocols/mimblewimble-1/MainReport.html#stopping-fraud">Stopping Fraud</a></li>
<li><a href="protocols/mimblewimble-1/MainReport.html#transaction-summary">Transaction Summary</a></li>
<li><a href="protocols/mimblewimble-1/MainReport.html#references">References</a></li>
<li><a href="protocols/mimblewimble-1/MainReport.html#contributors">Contributors</a></li>
</ul>
<h2><a class="header" href="#high-level-overview" id="high-level-overview">High-level Overview</a></h2>
<p>Mimblewimble is a privacy-oriented, cryptocurrency technology. It differs from Bitcoin in some key areas:</p>
<ul>
<li>No addresses. The concept of Mimblewimble addresses does not exist.</li>
<li>Completely private. Every transaction is confidential.</li>
<li>Compact blockchain. Mimblewimble uses a different set of security guarantees to Bitcoin, which leads to a far more 
compact blockchain.</li>
</ul>
<h2><a class="header" href="#transactions-explained" id="transactions-explained">Transactions Explained</a></h2>
<p>Confidential transactions [<a href="https://www.mycryptopedia.com/what-are-confidential-transactions/" title="What are Bitcoin Confidential Transactions?">1</a>] were invented by Dr. Adam Back and are employed in several cryptocurrency projects,
including Monero and Tari - by way of Mimblewimble.</p>
<p>Recipients of Tari create the private keys for receiving coins on the fly. Therefore they must be involved in the
construction of a Tari transaction.</p>
<p>This doesn't necessarily mean that recipients have to be online. However, they do need to be able to communicate, 
whether it
be by email, Instant Messaging (IM) or carrier pigeon.</p>
<h3><a class="header" href="#basic-transaction" id="basic-transaction">Basic Transaction</a></h3>
<p>We'll explain how Alice can send Tari to Bob using a two-party protocol for Mimblewimble. Multiparty transactions are
similar, but the flow of information is a bit different and takes place over additional communication rounds.</p>
<p>Let's say Alice has 300 µT and she wants to send 200 µT to Bob.</p>
<p>Here’s the basic transaction:</p>
<table><thead><tr><th align="left">Inputs</th><th align="left">Outputs</th><th align="left"></th><th align="left"></th></tr></thead><tbody>
<tr><td align="left">300</td><td align="left">200</td><td align="left">90</td><td align="left">10</td></tr>
<tr><td align="left">Alice's UTXO</td><td align="left">To Bob</td><td align="left">Change</td><td align="left">fee</td></tr>
</tbody></table>
<p>If we write this as a mathematical equation, where outputs are positive and inputs are negative, we should be able to
balance things out so that there's no creation of coins out of thin air:</p>
<p>$$ -300 + 200 + 90 + 10 = 0 ​$$</p>
<p>This is basically the information that sits in the Bitcoin blockchain. Anyone can audit anyone else's transactions
simply by inspecting the global ledger's transaction history. This isn't great for privacy.</p>
<p>Here is where confidential transactions come in. We can start by multiplying both sides of the preceding equation by some
generator point <em>H</em> on the elliptic curve (for an introduction to elliptic curve math, refer to
<a href="protocols/mimblewimble-1/../../cryptography/crypto-1/sources/PITCHME.link.html">this presentation</a>):</p>
<p>$$ 300.H = 200.H + 90.H + 10.H ​$$</p>
<p>Since <em>H</em> is a constant, the math above still holds, so we can validate that Alice is not stealing by checking that</p>
<p>$$(3.H) - (2.H) - (1.H) - (f.H) \equiv 0.H = 0 $$</p>
<p>Notice that we <em>only see public keys</em> and thus the values are hidden. Cool!</p>
<div class="note info">
Technically, only scalar integer values are valid for elliptic curve multiplication. This is why we use µT in the
transactions so that the amounts are always integers.
</div>
There's a catch though. If _H_ is constant and known (it is), couldn’t someone just pre-calculate $n.H​$ for all
reasonable values of _n_ and scan the blockchain for those public keys?<sup>[^a]</sup>
<p>In short, <em>yes</em>. So we’re not done yet.</p>
<div class="footnote-definition" id="a"><sup class="footnote-definition-label">1</sup>
<p>&quot;This is called a pre-image attack.&quot;</p>
</div>
<h3><a class="header" href="#blinding-factors" id="blinding-factors">Blinding Factors</a></h3>
<p>To prevent a pre-image attack from unblinding all the values in Tari transactions, we need to add randomness to each
input and output. The basic idea is to do this by adding a second public key to each transaction output.</p>
<p>So if we rewrite the inputs and outputs as follows:</p>
<p>$$ C_i = n_i.H + k_i.G $$</p>
<p>where <em>G</em> is another generator on the same curve, this completely <em>blinds</em> the inputs and outputs so that no pre-image 
attack is possible. This formulation is called a <em>Pedersen commitment</em> [<a href="https://en.wikipedia.org/wiki/Commitment_scheme" title="Commitment Scheme">3</a>].</p>
<div class="note warning">
The two generators, _H_ and _G_ must be selected in a way that it's impossible to convert values from one generator to
the other [[2]]. Specifically, if _G_ is the base generator, then there exists some _k_ where $$ H = kG $$
<p>If anyone is able to figure out this <em>k</em>, the whole security of Confidential Transactions falls apart. It's left as an
exercise for the reader to figure out why.</p>
<p>For a semi-gentle introduction to these concepts, Adam Gibson's paper on the subject is excellent [<a href="https://joinmarket.me/static/FromZK2BPs_v1.pdf" title="From Zero (Knowledge) to BulletProofs">5</a>].</p>
</div>
<h3><a class="header" href="#alice-prepares-a-transaction" id="alice-prepares-a-transaction">Alice Prepares a Transaction</a></h3>
<p>Alice can now start to build a transaction.</p>
<table><thead><tr><th align="left">Type</th><th align="left">Formula</th><th align="left">Name</th></tr></thead><tbody>
<tr><td align="left">Input</td><td align="left">$$ -300.H - k_1.G $$</td><td align="left">C1</td></tr>
<tr><td align="left">Change output</td><td align="left">$$ 90.H + k_2.G $$</td><td align="left">C2</td></tr>
<tr><td align="left">Fee</td><td align="left">$$ 10.H + 0.G $$</td><td align="left">f</td></tr>
<tr><td align="left">Total spent</td><td align="left">$$ 200.H + 0.G $$</td><td align="left">C*</td></tr>
<tr><td align="left"><em>Sum</em></td><td align="left">$$ 0.H + (k_2-k_1).G $$</td><td align="left">X</td></tr>
</tbody></table>
<p>The \( k_i \)-values, \(k_1, k_2\) are the spending keys for those outputs.</p>
<div class="note warning">
The _only pieces of information you need to spend Tari outputs_ are the spending key
(also called a blinding factor) and its associated value.
</div>
<p>Therefore for this transaction, Alice's wallet, which tracks all of her Tari unspent outputs, would have provided the
blinding factor and the value &quot;300&quot; to complete the commitment <em>C1</em>.</p>
<p>Notice that when all the inputs and outputs are summed (including the fee), all the values cancel to zero, as they
should. Notice also that the only term left is multiplied by the point <em>G</em>. All the <em>H</em> terms are gone. We call this sum
the <em>public excess</em> for Alice's part of the transaction.</p>
<p>We define the <em>excess</em> of the transaction to be</p>
<p>$$ x_s = k_2 - k_1 $$</p>
<p>A simple way for Alice to calculate her excess (and how the Tari wallet software does it) is to sum
her output blinding factors and minus the sum of her input blinding factors.</p>
<p>Let's say Alice was trying to create some money for herself and made the change 100 µT instead of 90. In this instance,
the sum of the outputs and inputs would not cancel on <em>H</em> and we would have</p>
<p>$$X^* = 10.H + x_s.G$$</p>
<p>We'll see in a bit how the Mimblewimble protocol catches Alice out if she tries to pull shenanigans like this.</p>
<div class="note info">
Alice actually also prepares a range proof for each output, which is a proof that the value of the output is between
zero and 2^64 µT. Without range proofs, Alice could send negative amounts to people, enriching herself, and not breaking
any of the accounting of Tari.
</div>
<div class="note info">
 In Tari and Grin, the excess value is actually split into two values for added privacy. The Grin team has a good
 explanation of why this `offset` value is necessary [[4]]. We leave off this step to keep the explanation simple(r).
</div>
<p>Alice also chooses a random <em>nonce</em>,</p>
<p>$$ r_a $$</p>
<p>and calculates the corresponding public nonce,</p>
<p>$$ R_a = r_a.G $$</p>
<p>Alice then sends the following information to Bob:</p>
<table><thead><tr><th align="left">Field</th><th align="left">Value</th></tr></thead><tbody>
<tr><td align="left">Inputs</td><td align="left">C1</td></tr>
<tr><td align="left">Outputs</td><td align="left">C2</td></tr>
<tr><td align="left">Fee</td><td align="left">10</td></tr>
<tr><td align="left">Amount paid to Bob</td><td align="left">200</td></tr>
<tr><td align="left">Public nonce</td><td align="left">$$ R_a $$</td></tr>
<tr><td align="left">Public excess</td><td align="left">X</td></tr>
<tr><td align="left">Metadata</td><td align="left">m</td></tr>
</tbody></table>
<p>The message metadata is some extra bits of information that pertains to the transaction (such as when the output can be spent).</p>
<h3><a class="header" href="#bob-prepares-his-response" id="bob-prepares-his-response">Bob Prepares his Response</a></h3>
<p>Bob receives this information and then sets about completing his part of the transaction.</p>
<p>First, he can verify that Alice has sent over the correct information by checking that the public excess, <em>X</em>, is 
correct by following the same procedure that Alice used to calculate it above. This step isn't strictly necessary, 
since he doesn't have enough information to detect any fraud at this point.</p>
<p>He then builds a commitment from the <code>amount</code> field that Alice is sending to him:</p>
<p>$$ C_b = 200.H + k_b.G $$</p>
<p>where \(k_b\) is Bob's private spend key. He calculates</p>
<p>$$P_b = k_b.G$$</p>
<p>and generates a range proof for the commitment.</p>
<p>Bob then needs to sign that he's happy that everything is complete to his satisfaction. He creates a partial
<a href="protocols/mimblewimble-1/../../cryptography/digital_signatures/introduction_schnorr_signatures.html">Schnorr Signature</a> with the challenge,</p>
<p>$$ e = H(R_a + R_b \Vert X + P_b \Vert f \Vert m) $$</p>
<p>and the signature is given by</p>
<p>$$ s_b = r_b + ek_b $$</p>
<p>Bob sends back</p>
<table><thead><tr><th align="left">Field</th><th align="left">Value</th></tr></thead><tbody>
<tr><td align="left">Output (commitment and range proof)</td><td align="left">$$C_b$$</td></tr>
<tr><td align="left">Public nonce</td><td align="left">$$R_b$$</td></tr>
<tr><td align="left">Signature</td><td align="left">$$s_b$$</td></tr>
<tr><td align="left">Public key</td><td align="left">$$P_b$$</td></tr>
</tbody></table>
<h3><a class="header" href="#alice-completes-and-broadcasts-the-transaction" id="alice-completes-and-broadcasts-the-transaction">Alice Completes and Broadcasts the Transaction</a></h3>
<p>After hearing back from Bob, Alice can wrap things up.</p>
<p>First, she can now use Bob's public nonce and public key to independently calculate the same challenge that Bob signed:</p>
<p>$$ e = H(R_a + R_b \Vert X + P_b \Vert f \Vert m) $$</p>
<p>Alice then creates both her own partial signature,</p>
<p>$$ s_a = r_a + e.x_s $$</p>
<p>and the combined aggregate signature, $$ s = s_a + s_b, R = R_a + R_b $$.</p>
<p>Alice can now broadcast this transaction to the network. The final transaction looks as follows:</p>
<table><thead><tr><th align="left">Transaction Kernel</th><th align="left"></th></tr></thead><tbody>
<tr><td align="left">Public excess</td><td align="left">$$ X + P_b $$</td></tr>
<tr><td align="left">Signature</td><td align="left">$$ (s, R) $$</td></tr>
<tr><td align="left">Fee</td><td align="left">10</td></tr>
<tr><td align="left">Transaction metadata</td><td align="left">m</td></tr>
</tbody></table>
<table><thead><tr><th align="left">Transaction Body</th><th align="left"></th></tr></thead><tbody>
<tr><td align="left">Inputs with range proofs</td><td align="left">$$[C_1]$$</td></tr>
<tr><td align="left">Outputs with range proofs</td><td align="left">$$[C_2, C_B]$$</td></tr>
</tbody></table>
<h2><a class="header" href="#transaction-verification-and-propagation" id="transaction-verification-and-propagation">Transaction Verification and Propagation</a></h2>
<p>When a full node receives Alice's transaction, it needs to verify that it's on the level before sending it on to its
peers. The node wants to check the following:</p>
<ol>
<li>
<p>All inputs come from the current UTXO set</p>
<p>All full nodes keep track of the set of unspent outputs, so the node will check that <em>C1</em> is in that list.</p>
</li>
<li>
<p>All outputs have a valid range proof</p>
<p>The range proof is verified against its matching commitment.</p>
</li>
<li>
<p>The values balance</p>
<p>In this check, the node wants to make sure that no coins are created or destroyed in the transaction. But how can it 
do this if the values are blinded?</p>
<p>Recall that in an honest transaction, all the values (which are multiplied by <em>H</em>) cancel, and you're left with the 
sum of the public keys of the outputs minus the public keys of the inputs. This non-coincidentally happens to be the 
same value that is stored in the kernel as the public excess.</p>
<p>The summed public nonces, <em>R</em> are also stored in the kernel, so this allows the node to verify the signature by 
checking the following, where the challenge <em>e</em> is calculated as before:</p>
</li>
</ol>
<p>$$ s.G \stackrel{?}{=} R + e(X + P_b) $$</p>
<ol start="4">
<li>
<p>The signature in the kernel is valid</p>
<p>Therefore by validating the kernel signature, we also prove to ourselves that the transaction accounting is correct.</p>
</li>
<li>
<p>Various other consensus checks</p>
<p>Such as whether the fee is greater than the minimum.</p>
</li>
</ol>
<p>If all these checks pass, then the node will forward the transaction on to its peers and it will eventually be mined and
be added to the blockchain.</p>
<h2><a class="header" href="#stopping-fraud" id="stopping-fraud">Stopping Fraud</a></h2>
<p>Now let's say Alice tried to be sneaky and used \( X^* \) as her excess; the one where she gave herself 100 µT change
instead of 90 µT. Now the values won't balance. The sum of outputs, inputs and fees will look something like this:</p>
<p>$$ 10.H + (x_s + k_b).G ​$$</p>
<p>So now when a full node checks the signature:</p>
<p>$$
\begin{align}
R + e(X^* + P_b) &amp;\stackrel{?}{=} s.G  \\
R + e(10.H + x_s.G + P_b) &amp;\stackrel{?}{=} (r_a + r_b + e(x_s + k_b)).G \\
R + e(10.H + X + P_b) &amp;\stackrel{?}{=} (r_a + r_b).G + e(x_s + k_b).G \\
\mathbf{10e.H} + R + e(X + P_b) &amp;\stackrel{?}{=} R + e(X + P_b) \\
\end{align}
$$</p>
<p>The signature doesn't verify! The node can't tell exactly what is wrong with the transaction, but it knows something is
up, and so it will just drop the transaction silently and get on with its life.</p>
<h2><a class="header" href="#transaction-summary" id="transaction-summary">Transaction Summary</a></h2>
<p>To sum up: a Tari/MimbleWimble transaction includes the following:</p>
<ul>
<li>From Alice, a set of inputs that reference and spend a set of previous outputs.</li>
<li>From Alice and Bob, a set of new outputs, including:
<ul>
<li>A value and a blinding factor (which is just a new private key).</li>
<li>A range proof that shows that the value is non-negative.</li>
</ul>
</li>
<li>The transaction fee, in cleartext,</li>
<li>The public excess, which is the sum of all blinding factors used in the transaction.</li>
<li>Transaction metadata.</li>
<li>The excess blinding value used as the private key to sign a message attesting to the transaction metadata, and the
public excess.</li>
</ul>
<h2><a class="header" href="#references-20" id="references-20">References</a></h2>
<p>[<a href="https://www.mycryptopedia.com/what-are-confidential-transactions/" title="What are Bitcoin Confidential Transactions?">1</a>] &quot;What are Bitcoin Confidential Transactions?&quot; [Online.] Available: <a href="https://www.mycryptopedia.com/what-are-confidential-transactions/">https://www.mycryptopedia.com/what-are-confidential-transactions/</a> 
Date accessed: 2019‑04‑09.</p>
<p>[<a href="https://en.wikipedia.org/w/index.php?title=Nothing-up-my-sleeve_number&amp;oldid=889582749" title="Nothing-Up-My_Sleeve Number">2</a>] &quot;Nothing-Up-My_Sleeve Number&quot; [online].<br>Available:
<a href="https://en.wikipedia.org/w/index.php?title=Nothing-up-my-sleeve_number&amp;oldid=889582749">https://en.wikipedia.org/w/index.php?title=Nothing-up-my-sleeve_number&amp;oldid=889582749</a>. Date accessed: 2019‑04‑09.</p>
<p>[<a href="https://en.wikipedia.org/wiki/Commitment_scheme" title="Commitment Scheme">3</a>] Wikipedia: &quot;Commitment Scheme&quot; [online]. Available: <a href="https://en.wikipedia.org/wiki/Commitment_scheme">https://en.wikipedia.org/wiki/Commitment_scheme</a>. 
Date accessed: 2019‑04‑09.</p>
<p>[<a href="https://github.com/mimblewimble/grin/blob/master/doc/intro.md#kernel-offsets" title="Kernel Offsets">4</a>] &quot;Kernel Offsets, in Introduction to MimbleWimble and Grin&quot; [online]. Available:
<a href="https://github.com/mimblewimble/grin/blob/master/doc/intro.md#kernel-offsets">https://github.com/mimblewimble/grin/blob/master/doc/intro.md#kernel-offsets</a>. Date accessed: 2019‑04‑09.</p>
<p>[<a href="https://joinmarket.me/static/FromZK2BPs_v1.pdf" title="From Zero (Knowledge) to BulletProofs">5</a>] A. Gibson, &quot;From Zero (Knowledge) to BulletProofs&quot; [online]. 
Available: <a href="https://joinmarket.me/static/FromZK2BPs_v1.pdf">https://joinmarket.me/static/FromZK2BPs_v1.pdf</a>.
Date accessed: 2019‑04‑10.</p>
<h2><a class="header" href="#contributors-13" id="contributors-13">Contributors</a></h2>
<ul>
<li><a href="https://github.com/CjS77">https://github.com/CjS77</a></li>
<li><a href="https://github.com/anselld">https://github.com/anselld</a></li>
</ul>
<h1><a class="header" href="#mimblewimble-grin-blockchain-protocol-overview" id="mimblewimble-grin-blockchain-protocol-overview">Mimblewimble-Grin Blockchain Protocol Overview</a></h1>
<ul>
<li><a href="protocols/grin-protocol-overview/MainReport.html#introduction">Introduction</a></li>
<li><a href="protocols/grin-protocol-overview/MainReport.html#mimblewimble-protocol-overview">Mimblewimble Protocol Overview</a>
<ul>
<li><a href="protocols/grin-protocol-overview/MainReport.html#commitments">Commitments</a></li>
<li><a href="protocols/grin-protocol-overview/MainReport.html#cut-through-and-pruning">Cut-through and Pruning</a>
<ul>
<li><a href="protocols/grin-protocol-overview/MainReport.html#cut-through">Cut-through</a></li>
<li><a href="protocols/grin-protocol-overview/MainReport.html#pruning">Pruning</a></li>
</ul>
</li>
<li><a href="protocols/grin-protocol-overview/MainReport.html#grin-blocks">Grin Blocks</a></li>
</ul>
</li>
<li><a href="protocols/grin-protocol-overview/MainReport.html#trustless-transactions">Trustless Transactions</a></li>
<li><a href="protocols/grin-protocol-overview/MainReport.html#contracts">Contracts</a>
<ul>
<li><a href="protocols/grin-protocol-overview/MainReport.html#time-locked">Time-locked</a>
<ul>
<li><a href="protocols/grin-protocol-overview/MainReport.html#absolute">Absolute</a></li>
<li><a href="protocols/grin-protocol-overview/MainReport.html#relative">Relative</a></li>
</ul>
</li>
<li><a href="protocols/grin-protocol-overview/MainReport.html#multisig">Multisig</a></li>
</ul>
</li>
<li><a href="protocols/grin-protocol-overview/MainReport.html#atomic-swaps">Atomic Swaps</a></li>
<li><a href="protocols/grin-protocol-overview/MainReport.html#references">References</a></li>
<li><a href="protocols/grin-protocol-overview/MainReport.html#appendices">Appendices</a>
<ul>
<li><a href="protocols/grin-protocol-overview/MainReport.html#appendix-a-example-of-grin-block">Appendix A: Example of Grin Block</a></li>
</ul>
</li>
<li><a href="protocols/grin-protocol-overview/MainReport.html#contributors">Contributors</a></li>
</ul>
<h2><a class="header" href="#introduction-11" id="introduction-11">Introduction</a></h2>
<p>Depending on whom you ask, Mimblewimble is either a tongue-tying curse or a blockchain protocol designed to be private 
and scalable. The transactions in Mimblewimble are derived from confidential transactions by Greg Maxwell [<a href="https://people.xiph.org/%7Egreg/confidential_values.txt" title="Original confidential transaction paper">1</a>], which 
in turn are based on the Pedersen commitment scheme. On 19 July 2016, Tom Elvis Jedusor left a white paper 
on the tor network describing how Mimblewimble could work. As the potential for this was realized, work was done to make 
this a reality. One of these projects is Grin, which is a minimalistic implementation of Mimblewimble. Further 
information can be found in [<a href="https://tari-labs.github.io/tari-university/protocols/grin-beam-comparison/MainReport.html#grin-vs-beam-a-comparison" title="Grin vs. BEAM, a Comparison">2</a>] and [<a href="https://tari-labs.github.io/tari-university/protocols/grin-design-choice-criticisms/MainReport.html" title="Grin Design Choice Criticisms">3</a>]. </p>
<h2><a class="header" href="#mimblewimble-protocol-overview" id="mimblewimble-protocol-overview">Mimblewimble Protocol Overview</a></h2>
<h3><a class="header" href="#commitments" id="commitments">Commitments</a></h3>
<p>Mimblewimble publishes all transactions as confidential transactions. All inputs, outputs and change are expressed in 
the following form:</p>
<p>​	$ r \cdot G + v \cdot H $</p>
<p>where $ G $ and $ H $ are elliptic curves, $ r $ a private key used as a blinding factor, $ v $ the value and 
&quot;$ \cdot $&quot; is Elliptic-curve cryptography (ECC) multiplication.</p>
<p>An example transaction can be expressed as input = output + change. </p>
<p>​	$ (r_i \cdot G + v_i \cdot H) = (r_o \cdot G + v_o \cdot H) + (r_c \cdot G + v_c + \cdot H) $</p>
<p>But this requires that</p>
<p>​	$ r_i = r_o + r_c $</p>
<p>A more detailed explanation of how Mimblewimble works can be found in the Grin GitHub documents [<a href="https://github.com/mimblewimble/grin/blob/master/doc/table_of_contents.md" title="Main Grin Document Structure">4</a>].</p>
<h3><a class="header" href="#cut-through-and-pruning" id="cut-through-and-pruning">Cut-through and Pruning</a></h3>
<h4><a class="header" href="#cut-through" id="cut-through">Cut-through</a></h4>
<p>Grin includes something called &quot;cut-through&quot; in the transaction pool. Cut-through removes outputs from the transaction 
pool, which have already been spent as new inputs, using the fact that every transaction in a block should sum to zero. 
This is shown below:</p>
<p>​	$ output - inputs = kernel_-excess +(part \mspace{3mu} of)kernel_- offset $ </p>
<p>The kernel offset is used to hide which kernel belongs to which transaction and we only have a summed kernel offset 
stored in the header of each block. </p>
<p>We don't have to record these transactions inside the block, although we still have to record the kernel as the kernel 
proof transfer of ownership to make sure that the whole block sums to zero, as expressed in the following formula:</p>
<p>​	$ sum(ouputs) - sum(inputs) = sum(kernel_-excess) + kernel_-offset $</p>
<p>An example of cut-through follows:</p>
<pre><code class="language-text"> I1(x1)    +---&gt; O1
           +---&gt; O2

 I2(x2,O2) +---&gt; O3

 I3(O3)    +---&gt; O4
           +---&gt; O5
</code></pre>
<p>After cut-through:</p>
<pre><code class="language-text"> I1(x1)    +---&gt; O1
 I2(x2)    +---&gt; O4
           +---&gt; O5
</code></pre>
<p>In the preceding examples, &quot;I&quot; represents new inputs, &quot;X&quot; represents inputs from previous blocks and &quot;O&quot; represents 
outputs. </p>
<p>This causes Mimblewimble blocks to be much smaller than normal bitcoin blocks, as the cut-through transactions are 
no longer listed under inputs and outputs. In practice, after this we can still see there was a transaction, because 
the kernel excess still remains, but the actual hidden values are not recorded. </p>
<h4><a class="header" href="#pruning" id="pruning">Pruning</a></h4>
<p>Pruning takes this same concept but goes into past blocks. Therefore, if an output in a previous block gets spent, it 
will be removed from that block. Pruning removes the leaves from the Merkle Mountain Range (MMR) as well. Thus, it 
allows the ledger to be small and scalable. According to the Grin team [<a href="https://tari-labs.github.io/tari-university/protocols/grin-design-choice-criticisms/MainReport.html" title="Grin Design Choice Criticisms">3</a>], assuming 10 million transactions with 
100,000  unspent outputs, the ledger will be roughly 130GB, which can be divided into the following parts:</p>
<ul>
<li>128GB transaction data (inputs and outputs);</li>
<li>1GB transaction proof data;</li>
<li>250MB block headers.</li>
</ul>
<p>The total storage requirements can be reduced if cut-through and pruning are applied. The ledger will shrink to 
approximately 1.8GB and will result in the following:</p>
<ul>
<li>1GB transaction proof data;</li>
<li>UTXO size 520MB;</li>
<li>250MB block headers.</li>
</ul>
<h3><a class="header" href="#grin-blocks" id="grin-blocks">Grin Blocks</a></h3>
<p>The grin block contains the following data:</p>
<ol>
<li>Transaction outputs, which include for each output:
<ul>
<li>A Pedersen commitment (33 bytes).</li>
<li>A range proof (over 5KB at this time).</li>
</ul>
</li>
<li>Transaction inputs, which are just output references (32 bytes).</li>
<li>Transaction fees, in clear text.</li>
<li>Transaction &quot;proofs&quot;, which include for each transaction:
<ul>
<li>The excess commitment sum for the transaction (33 bytes).</li>
<li>A signature generated with the excess (71 bytes average).</li>
</ul>
</li>
<li>A block header that includes Merkle trees and proof of work (approximately 250 bytes).</li>
</ol>
<p>The Grin header:</p>
<table><thead><tr><th>Header Field</th><th>Description</th></tr></thead><tbody>
<tr><td>Hash</td><td>Unique hash of block</td></tr>
<tr><td>Version</td><td>Grin version</td></tr>
<tr><td>Previous Block</td><td>Unique hash of previous block</td></tr>
<tr><td>Age</td><td>Time the block was mined</td></tr>
<tr><td>Cuckoo Solution</td><td>The wining cuckoo solution</td></tr>
<tr><td>Difficulty</td><td>Difficulty of the solved cuckoo</td></tr>
<tr><td>Target Difficulty</td><td>Difficulty of this block</td></tr>
<tr><td>Total Difficulty</td><td>Total difficulty of mined chain up to age</td></tr>
<tr><td>Total Kernel Offset</td><td>Kernel offset</td></tr>
<tr><td>Nonce</td><td>Random number for cuckoo</td></tr>
<tr><td>Block Reward</td><td>Coinbase + fee reward for block</td></tr>
</tbody></table>
<p>The rest of the block contains a list of kernels, inputs and outputs. <a href="protocols/grin-protocol-overview/MainReport.html#appendix-a-example-of-grin-block">Appendix A</a> 
contains an example of a grin block.</p>
<h2><a class="header" href="#trustless-transactions" id="trustless-transactions">Trustless Transactions</a></h2>
<p>Schnorr signatures have been done in Tari Labs University (TLU). Please look 
<a href="protocols/grin-protocol-overview/../../cryptography/digital_signatures/introduction.html">here</a> for a more detailed explanation [<a href="https://tari-labs.github.io/tari-university/" title="Tari Labs University">7</a>]. </p>
<p>Since Grin transactions are obscured by Pedersen Commitments, there is no proof that money was actually transferred. To 
solve this problem, we require the receiver to collaborate with the sender in building a transaction and, more 
specifically, the kernel signature [<a href="https://github.com/mimblewimble/grin/blob/master/doc/table_of_contents.md" title="Main Grin Document Structure">4</a>].</p>
<p>When Alice wants to pay Bob, the transaction will be performed using the following steps:</p>
<ol>
<li>Alice selects her inputs and her change. The sum of all blinding factors (change output minus inputs) is $ r_s $.</li>
<li>Alice picks a random nonce ks and sends her partial transaction, $ k_s\cdot G $ and $ r_s\cdot G $ to Bob.</li>
<li>Bob picks his own random nonce $ k_r $ and the blinding factor for his output $ r_r $. Using $ r_r $, Bob adds his 
output to the transaction.</li>
<li>Bob computes the following:
<ul>
<li>message $ m = fee \Vert lock_-height $; </li>
<li>Schnorr challenge $ e = SHA256(m \Vert k_r \cdot G + k_s\cdot  G \Vert r_r\cdot G + r_s\cdot G) $; and </li>
<li>his side of the signature, $ s_r = k_r + e\cdot G $.</li>
</ul>
</li>
<li>Bob sends $ s_r $ and $ k_r\cdot G $ and $ r_r\cdot G $  to Alice.</li>
<li>Alice computes $ e $, just like Bob did, and can check that $ s_r\cdot G = k_r\cdot G + e\cdot r_r \cdot G $.</li>
<li>Alice sends her side of the signature, $ s_s = k_s + e\cdot r_s $, to Bob.</li>
<li>Bob validates $ s_s\cdot G $, just like Alice did for $ s_r\cdot G $ in step 5, and can produce the final signature 
$ sig = (s_s + s_r , \mspace{6mu} k_s\cdot G + k_s\cdot G) $ as well as the final transaction kernel, including $ sig $ and the public key 
$ r_r\cdot G + r_s\cdot G$. </li>
</ol>
<h2><a class="header" href="#contracts" id="contracts">Contracts</a></h2>
<h3><a class="header" href="#time-locked" id="time-locked">Time-locked</a></h3>
<h4><a class="header" href="#absolute" id="absolute">Absolute</a></h4>
<p>In a normal Grin transaction, the signature [<a href="https://github.com/mimblewimble/grin/blob/master/doc/table_of_contents.md" title="Main Grin Document Structure">4</a>], just the normal fee, gets signed as the message. But to get an absolute 
time-locked transaction, the message can be modified taking the block height and appending the fee to that. A block with 
a kernel that includes a lock height greater than the current block height is then rejected.</p>
<p>​	$ m = fee \Vert h $</p>
<h4><a class="header" href="#relative" id="relative">Relative</a></h4>
<p>Taking into account how an absolute time-locked transaction is constructed, the same idea can be extended by taking the 
relative block height and not the absolute height, but also adding a specific kernel commitment. In this way, the 
signature references a specific block as height. The same principle counts as with absolute time-locked transactions in 
that a block with a kernel containing a relative time-locked transaction that has not passed, is rejected. </p>
<p>​	$ m = fee \Vert h \Vert c $</p>
<h3><a class="header" href="#multisig" id="multisig">Multisig</a></h3>
<p>Multi-signatures (multisigs) are also known as N-of-M signatures. This means that N amount out of M amount of peers 
need to agree before a transaction can be spent.</p>
<p>When Bob and Alice [<a href="https://github.com/mimblewimble/grin/blob/master/doc/contracts.md" title="Grin Contracts">6</a>] want to do a 2‑of‑2 multisig contract, the contract can be done using the following 
steps:</p>
<ol>
<li>Bob picks a blinding factor $ r_b $ and sends $ r_b\cdot G $ to Alice.</li>
<li>Alice picks a blinding factor $ r_a $ and builds the commitment $ C= r_a\cdot G + r_b\cdot G + v\cdot H $; she 
sends the commitment to Bob.</li>
<li>Bob creates a range proof for $ v $ using $ C $ and $ r_b $, and sends it to Alice.</li>
<li>Alice generates her own range proof and aggregates it with Bob, finalizing the multiparty output $ O_{ab} $. </li>
<li>The kernel is built following the same procedure as used with <a href="protocols/grin-protocol-overview/MainReport.html#trustless-transactions">Trustless Transactions</a>.</li>
</ol>
<p>We observe that the output $ O_{ab} $ is unknown to both parties, because neither knows the whole blinding factor. To be 
able to build a transaction spending $ O_{ab} $, someone would need to know $ r_a + r_b $ to produce a kernel 
signature. To produce the original spending kernel, Alice and Bob need to collaborate.</p>
<h2><a class="header" href="#atomic-swaps" id="atomic-swaps">Atomic Swaps</a></h2>
<p>Atomic swaps can be used to exchange coins from different blockchains in a trustless environment. In the Grin 
documentation, this is handled in the contracts documentation [<a href="https://github.com/mimblewimble/grin/blob/master/doc/contracts.md" title="Grin Contracts">6</a>] and in the contract ideas documentation 
[<a href="https://github.com/mimblewimble/grin/blob/master/doc/contract_ideas.md" title="Grin Contract Ideas Discussion Document">8</a>]. In practice, there has already been an atomic swap between Grin and Ethereum [<a href="https://medium.com/grinswap/first-grin-atomic-swap-a16b4cc19196" title="First ever Grin atomic swap">9</a>], but this only used the Grin 
testnet with a modified Grin implementation, as the release version of Grin did not yet support the required contracts. 
TLU has a section about <a href="protocols/grin-protocol-overview/../atomic-swaps/AtomicSwaps.html">Atomic Swaps</a> [<a href="https://tari-labs.github.io/tari-university/" title="Tari Labs University">7</a>].</p>
<p>Atomic swaps work with 2‑of‑2 multisig contracts, one public key being Alice's, the other being the hash of 
a preimage 
that Bob has to reveal. Consider public key derivation $ x\cdot G $ to be the hash function and by Bob revealing 
$ x $, Alice can then produce an adequate signature, proving she knows $ x $ (in addition to her own private key).</p>
<p>Alice will swap Grin with Bob for Bitcoin. We assume Bob created an output on the Bitcoin blockchain that allows 
spending by Alice if she learns a hash preimage $ x $, or by Bob after time $ T_b $. Alice is ready to send her Grin 
to Bob if he reveals $ x $.</p>
<p>Alice will send her Grin to a multiparty timelock contract with a refund time $ T_a &lt; T_b $. To send the 
2‑of‑2 output 
to Bob and execute the swap, Alice and Bob start as if they were building a normal trustless transaction:</p>
<ol>
<li>Alice picks a random nonce $ k_s $ and her blinding sum $ r_s $ and sends $ k_s\cdot G $ and $ r_s\cdot G $ to Bob.</li>
<li>Bob picks a random blinding factor $ r_r $ and a random nonce $ k_r $. However, this time, instead of simply sending 
$ s_r = k_r + e\cdot r_r $ with his $ r_r\cdot G $ and $ k_r\cdot G $, Bob sends $ s_r' = k_r + x + e\cdot r_r $ as 
well as $ x\cdot G $. </li>
<li>Alice can validate that $ s_r'\cdot G = k_r\cdot G + x\cdot G + r_r\cdot G $. She can also check that Bob has money 
locked with $ x\cdot G $ on the other chain.</li>
<li>Alice sends back her $ s_s = k_s + e\cdot x_s $ as she normally would, now that she can also compute 
$ e = SHA256(m \Vert k_s\cdot G+k_r\cdot G) $.</li>
<li>To complete the signature, Bob computes $ s_r = k_r + e\cdot r_r $ and the final signature is 
$ (s_r + s_s, \mspace{6mu} k_r\cdot G + k_s\cdot G) $. </li>
<li>As soon as Bob broadcasts the final transaction to get his Grin, Alice can compute $ s_r' - s_r $ to get $ x $.</li>
</ol>
<p>Prior to completing the atomic swap, Bob needs to know Alice's public key. Bob would then create an output on the 
Bitcoin blockchain with a 2‑of‑2 multisig similar to <code>alice_pubkey secret_pubkey 2 OP_CHECKMULTISIG</code>. This 
should be 
wrapped in an <code>OP_IF</code> so Bob can get his money back after an agreed-upon time. All of this can even be wrapped in a 
Pays To Script Hash (P2SH). Here, <code>secret_pubkey</code> is $x\cdot G$ from the previous section.</p>
<p>To verify the output, Alice would take $x\cdot G$, recreate the bitcoin script, hash it and check that her hash matches 
what's in theP2SH (step 2 in the <a href="protocols/grin-protocol-overview/MainReport.html#multisig">Multisig</a> section). Once she gets $x$ (step 6), she can build the 
two signatures necessary 
to spend the 2‑of‑2, having both private keys, and get her bitcoin.</p>
<h2><a class="header" href="#references-21" id="references-21">References</a></h2>
<p>[<a href="https://people.xiph.org/%7Egreg/confidential_values.txt" title="Original confidential transaction paper">1</a>]  G. Maxwell, &quot;Confidential Transactions&quot;, 2017 [online].  Available: 
<a href="https://people.xiph.org/%7Egreg/confidential_values.txt">https://people.xiph.org/~greg/confidential_values.txt</a>. Accessed: 2018‑10‑24.</p>
<p>[<a href="https://tari-labs.github.io/tari-university/protocols/grin-beam-comparison/MainReport.html#grin-vs-beam-a-comparison" title="Grin vs. BEAM, a Comparison">2</a>] P. Robinson, H. Odendaal, S. W. van Heerden and A. Zaidelson, &quot;Grin vs. BEAM, a Comparison&quot;, 2018 [online].
Available: <a href="https://tari&amp;#8209;labs.github.io/tari-university/protocols/grin-beam-comparison/MainReport.html#grin-vs-beam-a-comparison">https://tari&amp;#8209;labs.github.io/tari-university/protocols/grin-beam-comparison/MainReport.html#grin-vs-beam-a-comparison</a>.
Accessed: 2018‑10‑08.</p>
<p>[<a href="https://tari-labs.github.io/tari-university/protocols/grin-design-choice-criticisms/MainReport.html" title="Grin Design Choice Criticisms">3</a>] Y. Roodt, H. Odendaal, S. W. van Heerden, R. Robinson and A. Kamal, &quot;Grin Design Choice Criticisms - Truth or 
Fiction&quot;, 2018 [online]. Available: 
<a href="https://tari-labs.github.io/tari-university/protocols/grin-design-choice-criticisms/MainReport.html">https://tari-labs.github.io/tari-university/protocols/grin-design-choice-criticisms/MainReport.html</a>. 
Accessed: 2018‑10‑08.</p>
<p>[<a href="https://github.com/mimblewimble/grin/blob/master/doc/table_of_contents.md" title="Main Grin Document Structure">4</a>] B. Simon et al., &quot;Grin Document Structure&quot;, 2018 [online]. Available: 
<a href="https://github.com/mimblewimble/grin/blob/master/doc/table_of_contents.md">https://github.com/mimblewimble/grin/blob/master/doc/table_of_contents.md</a>. Accessed: 2018‑10‑24).</p>
<p>[<a href="https://github.com/mimblewimble/grin/blob/master/doc/pruning.md" title="Grin Pruning">5</a>] I. Peverell et al., &quot;Pruning Blockchain Data&quot;, 2016 [online]. Available: 
<a href="https://github.com/mimblewimble/grin/blob/master/doc/pruning.md">https://github.com/mimblewimble/grin/blob/master/doc/pruning.md</a>. Accessed: 2018‑10‑26.</p>
<p>[<a href="https://github.com/mimblewimble/grin/blob/master/doc/contracts.md" title="Grin Contracts">6</a>] I. Peverell et al., &quot;Contracts&quot;, 2018 [online]. Available: 
<a href="https://github.com/mimblewimble/grin/blob/master/doc/contracts.md">https://github.com/mimblewimble/grin/blob/master/doc/contracts.md</a>.
Accessed: 2018‑10‑26.</p>
<p>[<a href="https://tari-labs.github.io/tari-university/" title="Tari Labs University">7</a>] &quot;Tari Labs University&quot;.  Tari Labs, 2018 [online]. Available: <a href="https://tari-labs.github.io/tari-university/">https://tari-labs.github.io/tari-university/</a>.
Accessed: 2018‑10‑27.</p>
<p>[<a href="https://github.com/mimblewimble/grin/blob/master/doc/contract_ideas.md" title="Grin Contract Ideas Discussion Document">8</a>] Q. Le Sceller, &quot;Contract Ideas&quot;, 2018 [online]. Available: 
<a href="https://github.com/mimblewimble/grin/blob/master/doc/contract_ideas.md">https://github.com/mimblewimble/grin/blob/master/doc/contract_ideas.md</a>. (Accessed: 2018‑10‑27.)</p>
<p>[<a href="https://medium.com/grinswap/first-grin-atomic-swap-a16b4cc19196" title="First ever Grin atomic swap">9</a>] Jasper, &quot;First Grin Atomic Swap!&quot; (2018) [online]. Available: 
<a href="https://medium.com/grinswap/first-grin-atomic-swap-a16b4cc19196">https://medium.com/grinswap/first-grin-atomic-swap-a16b4cc19196</a>. Accessed: 2018‑10‑27.</p>
<h2><a class="header" href="#appendices-6" id="appendices-6">Appendices</a></h2>
<h3><a class="header" href="#appendix-a-example-of-grin-block" id="appendix-a-example-of-grin-block">Appendix A: Example of Grin Block</a></h3>
<table><thead><tr><th>Hash</th><th>02cb5e810857266609511699c8d222ed4e02883c6b6d3405c05a3caea9bb0f64</th></tr></thead><tbody>
<tr><td>Version</td><td>1</td></tr>
<tr><td>Previous Block</td><td><a href="https://grinexplorer.net/block/0343597fe7c69f497177248913e6e485f3f23bb03b07a0b8a5b54f68187dbc1d">0343597fe7c69f497177248913e6e485f3f23bb03b07a0b8a5b54f68187dbc1d</a></td></tr>
<tr><td>Age</td><td>2018-10-23, 08:03:46 UTC</td></tr>
<tr><td>Cuckoo Solution</td><td>Size:</td></tr>
<tr><td>Difficulty</td><td>37,652</td></tr>
<tr><td>Target Difficulty</td><td>17,736</td></tr>
<tr><td>Total Difficulty</td><td>290,138,524</td></tr>
<tr><td>Total Kernel Offset</td><td>b52ccdf119fe18d7bd12bcdf0642fcb479c6093dca566e0aed33eb538f410fb5</td></tr>
<tr><td>Nonce</td><td>7262225957146290317</td></tr>
<tr><td>Block Reward</td><td>60 grin</td></tr>
<tr><td>Fees</td><td>14 mg</td></tr>
</tbody></table>
<p><code>4 x Inputs</code></p>
<table><thead><tr><th>No.</th><th>Commit</th></tr></thead><tbody>
<tr><td>1</td><td>0898a4b53964ada66aa16de3d44ff02228c168a23c0bd71b162f4366ce0dae24b0</td></tr>
<tr><td>2</td><td>09a173023e9c39c923e626317ffd384c7bce44109fea91a9c142723bfa700fce27</td></tr>
<tr><td>3</td><td>086e0d164fe92d837b5365465a6b37af496a4f8520a2c1fccbb9f736521631ba96</td></tr>
<tr><td>4</td><td>087a00d61f8ada399f170953c6cc7336c6a0b22518a8b02fd8dd3e28c01ee51fdb</td></tr>
</tbody></table>
<p><code>5 x Outputs</code></p>
<table><thead><tr><th>No.</th><th>Output Type</th><th>Commit</th><th>Spent</th></tr></thead><tbody>
<tr><td>1</td><td>Transaction</td><td>09eac33dfdeb84da698c6c17329e4a06020238d9bb31435a4abd9d2ffc122f6879</td><td>False</td></tr>
<tr><td>2</td><td>Transaction</td><td>0860e9cf37a94668c842738a5acc8abd628c122608f48a50bbb7728f46a3d50673</td><td>False</td></tr>
<tr><td>3</td><td>Coinbase</td><td>08324cdbf7443b6253bb0cdf314fce39117dcafbddda36ed37f2c209fc651802d6</td><td>False</td></tr>
<tr><td>4</td><td>Transaction</td><td>0873f0da4ce164e2597800bf678946aad1cd2d7e2371c4eed471fecf9571942b4f</td><td>False</td></tr>
<tr><td>5</td><td>Transaction</td><td>09774ee77edaaa81b3c6ee31f471f014db86c4b3345f739472cb12ecc8f40401df</td><td>False</td></tr>
</tbody></table>
<p><code>3 x Kernels</code></p>
<table><thead><tr><th>No.</th><th>Features</th><th>Fee</th><th>Lock Height</th></tr></thead><tbody>
<tr><td>1</td><td>DEFAULT_KERNEL</td><td>6 mg</td><td>7477</td></tr>
<tr><td>2</td><td>DEFAULT_KERNEL</td><td>8 mg</td><td>7477</td></tr>
<tr><td>3</td><td>COINBASE_KERNEL</td><td>0 grin</td><td>7482</td></tr>
</tbody></table>
<p>Apart from the header information, we can only see that this block contains two transactions from the two kernels 
present. Between these two transactions, we only know that there were four inputs and four outputs. Because of the way 
in which Mimblewimble obfuscates the transaction, we don't know the values or which input and output belong to which 
transaction.</p>
<h2><a class="header" href="#contributors-14" id="contributors-14">Contributors</a></h2>
<ul>
<li><a href="https://github.com/SWvheerden">https://github.com/SWvheerden</a></li>
<li><a href="https://github.com/neonknight64">https://github.com/neonknight64</a></li>
<li><a href="https://github.com/hansieodendaal">https://github.com/hansieodendaal</a></li>
<li><a href="https://github.com/anselld">https://github.com/anselld</a></li>
</ul>
<h1><a class="header" href="#grin-vs-beam-a-comparison" id="grin-vs-beam-a-comparison">Grin vs. BEAM, a Comparison</a></h1>
<ul>
<li><a href="protocols/grin-beam-comparison/MainReport.html#introduction">Introduction</a></li>
<li><a href="protocols/grin-beam-comparison/MainReport.html#comparison-of-features-and-implementation-in-grin-vs-beam">Comparison of Features and Implementation in Grin vs. BEAM</a>
<ul>
<li><a href="protocols/grin-beam-comparison/MainReport.html#grin-unique-features">Grin Unique Features</a></li>
<li><a href="protocols/grin-beam-comparison/MainReport.html#beam-unique-features">BEAM Unique Features</a></li>
</ul>
</li>
<li><a href="protocols/grin-beam-comparison/MainReport.html#proof-of-work-mining-algorithm">Proof of Work Mining Algorithm</a></li>
<li><a href="protocols/grin-beam-comparison/MainReport.html#governance-models-and-monetary-policy">Governance Models and Monetary Policy</a></li>
<li><a href="protocols/grin-beam-comparison/MainReport.html#conclusions-observations-and-recommendations">Conclusions, Observations and Recommendations</a></li>
<li><a href="protocols/grin-beam-comparison/MainReport.html#references">References</a></li>
<li><a href="protocols/grin-beam-comparison/MainReport.html#appendices">Appendices</a>
<ul>
<li><a href="protocols/grin-beam-comparison/MainReport.html#appendix-a-cuckoocuckatoo-cycle-proof-of-work-algorithm">Appendix A: Cuckoo/Cuckatoo Cycle Proof of Work Algorithm</a></li>
</ul>
</li>
<li><a href="protocols/grin-beam-comparison/MainReport.html#contributors">Contributors</a></li>
</ul>
<h2><a class="header" href="#introduction-12" id="introduction-12">Introduction</a></h2>
<p>Grin and BEAM are two open-source cryptocurrency projects based on the Mimblewimble protocol. The Mimblewimble protocol 
was first proposed by an anonymous user using the pseudonym Tom Elvis Jedusor (the French translation of Voldemort's 
name from the Harry Potter series of books). This user logged onto a bitcoin research Internet Relay Chat (IRC) channel 
and posted a link to a text article hosted on a Tor hidden service [<a href="https://download.wpsoftware.net/bitcoin/wizardry/mimblewimble.txt" title="MIMBLEWIMBLE">1</a>]. This article provided the basis for a new way 
to construct blockchain-style transactions that provided inherent privacy and the ability to dramatically reduce the 
size of the blockchain by compressing the transaction history of the chain. The initial article presented the main ideas 
of the protocol, but left out a number of critical elements required for a practical implementation and even contained a 
mistake in the cryptographic formulation. Andrew Poelstra published a follow-up paper that addresses many of these 
issues and refines the core concepts of Mimblewimble [<a href="https://download.wpsoftware.net/bitcoin/wizardry/mimblewimble.pdf" title="Mimblewimble">2</a>], which have been applied to the practical implementation of 
this protocol in both the Grin [<a href="https://github.com/mimblewimble/grin/blob/master/doc/intro.md" title="Introduction to 
Mimblewimble and Grin">3</a>] and BEAM [<a href="https://docs.wixstatic.com/ugd/87affd_3b032677d12b43ceb53fa38d5948cb08.pdf" title="BEAM: The Scalable 
Confidential Cryptocurrency">4</a>] projects.</p>
<p>The Mimblewimble protocol describes how transacting parties will interactively work to build a valid transaction using 
their public/private key pairs (which are used to prove ownership of transaction outputs) and interactively chosen blinding 
factors. Blinding factors are used to obfuscate the participants' public keys from everyone, including each 
other, and to hide the value of the transaction from everyone except the counterparty in that specific transaction. The 
protocol also performs a process called cut-through, which condenses transactions by eliminating intermediary 
transactions. This improves privacy and compresses the amount of data that is maintained on the blockchain [<a href="https://github.com/mimblewimble/grin/blob/master/doc/intro.md" title="Introduction to 
Mimblewimble and Grin">3</a>]. This 
cut-through process precludes general-purpose scripting systems such as those found in Bitcoin. However, Andrew Poelstra 
proposed the concept of Scriptless scripts, which make use of Schnorr signatures to build adaptor signatures that 
allow for encoding of many of the behaviors that scripts are traditionally used to achieve. Scriptless scripts enable 
functionality such as payment channels (e.g. Lightning Network) and atomic swaps [<a href="https://joinmarket.me/blog/blog/flipping-the-scriptless-script-on-schnorr/" title="Flipping the Scriptless 
Script on Schnorr">5</a>].</p>
<p>The Grin and BEAM projects both implement the Mimblewimble protocol, but both have been built from scratch. Grin is 
written in RUST and BEAM in C++. This report describes some of the aspects of each project that set them apart. Both 
projects are still in their early development cycles and many of these details are changing on a daily basis. Furthermore, 
the BEAM project documentation is mostly available only in Russian. As of the writing of this report, not all the 
technical details are available for English readers. Therefore the discussion in this report will most likely become 
outdated as the projects evolve.</p>
<p>This report is structured as follows:</p>
<ul>
<li>Firstly, some implementation details are given and unique features of 
the projects are discussed.</li>
<li>Secondly, the differences in the projects' Proof-of-Work (PoW) algorithms are examined.</li>
<li>Finally, the projects' governance models are discussed.</li>
</ul>
<h2><a class="header" href="#comparison-of-features-and-implementation-in-grin-vs-beam" id="comparison-of-features-and-implementation-in-grin-vs-beam">Comparison of Features and Implementation in Grin vs. BEAM</a></h2>
<p>The two projects are being independently built from scratch by different teams in different languages (Rust [<a href="https://github.com/mimblewimble/grin" title="Grin Github Repository">6</a>] and 
C++ [<a href="https://github.com/beam-mw/beam" title="BEAM Github Repository">7</a>]), so there will be many differences in the raw implementations. For example, Grin uses the Lightning 
Memory-mapped Database (LMDB) for its embedded 
database and BEAM uses SQLite. Although they have performance differences, they are functionally similar. Grin uses a 
Directed Acyclic Graph (DAG) to represent its mempool to avoid transaction reference loops [<a href="https://github.com/mimblewimble/grin/blob/master/doc/internal/pool.md" title="Grin - Transaction Pool">8</a>], while BEAM uses a 
multiset key-value data structure with logic to enable some of its extended features [<a href="https://github.com/beam-mw/beam" title="BEAM Github Repository">7</a>].</p>
<p>From the perspective of features, the two projects exhibit all the features inherent to Mimblewimble. Grin's stated 
goal is to produce a simple and easy to maintain implementation of the Mimblewimble protocol [<a href="https://github.com/mimblewimble/grin/blob/master/doc/intro.md" title="Introduction to 
Mimblewimble and Grin">3</a>]. BEAM's 
implementation, however, contains a number of modifications to the Mimblewimble approach, with the aim to provide some 
unique features for its implementation. Before we get into the features and design elements that set the two projects 
apart, let's discuss an interesting feature that both projects have implemented.</p>
<p>Both Grin and BEAM have incorporated a version of the Dandelion relay protocol, which supports transaction aggregation. 
One of the major outstanding challenges for privacy that cryptocurrencies face is that it is possible to track 
transactions as they are added to the mempool and propagate across the network, and to link those transactions to their 
originating IP addresses. This information can be used to deanonymize users, even on networks with strong transaction 
privacy. The Dandelion network propagation scheme was proposed to improve privacy during the propagation of transactions 
to the network [<a href="https://arxiv.org/abs/1701.04439" title="Dandelion: Redesigning the Bitcoin 
Network for Anonymity">9</a>]. In this scheme, transactions are propagated in two phases: the Anonymity (or &quot;stem&quot;) phase and the 
Spreading (or &quot;fluff&quot;) phase, as illustrated in Figure 1.</p>
<ul>
<li>
<p>In the <strong>stem</strong> (anonymity) phase, a transaction is 
propagated to only a single randomly selected peer from the current node's peer list. After a random number of hops 
along the network, each hop propagating to only a single random peer, the propagation process enters the second phase.</p>
</li>
<li>
<p>During the <strong>fluff</strong> (spreading) phase, the transaction is propagated using a full flood/diffusion method, as found 
in most networks. This approach means that the transaction has first propagated to a random point in the network 
before flooding the network, thereby making it much more difficult to track its origin.</p>
</li>
</ul>
<p align="center">
  <img src="protocols/grin-beam-comparison/sources/dandelion-stem-fluff.png" width="450" />
  <p>
    <center><strong>
      Figure 1: Two Phases of Dandelion Peer-to-peer Transaction Propagation 
      [<a href="https://arxiv.org/abs/1701.04439" title="Dandelion: Redesigning the Bitcoin Network for Anonymity.">9</a>]
    </strong></center>
  </p>
</p>
<p>Both projects have adapted this approach to work with Mimblewimble transactions. Grin's implementation allows for 
transaction aggregation and cut-through in the stem phase of propagation, which provides even greater anonymity to the 
transactions before they spread during the fluff phase [<a href="https://github.com/mimblewimble/grin/blob/master/doc/dandelion/dandelion.md" title="Dandelion in Grin: 
Privacy-Preserving Transaction 
Aggregation and Propagation">10</a>]. In addition to transaction aggregation and cut-through, 
BEAM introduces “dummy” transactions that are added in the stem phase to compensate for situations when real 
transactions are not available [<a href="https://github.com/BeamMW/beam/wiki/Transaction-graph-obfuscation" title="Beam's Transaction Graph 
Obfuscation">33</a>].</p>
<h3><a class="header" href="#grin-unique-features" id="grin-unique-features">Grin Unique Features</a></h3>
<p>Grin is aiming to be a simple and minimal reference implementation of a Mimblewimble blockchain. It is therefore not aiming 
to include many features to extend the core Mimblewimble functionality, as discussed. However, the Grin implementation 
does include some interesting implementation choices that it has documented in depth on its growing Github 
repository's wiki.</p>
<p>For example, Grin has implemented a method for a node to sync the blockchain very quickly by only downloading a partial 
history [<a href="https://github.com/mimblewimble/grin/blob/master/doc/chain/chain_sync.md" title="Grin - Blockchain Syncing">11</a>]. A new node entering the network will query the current head block of the chain and then request the 
block header at a horizon. In the example, the horizon is initially set at 5,000 blocks before the current head. The 
node then checks if there is enough data to confirm consensus. If there isn't consensus, the node will increase its 
horizon until consensus is reached. At that point, it will download the full Unspent Transaction Output (UTXO) set of 
the horizon block. This approach does introduce a few security risks, but mitigations are provided and the result is 
that a node can sync to the network with an order of magnitude less data.</p>
<p>Since the initial writing of this article (October 2018), BEAM has published its solution for fast node 
synchronization using macroblocks. A macroblock is a complete state of all UTXOs, periodically created by BEAM 
nodes [<a href="https://github.com/beam-mw/beam/wiki/Node-initial-synchronization" title="BEAM - Node Initialization 
Synchronization">12</a>].</p>
<h3><a class="header" href="#beam-unique-features" id="beam-unique-features">BEAM Unique Features</a></h3>
<p>BEAM has set out to extend the feature set of Mimblewimble in a number of ways. BEAM supports setting an explicit 
incubation period on a UTXO, which limits its ability to be spent to a specific number of blocks after its 
creation [<a href="https://www.scribd.com/document/385080303/BEAM-Description-Comparison-With-Classical-MW" title="BEAM Description. Comparison 
with Classical MW">13</a>]. This is different to a timelock, which prevents a transaction from being added to a block before a 
certain time. BEAM also supports the traditional timelock feature, but includes the ability to also specify an upper 
time limit, after which the transaction can no longer be included in a block [<a href="https://www.scribd.com/document/385080303/BEAM-Description-Comparison-With-Classical-MW" title="BEAM Description. Comparison 
with Classical MW">13</a>]. This feature means that a party can 
be sure that if a transaction is not included in a block on the main blockchain after a certain time, it will never 
appear.</p>
<p>Another unique feature of BEAM is the implementation of an auditable wallet. For a business to operate in a given 
regulatory environment, it will need to demonstrate its compliance to the relevant authorities. BEAM has proposed a 
wallet designed for compliant businesses, which generates additional public/private key pairs specifically for audit 
purposes. These signatures are used to tag transactions so that only the auditing authority that is given the public 
key can identify those transactions on the blockchain, but cannot create transactions with this tag. This 
allows a business to provide visibility of its transactions to a given authority without compromising its privacy 
to the public [<a href="https://github.com/beam-mw/beam/wiki/Wallet-audit" title="BEAM - Wallet Audit">14</a>].</p>
<p>BEAM's implementation of Dandelion improves privacy by adding decoy transaction outputs at the stem phase. Each such 
output has a value of zero, but is indistinguishable from regular outputs. At a later stage (a randomly calculated 
number of blocks for each output), the UTXOs are added as inputs to new transactions, thus spending them and removing
them from the blockchain.</p>
<p>BEAM has also proposed another feature aimed at keeping the blockchain as compact as possible. In Mimblewimble, as 
transactions are added, cut-through is performed, which eliminates all intermediary transaction commitments [<a href="https://github.com/mimblewimble/grin/blob/master/doc/intro.md" title="Introduction to 
Mimblewimble and Grin">3</a>]. 
However, the transaction kernels for every transaction are never removed. BEAM has proposed a scheme to reuse these 
transaction kernels to validate subsequent transactions [<a href="https://www.scribd.com/document/385080303/BEAM-Description-Comparison-With-Classical-MW" title="BEAM Description. Comparison 
with Classical MW">13</a>]. In order to consume the existing kernels without 
compromising the transaction irreversibility principle, BEAM proposes that a multiplier be applied to an old kernel 
by the same user who has visibility of the old kernel, and that this be used in a new transaction. In order to incentivize 
transactions to be built in this way, BEAM includes a fee refund model for these types of transactions. This feature 
will not be part of the initial release. </p>
<p>When constructing a valid Mimblewimble transaction, the parties involved need to collaborate in order to choose blinding 
factors that balance. This interactive negotiation requires a number of steps and it implies that the parties need to 
be in communication to finalize the transaction. Grin facilitates this process by the two parties connecting directly 
to one another using a socket-based channel for a &quot;real-time&quot; session. This means that both parties need to be online 
simultaneously. BEAM has implemented a Secure Bulletin Board System (SBBS) that is run on BEAM full-nodes to allow for 
asynchronous negotiation of transactions ([<a href="https://medium.com/beam-mw/the-secure-bulletin-board-system-sbbs-implementation-in-beam-a01b91c0e919" title="The Secure Bulletin Board 
System (SBBS) Implementation in Beam">30</a>], [<a href="https://github.com/BeamMW/beam/wiki/Secure-bulletin-board-system-(SBBS)" title="Beam's SBBS Specification">31</a>]).</p>
<p>Requiring the interactive participation of both parties in constructing a transaction can be a point of friction in 
using a Mimblewimble blockchain. In addition to the secure BBS communication channel, BEAM also plans to support 
one-sided transactions where the payee in a transaction who expects to be paid a certain amount can construct their 
half of the transaction and send this half-constructed transaction to the payer. The payer can then finish constructing 
the transaction and publish it to the blockchain. Under the normal Mimblewimble system this is not possible, because it 
would involve revealing your blinding factor to the counterparty. BEAM solves this problem by using a process it calls 
<em>kernel fusion</em>, whereby a kernel can include a reference to another kernel so that it is only valid if both kernels are 
present in the transaction. In this way, the payee can build their half of the transaction with a secret blinding factor 
and a kernel that compensates for their blinding factor, which <strong>must</strong> be included when the payer completes the 
transaction [<a href="https://www.scribd.com/document/385080303/BEAM-Description-Comparison-With-Classical-MW" title="BEAM Description. Comparison 
with Classical MW">13</a>]. </p>
<p>Both projects make use of a number of Merkle tree structures to keep track of various aspects of the respective 
blockchains. Details of the exact trees and what they record are documented for both projects ([<a href="https://github.com/mimblewimble/grin/blob/master/doc/merkle.md" title="GRIN - Merkle Structures">16</a>], [<a href="https://github.com/beam-mw/beam/wiki/Merkle-trees" title="BEAM - Merkle Trees">17</a>]). BEAM, 
however, makes use of a Radix-Hash tree structure for some of its trees. This structure is a modified Merkle tree that 
is also a binary search tree. This provides a number of features that the standard Merkle trees do not have, and which 
BEAM exploits in its implementation [<a href="https://github.com/beam-mw/beam/wiki/Merkle-trees" title="BEAM - Merkle Trees">17</a>].</p>
<p>The features discussed here can all be seen in the code at the time of writing (May 2019), although this is not a 
guarantee that they are working. A couple of features, which have been mentioned in the literature as planned for the 
future, have not yet been implemented. These include embedding signed textual content into transactions that can be used 
to record contract text [<a href="https://www.scribd.com/document/385080303/BEAM-Description-Comparison-With-Classical-MW" title="BEAM Description. Comparison 
with Classical MW">13</a>], and issuing confidential assets [<a href="https://github.com/beam-mw/beam/wiki/Confidential-assets" title="BEAM - Confidential Assets">18</a>].</p>
<h2><a class="header" href="#proof-of-work-mining-algorithm" id="proof-of-work-mining-algorithm">Proof-of-Work Mining Algorithm</a></h2>
<p>BEAM has announced that it will employ the Equihash PoW mining algorithm with the parameters set to 
n=150, k=5 [<a href="https://github.com/BeamMW/beam/wiki/BEAM-Mining" title="Beam's Mining Specification">32</a>]. Equihash was proposed in 2016 as a memory-hard PoW algorithm that relied heavily on memory usage to 
achieve Application Specific Integrated Circuit (ASIC) resistance [<a href="https://www.cryptolux.org/images/b/b9/Equihash.pdf" title="Equihash: Asymmetric Proof-of-work 
based on the Generalized 
Birthday Problem">19</a>]. The goal was to produce an algorithm that 
would be more efficient to run on consumer Graphics Processing Units (GPUs) as opposed to the growing field of ASIC 
miners, mainly produced by Bitmain at the time. It was hoped this would assist cryptocurrencies that used this 
algorithm, to decentralize the mining power. The idea behind Equihash's ASIC resistance was that at the time, 
implementing memory in an ASIC was expensive and GPUs were more efficient at calculating the Equihash PoW. This ASIC 
resistance lasted for a while, but in early 2018, Bitmain released an ASIC for Equihash that was significantly more 
efficient than GPUs for the Equihash configurations used by Zcash, Bitcoin Gold and Zencash, to name a few. It is 
possible to tweak the parameters of the Equihash algorithm to make it more memory intensive and thus make current ASICs 
and the older GPU mining farms obsolete, but it remains to be seen if BEAM will do this. No block time has been published 
at the time of writing of this report (May 2019).</p>
<p>Grin initially opted to use the new Cuckoo Cycle PoW algorithm, also purported to be ASIC resistant due to being memory 
latency bound [<a href="https://github.com/tromp/cuckoo" title="Cuckoo Cycle">20</a>]. This means that the algorithm is bound by memory bandwidth rather than raw processor speed, with 
the hope that it will make mining possible on commodity hardware.</p>
<p>In August 2018, the Grin team announced at the launch of its mainnet that it had become aware that it was likely 
that an ASIC would be available for the Cuckoo cycle algorithm [<a href="https://www.grin-forum.org/t/proof-of-work-update/713" title="Proof of Work Update">21</a>]. While acknowledging that ASIC mining is 
inevitable, Grin is concerned that the current ASIC market is very centralized (i.e. Bitmain), and it wants to 
foster a grassroots GPU mining community for two years, in the early days of Grin. After two years, Grin hopes that 
ASICs will have become more of a commodity and thus decentralized.</p>
<p>To address this, it was proposed to use two PoW algorithms initially: one that is ASIC Friendly (AF) and one that is 
ASIC Resistant (AR), and then to select which PoW is used per block to balance the mining rewards between 
the two algorithms, over a 24‑hour period. The Governance committee resolved on 25 September 2018 to go 
ahead with this approach, using a modified version of the Cuckoo Cycle algorithm, called the Cuckatoo Cycle. The AF 
algorithm at launch will be Cuckatoo32+, which will gradually increase its memory requirements to make older single-chip 
ASICs obsolete over time. The AR algorithm is still not defined [<a href="https://www.grin-forum.org/t/meeting-notes-governance-sep-25-2018/874" title="Meeting Notes: 
Governance, Sep 25 2018">23</a>].</p>
<h2><a class="header" href="#governance-models-and-monetary-policy" id="governance-models-and-monetary-policy">Governance Models and Monetary Policy</a></h2>
<p>Both the Grin and BEAM projects are open-source and available on Github ([<a href="https://github.com/mimblewimble/grin" title="Grin Github Repository">6</a>], [<a href="https://github.com/beam-mw/beam" title="BEAM Github Repository">7</a>]). The Grin project has 75 
contributors, eight of which have contributed the vast majority of the code. BEAM has 10 contributors, four of 
which have contributed the vast majority of the code (at the time of writing). The two projects have opted for different 
models of governance. BEAM has opted to set up a foundation that includes the core developers, to manage the project. 
This is the route taken by most cryptocurrency projects in this space. The Grin community has decided 
against setting up a central foundation and has compiled an interesting discussion of the pros and cons of a 
centralized foundation [<a href="https://github.com/mimblewimble/docs/wiki/Regarding-Foundations" title="Regarding Foundations">22</a>]. This document contains a very in-depth discussion that weighs up the various governance 
functions that a foundation might serve, and evaluates each use case. The Grin community came to the 
conclusion that while foundations are useful, they do not provide the only solution to governance problems, and 
have therefore opted to remain a completely decentralized community-driven project. Currently, decisions are made at 
periodic governance meetings that are convened on Gitter with community members, where an agenda is discussed and 
decisions are ratified. Agendas and minutes of these meetings can be found in the Grin Forums governance section. 
An example of the outcomes of such a meeting can be seen in [<a href="https://www.grin-forum.org/t/meeting-notes-governance-sep-25-2018/874" title="Meeting Notes: 
Governance, Sep 25 2018">23</a>].</p>
<p>Neither project will engage in an Initial Coin Offering (ICO) or pre-mine, but the two projects also have different 
funding models. BEAM set up a Limited Liability Company (LLC) and has attracted investors to it for its initial round of 
non-profit BEAM Foundation that will take over the management of the protocol during the first year after launch [<a href="https://www.beam-mw.com/features" title="BEAM Features">24</a>]. 
The goal of the Foundation will be to support maintenance and further development of BEAM; promote relevant 
cryptographic research; support awareness and education in the areas of financial privacy; and support academic work in 
adjacent areas. In the industry, this treasury mechanism is called a <em>dev tax</em>. Grin will not levy a <em>dev tax</em> on the 
mining rewards, and will rely on community participation and community funding. The Grin project does accept financial 
support, but these funding campaigns are conducted according to their &quot;Community Funding Principles&quot; [<a href="https://grin-tech.org/funding.html" title="Grin's Community Funding Principles">25</a>], which will 
be conducted on a &quot;need-by-need&quot; basis. A campaign will specify a specific need it aims to fulfill (e.g. &quot;Hosting 
fees for X for the next year&quot;) and the funding will be received by the community member who ran the campaign. This will 
provide 100% visibility regarding who is responsible for the received funds. An example of a funding campaign is the 
Developer Funding Campaign run by Yeastplume to fund his full-time involvement in the project from October 2018 to 
February 2019. Refer to [<a href="https://grin-tech.org/yeastplume.html" title="Oct 2018 - Feb 2019 
Developer Funding - Yeastplume">26</a>].</p>
<p>In terms of the monetary policy of the two projects, BEAM has stated that it will be using a deflationary model with 
periodic halving of its mining reward and a maximum supply of BEAM of 262,800,000 coins. BEAM will start with 
100 coins emitted per block. The first halving will occur after one year. Halving will then happen every four years 
[<a href="https://github.com/BeamMW/beam/wiki/BEAM-Mining" title="Beam's Mining Specification">32</a>]. Grin has opted for an inflationary model where the block reward will remain constant, making its arguments 
for this approach in [<a href="https://github.com/mimblewimble/docs/wiki/Monetary-Policy" title="Monetary Policy">27</a>]. This approach will asymptotically tend towards a zero percent dilution as the supply 
increases, instead of enforcing a set supply [<a href="https://github.com/mimblewimble/grin/wiki/fees-mining" title="Economic Policy: Fees 
and Mining Reward">28</a>]. Grin has not yet specified its mining reward or fees structure, 
but based on its current documentation, it is planning on a 60 grin per block reward. Neither project has made a 
final decision regarding how to structure fees, but the Grin project has started to explore how to set a fee baseline by 
using a metric of &quot;fees per reward per minute&quot; [<a href="https://github.com/mimblewimble/grin/wiki/fees-mining" title="Economic Policy: Fees 
and Mining Reward">28</a>].</p>
<h2><a class="header" href="#conclusions-observations-and-recommendations-7" id="conclusions-observations-and-recommendations-7">Conclusions, Observations and Recommendations</a></h2>
<p>In summary, Grin and BEAM are two open-source projects that are implementing the Mimblewimble blockchain scheme. Both 
projects are building from scratch. Grin uses Rust while BEAM uses C++; therefore there are many technical 
differences in their design and implementation. However, from a functional perspective, both projects will support all 
the core Mimblewimble functionality. Each project does contain some unique functionality, but as Grin's goal is to produce 
a minimalistic implementation of Mimblewimble, most of the unique features that extend Mimblewimble lie in the 
BEAM project. The following list summarizes the functional similarities and differences between the two projects.</p>
<ul>
<li>Similarities:
<ul>
<li>Core Mimblewimble feature set.</li>
<li>Dandelion relay protocol.</li>
</ul>
</li>
<li>Grin unique features:
<ul>
<li>Partial history syncing.</li>
<li>DAG representation of Mempool to prevent duplicate UTXOs and cyclic transaction references.</li>
</ul>
</li>
<li>BEAM unique features:
<ul>
<li>Secure BBS hosted on the nodes for establishing communication between wallets. Removes the need for sender and 
receiver to be online at the same time.</li>
<li>Use of decoy outputs in Dandelion stem phase. Decoy outputs are later spent to avoid clutter on blockchain.</li>
<li>Explicit UTXO incubation period.</li>
<li>Timelocks with a minimum and maximum threshold.</li>
<li>Auditable transactions as part of the roadmap.</li>
<li>One-sided transaction construction for non-interactive payments.</li>
<li>Use of Radix-Hash trees.</li>
</ul>
</li>
</ul>
<p>Both projects are still very young. At the time of writing this report (May 2019), both are still in the testnet 
phase, and many of 
their core design choices have not yet been built or tested. Much of the BEAM wiki is still in Russian, so it is likely 
that there are details to which we are not yet privy. It will be interesting to keep an eye on these projects 
to see how their various decisions play out, both technically and in terms of their monetary policy and governance models.</p>
<h2><a class="header" href="#references-22" id="references-22">References</a></h2>
<p>[<a href="https://download.wpsoftware.net/bitcoin/wizardry/mimblewimble.txt" title="MIMBLEWIMBLE">1</a>] T. E. Jedusor, &quot;MIMBLEWIMBLE&quot; [online]. Available: 
<a href="https://download.wpsoftware.net/bitcoin/wizardry/mimblewimble.txt">https://download.wpsoftware.net/bitcoin/wizardry/mimblewimble.txt</a>. Date accessed: 2018‑09‑30.</p>
<p>[<a href="https://download.wpsoftware.net/bitcoin/wizardry/mimblewimble.pdf" title="Mimblewimble">2</a>] A. Poelstra, &quot;Mimblewimble&quot; [online]. Available: 
<a href="https://download.wpsoftware.net/bitcoin/wizardry/mimblewimble.pdf">https://download.wpsoftware.net/bitcoin/wizardry/mimblewimble.pdf</a>. Date accessed: 2018‑09‑30.</p>
<p>[<a href="https://github.com/mimblewimble/grin/blob/master/doc/intro.md" title="Introduction to 
Mimblewimble and Grin">3</a>] &quot;Introduction to Mimblewimble and Grin&quot; [online]. Available: 
<a href="https://github.com/mimblewimble/grin/blob/master/doc/intro.md">https://github.com/mimblewimble/grin/blob/master/doc/intro.md</a>. Date accessed: 2018‑09‑30.</p>
<p>[<a href="https://docs.wixstatic.com/ugd/87affd_3b032677d12b43ceb53fa38d5948cb08.pdf" title="BEAM: The Scalable 
Confidential Cryptocurrency">4</a>] &quot;BEAM: The Scalable Confidential Cryptocurrency&quot; [online]. Available: 
<a href="https://docs.wixstatic.com/ugd/87affd_3b032677d12b43ceb53fa38d5948cb08.pdf">https://docs.wixstatic.com/ugd/87affd_3b032677d12b43ceb53fa38d5948cb08.pdf</a>. Date accessed: 2018‑09‑28.</p>
<p>[<a href="https://joinmarket.me/blog/blog/flipping-the-scriptless-script-on-schnorr/" title="Flipping the Scriptless 
Script on Schnorr">5</a>] A. Gibson, &quot;Flipping the Scriptless Script on Schnorr&quot; [online]. 
Available: <a href="https://joinmarket.me/blog/blog/flipping-the-scriptless-script-on-schnorr/">https://joinmarket.me/blog/blog/flipping-the-scriptless-script-on-schnorr/</a>. Date accessed: 2018‑09‑30.</p>
<p>[<a href="https://github.com/mimblewimble/grin" title="Grin Github Repository">6</a>] &quot;Grin Github Repository&quot; [online]. Available: <a href="https://github.com/mimblewimble/grin">https://github.com/mimblewimble/grin</a>. 
Date accessed: 2018‑09‑30.</p>
<p>[<a href="https://github.com/beam-mw/beam" title="BEAM Github Repository">7</a>] &quot;BEAM Github Repository&quot; [online]. Available: <a href="https://github.com/beam-mw/beam">https://github.com/beam-mw/beam</a>. Date accessed: 2018‑09‑30.</p>
<p>[<a href="https://github.com/mimblewimble/grin/blob/master/doc/internal/pool.md" title="Grin - Transaction Pool">8</a>] &quot;Grin - Transaction Pool&quot; [online]. Available: 
<a href="https://github.com/mimblewimble/grin/blob/master/doc/internal/pool.md">https://github.com/mimblewimble/grin/blob/master/doc/internal/pool.md</a>. Date accessed: 2018‑10‑22.</p>
<p>[<a href="https://arxiv.org/abs/1701.04439" title="Dandelion: Redesigning the Bitcoin 
Network for Anonymity">9</a>] S. B. Venkatakrishnan, G. Fanti and P. Viswanath, &quot;Dandelion: Redesigning the Bitcoin Network for Anonymity&quot; 
[online]. Available: <a href="https://arxiv.org/abs/1701.04439">https://arxiv.org/abs/1701.04439</a>. Proc. ACM Meas. Anal. Comput. Syst. 1, 1, 2017. 
Date accessed: 2018‑10‑22.</p>
<p>[<a href="https://github.com/mimblewimble/grin/blob/master/doc/dandelion/dandelion.md" title="Dandelion in Grin: 
Privacy-Preserving Transaction 
Aggregation and Propagation">10</a>] &quot;Dandelion in Grin: Privacy-Preserving Transaction Aggregation and Propagation&quot; [online]. Available: 
<a href="https://github.com/mimblewimble/grin/blob/master/doc/dandelion/dandelion.md">https://github.com/mimblewimble/grin/blob/master/doc/dandelion/dandelion.md</a>. Date accessed: 2018‑09‑30.</p>
<p>[<a href="https://github.com/mimblewimble/grin/blob/master/doc/chain/chain_sync.md" title="Grin - Blockchain Syncing">11</a>] &quot;Grin - Blockchain Syncing&quot; [online]. Available: 
<a href="https://github.com/mimblewimble/grin/blob/master/doc/chain/chain_sync.md">https://github.com/mimblewimble/grin/blob/master/doc/chain/chain_sync.md</a>. Date accessed: 2018‑10‑22.</p>
<p>[<a href="https://github.com/beam-mw/beam/wiki/Node-initial-synchronization" title="BEAM - Node Initialization 
Synchronization">12</a>] &quot;BEAM - Node Initialization Synchronization&quot; [online]. Available: 
<a href="https://github.com/beam-mw/beam/wiki/Node-initial-synchronization">https://github.com/beam-mw/beam/wiki/Node-initial-synchronization</a>. Date accessed: 2018‑12‑24.</p>
<p>[<a href="https://www.scribd.com/document/385080303/BEAM-Description-Comparison-With-Classical-MW" title="BEAM Description. Comparison 
with Classical MW">13</a>] &quot;BEAM Description. Comparison with Classical MW&quot; [online]. Available: 
<a href="https://www.scribd.com/document/385080303/BEAM-Description-Comparison-With-Classical-MW">https://www.scribd.com/document/385080303/BEAM-Description-Comparison-With-Classical-MW</a>. Date accessed: 2018‑10‑18.</p>
<p>[<a href="https://github.com/beam-mw/beam/wiki/Wallet-audit" title="BEAM - Wallet Audit">14</a>] &quot;BEAM - Wallet Audit&quot; [online]. Available: <a href="https://github.com/beam-mw/beam/wiki/Wallet-audit">https://github.com/beam-mw/beam/wiki/Wallet-audit</a>. 
Date accessed: 2018‑09‑30.</p>
<p>[<a href="https://www.reddit.com/r/beamprivacy/comments/9fqbfg/beams_offline_transactions_using_secure_bbs_system/" title="Beam's Offline Transaction 
using Secure BBS System">15</a>] &quot;Beam's Offline Transaction using Secure BBS System&quot; [online]. Available: 
<a href="https://www.reddit.com/r/beamprivacy/comments/9fqbfg/beams_offline_transactions_using_secure_bbs_system">https://www.reddit.com/r/beamprivacy/comments/9fqbfg/beams_offline_transactions_using_secure_bbs_system</a>. 
Date accessed: 2018‑10‑22.</p>
<p>[<a href="https://github.com/mimblewimble/grin/blob/master/doc/merkle.md" title="GRIN - Merkle Structures">16</a>] &quot;GRIN - Merkle Structures&quot; [online]. Available: <a href="https://github.com/mimblewimble/grin/blob/master/doc/merkle.md">https://github.com/mimblewimble/grin/blob/master/doc/merkle.md</a>. 
Date accessed: 2018‑10‑22.</p>
<p>[<a href="https://github.com/beam-mw/beam/wiki/Merkle-trees" title="BEAM - Merkle Trees">17</a>] &quot;BEAM - Merkle Trees&quot; [online]. Available: <a href="https://github.com/beam-mw/beam/wiki/Merkle-trees">https://github.com/beam-mw/beam/wiki/Merkle-trees</a>. 
Date accessed: 2018‑10‑22.</p>
<p>[<a href="https://github.com/beam-mw/beam/wiki/Confidential-assets" title="BEAM - Confidential Assets">18</a>] &quot;BEAM - Confidential Assets&quot; [online]. Available: <a href="https://github.com/beam-mw/beam/wiki/Confidential-assets">https://github.com/beam-mw/beam/wiki/Confidential-assets</a>. 
Date accessed: 2018‑10‑22.</p>
<p>[<a href="https://www.cryptolux.org/images/b/b9/Equihash.pdf" title="Equihash: Asymmetric Proof-of-work 
based on the Generalized 
Birthday Problem">19</a>] A. Biryukov and D. Khovratovich, &quot;Equihash: Asymmetric Proof-of-work based on the Generalized Birthday Problem&quot; 
[online] Available: <a href="https://www.cryptolux.org/images/b/b9/Equihash.pdf">https://www.cryptolux.org/images/b/b9/Equihash.pdf</a>. Proceedings of NDSS, 2016. 
Date accessed: 2018‑09‑30.</p>
<p>[<a href="https://github.com/tromp/cuckoo" title="Cuckoo Cycle">20</a>] &quot;Cuckoo Cycle&quot; [online]. Available: <a href="https://github.com/tromp/cuckoo">https://github.com/tromp/cuckoo</a>. Date accessed: 2018‑09‑30.</p>
<p>[<a href="https://www.grin-forum.org/t/proof-of-work-update/713" title="Proof of Work Update">21</a>] I. Peverell, &quot;Proof of Work Update&quot; [online]. Available: <a href="https://www.grin-forum.org/t/proof-of-work-update/713">https://www.grin-forum.org/t/proof-of-work-update/713</a>. 
Date accessed: 2018‑09‑30.</p>
<p>[<a href="https://github.com/mimblewimble/docs/wiki/Regarding-Foundations" title="Regarding Foundations">22</a>] &quot;Regarding Foundations&quot; [online]. Available: <a href="https://github.com/mimblewimble/docs/wiki/Regarding-Foundations">https://github.com/mimblewimble/docs/wiki/Regarding-Foundations</a>. 
Date accessed: 2018‑09‑30.</p>
<p>[<a href="https://www.grin-forum.org/t/meeting-notes-governance-sep-25-2018/874" title="Meeting Notes: 
Governance, Sep 25 2018">23</a>] &quot;Meeting Notes: Governance, Sep 25 2018&quot; [online]. Available: 
<a href="https://www.grin-forum.org/t/meeting-notes-governance-sep-25-2018/874">https://www.grin-forum.org/t/meeting-notes-governance-sep-25-2018/874</a>. Date accessed: 2018‑09‑30.</p>
<p>[<a href="https://www.beam-mw.com/features" title="BEAM Features">24</a>] &quot;BEAM Features&quot; [online]. Available: <a href="https://www.beam-mw.com/features">https://www.beam-mw.com/features</a>. Date accessed: 2018‑09‑30.</p>
<p>[<a href="https://grin-tech.org/funding.html" title="Grin's Community Funding Principles">25</a>] &quot;Grin's Community Funding Principles&quot; [online]. Available: <a href="https://grin-tech.org/funding.html">https://grin-tech.org/funding.html</a>. 
Date accessed: 2018‑09‑28.</p>
<p>[<a href="https://grin-tech.org/yeastplume.html" title="Oct 2018 - Feb 2019 
Developer Funding - Yeastplume">26</a>] &quot;Oct 2018 - Feb 2019 Developer Funding - Yeastplume&quot; [online]. Available: <a href="https://grin-tech.org/yeastplume.html">https://grin-tech.org/yeastplume.html</a>. 
Date accessed: 2018‑09‑30.</p>
<p>[<a href="https://github.com/mimblewimble/docs/wiki/Monetary-Policy" title="Monetary Policy">27</a>] &quot;Monetary Policy&quot; [online]. Available: <a href="https://github.com/mimblewimble/docs/wiki/Monetary-Policy">https://github.com/mimblewimble/docs/wiki/Monetary-Policy</a>. 
Date accessed: 2018‑09‑30.</p>
<p>[<a href="https://github.com/mimblewimble/grin/wiki/fees-mining" title="Economic Policy: Fees 
and Mining Reward">28</a>] &quot;Economic Policy: Fees and Mining Reward&quot; [online]. Available: <a href="https://github.com/mimblewimble/grin/wiki/fees-mining">https://github.com/mimblewimble/grin/wiki/fees-mining</a>. 
Date accessed: 2018‑09‑30.</p>
<p>[<a href="https://github.com/mimblewimble/grin/blob/master/doc/pow/pow.md" title="Grin's Proof-of-Work">29</a>] &quot;Grin's Proof-of-Work&quot; [online]. Available: <a href="https://github.com/mimblewimble/grin/blob/master/doc/pow/pow.md">https://github.com/mimblewimble/grin/blob/master/doc/pow/pow.md</a>. 
Date accessed: 2018‑09‑30.</p>
<p>[<a href="https://medium.com/beam-mw/the-secure-bulletin-board-system-sbbs-implementation-in-beam-a01b91c0e919" title="The Secure Bulletin Board 
System (SBBS) Implementation in Beam">30</a>]: R Lahat, &quot;The Secure Bulletin Board System (SBBS) Implementation in Beam&quot; [online]. Available: 
<a href="https://medium.com/beam-mw/the-secure-bulletin-board-system-sbbs-implementation-in-beam-a01b91c0e919">https://medium.com/beam-mw/the-secure-bulletin-board-system-sbbs-implementation-in-beam-a01b91c0e919</a>. 
Date accessed: 2018‑12‑24.</p>
<p>[<a href="https://github.com/BeamMW/beam/wiki/Secure-bulletin-board-system-(SBBS)" title="Beam's SBBS Specification">31</a>]: &quot;Secure Bulletin Board System (SBBS)&quot; [online]. Available: 
<a href="https://github.com/BeamMW/beam/wiki/Secure-bulletin-board-system-(SBBS)">https://github.com/BeamMW/beam/wiki/Secure-bulletin-board-system-(SBBS)</a>. Date accessed: 2018‑12‑24.</p>
<p>[<a href="https://github.com/BeamMW/beam/wiki/BEAM-Mining" title="Beam's Mining Specification">32</a>]: &quot;Beam’s Mining Specification&quot; [online]. Available: <a href="https://github.com/BeamMW/beam/wiki/BEAM-Mining">https://github.com/BeamMW/beam/wiki/BEAM-Mining</a>. 
Date accessed: 2018‑12‑24.</p>
<p>[<a href="https://github.com/BeamMW/beam/wiki/Transaction-graph-obfuscation" title="Beam's Transaction Graph 
Obfuscation">33</a>]: &quot;Beam’s Transaction Graph Obfuscation&quot; [online]. Available: 
<a href="https://github.com/BeamMW/beam/wiki/Transaction-graph-obfuscation">https://github.com/BeamMW/beam/wiki/Transaction-graph-obfuscation</a>. Date accessed: 2018‑12‑24.</p>
<h2><a class="header" href="#appendices-7" id="appendices-7">Appendices</a></h2>
<p>This section contains some information on topics discussed in the report, details of which are not directly relevant to 
the Grin vs. 
BEAM discussion.</p>
<h3><a class="header" href="#appendix-a-cuckoocuckatoo-cycle-proof-of-work-algorithm" id="appendix-a-cuckoocuckatoo-cycle-proof-of-work-algorithm">Appendix A: Cuckoo/Cuckatoo Cycle Proof-of-Work Algorithm</a></h3>
<p>The Cuckoo Cycle algorithm is based on finding cycles of a certain length of edges in a bipartite graph of N nodes and 
M edges. The graph is bipartite because it consists of two separate groups of nodes with edges that connect nodes from 
one set to the other. As an example, let's consider nodes with even indices to be in one group and nodes with odd 
indices to be in another group. Figure 2 shows eight nodes with four randomly placed edges, N = 8 and M = 4. 
So if 
we are looking for cycles of length 4, we can easily confirm that none exist in Figure 2. By adjusting the number 
of edges present in the graph vs. the number of nodes, we can control the probability that a cycle of a certain length 
exists in the graph. When looking for cycles of length 4, the difficulty, as illustrated in Figure 2, is that a 
4/8 (M/N) graph 
would mean that the four edges would need to be randomly chosen in an exact cycle for one to exist [<a href="https://github.com/mimblewimble/grin/blob/master/doc/pow/pow.md" title="Grin's Proof-of-Work">29</a>].</p>
<p align="center">
   <img src="protocols/grin-beam-comparison/sources/cuckoo_base_numbered_few_edges.png" width="250"/>
   <p>
     <center><strong>
       Figure 2: Eight Nodes with Four Edges, no Solution 
       [<a href="https://github.com/mimblewimble/grin/blob/master/doc/pow/pow.md" title="Grin's Proof-of-Work">29</a>]
     </strong></center>
   </p>
</p>
<p>If we increase the number of edges in the graph relative to the number of nodes, we adjust the probability of a cycle 
occurring in the randomly chosen set of edges. Figure 3 shows an example of M = 7 and N = 8, 
and it can be seen that a four-edged cycle appeared. Thus, we can control the probability of a cycle of a certain length 
occurring by adjusting the ratio of M/N [<a href="https://github.com/mimblewimble/grin/blob/master/doc/pow/pow.md" title="Grin's Proof-of-Work">29</a>].</p>
<p align="center">
  <img src="protocols/grin-beam-comparison/sources/cuckoo_base_numbered_few_edges_cycle.png" width="250"/>
  <p>
    <center><strong>
      Figure 3: Cycle Found from 0-5-4-1-0 
      [<a href="https://github.com/mimblewimble/grin/blob/master/doc/pow/pow.md" title="Grin's Proof-of-Work">29</a>]
    </center></strong>
  </p>
</p>
<p>Detecting that a cycle of a certain length has occurred in a graph with randomly selected edges becomes significantly 
more difficult as the number of graphs gets larger. Figure 4 shows a 22‑node graph with 14 random edges in it. 
Can you determine if a cycle of eight edges is present? [<a href="https://github.com/mimblewimble/grin/blob/master/doc/pow/pow.md" title="Grin's Proof-of-Work">29</a>]</p>
<p align="center">
  <img src="protocols/grin-beam-comparison/sources/cuckoo_base_numbered_many_edges.png" width="650"/>
  <p>
    <center><strong>
      Figure 4: 22 Nodes with 14 Edges, can you find a Cycle Eight Edges Long? 
      [<a href="https://github.com/mimblewimble/grin/blob/master/doc/pow/pow.md" title="Grin's Proof-of-Work">29</a>]
    </center></strong>
  </p>
</p>
<p>The Cuckoo cycle PoW algorithm is built to solve this problem. The bipartite graph that is analyzed is called a &quot;Cuckoo 
Hashtable&quot;, where a key is inserted into two arrays, each with its own hash function, in a location based on the 
hash of the key. Each key inserted in this way produces an edge between the locations generated by the two hashing 
functions. Nonces are enumerated for the hashing functions until a cycle of the desired length is detected. This 
algorithm has two main control parameters. It is difficult to establish the M/N ratio and the number of nodes in the 
graph. There are a number of variants of this algorithm that make speed/memory trade-offs [<a href="https://github.com/tromp/cuckoo" title="Cuckoo Cycle">20</a>]. In Grin, a third 
difficulty parameter was introduced to more finely tune the difficulty of the PoW algorithm to ensure a one-minute block 
time in the face of changing network hash rates. This was done by taking a Blake2b hash of the set of nonces and 
ensuring that the result is above a difficulty threshold [<a href="https://github.com/mimblewimble/grin/blob/master/doc/pow/pow.md" title="Grin's Proof-of-Work">29</a>].</p>
<h2><a class="header" href="#contributors-15" id="contributors-15">Contributors</a></h2>
<ul>
<li><a href="https://github.com/philipr-za">https://github.com/philipr-za</a></li>
<li><a href="https://github.com/hansieodendaal">https://github.com/hansieodendaal</a></li>
<li><a href="https://github.com/SWvheerden">https://github.com/SWvheerden</a></li>
<li><a href="https://github.com/anselld">https://github.com/anselld</a></li>
<li>Some clarification by BEAM CEO Alexander Zaidelson <a href="https://github.com/azaidelson">https://github.com/azaidelson</a></li>
</ul>
<h1><a class="header" href="#grin-design-choice-criticisms---truth-or-fiction" id="grin-design-choice-criticisms---truth-or-fiction">Grin Design Choice Criticisms - Truth or Fiction</a></h1>
<ul>
<li><a href="protocols/grin-design-choice-criticisms/MainReport.html#introduction">Introduction</a></li>
<li><a href="protocols/grin-design-choice-criticisms/MainReport.html#monetary-policy-due-to-choice-of-static-emission-scheme">Monetary Policy due to Choice of Static Emission Scheme</a></li>
<li><a href="protocols/grin-design-choice-criticisms/MainReport.html#proof-of-work-algorithm---from-asic-resistant-to-asic-friendly">Proof-of-Work Algorithm - from ASIC Resistant to ASIC Friendly</a></li>
<li><a href="protocols/grin-design-choice-criticisms/MainReport.html#choice-of-cryptographic-elliptic-curve---secp256k1">Choice of Cryptographic Elliptic-curve - secp256k1</a></li>
<li><a href="protocols/grin-design-choice-criticisms/MainReport.html#selection-of-key-store-library">Selection of Key-store Library</a></li>
<li><a href="protocols/grin-design-choice-criticisms/MainReport.html#conclusions-observations-and-recommendations">Conclusions, Observations and Recommendations</a></li>
<li><a href="protocols/grin-design-choice-criticisms/MainReport.html#references">References</a></li>
<li><a href="protocols/grin-design-choice-criticisms/MainReport.html#contributors">Contributors</a></li>
</ul>
<h2><a class="header" href="#introduction-13" id="introduction-13">Introduction</a></h2>
<p>Grin is a cryptocurrency, implemented in Rust, that makes use of Mimblewimble transactions and the Cuckatoo algorithm to 
perform Proof-of-Work (PoW) calculations. The main design goals of the Grin project are privacy, transaction scaling 
and design simplicity to promote long-term maintenance of the Grin source code [<a href="https://medium.com/novamining/grin-testnet-is-live-98b0f8cd135d" title="Grin: A Lightweight Implementation of 
the MimbleWimble Protocol, Mattia Franzoni">1</a>].</p>
<p>During the development of the Grin project, the developers have been criticized by the community regarding a number of 
their design and implementation decisions. This report will look at some of this criticism 
and determine if there is any truth to these concerns, or if they are unwarranted or invalid. Some suggestions 
will be made as to how these problems could be mitigated or addressed.</p>
<p>This report will also investigate Grin's selected emission scheme, PoW algorithm, choice of cryptographic curve used for
signatures, and selection of key-store library. Each of these topics will be discussed in detail.</p>
<p align="center"><img src="protocols/grin-design-choice-criticisms/sources/intro.png" width="700" /></p>
<h2><a class="header" href="#monetary-policy-due-to-choice-of-static-emission-scheme" id="monetary-policy-due-to-choice-of-static-emission-scheme">Monetary Policy due to Choice of Static Emission Scheme</a></h2>
<p>Bitcoin has a limited and finite supply of coins. It makes use of 10‑minute block times, where the initial reward for 
solving the first block was 50 BTC. This reward is reduced every four years, by halving it, until a maximum of 
21 million coins are in circulation [<a href="https://bitcoin.org/bitcoin.pdf" title="Bitcoin: A Peer-to-Peer Electronic 
Cash System, Satoshi Nakamoto">2</a>]. During this process, the transaction fees and newly minted coins are 
paid to miners and used as an incentive for miners to maintain the blockchain. Once all 21 million Bitcoins 
are released, only transaction fees will be paid to miners. Many fear that paying miners only transaction fees in the 
future will not be sufficient to maintain a large network of miners. This would result in the centralization of the 
network, as only large mining farms would be able to perform the mining task in a profitable manner. Others believe that 
in time, mining fees will increase and hardware costs for miners will decrease, making the act of mining lucrative and 
profitable, and maintaining the bitcoin blockchain [<a href="https://www.investopedia.com/tech/what-happens-bitcoin-after-21-million-mined/" title="What Happens to Bitcoin after 
all 21 Million are Mined? Adam Barone">3</a>].</p>
<p>Grin has decided on a different approach, where its number of coins will not be capped at a fixed supply. It will 
make use of a static emission rate, where a constant 60 Grin is released as a reward for solving every block. This
algorithm makes use of a block goal of 60 seconds. This will result in approximately one coin being created every 
second for as long as the blockchain is being maintained [<a href="https://www.grin-forum.org/t/emmission-rate-of-grin/171" title="Emission Rate of Grin">4</a>].</p>
<p>Grin's primary motivation for selecting a static emission rate is: </p>
<ul>
<li>there will be no upper limit on the number of coins that can be created;</li>
<li>the percentage of newly created coins compared to the total coins in circulation will tend toward zero;</li>
<li>it will mitigate the effect of orphaned and lost coins; and</li>
<li>it will encourage spending rather than holding of coins.</li>
</ul>
<p>The selected emission rate will result in Grin becoming a high inflationary currency with more than 10% inflation for 
the first 10 years, which is higher than most competing cryptocurrencies or successful fiat systems. This is in 
comparison to other cryptocurrencies such as Monero, which will have less than 1% inflation after the first eight years 
in circulation, and a decreasing 0.87% inflation with the start of its tail emissions [<a href="https://www.reddit.com/r/Monero/comments/512kwh/useful_for_learning_about_monero_coin_emission/d78tpgi" title="Coin Emission and Block Reward 
Schedules: Bitcoin vs. Monero">5</a>]. Monero will have a 
better potential of being used as a Store of Value (SoV) in the long run.</p>
<p>The fixed emission rate of Grin, on the other hand, will limit its use as an SoV, as it will experience constant price 
pressure. This might make it difficult for Grin to maintain a high value initially, while the inflation rate remains 
high. The high inflation rate may encourage Grin to rather be used as a Medium of Exchange (MoE) [<a href="https://www.reddit.com/r/grincoin/comments/91g1nx/on_grin_mimblewimble_and_monetary_policy/" title="On Grin, MimbleWimble, and Monetary Policy">6</a>], as it will 
take approximately 50 years for the inflation to drop below 2%. The Grin team believes that the inflation rate is 
not that high, as many coins are lost and become unusable on a blockchain. These lost coins, which the team believes can 
be as much as 2% per year of the total supply, should be excluded from the inflation rate calculation [<a href="https://github.com/mimblewimble/docs/wiki/Monetary-Policy" title="Grin - Monetary Policy">7</a>]. The total 
percentage of lost transactional coins is difficult to estimate [<a href="http://fortune.com/2017/11/25/lost-bitcoins/" title="Exclusive: Nearly 4 Million Bitcoin 
Lost Forever, New Study Says, 
Jeff J. Roberts and Nicolas Rapp">8</a>]. It appears that this value is higher for low‑
value coins than for high-value coins, where users tend to be more careful. The Grin team believes that selecting 
a high inflation rate will improve the distribution of coins, as holding of coins will be discouraged. It also hopes 
that a high inflation rate will produce natural pricing and limit price manipulation by large coin holders [<a href="https://github.com/mimblewimble/docs/wiki/Monetary-Policy" title="Grin - Monetary Policy">7</a>]. </p>
<p>Most economists for traditional fiat systems agree that deflation is bad, as it increases debt; and some inflation is 
good, as it stimulates the economy of a country [<a href="https://cryptobriefing.com/how-inflationary-should-cryptocurrency-be/" title="How Inflationary should 
Cryptocurrency really be? Andrew Ancheta">9</a>]. With inflation, the purchasing power of savings decreases over 
time. This encourages the purchasing of goods and services, resulting in the currency being used as an MoE rather than 
as an SoV.  People with debt such as study loans, vehicle loans and home loans also benefit from inflation, as it 
produces an eroding effect on the total debt for long periods of repayment. Currently, this benefit does not apply to 
cryptocurrencies, as not much debt exists. This is because it is difficult to maintain successful borrower-lender 
relationships due to the anonymous nature of cryptocurrencies [<a href="https://web.archive.org/web/20180917125549/https://cryptoinsider.21mil.com/debtcoin-credit-debt-and-cryptocurrencies/" title="Debtcoin: Credit, Debt, 
and Cryptocurrencies, Landon Mutch">10</a>].</p>
<p>On the other hand, over time, deflation in traditional fiat systems produces an increase of purchasing power that 
encourages saving and discourages debt, resulting in the currency being used as an SoV. Unfortunately, this comes with a 
negative side effect that people will stop purchasing goods and services. Bitcoin can be considered deflationary, as 
people would rather buy and hold Bitcoins, as the price per coin might increase over time. This is limiting its use as an 
MoE. Deflation can also cause a deflationary spiral, as people with debt will have more debt and people with 
money will start hoarding their money, as it might be worth more at a later stage [<a href="https://blockonomi.com/bitcoin-deflation/" title="Inflation vs Deflation: 
A Guide to Bitcoin &amp; Cryptocurrencies 
Deflationary Nature, Brian Curran">11</a>]. Deflation in traditional fiat 
systems typically tends to only happen in times of economic crisis and recession, and is managed by introducing inflation, 
using monetary policies [<a href="https://www.investopedia.com/articles/personal-finance/030915/why-deflation-bad-economy.asp" title="Why is Deflation Bad 
for the Economy? Adam Hayes">12</a>]. </p>
<p>As most inflationary fiat systems are government backed, they are able to control the level of inflation to help 
alleviate government debt and finance budget deficits [<a href="https://www.nationalaffairs.com/publications/detail/inflation-and-debt" title="Inflation and Debt, 
John H. Cochrane">13</a>]. This could result in hyperinflation where the 
devaluation of currency occurs at an extreme pace, resulting in many people losing their savings and pensions [<a href="https://medium.com/@Digix/think-piece-fighting-hyperinflation-with-cryptocurrencies-a08fe86bb66a" title="Think Piece: Fighting Hyperinflation 
with Cryptocurrencies, Lucia Ziyuan">14</a>]. 
Cryptocurrencies, on the other hand, provide a transparent algorithmic monetary inflation that is not controlled by a 
central authority or government. This limits its misuse. </p>
<p>Finding a good balance between being an SoV and MoE is an important issue for developing a successful currency. A 
balance between deflation and inflation needs to be achieved to motivate saving and at the same time spending of a 
currency. A low inflationary model where inflation is algorithmically maintained and not controlled by a single 
authority seems to be the safest choice. However, only time will tell if the high inflation model proposed by Grin will 
have the desired effect. </p>
<h2><a class="header" href="#proof-of-work-algorithm---from-asic-resistant-to-asic-friendly" id="proof-of-work-algorithm---from-asic-resistant-to-asic-friendly">Proof-of-Work Algorithm - from ASIC Resistant to ASIC Friendly</a></h2>
<p>Initially, the Grin team proposed using two Application-Specific Integrated Circuit (ASIC) resistant algorithms: 
Cuckoo cycles and a high memory requirement Equihash algorithm called Equigrin. These algorithms were selected to 
encourage mining decentralization. ASIC resistance was obtained by having high memory requirements for the PoW 
algorithms, limiting their calculation to Central Processing Units (CPUs) and High-range Graphics Processing Units 
(GPUs) [<a href="https://www.grin-forum.org/t/proof-of-work-update/713" title="Grin - Proof of Work Update">15</a>]. The plan was to adjust the parameters of these PoW algorithms every six months to deter stealth ASIC 
mining and move over to using only Cuckoo cycles as the primary PoW algorithm.</p>
<p>Recently, the Grin team proposed switching to a new dual PoW system, where one PoW algorithm is ASIC friendly and the 
other PoW algorithm is not. Grin will now make use of the new Cuckatoo Cycle algorithm, but details of its second PoW 
algorithm remain vague. The Cuckatoo PoW algorithm is a variation of Cuckoo that aims to be more ASIC friendly [<a href="https://www.grin-forum.org/t/meeting-notes-governance-sep-25-2018/874" title="Grin - Meeting Notes: 
Governance, Sep 25 2018">16</a>]. 
This is achieved by using plain bits for ternary counters and requiring large amounts of Static Random-Access Memory 
(SRAM) to speed up the memory latency bound access of random node bits. SRAM tends to be limited on GPU and CPU 
processors, but increasing SRAM on ASIC processors is much easier to implement [<a href="https://github.com/tromp/cuckoo" title="Cuck(at)oo Cycle">17</a>].</p>
<p align="center"><img src="protocols/grin-design-choice-criticisms/sources/attack51.jpg" width="550" /></p>
<p>ASIC miners tend to be specialized hardware that is very efficient at calculating and solving specific PoW algorithms. 
Encouraging ASIC miners on a network might not seem like a bad idea, as the mining network will have a higher hash rate. 
This will make it more difficult to hack and it will use less electrical power compared to using primarily CPU and GPU 
based miners. </p>
<p>Unfortunately, a negative side effect of running a PoW algorithm that is ASIC friendly is that the network of miners 
will become more centralized. General consumers do not have access to or a need for this type of hardware. This results 
in the use of ASIC miners being primarily reserved for enthusiasts and large corporations that are establishing mining 
farms. Having most of the network's hash rate localized in large mining farms will result in the blockchain becoming more 
vulnerable to potential 51% attacks [<a href="https://www.investopedia.com/terms/1/51-attack.asp" title="51% Attack">18</a>], especially when specific ASIC manufacturers recommend or enforce their 
hardware to make use of specific mining pools that are controlled by single bodies.</p>
<p align="center"><img src="protocols/grin-design-choice-criticisms/sources/gpu_mining.jpg" width="450" /></p>
<p>Using general-purpose and multi-use hardware such as CPUs and GPUs that are primarily used for gaming and large 
workstations ensures that the network of miners is more widely distributed and that it is not controlled by a single 
potential bad player. This will make it more difficult for a single entity to control more than 50% of the network's 
hash rate or total computational power, limiting the potential of double spends.</p>
<p>Selecting to be ASIC resistant or ASIC friendly is an important decision that can affect the security of the blockchain. 
The Grin team's choice to support the ASIC community and try to balance an ASIC-friendly and an ASIC-resistant PoW 
algorithm will be interesting, with many potential pitfalls.</p>
<h2><a class="header" href="#choice-of-cryptographic-elliptic-curve---secp256k1" id="choice-of-cryptographic-elliptic-curve---secp256k1">Choice of Cryptographic Elliptic-curve - secp256k1</a></h2>
<p>Elliptic curve cryptography is used for generating Private and Public key pairs that can be used for digital signatures 
as well as authorization for individuals and transactions. It is much more secure and requires smaller keys for similar 
security compared to other Public-key cryptography techniques such as RSA [<a href="https://hackernoon.com/what-is-the-math-behind-elliptic-curve-cryptography-f61b25253da3" title="What is the Math behind 
Elliptic Curve Cryptography? Hans Knutson">19</a>].</p>
<p align="center"><img src="protocols/grin-design-choice-criticisms/sources/publickey.png" width="700" /></p>
<p>Secp256k1 is an elliptic curve defined in the Standards for Efficient Cryptography [<a href="http://www.secg.org/" title="Standards for Efficient 
Cryptography Group">20</a>] and is used for digital 
signatures in a number of cryptocurrencies such as Bitcoin, Ethereum, EOS and Litecoin [<a href="https://en.bitcoin.it/wiki/Secp256k1" title="Secp256k1">21</a>]. Grin also makes use 
of this same elliptic curve [<a href="https://www.grin-forum.org/t/schnorr-signatures-in-grin-information/730" title="Grin - Schnorr Signatures 
in Grin &amp; Information">22</a>]. Some security experts recommend not using the secp256k1 curve, as some issues have 
been uncovered, but not necessarily exploited. One of these problems is that the complex-multiplication field 
discriminant is not high enough to be secure. This could result in potential future exploits, as curves with low 
complex-multiplication field discriminant tend to be easier to break [<a href="http://safecurves.cr.yp.to/disc.html" title="SafeCurves - CM Field Discriminants">23</a>].</p>
<p>Starting a project with a potentially compromised curve does not seem like a good idea, especially when other curves 
with better security properties and characteristics do exist. A number of alternative curves exist that could be used 
to improve security. For example, Curve25519, which can be used with the improved Ed25519 public-key signature system. The 
Ed25519 signature scheme makes use of the Edwards-curve Digital Signature Algorithm (EdDSA) and uses SHA-512 and 
Curve25519 [<a href="https://cr.yp.to/ecdh/curve25519-20060209.pdf" title="Curve25519: New Diffie-Hellman 
Speed Records, Daniel J. Bernstein">24</a>] to build a fast signature scheme without sacrificing security.</p>
<p>Many additional alternatives exist, and platforms such as SafeCurves, maintained by Daniel J. Bernstein and Tanje Lange, 
can help with the investigation and selection of an alternative security curve. The SafeCurves platform will make it 
easier to evaluate the security properties and potential vulnerabilities of many cryptographic curves [<a href="http://safecurves.cr.yp.to/" title="SafeCurves - Choosing Safe Curves 
for Elliptic-curve Cryptography">25</a>].</p>
<h2><a class="header" href="#selection-of-key-store-library" id="selection-of-key-store-library">Selection of Key-store Library</a></h2>
<p>Grin originally made use of RocksDB [<a href="https://rocksdb.org/" title="RocksDB">26</a>] as an internal key-value store, but received some criticism for this 
decision. A number of alternatives with other performance and security characteristics exist, such as LevelDB [<a href="https://web.archive.org/web/20180917125549/https://cryptoinsider.21mil.com/debtcoin-credit-debt-and-cryptocurrencies/" title="LevelDB">27</a>], 
HyperLevelDB [<a href="http://hyperdex.org/" title="HyperLevelDB">28</a>] and the Lightning Memory-Mapped Database (LMDB) [<a href="https://github.com/LMDB" title="LMDB">29</a>]. Selecting between these to find the &quot;best&quot; 
key-value store library for blockchain applications remains a difficult problem, as many online sources provide 
conflicting information.</p>
<p>Based on the controversial results from a number of online benchmarks, it seems as if some of these alternatives have 
better performance, such as producing small database sizes and performing faster queries [<a href="https://www.influxdata.com/blog/benchmarking-leveldb-vs-rocksdb-vs-hyperleveldb-vs-lmdb-performance-for-influxdb/" title="Benchmarking LevelDB vs. RocksDB 
vs. HyperLevelDB vs. LMDB 
Performance for InfluxDB, Paul Dix">30</a>]. As an example, RocksDB 
and LevelDB seem incorrectly to be better alternatives to LMDB, as they produce the fastest reads and deletes, as well 
as some of the smallest databases, compared to the other database libraries [<a href="https://github.com/lmdbjava/benchmarks/blob/master/results/20160630/README.md" title="Lmdbjava - Benchmarks, Ben Alex">31</a>]. This is not entirely true, as 
some mistakes were made during the testing process. Howard Chu wrote an article entitled &quot;Lies, Damn Lies, Statistics, 
and Benchmarks&quot;, which exposes some of these issues and shows that LMDB is the best key-value store library [<a href="https://www.linkedin.com/pulse/lies-damn-statistics-benchmarks-howard-chu" title="Lies, Damn Lies, Statistics, 
and Benchmarks, Howard Chu">32</a>]. Other 
benchmarks performed by Symas Corp support this claim, where LMDB outperformed all the tested key store libraries [<a href="http://www.lmdb.tech/bench/hyperdex/" title="HyperDex Benchmark, Symas Corp">33</a>].</p>
<p>Grin later replaced RocksDB with LMDB to maintain the state of Grin Wallets [<a href="https://www.grin-forum.org/t/yeastplume-progress-update-thread-may-sept-2018/361/12" title="Progress Update May - Sep 2018, Yeastplume">34</a>]. This switch appears to be a 
good idea, as LMDB seem to be the best key-value store library for blockchain-related applications.</p>
<h2><a class="header" href="#conclusions-observations-and-recommendations-8" id="conclusions-observations-and-recommendations-8">Conclusions, Observations and Recommendations</a></h2>
<ul>
<li>Selecting the correct emission rate to create a sustainable monetary policy is an important decision. Care should 
be taken to ensure that the right balance is found between being an SoV and/or an MoE.</li>
<li>Weighing the benefits and potential issues of being ASIC friendly compared to ASIC resistant needs to be carefully 
evaluated.</li>
<li>Tools such as SafeCurves can be used to select a secure elliptic curve for an application. Cryptographic curves with 
even potential security vulnerabilities should rather be ignored.</li>
<li>Care should be taken when using online benchmarks to help select libraries for a project, as the results might be 
misleading.</li>
</ul>
<h2><a class="header" href="#references-23" id="references-23">References</a></h2>
<p>[<a href="https://medium.com/novamining/grin-testnet-is-live-98b0f8cd135d" title="Grin: A Lightweight Implementation of 
the MimbleWimble Protocol, Mattia Franzoni">1</a>]  M. Franzoni, &quot;Grin: a Lightweight Implementation of the MimbleWimble Protocol&quot; [online]. 
Available: <a href="https://medium.com/novamining/grin-testnet-is-live-98b0f8cd135d">https://medium.com/novamining/grin-testnet-is-live-98b0f8cd135d</a>. Date accessed: 2018‑10‑05.</p>
<p>[<a href="https://bitcoin.org/bitcoin.pdf" title="Bitcoin: A Peer-to-Peer Electronic 
Cash System, Satoshi Nakamoto">2</a>] S. Nakamoto, &quot;Bitcoin: A Peer-to-Peer Electronic Cash System&quot; [online]. 
Available: &lt;<a href="https://bitcoin.org/bitcoin.pdf">https://bitcoin.org/bitcoin.pdf</a>. Date accessed: 2018‑10‑05.</p>
<p>[<a href="https://www.investopedia.com/tech/what-happens-bitcoin-after-21-million-mined/" title="What Happens to Bitcoin after 
all 21 Million are Mined? Adam Barone">3</a>] A. Barone, &quot;What Happens to Bitcoin after all 21 Million are Mined?&quot; [Online.] 
Available: <a href="https://www.investopedia.com/tech/what-happens-bitcoin-after-21-million-mined/">https://www.investopedia.com/tech/what-happens-bitcoin-after-21-million-mined/</a>. Date accessed: 2018‑10‑07.</p>
<p>[<a href="https://www.grin-forum.org/t/emmission-rate-of-grin/171" title="Emission Rate of Grin">4</a>] &quot;Emission Rate of Grin&quot; [online]. Available: <a href="https://www.grin-forum.org/t/emmission-rate-of-grin/171">https://www.grin-forum.org/t/emmission-rate-of-grin/171</a>. 
Date accessed: 2018‑10‑15.</p>
<p>[<a href="https://www.reddit.com/r/Monero/comments/512kwh/useful_for_learning_about_monero_coin_emission/d78tpgi" title="Coin Emission and Block Reward 
Schedules: Bitcoin vs. Monero">5</a>] &quot;Coin Emission and Block Reward Schedules: Bitcoin vs. Monero&quot; [online]. Available: <a href="https://www.reddit.com/r/Monero/comments/512kwh/useful_for_learning_about_monero_coin_emission/d78tpgi">https://www.reddit.com/r/Monero/comments/512kwh/useful_for_learning_about_monero_coin_emission/d78tpgi</a>. 
Date accessed: 2018‑10‑15.</p>
<p>[<a href="https://www.reddit.com/r/grincoin/comments/91g1nx/on_grin_mimblewimble_and_monetary_policy/" title="On Grin, MimbleWimble, and Monetary Policy">6</a>] &quot;On Grin, MimbleWimble, and Monetary Policy&quot; [online]. 
Available: <a href="https://www.reddit.com/r/grincoin/comments/91g1nx/on_grin_mimblewimble_and_monetary_policy/">https://www.reddit.com/r/grincoin/comments/91g1nx/on_grin_mimblewimble_and_monetary_policy/</a>. 
Date accessed: 2018‑10‑07.</p>
<p>[<a href="https://github.com/mimblewimble/docs/wiki/Monetary-Policy" title="Grin - Monetary Policy">7</a>] &quot;Grin - Monetary Policy&quot; [online]. Available: <a href="https://github.com/mimblewimble/docs/wiki/Monetary-Policy">https://github.com/mimblewimble/docs/wiki/Monetary-Policy</a>. 
Date accessed: 2018‑10‑08.</p>
<p>[<a href="http://fortune.com/2017/11/25/lost-bitcoins/" title="Exclusive: Nearly 4 Million Bitcoin 
Lost Forever, New Study Says, 
Jeff J. Roberts and Nicolas Rapp">8</a>] J. J. Roberts and N. Rapp, &quot;Exclusive: Nearly 4 Million Bitcoin Lost Forever, New Study Says&quot; [online]. 
Available: <a href="http://fortune.com/2017/11/25/lost-bitcoins/">http://fortune.com/2017/11/25/lost-bitcoins/</a>. Date accessed: 2018‑10‑08.</p>
<p>[<a href="https://cryptobriefing.com/how-inflationary-should-cryptocurrency-be/" title="How Inflationary should 
Cryptocurrency really be? Andrew Ancheta">9</a>] Andrew Ancheta, &quot;How Inflationary should Cryptocurrency really be?&quot; [Online.]. 
Available: <a href="https://cryptobriefing.com/how-inflationary-should-cryptocurrency-be/">https://cryptobriefing.com/how-inflationary-should-cryptocurrency-be/</a>. Date accessed: 2018‑11‑06.</p>
<p>[<a href="https://web.archive.org/web/20180917125549/https://cryptoinsider.21mil.com/debtcoin-credit-debt-and-cryptocurrencies/" title="Debtcoin: Credit, Debt, 
and Cryptocurrencies, Landon Mutch">10</a>] L. Mutch, &quot;Debtcoin: Credit, Debt, and Cryptocurrencies&quot; [online]. 
Available: <a href="https://web.archive.org/web/20180917125549/https://cryptoinsider.21mil.com/debtcoin-credit-debt-and-cryptocurrencies/">https://web.archive.org/web/20180917125549/https://cryptoinsider.21mil.com/debtcoin-credit-debt-and-cryptocurrencies/</a>. 
Date accessed: 2018‑11‑06.</p>
<p>[<a href="https://blockonomi.com/bitcoin-deflation/" title="Inflation vs Deflation: 
A Guide to Bitcoin &amp; Cryptocurrencies 
Deflationary Nature, Brian Curran">11</a>] Brian Curran, &quot;Inflation vs Deflation: A Guide to Bitcoin &amp; Cryptocurrencies Deflationary Nature&quot; [online]. 
Available: <a href="https://blockonomi.com/bitcoin-deflation/">https://blockonomi.com/bitcoin-deflation/</a>. Date accessed: 2018‑11‑06.</p>
<p>[<a href="https://www.investopedia.com/articles/personal-finance/030915/why-deflation-bad-economy.asp" title="Why is Deflation Bad 
for the Economy? Adam Hayes">12</a>] A. Hayes, &quot;Why is Deflation Bad for the Economy?&quot; [Online.] 
Available: <a href="https://www.investopedia.com/articles/personal-finance/030915/why-deflation-bad-economy.asp">https://www.investopedia.com/articles/personal-finance/030915/why-deflation-bad-economy.asp</a>. 
Date accessed: 2018‑11‑06.</p>
<p>[<a href="https://www.nationalaffairs.com/publications/detail/inflation-and-debt" title="Inflation and Debt, 
John H. Cochrane">13</a>] J. H. Cochrane, &quot;Inflation and Debt&quot; [online]. 
Available: <a href="https://www.nationalaffairs.com/publications/detail/inflation-and-debt">https://www.nationalaffairs.com/publications/detail/inflation-and-debt</a>. Date accessed: 2018‑11‑07.</p>
<p>[<a href="https://medium.com/@Digix/think-piece-fighting-hyperinflation-with-cryptocurrencies-a08fe86bb66a" title="Think Piece: Fighting Hyperinflation 
with Cryptocurrencies, Lucia Ziyuan">14</a>] L. Ziyuan, &quot;Think Piece: Fighting Hyperinflation with Cryptocurrencies&quot; [online]. 
Available: <a href="https://medium.com/@Digix/think-piece-fighting-hyperinflation-with-cryptocurrencies-a08fe86bb66a">https://medium.com/@Digix/think-piece-fighting-hyperinflation-with-cryptocurrencies-a08fe86bb66a</a>. 
Date accessed: 2018‑11‑07.</p>
<p>[<a href="https://www.grin-forum.org/t/proof-of-work-update/713" title="Grin - Proof of Work Update">15</a>] &quot;Grin - Proof of Work Update&quot; [online]. Available: <a href="https://www.grin-forum.org/t/proof-of-work-update/713">https://www.grin-forum.org/t/proof-of-work-update/713</a>. 
Date accessed: 2018‑10‑15.</p>
<p>[<a href="https://www.grin-forum.org/t/meeting-notes-governance-sep-25-2018/874" title="Grin - Meeting Notes: 
Governance, Sep 25 2018">16</a>] &quot;Grin - Meeting Notes: Governance, Sep 25 2018&quot; [online]. 
Available: <a href="https://www.grin-forum.org/t/meeting-notes-governance-sep-25-2018/874">https://www.grin-forum.org/t/meeting-notes-governance-sep-25-2018/874</a>. Date accessed: 2018‑10‑15.</p>
<p>[<a href="https://github.com/tromp/cuckoo" title="Cuck(at)oo Cycle">17</a>] &quot;Cuck(at)oo Cycle&quot; [online]. Available: <a href="https://github.com/tromp/cuckoo">https://github.com/tromp/cuckoo</a>. Date accessed: 2018‑10‑15.</p>
<p>[<a href="https://www.investopedia.com/terms/1/51-attack.asp" title="51% Attack">18</a>] &quot;51% Attack&quot; [online]. Available: <a href="https://www.investopedia.com/terms/1/51-attack.asp">https://www.investopedia.com/terms/1/51-attack.asp</a>. Date accessed: 
2018‑10‑11.</p>
<p>[<a href="https://hackernoon.com/what-is-the-math-behind-elliptic-curve-cryptography-f61b25253da3" title="What is the Math behind 
Elliptic Curve Cryptography? Hans Knutson">19</a>] H. Knutson, &quot;What is the Math behind Elliptic Curve Cryptography?&quot; [Online.] 
Available: <a href="https://hackernoon.com/what-is-the-math-behind-elliptic-curve-cryptography-f61b25253da3">https://hackernoon.com/what-is-the-math-behind-elliptic-curve-cryptography-f61b25253da3</a>. 
Date accessed: 2018‑10‑14.</p>
<p>[<a href="http://www.secg.org/" title="Standards for Efficient 
Cryptography Group">20</a>] &quot;Standards for Efficient Cryptography Group&quot; [online]. Available: <a href="http://www.secg.org/">http://www.secg.org/</a>. Date accessed: 
2018‑10‑11.</p>
<p>[<a href="https://en.bitcoin.it/wiki/Secp256k1" title="Secp256k1">21</a>] &quot;Secp256k1&quot; [online]. Available: <a href="https://en.bitcoin.it/wiki/Secp256k1">https://en.bitcoin.it/wiki/Secp256k1</a>. Date accessed: 2018‑10‑15.</p>
<p>[<a href="https://www.grin-forum.org/t/schnorr-signatures-in-grin-information/730" title="Grin - Schnorr Signatures 
in Grin &amp; Information">22</a>] &quot;Grin - Schnorr Signatures in Grin &amp; Information&quot; [online]. 
Available: <a href="https://www.grin-forum.org/t/schnorr-signatures-in-grin-information/730">https://www.grin-forum.org/t/schnorr-signatures-in-grin-information/730</a>. Date accessed: 
2018‑10‑08.</p>
<p>[<a href="http://safecurves.cr.yp.to/disc.html" title="SafeCurves - CM Field Discriminants">23</a>] &quot;SafeCurves - CM Field Discriminants&quot; [online]. Available: <a href="http://safecurves.cr.yp.to/disc.html">http://safecurves.cr.yp.to/disc.html</a>. 
Date accessed: 2018‑10‑15.</p>
<p>[<a href="https://cr.yp.to/ecdh/curve25519-20060209.pdf" title="Curve25519: New Diffie-Hellman 
Speed Records, Daniel J. Bernstein">24</a>] D. J. Bernstein, &quot;Curve25519: New Diffie-Hellman Speed Records&quot; [online]. 
Available: <a href="https://cr.yp.to/ecdh/curve25519-20060209.pdf">https://cr.yp.to/ecdh/curve25519-20060209.pdf</a>. Date accessed: 2018‑10‑15.</p>
<p>[<a href="http://safecurves.cr.yp.to/" title="SafeCurves - Choosing Safe Curves 
for Elliptic-curve Cryptography">25</a>] &quot;SafeCurves - Choosing Safe Curves for Elliptic-curve Cryptography&quot; [online]. 
Available: <a href="http://safecurves.cr.yp.to/">http://safecurves.cr.yp.to/</a>. Date accessed: 2018‑10‑10.</p>
<p>[<a href="https://rocksdb.org/" title="RocksDB">26</a>] &quot;RocksDB&quot; [online]. Available: <a href="https://rocksdb.org/">https://rocksdb.org/</a>. Date accessed: 2018‑10‑10.</p>
<p>[<a href="https://web.archive.org/web/20180917125549/https://cryptoinsider.21mil.com/debtcoin-credit-debt-and-cryptocurrencies/" title="LevelDB">27</a>] &quot;LevelDB&quot; [online]. Available: 
<a href="https://web.archive.org/web/20180917125549/https://cryptoinsider.21mil.com/debtcoin-credit-debt-and-cryptocurrencies/">https://web.archive.org/web/20180917125549/https://cryptoinsider.21mil.com/debtcoin-credit-debt-and-cryptocurrencies/</a>. 
Date accessed: 2018‑10‑15.</p>
<p>[<a href="http://hyperdex.org/" title="HyperLevelDB">28</a>] &quot;HyperLevelDB&quot; [online]. Available: <a href="http://hyperdex.org/">http://hyperdex.org/</a>. Date accessed: 2018‑10‑15.</p>
<p>[<a href="https://github.com/LMDB" title="LMDB">29</a>] &quot;LMDB&quot; [online]. Available: <a href="https://github.com/LMDB">https://github.com/LMDB</a>. Date accessed: 2018‑10‑29.</p>
<p>[<a href="https://www.influxdata.com/blog/benchmarking-leveldb-vs-rocksdb-vs-hyperleveldb-vs-lmdb-performance-for-influxdb/" title="Benchmarking LevelDB vs. RocksDB 
vs. HyperLevelDB vs. LMDB 
Performance for InfluxDB, Paul Dix">30</a>] P. Dix, &quot;Benchmarking LevelDB vs. RocksDB vs. HyperLevelDB vs. LMDB Performance for InfluxDB&quot; [online]. Available: 
<a href="https://www.influxdata.com/blog/benchmarking-leveldb-vs-rocksdb-vs-hyperleveldb-vs-lmdb-performance-for-influxdb/">https://www.influxdata.com/blog/benchmarking-leveldb-vs-rocksdb-vs-hyperleveldb-vs-lmdb-performance-for-influxdb/</a> 
Date accessed: 2018‑10‑15.</p>
<p>[<a href="https://github.com/lmdbjava/benchmarks/blob/master/results/20160630/README.md" title="Lmdbjava - Benchmarks, Ben Alex">31</a>] B. Alex, &quot;Lmdbjava - Benchmarks&quot; [online]. 
Available: <a href="https://github.com/lmdbjava/benchmarks/blob/master/results/20160630/README.md">https://github.com/lmdbjava/benchmarks/blob/master/results/20160630/README.md</a>. Date accessed: 
2018‑10‑14.</p>
<p>[<a href="https://www.linkedin.com/pulse/lies-damn-statistics-benchmarks-howard-chu" title="Lies, Damn Lies, Statistics, 
and Benchmarks, Howard Chu">32</a>] H. Chu, &quot;Lies, Damn Lies, Statistics, and Benchmarks&quot; [online]. 
Available: <a href="https://www.linkedin.com/pulse/lies-damn-statistics-benchmarks-howard-chu">https://www.linkedin.com/pulse/lies-damn-statistics-benchmarks-howard-chu</a>. Date accessed: 
2018‑10‑29.</p>
<p>[<a href="http://www.lmdb.tech/bench/hyperdex/" title="HyperDex Benchmark, Symas Corp">33</a>] &quot;HyperDex Benchmark, Symas Corp&quot; [online]. Available: <a href="http://www.lmdb.tech/bench/hyperdex/">http://www.lmdb.tech/bench/hyperdex/</a>. 
Date accessed: 2018‑10‑29.</p>
<p>[<a href="https://www.grin-forum.org/t/yeastplume-progress-update-thread-may-sept-2018/361/12" title="Progress Update May - Sep 2018, Yeastplume">34</a>] Yeastplume, &quot;Progress Update May - Sep 2018&quot;  [online]. 
Available: <a href="https://www.grin-forum.org/t/yeastplume-progress-update-thread-may-sept-2018/361/12">https://www.grin-forum.org/t/yeastplume-progress-update-thread-may-sept-2018/361/12</a>. 
Date accessed: 2018‑10‑28.</p>
<h2><a class="header" href="#contributors-16" id="contributors-16">Contributors</a></h2>
<ul>
<li><a href="https://github.com/neonknight64">https://github.com/neonknight64</a></li>
<li><a href="https://github.com/hansieodendaal">https://github.com/hansieodendaal</a></li>
<li><a href="https://github.com/SWvheerden">https://github.com/SWvheerden</a></li>
<li><a href="https://github.com/philipr-za">https://github.com/philipr-za</a></li>
<li><a href="https://github.com/kim0">https://github.com/kim0</a></li>
<li><a href="https://github.com/anselld">https://github.com/anselld</a></li>
</ul>
<h1><a class="header" href="#atomic-swaps-1" id="atomic-swaps-1">Atomic Swaps</a></h1>
<ul>
<li><a href="protocols/atomic-swaps/AtomicSwaps.html#what-are-atomic-swaps">What are Atomic Swaps?</a></li>
<li><a href="protocols/atomic-swaps/AtomicSwaps.html#hashed-timelock-contracts">Hashed Timelock Contracts</a></li>
<li><a href="protocols/atomic-swaps/AtomicSwaps.html#atomic-vs-etomic-swaps">Atomic vs. Etomic Swaps</a></li>
<li><a href="protocols/atomic-swaps/AtomicSwaps.html#examples-of-current-atomic-swaps-and-implementations">Examples of Current Atomic Swaps and Implementations</a>
<ul>
<li><a href="protocols/atomic-swaps/AtomicSwaps.html#1-manual-method">#1 Manual Method</a></li>
<li><a href="protocols/atomic-swaps/AtomicSwaps.html#2-atomic-wallet">#2 Atomic Wallet</a></li>
<li><a href="protocols/atomic-swaps/AtomicSwaps.html#3-barterdex">#3 BarterDEX</a></li>
<li><a href="protocols/atomic-swaps/AtomicSwaps.html#4-comit">#4 COMIT</a></li>
</ul>
</li>
<li><a href="protocols/atomic-swaps/AtomicSwaps.html#references">References</a></li>
<li><a href="protocols/atomic-swaps/AtomicSwaps.html#contributors">Contributors</a></li>
</ul>
<h2><a class="header" href="#what-are-atomic-swaps" id="what-are-atomic-swaps">What are Atomic Swaps?</a></h2>
<p>Atomic swaps or cross-chain atomic swaps [<a href="https://coinsutra.com/atomic-swap/" title="What is Atomic Swap and Why it Matters?">1</a>], in a nutshell, are decentralized 
exchanges, but only for cryptocurrencies. They allow multiple parties to exchange two different crypto currencies in a 
trustless environment. If one party defaults or fails the transaction, neither party can &quot;run off&quot; with anyone's 
money. For this to work, we will require two technologies: a payment channel and hashed timelock contracts. An 
implementation of a payment channel is the lightning network. </p>
<h2><a class="header" href="#hashed-timelock-contracts" id="hashed-timelock-contracts">Hashed Timelock Contracts</a></h2>
<p>Hashed Timelock Contracts (HTLC) [<a href="https://hackernoon.com/what-are-hashed-timelock-contracts-htlcs-application-in-lightning-network-payment-channels-14437eeb9345" title="What are Hashed Timelock Contracts (HTLCs)? Application in Lightning Network &amp; Payment Channels">2</a>] is one of the most important technologies required for atomic swaps. This is a 
payment class that uses hashlocks and timelocks to require certain public knowledge before making a payment, otherwise 
the payment is reversed. HTLCs are also 
crucial in the lighting network [<a href="https://lightning.network/lightning-network-paper.pdf" title="The Bitcoin Lightning Network: Scalable Off-chain Instant Payments v0.5.9.2">3</a>]. </p>
<p>Here is a quick example of how an HTLC works:</p>
<p><img src="protocols/atomic-swaps/sources/Characters.png" alt="alt" /></p>
<p>In this example, Alex wants to pay Carla, but he does not have an open payment channel to Carla. However, he does have an 
open channel to Bart, who does have an open channel to Carla. </p>
<ol>
<li>Carla generates a random number and gives the hash of the number to Alex. </li>
<li>Alex pays Bart, but adds the condition that if Bart wants to claim the payment, he has to provide the random number 
that generated the hash Carla gave to Alex. </li>
<li>Bart pays Carla, but he adds the same condition to the payment. </li>
<li>Carla claims the payment by providing the random number, thus exposing the random number to Bart. </li>
<li>Bart uses the random number to claim the payment from Alex. </li>
</ol>
<p>If the payment to Carla does not go through, the timelock in the contract will reverse all transactions. </p>
<h2><a class="header" href="#atomic-vs-etomic-swaps" id="atomic-vs-etomic-swaps">Atomic vs. Etomic Swaps</a></h2>
<p>For an atomic swap transaction to happen, both cryptocurrencies must use the same hashing function, as this is crucial 
for HTLC to function. Etomic swaps were created in an attempt to make atomic swaps happen between Bitcoin tokens and 
Ethereum-based tokens. </p>
<h2><a class="header" href="#examples-of-current-atomic-swaps-and-implementations" id="examples-of-current-atomic-swaps-and-implementations">Examples of Current Atomic Swaps and Implementations</a></h2>
<h3><a class="header" href="#1-manual-method" id="1-manual-method">#1 Manual Method</a></h3>
<p>An article was posted on Hackernoon [<a href="https://hackernoon.com/so-how-do-i-really-do-an-atomic-swap-f797852c7639" title="So how do I really do an Atomic Swap">4</a>] 
giving the exact steps that are required for doing an atomic swap using cli. The requirements for this method are:</p>
<ul>
<li>Full nodes on both parties.</li>
<li>Atomic swap package [<a href="https://github.com/viacoin/atomicswap" title="viacoin/atomicswap">5</a>].</li>
<li>Use of supported coins (UXTO-based protocol coins, e.g. Bitcoin, Litecoin and Viacoin).</li>
<li>Power user.</li>
</ul>
<h3><a class="header" href="#2-atomic-wallet" id="2-atomic-wallet">#2 Atomic Wallet</a></h3>
<p>Atomic Wallet [<a href="https://atomicwallet.io/" title="Atomic Wallet">6</a>] is an atomic swap exchange. It allows two parties to trade with it as 
a third party. The process is as follows:</p>
<ol>
<li>Party A selects an order from the BitTorrent order book.</li>
<li>Party A enters an amount of coin to swap or coin to receive.</li>
<li>Party A confirms the swap.</li>
<li>Party B receives notification.</li>
<li>Party B confirms the swap.</li>
<li>Party A and Party B's Atomic Wallets check the contracts.</li>
<li>Both parties receive their coins.</li>
</ol>
<h3><a class="header" href="#3-barterdex" id="3-barterdex">#3 BarterDEX</a></h3>
<p>BarterDEX is a decentralized exchange created by Komodo [<a href="https://komodoplatform.com/decentralized-exchange/" title="BarterDEX">7</a>], but 
it works with electron servers or native. BarterDEX at its core is more like an auction system than a true decentralized 
exchange. It also uses a security deposit in the form of Zcredits to do swaps without waiting for confirmation.</p>
<p>BarterDEX also supports Etomic swaps. These work by keeping the payments locked in an etomic blockchain that will act 
as a third party. Although swaps have been done, it is stated as not yet being production ready [<a href="https://github.com/artemii235/etomic-swap" title="etomic-swap">8</a>]. Currently 
(July 2018), it is only possible to use Barterdex out of the Command Line Interface (CLI) [<a href="https://github.com/KomodoPlatform/KomodoPlatform/wiki/Installing-and-Using-Komodo-Platform-(barterDEX" title="Barterdex">9</a>]. Barterdex charges 
a 0.1287% fee for a swap [<a href="https://github.com/KomodoPlatform/KomodoPlatform/wiki/barterDEX-Whitepaper-v2" title="barterDEX Whitepaper v2">10</a>]. </p>
<h3><a class="header" href="#4-comit" id="4-comit">#4 COMIT</a></h3>
<p>Cryptographically-secure Off-chain Multi-asset Instant Transaction (COMIT) is an open-source protocol for 
cross-blockchain applications, like peer-to-peer atomic swaps, and does not feature another blockchain nor token. It 
is powered by simple cryptographic principles such as HTLCs and enables users to trustlessly exchange one digital asset 
to another. Its specification, reference implementation in Rust, JavaScript Software Development Kit (SDK), CLI and web 
Graphical User Interface (GUI) are available on GitHub. At the time of writing, October 2019, COMIT supports 
assets from the Bitcoin blockchain (e.g. BTC) and from the Ethereum blockchain (e.g. ETH and ERC20 tokens) 
([<a href="https://github.com/comit-network" title="GitHub: comit-network">11</a>, [<a href="https://blog.coblox.tech/2018/06/23/connect-all-the-blockchains.html" title="CoBloX Connect all the Blockchains!!!">12</a>], [<a href="https://comit.network/" title="COMIT Website">13</a>]). </p>
<h2><a class="header" href="#references-24" id="references-24">References</a></h2>
<p>[<a href="https://coinsutra.com/atomic-swap/" title="What is Atomic Swap and Why it Matters?">1</a>] S. Khatwani (2018), &quot;What is Atomic Swap and Why it Matters?&quot; <em>Coinsutra</em>. [Online.] 
Available: <a href="https://coinsutra.com/atomic-swap/">https://coinsutra.com/atomic-swap/</a>. Date accessed: 2018‑07‑12.</p>
<p>[<a href="https://hackernoon.com/what-are-hashed-timelock-contracts-htlcs-application-in-lightning-network-payment-channels-14437eeb9345" title="What are Hashed Timelock Contracts (HTLCs)? Application in Lightning Network &amp; Payment Channels">2</a>] A. Vohra (2016), &quot;What are Hashed Timelock Contracts (HTLCs)? Application in Lightning Network &amp; Payment Channels&quot;, 
<em>Hackernoon</em> [online] Available: <a href="https://hackernoon.com/what-are-hashed-timelock-contracts-htlcs-application-in-lightning-network-payment-channels-14437eeb9345">https://hackernoon.com/what-are-hashed-timelock-contracts-htlcs-application-in-lightning-network-payment-channels-14437eeb9345</a>. 
Date accessed: 2018‑07‑12.</p>
<p>[<a href="https://lightning.network/lightning-network-paper.pdf" title="The Bitcoin Lightning Network: Scalable Off-chain Instant Payments v0.5.9.2">3</a>] J. Poon and T. Dryja (2016), &quot;The Bitcoin Lightning Network: Scalable Off-chain Instant Payments v0.5.9.2&quot; [online]. 
Available: <a href="https://lightning.network/lightning-network-paper.pdf">https://lightning.network/lightning-network-paper.pdf</a>. Date accessed: 2018‑07‑13.</p>
<p>[<a href="https://hackernoon.com/so-how-do-i-really-do-an-atomic-swap-f797852c7639" title="So how do I really do an Atomic Swap">4</a>] Hotshot (2018), &quot;So how do I really do an Atomic Swap&quot;, <em>Hackernoon</em> [online] 
Available: <a href="https://hackernoon.com/so-how-do-i-really-do-an-atomic-swap-f797852c7639">https://hackernoon.com/so-how-do-i-really-do-an-atomic-swap-f797852c7639</a>. Date accessed: 2018‑07‑13.</p>
<p>[<a href="https://github.com/viacoin/atomicswap" title="viacoin/atomicswap">5</a>] Open Source (ISC) (2018), &quot;viacoin/atomicswap&quot;, GitHub [online]. Available: <a href="https://github.com/viacoin/atomicswap">https://github.com/viacoin/atomicswap</a>. 
Date accessed: 2018‑07‑13.</p>
<p>[<a href="https://atomicwallet.io/" title="Atomic Wallet">6</a>] Atomic (2018), &quot;Atomic Wallet&quot; [online]. Available: <a href="https://atomicwallet.io/">https://atomicwallet.io/</a>. Date accessed: 2018‑07‑13.</p>
<p>[<a href="https://komodoplatform.com/decentralized-exchange/" title="BarterDEX">7</a>] Komodo (2018), &quot;BarterDEX&quot; [online]. Available: <a href="https://komodoplatform.com/decentralized-exchange/">https://komodoplatform.com/decentralized-exchange/</a>. 
Date accessed: 2018‑07‑13.</p>
<p>[<a href="https://github.com/artemii235/etomic-swap" title="etomic-swap">8</a>] Artemii235 (2018), &quot;etomic-swap&quot;, GitHub [online]. Available: <a href="https://github.com/artemii235/etomic-swap">https://github.com/artemii235/etomic-swap</a>.
Date accessed: 2018‑07‑13.</p>
<p>[<a href="https://github.com/KomodoPlatform/KomodoPlatform/wiki/Installing-and-Using-Komodo-Platform-(barterDEX" title="Barterdex">9</a>] Komodo (2018), &quot;Barterdex&quot;, GitHub [online]. Available:
<a href="https://github.com/KomodoPlatform/KomodoPlatform/wiki/Installing-and-Using-Komodo-Platform-(barterDEX">https://github.com/KomodoPlatform/KomodoPlatform/wiki/Installing-and-Using-Komodo-Platform-(barterDEX</a>. 
Date accessed: 2018‑07‑13.</p>
<p>[<a href="https://github.com/KomodoPlatform/KomodoPlatform/wiki/barterDEX-Whitepaper-v2" title="barterDEX Whitepaper v2">10</a>] Komodo and S. Hossain (2017), &quot;barterDEX Whitepaper v2&quot; [online]. 
Available: <a href="https://github.com/KomodoPlatform/KomodoPlatform/wiki/barterDEX-Whitepaper-v2">https://github.com/KomodoPlatform/KomodoPlatform/wiki/barterDEX-Whitepaper-v2</a>. Date accessed: 2018‑07‑13.</p>
<p>[<a href="https://github.com/comit-network" title="GitHub: comit-network">11</a>] GitHub: &quot;comit-network, COMIT is an open protocol facilitating trustless cross-blockchain applications.&quot; 
[online]. Available: <a href="https://github.com/comit-network">https://github.com/comit-network</a>. Date accessed: 2019‑10‑16.</p>
<p>[<a href="https://blog.coblox.tech/2018/06/23/connect-all-the-blockchains.html" title="CoBloX Connect all the Blockchains!!!">12</a>] CoBloX (2018), &quot;Connect all the Blockchains!!!&quot; [online] Available: 
<a href="https://blog.coblox.tech/2018/06/23/connect-all-the-blockchains.html/">https://blog.coblox.tech/2018/06/23/connect-all-the-blockchains.html/</a>. Date accessed: 2019‑10‑16.</p>
<p>[<a href="https://comit.network/" title="COMIT Website">13</a>] &quot;COMIT is an open protocol facilitating trustless cross-blockchain applications&quot; [online]
Available: <a href="https://comit.network/">https://comit.network/</a>. Date accessed: 2019‑10‑16.</p>
<h2><a class="header" href="#contributors-17" id="contributors-17">Contributors</a></h2>
<ul>
<li><a href="https://github.com/SWvheerden">https://github.com/SWvheerden</a></li>
<li><a href="https://github.com/anselld">https://github.com/anselld</a></li>
<li><a href="https://github.com/bonomat">https://github.com/bonomat</a></li>
</ul>
<h1><a class="header" href="#lightning-network-for-dummies" id="lightning-network-for-dummies">Lightning Network for Dummies</a></h1>
<iframe width=750 height=600 src="https://gitpitch.com/tari-labs/tari-university/master?p=/src/protocols/lightning-network-for-dummies#/"></iframe>
<h3><a class="header" href="#having-trouble-viewing-this-presentation-5" id="having-trouble-viewing-this-presentation-5">Having trouble viewing this presentation?</a></h3>
<p>View it in a <a href="https://gitpitch.com/tari-labs/tari-university/master?p=/src/protocols/lightning-network-for-dummies#/">separate window</a>.</p>
<h1><a class="header" href="#introduction-to-spv-merkle-trees-and-bloom-filters" id="introduction-to-spv-merkle-trees-and-bloom-filters">Introduction to SPV, Merkle Trees and Bloom Filters</a></h1>
<iframe width=750 height=600 src="https://gitpitch.com/tari-labs/tari-university/master?p=/src/protocols/merkle-trees-and-spv-1#/"></iframe>
<h3><a class="header" href="#having-trouble-viewing-this-presentation-6" id="having-trouble-viewing-this-presentation-6">Having trouble viewing this presentation?</a></h3>
<p>View it in a <a href="https://gitpitch.com/tari-labs/tari-university/master?p=/src/protocols/merkle-trees-and-spv-1#/">separate window</a>.</p>
<h1><a class="header" href="#the-rgb-protocol---an-introduction" id="the-rgb-protocol---an-introduction">The RGB Protocol - An Introduction</a></h1>
<iframe width=750 height=600 src="https://gitpitch.com/tari-labs/tari-university/master?p=/src/protocols/rgb-introduction#/"></iframe>
<h3><a class="header" href="#having-trouble-viewing-this-presentation-7" id="having-trouble-viewing-this-presentation-7">Having trouble viewing this presentation?</a></h3>
<p>View it in a <a href="https://gitpitch.com/tari-labs/tari-university/master?p=/src/protocols/rgb-introduction#/">separate window</a>.</p>
<h1><a class="header" href="#introduction-to-tor-and-i2p" id="introduction-to-tor-and-i2p">Introduction to Tor and I2P</a></h1>
<ul>
<li><a href="protocols/intro-to-tor-i2P/MainReport.html#introduction">Introduction</a></li>
<li><a href="protocols/intro-to-tor-i2P/MainReport.html#i2p-network">I2P Network</a>
<ul>
<li><a href="protocols/intro-to-tor-i2P/MainReport.html#what-is-i2p">What is I2P?</a></li>
<li><a href="protocols/intro-to-tor-i2P/MainReport.html#how-does-i2p-work">How does I2P Work?</a></li>
<li><a href="protocols/intro-to-tor-i2P/MainReport.html#i2p-infrastructure">I2P Infrastructure</a>
<ul>
<li><a href="protocols/intro-to-tor-i2P/MainReport.html#routing-infrastructure-and-anonymity">Routing Infrastructure and Anonymity</a></li>
<li><a href="protocols/intro-to-tor-i2P/MainReport.html#distributed-network-database">Distributed Network Database</a></li>
<li><a href="protocols/intro-to-tor-i2P/MainReport.html#floodfill-routers">Floodfill Routers</a></li>
<li><a href="protocols/intro-to-tor-i2P/MainReport.html#garlic-routing">Garlic Routing</a></li>
</ul>
</li>
<li><a href="protocols/intro-to-tor-i2P/MainReport.html#i2p-threats-security-and-vulnerability">I2P Threats, Security and Vulnerability</a>
<ul>
<li><a href="protocols/intro-to-tor-i2P/MainReport.html#sybil-attacks">Sybil Attacks</a></li>
<li><a href="protocols/intro-to-tor-i2P/MainReport.html#eclipse-attacks">Eclipse Attacks</a></li>
<li><a href="protocols/intro-to-tor-i2P/MainReport.html#brute-force-attacks">Brute Force Attacks</a></li>
<li><a href="protocols/intro-to-tor-i2P/MainReport.html#intersection-attacks">Intersection Attacks</a></li>
<li><a href="protocols/intro-to-tor-i2P/MainReport.html#denial-of-service-attacks">Denial of Service Attacks</a>
<ul>
<li><a href="protocols/intro-to-tor-i2P/MainReport.html#greedy-user-attack">Greedy User Attack</a></li>
<li><a href="protocols/intro-to-tor-i2P/MainReport.html#starvation-attack">Starvation Attack</a></li>
<li><a href="protocols/intro-to-tor-i2P/MainReport.html#flooding-attack">Flooding Attack</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="protocols/intro-to-tor-i2P/MainReport.html#tor-network">Tor Network</a>
<ul>
<li><a href="protocols/intro-to-tor-i2P/MainReport.html#what-is-tor">What is Tor?</a></li>
<li><a href="protocols/intro-to-tor-i2P/MainReport.html#how-does-tor-work">How does Tor Work</a></li>
<li><a href="protocols/intro-to-tor-i2P/MainReport.html#how-does-onion-routing-work">How does Onion Routing Work?</a></li>
<li><a href="protocols/intro-to-tor-i2P/MainReport.html#types-of-tor-relaysnodes-routing">Types of Tor Relays/Nodes Routing</a>
<ul>
<li><a href="protocols/intro-to-tor-i2P/MainReport.html#guard-or-entry-relay-non-exit-relay-nodes">Guard or Entry Relay (Non-exit Relay) Nodes</a></li>
<li><a href="protocols/intro-to-tor-i2P/MainReport.html#middle-relay-nodes">Middle Relay Nodes</a></li>
<li><a href="protocols/intro-to-tor-i2P/MainReport.html#exit-relay-nodes">Exit Relay Nodes</a></li>
<li><a href="protocols/intro-to-tor-i2P/MainReport.html#bridge-relay-nodes">Bridge Relay Nodes</a></li>
</ul>
</li>
<li><a href="protocols/intro-to-tor-i2P/MainReport.html#pitfalls-of-using-tor-anonymously---is-it-broken">Pitfalls of Using Tor Anonymously - is it Broken?</a></li>
<li><a href="protocols/intro-to-tor-i2P/MainReport.html#advantages-and-disadvantages">Advantages and Disadvantages</a></li>
</ul>
</li>
<li><a href="protocols/intro-to-tor-i2P/MainReport.html#differences-between-i2p-and-tor">Differences between I2P and Tor</a></li>
<li><a href="protocols/intro-to-tor-i2P/MainReport.html#conclusion">Conclusion</a></li>
<li><a href="protocols/intro-to-tor-i2P/MainReport.html#references">References</a></li>
<li><a href="protocols/intro-to-tor-i2P/MainReport.html#appendices">Appendices</a>
<ul>
<li><a href="protocols/intro-to-tor-i2P/MainReport.html#appendix-a-tor-further-investigation">Appendix A: Tor Further Investigation</a></li>
<li><a href="protocols/intro-to-tor-i2P/MainReport.html#appendix-b-tor-links-of-interest">Appendix B: Tor Links of Interest</a></li>
</ul>
</li>
<li><a href="protocols/intro-to-tor-i2P/MainReport.html#contributors">Contributors</a></li>
</ul>
<h2><a class="header" href="#introduction-14" id="introduction-14">Introduction</a></h2>
<p>Invisible Internet Project (I2P), Tor and Virtual Private Networks (VPNs) are well-known anonymity networks. They are all 
designed in different ways and for specific uses, although most people use them with the intent of privately browsing the 
Internet. These network functions have very similar characteristics, but also have important differentiators 
in how they work to anonymize and secure users' Internet traffic.</p>
<p>In this report we'll examine what Tor and the I2P networks are, the paradigms of how they work, their security 
infrastructure and their potential or known use-cases in the blockchain domain.</p>
<h2><a class="header" href="#i2p-network" id="i2p-network">I2P Network</a></h2>
<h3><a class="header" href="#what-is-i2p" id="what-is-i2p">What is I2P?</a></h3>
<p>I2P (known as the Invisible Internet Project - founded in 2003) is a low-latency network layer that runs on a distributed 
network of computers across the globe. It is primarily built into applications such as email, Internet Relay Chat (IRC) 
and file sharing [<a href="https://delaat.net/rp/2017-2018/p97/report.pdf" title="Blockchain-based Sybil 
Attack Mitigation: 
A Case Study of the 
I2P Network">6</a>]. I2P works by automatically making each client in the network a node, through which data and 
traffic are routed. These nodes are responsible for providing encrypted, one-way connections to and from other computers 
within the network. </p>
<h3><a class="header" href="#how-does-i2p-work" id="how-does-i2p-work">How does I2P Work?</a></h3>
<p>I2P is an enclosed network that runs within the Internet infrastructure (referred to as the clearnet in this paradigm). 
Unlike VPNs and Tor, which are inherently &quot;outproxy&quot; networks designed for anonymous and private communication with the 
Internet, I2P is designed as a peer-to-peer network. This means it has very little to no communication with the 
Internet. It also means each node in I2P is not identified with an Internet Protocol (IP) address, but with a 
cryptographic identifier ([<a href="https://blokt.com/guides/what-is-i2p-vs-tor-browser#How_does_I2P_work" title="What Is I2P &amp; 
How Does It Compare vs. 
Tor Browser?">1</a>], [<a href="https://geti2p.net/en/docs/api/i2ptunnel" title="I2PTunnel">2</a>]). A node in the I2P network can be either a server that hosts a darknet service 
(similar to a website on the Internet), or a client who accesses the servers and services hosted by other nodes [<a href="https://delaat.net/rp/2017-2018/p97/report.pdf" title="Blockchain-based Sybil 
Attack Mitigation: 
A Case Study of the 
I2P Network">6</a>]. 
Tor, on the other hand, works by using a group of volunteer-operated relay servers/nodes that allow people to privately 
and securely access the Internet. This means people can choose to volunteer as a relay node in the network and hence 
donate bandwidth [<a href="https://2019.www.torproject.org/about/overview.html.en" title="Tor Project: How it works">13</a>]. Compared to Tor, each client/server in I2P is automatically a relay node. Whether data is 
routed through a specific node is normally bandwidth dependent. </p>
<p>Since there is no Internet in I2P, the network is made up of its own anonymous and hidden sites, called <strong>eepsites</strong>. 
These exist only within the network and are only accessible to people using I2P. Services such as <strong>I2PTunnel</strong>, 
which use a standard web server, can be used to create such sites.</p>
<h3><a class="header" href="#i2p-infrastructure" id="i2p-infrastructure">I2P Infrastructure</a></h3>
<h4><a class="header" href="#routing-infrastructure-and-anonymity" id="routing-infrastructure-and-anonymity">Routing Infrastructure and Anonymity</a></h4>
<p>I2P works by installing an I2P routing service within a client's device. This router creates temporary, encrypted, 
one-way connections with I2P routers on other devices. Connections are referred to as one way because they are made up 
of an <em>Outbound Tunnel</em> and an <em>Inbound Tunnel</em>. During any communication, data leaves the client's devices via the 
outbound tunnels and is received on other devices through their inbound tunnels. This means that messages do not 
travel in two directions within the same tunnel. Therefore, a single round-trip request message and its response between 
two parties needs four tunnels [<a href="https://censorbib.nymity.ch/pdf/Hoang2018a.pdf" title="An Empirical Study 
of the I2P Anonymity 
Network and its
Censorship Resistance">4</a>], as shown in Figure 1. Messages sent from one device do not travel directly to 
the inbound tunnel of the destination device. Instead, the outbound router queries a distributed network database for 
the corresponding address of the inbound router. This database is comprised of a custom Kademlia-style Distributed Hash 
Table (DHT) that contains the router information and destination information. For each application or client, the I2P 
router keeps a pool of tunnel pairs. Exploratory tunnels for interactions with the network database are shared among all 
users of a router. If a tunnel in the pool is about to expire or if the tunnel is no longer usable, the router creates a 
new tunnel and adds it to the pool. It is important to recall later that tunnels periodically expire every 10 minutes, 
and thus need to be refreshed frequently. This is one of I2P's security measures that are performed to prevent 
long-lived tunnels from becoming a threat to anonymity [<a href="https://sites.cs.ucsb.edu/%7Echris/research/doc/raid13_i2p.pdf" title="Practical Attacks Against
the I2P Network">3</a>].</p>
<p align="center"><a name="fig_eca"> </a><img src="protocols/intro-to-tor-i2P/assets/network-topology.png" width="950" /></p>
<p align="center"><b>Figure&nbsp;1: Network Topology [<a href="https://www.delaat.net/rp/2017-2018/p97/presentation.pdf" title="Network Topology">6</a>]</b></p> 
<h4><a class="header" href="#distributed-network-database" id="distributed-network-database">Distributed Network Database</a></h4>
<p>The Network Database (NetDB) is implemented as a DHT and is propagated via nodes known as 
floodfill routers using the Kademlia protocol. The NetDB is one of the characteristics that make I2P decentralized. 
To start participating in the network, a router installs a part of the NetDB. Obtaining the partial NetDB is called 
bootstrapping and happens by 'reseeding’ the router. By default, a router will reseed the first time by querying some 
bootstrapped domain names. When a router successfully establishes a connection to one of these domains, a Transport 
Layer Security (TLS) connection is set up through which the router downloads a signed partial copy of the NetDB. Once 
the router can reach at least one other participant in the network, the router will query for other parts of the NetDB 
it does not have itself [<a href="https://www.delaat.net/rp/2018-2019/p63/report.pdf" title="Invisible Internet Project - MSc Security and Network Engineering Research Project">12</a>].</p>
<p>The NetDB stores two types of data: </p>
<ol>
<li>
<p><strong>RouterInfo.</strong>
When a message is leaving one router, it needs to know some key pieces of data (known as <em>RouterInfo</em>) about the 
other router. The destination RouterInfo is stored in the NetDB with the router's identity as the key. To request a 
resource (or RouterInfo), a client requests the desired key from the node considered to be closest to the key. If 
the piece of data is located at the node, it is returned to the client. Otherwise, the node uses its local knowledge 
of participating nodes and returns the node it considers to be nearest to the key [<a href="https://sites.cs.ucsb.edu/%7Echris/research/doc/raid13_i2p.pdf" title="Practical Attacks Against
the I2P Network">3</a>]. The RouterInfo in the NetDB 
is made up of ([<a href="https://censorbib.nymity.ch/pdf/Hoang2018a.pdf" title="An Empirical Study 
of the I2P Anonymity 
Network and its
Censorship Resistance">4</a>], [<a href="https://delaat.net/rp/2017-2018/p97/report.pdf" title="Blockchain-based Sybil 
Attack Mitigation: 
A Case Study of the 
I2P Network">6</a>]):</p>
<ul>
<li>The router's identity - an encryption key, a signing key and a certificate.</li>
<li>The contact addresses at which it can be reached - protocol, IP and port.</li>
<li>When this was created or published.</li>
<li>Options - a set of arbitrary text options, e.g. bandwidth of router.</li>
<li>The signature of the above, generated by the identity's signing key.</li>
</ul>
</li>
<li>
<p><strong>LeaseSets.</strong> 
The LeaseSet specifies a tunnel entry point to reach an endpoint. This specifies the routers that can directly 
contact the desired destination. It contains the following data:</p>
<ul>
<li>Tunnel gateway router - given by specifying its identity.</li>
<li>Tunnel ID - tunnel used to send messages.</li>
<li>Tunnel expiration - when the tunnel will expire.</li>
<li>Destination itself - similar to router identity.</li>
<li>Signature - used to verify the LeaseSet.</li>
</ul>
</li>
</ol>
<h4><a class="header" href="#floodfill-routers" id="floodfill-routers">Floodfill Routers</a></h4>
<p>Special routers, referred to as <em>floodfill routers</em>, are responsible for storing the NetDB. Participation in the floodfill 
pool can be automatic or manual. Automatic participation occurs whenever the number of floodfill routers drops below a 
certain threshold, which is currently 6% of all nodes in the network ([<a href="https://delaat.net/rp/2017-2018/p97/report.pdf" title="Blockchain-based Sybil 
Attack Mitigation: 
A Case Study of the 
I2P Network">6</a>], [<a href="https://geti2p.net/en/docs/how/network-database" title="The Network Database">7</a>]). When this happens, a node is 
selected to participate as a floodfill router based on criteria such as uptime and bandwidth. It should be noted that 
approximately 95% of floodfill routers are automatic [<a href="http://ijsetr.org/wp-content/uploads/2015/05/IJSETR-VOL-4-ISSUE-5-1515-1518.pdf" title="Defending Eclipse Attack 
in I2P using Structured
Overlay Network">8</a>]. The NetDB is stored in a DHT format within the floodfill 
routers. A resource is requested from the floodfill router considered to be closest to that key. To have a higher 
success rate on a lookup, the client is able to iteratively look up the key. This means that the lookup continues with 
the next-closest peer should the initial lookup request fail.</p>
<h4><a class="header" href="#garlic-routing" id="garlic-routing">Garlic Routing</a></h4>
<p>Garlic routing is a way of building paths or tunnels through which messages in the I2P network travel. When a message
leaves the application or client, it is encrypted to the recipient's public key. The encrypted message is then encrypted 
with instructions specifying the next hop. The message travels in this way through each hop until it reaches the 
recipient. During the transportation of the message, it is bundled with other messages. This means that any message
travelling in the network could contain a number of other messages bundled with it. In essence, garlic routing does two
things:</p>
<ul>
<li>provides layered encryption; and</li>
<li>bundles multiple messages together.</li>
</ul>
<p>Figure 2 illustrates the end-to-end message bundling:</p>
<p align="center"><a name="fig_eca"> </a><img src="protocols/intro-to-tor-i2P/assets/garliccloves.png" width="1050" /></p>
<p align="center"><b>Figure&nbsp;2: Garlic Routing <a href="https://github.com/ElementsProject/confidential-assets-demo" title="ElementsProject/confidential-assets-demo"></a></b></p>
<h3><a class="header" href="#i2p-threats-security-and-vulnerability" id="i2p-threats-security-and-vulnerability">I2P Threats, Security and Vulnerability</a></h3>
<p>The I2P project has no specific threat model, but rather talks about common attacks and existing defenses. 
Overall, the design of I2P is motivated by threats similar to those addressed by Tor: the attacker can observe traffic 
locally, but not all traffic flowing through the network; and the integrity of all cryptographic primitives is assumed. 
Furthermore, an attacker is only allowed to control a limited number of peers in the network (the website talks about 
not more than 20% of nodes participating in the NetDB and a similar percentage of the total number of nodes controlled 
by the malicious entity). In this section, we'll look at different threat models affecting the network [<a href="https://sites.cs.ucsb.edu/%7Echris/research/doc/raid13_i2p.pdf" title="Practical Attacks Against
the I2P Network">3</a>].</p>
<h4><a class="header" href="#sybil-attacks" id="sybil-attacks">Sybil Attacks</a></h4>
<p>The Sybil attack, illustrated in Figure 3, is a well-known anonymity system attack in which the malicious user 
creates multiple identities in an effort to increase control over the network. Running this attack over the I2P network 
is rather difficult. This is because participants/clients in the network evaluate the performance of peers when 
selecting peers to interact with, instead of using a random sample. Since running multiple identities on the same host 
affects the performance of each of those instances, the number of additional identities running in parallel is 
effectively limited by the need to provide each of them with enough resources to be considered as peers. This means that 
the malicious user will need substantial resources to create multiple identities.</p>
<p align="center"><a name="fig_eca"> </a><img src="protocols/intro-to-tor-i2P/assets/Sybil Attack.png" width="750" /></p>
<p align="center"><b>Figure&nbsp;3: Sybil Attack [<a href="https://www.delaat.net/rp/2017-2018/p97/presentation.pdf" title="Network Topology">5</a>]</b></p>
<h4><a class="header" href="#eclipse-attacks" id="eclipse-attacks">Eclipse Attacks</a></h4>
<p>In eclipse attacks, a set of malicious and colluding nodes arranges that a good node can 
only communicate with malicious nodes. The union of malicious nodes therefore fools the good node into writing its
addresses into neighbouring lists of good nodes. In a Sybil attack, a single malicious node has a large number of 
identities in the network in order to control some part of the network. If an attacker wants to continue a Sybil attack 
into an eclipse attack, the attacker will try to place malicious nodes in the strategic routing path in such a way that 
all traffic will pass through the attacker's node [<a href="http://ijsetr.org/wp-content/uploads/2015/05/IJSETR-VOL-4-ISSUE-5-1515-1518.pdf" title="Defending Eclipse Attack 
in I2P using Structured
Overlay Network">8</a>].</p>
<h4><a class="header" href="#brute-force-attacks" id="brute-force-attacks">Brute Force Attacks</a></h4>
<p>Brute force attacks on the I2P network can be mounted by actively watching the network's messages as they pass between 
all of the nodes and attempting to correlate messages and their routes. Since all peers in the network are frequently 
sending messages, this attack is trivial. The attacker can send out large amounts of data (more than 2GB), observe all 
the nodes and narrow down those that routed the message. Transmission of a large chunk of data is necessary because 
inter-router communication is encrypted and streamed, i.e. 1,024 byte data is indistinguishable from 
2,048 byte data. Mounting this attack is, however, very difficult and one would need to be an Internet Service 
Provider (ISP) or government entity in order to observe a large chunk of the network.</p>
<h4><a class="header" href="#intersection-attacks" id="intersection-attacks">Intersection Attacks</a></h4>
<p>Intersection attacks involve observing the network and node churns over time. In order to narrow down specific targets, 
when a message is transferred through the network, the peers that are online are intersected. It is theoretically 
possible to mount this attack if the network is small, but impractical with a larger network.</p>
<h4><a class="header" href="#denial-of-service-attacks" id="denial-of-service-attacks">Denial of Service Attacks</a></h4>
<p>Denial of service attacks include the following:</p>
<h5><a class="header" href="#greedy-user-attack" id="greedy-user-attack">Greedy User Attack</a></h5>
<p>A greedy user attack occurs when a user is consuming significantly more resources than they are willing to contribute. 
I2P has strong defenses against these attacks, as users within the network are routers by default and hence contribute 
to the network by design.</p>
<h5><a class="header" href="#starvation-attack" id="starvation-attack">Starvation Attack</a></h5>
<p>A user/node may try to launch a starvation attack by creating a number of bad nodes that do not provide any resources or 
services to the network, causing existing peers to search through a larger network database, or request more tunnels 
than should be necessary. An attempt to find useful nodes can be difficult, as there are no differences between them and 
failing or loaded nodes. However, I2P, by design, maintains a profile of all peers and attempts to identify and ignore 
poorly performing nodes, making this attack difficult.</p>
<h5><a class="header" href="#flooding-attack" id="flooding-attack">Flooding Attack</a></h5>
<p>In a flooding attack, the malicious user sends a large number of messages to the target's inbound tunnels or to the 
network at large.</p>
<p>The targeted user can, however:</p>
<ul>
<li>detect this by the contents of the message and because the tunnel's 
tests will fail;</li>
<li>identify the unresponsive tunnels, ignore them and build new ones;</li>
<li>choose to throttle the number of messages a tunnel can receive.</li>
</ul>
<p>Although I2P has no defences against a network flooding 
attack, it is incredibly difficult to flood the network.</p>
<h2><a class="header" href="#tor-network" id="tor-network">Tor Network</a></h2>
<h3><a class="header" href="#what-is-tor" id="what-is-tor">What is Tor?</a></h3>
<p>Tor is a free and open-source anonymity/privacy tool, meant to protect a user's location and identity. The name is derived 
from the acronym for the original software project name, <strong>The Onion Router</strong> ([<a href="https://www.torproject.org/" title="Tor Project: Download for Tor Browser">17</a>], [<a href="https://en.wikipedia.org/wiki/Tor_(anonymity_network)" title="Wikipedia: Tor (Anonymity Network)">18</a>]). This refers to the way 
in which Tor protects a user's data, by wrapping it in multiple layers of encryption, similar to the layers of an onion.</p>
<p>Tor uses a unique system that was originally developed by the US Navy to protect government intelligence communications. 
Naval Research Laboratory released the Tor code under a free license and the Tor Project was founded in 2006. With the 
help of the Electronic Frontier Foundation (EFF), further research and development of Tor have continued as a Free and 
Open Source Project. The Tor network service is run by a worldwide community of volunteers and are not controlled by any 
corporate or government agencies.</p>
<p>The Tor network service is the heart of the Tor project. The Tor Browser and other tools, such as OnionShare, run on top 
of or via the Tor network. These tools are meant to make using the Tor network as simple and secure as possible.</p>
<p>Some tools, such as the Tor Browser Bundle, come as a single downloadable and installable package containing everything 
needed to use the Tor network and be anonymous.</p>
<p>Almost any network tool or application that can be configured to use a Socket Secure (SOCKS) proxy can be set up to use 
the Tor network service.</p>
<h3><a class="header" href="#how-does-tor-work" id="how-does-tor-work">How does Tor Work?</a></h3>
<p>Before Tor data enters the Tor network, it is bundled into nested layers of encrypted packets of the same size. These 
packets are then routed through a random series of volunteer-operated servers called relay nodes. Each 
time the Tor data passes through one of these relays, a layer of encryption is removed to reveal the location of the 
next relay. When the data reaches the final relay on its path, the last layer of encryption is removed and the data is 
sent to its final destination.</p>
<p>Relay nodes, such as I2P's nodes, are responsible for creating hops through which data is routed before reaching its 
intended destination on the Internet. They work by incrementally building a circuit of encrypted connections through 
relays on the network. The circuit is extended one hop at a time. Each relay along the way knows only which relay gave 
it data and which relay it is giving data to. No individual relay ever knows the complete path that a data packet has 
taken. Also, no request uses the same path. Later requests are given a new circuit, to keep people from linking a user's 
earlier actions to new actions. This process is also known as Onion Routing [<a href="https://svn.torproject.org/svn/projects/design-paper/tor-design.html" title="Tor: The Second-Generation Onion Router">14</a>], and is illustrated in Figure 4: </p>
<p align="center"><a name="fig_eca"> </a><img src="protocols/intro-to-tor-i2P/assets/htw3.png" width="625" /></p>
<p align="center"><b>Figure&nbsp;4: How Tor Works [<a href="https://2019.www.torproject.org/about/overview.html.en" title="How Tor Works">13</a>]</b></p>
<h3><a class="header" href="#how-does-onion-routing-work" id="how-does-onion-routing-work">How does Onion Routing Work?</a></h3>
<p>Onion Routing is essentially a distributed overlay network designed to anonymize Transmission Control Protocol (TCP) 
based applications such as web browsing, secure shell and instant messaging. Clients choose a path through the network 
and build a circuit in which each node in the path knows its predecessor and successor, but no other nodes in the 
circuit. Traffic flows down the circuit in fixed-size cells, which are unwrapped by a symmetric key at each node 
(similar to the layers of an onion) and relayed downstream [<a href="https://svn.torproject.org/svn/projects/design-paper/tor-design.html" title="Tor: The Second-Generation Onion Router">14</a>]. Each relay can only decrypt enough data to learn the 
location of the previous and next relay. Since each path is randomly generated and the relays do not keep records, it is 
nearly impossible for your activity to be traced back to you through Tor’s complex network [<a href="https://2019.www.torproject.org/about/overview.html.en" title="Tor Project: Overview">21</a>].</p>
<p>An <code>.onion</code> address points to some resource on the Tor network called a hidden service or an <code>onion</code> service. Onion 
services are generally only accessible by using the Tor network. As an example, if the DuckDuckGo Search engine onion 
address (https://3g2upl4pq6kufc4m.onion/) is visited, the request is routed through the Tor network without the client 
knowing the host IP address of the server. The onion address is practically meaningless without it being routed through 
and resolved by the Tor network. Traffic between a Tor client and an <code>.onion</code> site should never leave the Tor network, 
thus making the network traffic safer and more anonymous than publicly hosted sites. An <code>.onion</code> address is a domain 
name that is not easy to remember or find, as there are no directory services. It generally consists of opaque, 
non-mnemonic, 16- or 56-character alpha-semi-numerical strings that are generated on a cryptographically hashed public 
key. The Top Level Domain (TLD) <code>.onion</code> is not a true domain and cannot be found or queried on the Internet, but only 
inside the Tor network ([<a href="https://3g2upl4pq6kufc4m.onion/" title="DuckDuckGo Search Engine - 
link will not work unless 
Tor or Tor Browser is used">19</a>]], [<a href="https://en.wikipedia.org/wiki/.onion" title="Wikipedia: .onion">23</a>], [<a href="https://2019.www.torproject.org/docs/faq#AccessOnionServices" title="Tor Project: How do I access onion services?">24</a>]).</p>
<p>The designated use of relay nodes in the Tor network gives the network the following important characteristics [<a href="https://2019.www.torproject.org/about/overview.html.en" title="Tor Project: How it works">13</a>]: </p>
<ul>
<li>The stability of the network is proportional to the number of relay nodes in the network. The fewer the number of 
relay nodes, the less stable the network becomes. </li>
<li>The security of the network is also proportional to the number of relay nodes. A network with more active relay 
nodes is less vulnerable to attacks. </li>
<li>Finally, the speed of the network is proportional to the number of relay nodes. The more nodes there are, the faster 
the network becomes.</li>
</ul>
<h3><a class="header" href="#types-of-tor-relaysnodes-routing" id="types-of-tor-relaysnodes-routing">Types of Tor Relays/Nodes Routing</a></h3>
<p>Tor's relay nodes do not all function in the same way. As shown in Figure 5, there are four types of relay nodes: an 
entry or guard relay node, a middle relay node, an exit relay node and a bridge relay node. </p>
<p align="center"><a name="fig_eca"> </a><img src="protocols/intro-to-tor-i2P/assets/torCircuit.png" width="650" /></p>
<p align="center"><b>Figure&nbsp;5: Tor Circuit [<a href="https://medium.com/coinmonks/tor-nodes-explained-580808c29e2d" title="The Tor Circuit">14</a>]</b></p>
<h4><a class="header" href="#guard-or-entry-relay-non-exit-relay-nodes" id="guard-or-entry-relay-non-exit-relay-nodes">Guard or Entry Relay (Non-exit Relay) Nodes</a></h4>
<p>A guard relay node is the first relay node in the Tor circuit. Each client that wants to connect to the Tor network will 
first connect to a guard relay node. This means that guard relay nodes can see the IP address of the client attempting 
to connect. It is worth noting that Tor publishes its guard relay nodes and anyone can see them on websites such as the 
one in [<a href="https://torstatus.blutmagie.de/" title="Tor Network Status">15</a>]. Since it is possible to see the IP address of a client, there have been cases where attackers have 
filtered out traffic on the network using circuit fingerprinting techniques such as documented in [<a href="https://people.csail.mit.edu/devadas/pubs/circuit_finger.pdf" title="Circuit Fingerprinting Attacks: Passive Deanonymization of Tor Hidden Service">16</a>].</p>
<h4><a class="header" href="#middle-relay-nodes" id="middle-relay-nodes">Middle Relay Nodes</a></h4>
<p>Middle relay nodes cover most parts of the Tor network and act as hops. They consist of relays through which data is 
passed in encrypted format. No node knows more than its predecessor and descendant. All the available middle relay nodes 
show themselves to the guard and exit relay nodes so that any may connect to them for transmission. Middle relay nodes 
can never be exit relay nodes within the network [<a href="https://2019.www.torproject.org/about/overview.html.en" title="Tor Project: How it works">13</a>].</p>
<h4><a class="header" href="#exit-relay-nodes" id="exit-relay-nodes">Exit Relay Nodes</a></h4>
<p>Exit relay nodes act as a bridge between the Tor network and the Internet. They are Internet public-facing relays, where 
the last layer of Tor encryption is removed from traffic that can then leave the Tor network as normal traffic that 
merges into the Internet on its way to its desired destinations on the Internet.</p>
<p>The services to which Tor clients are connecting (website, chat service, email provider, etc.) will see the IP address 
of the exit relay instead of the real IP addresses of Tor users. Because of this, exit relay node owners are often 
subjected to numerous complaints, legal notices and shutdown threats [<a href="https://2019.www.torproject.org/about/overview.html.en" title="Tor Project: How it works">13</a>].</p>
<h4><a class="header" href="#bridge-relay-nodes" id="bridge-relay-nodes">Bridge Relay Nodes</a></h4>
<p>The design of the Tor network means that the IP addresses of Tor relays are public, as previously mentioned, and as 
shown in [<a href="https://torstatus.blutmagie.de/" title="Tor Network Status">15</a>]. Because of this, Tor can be blocked by governments or ISPs blacklisting the IP addresses of these 
public Tor nodes. In response to blocking tactics, a special kind of relay called a Bridge should be used, which is a
node in the network that is not listed in the public Tor directory. Bridge selection is done when installing the Tor 
Browser bundle, and makes it less likely to have to deal with complaints or have Internet traffic blocked by ISPs and 
governments.</p>
<p>Bridge relay nodes are meant for people who want to run Tor from their homes, have a static IP address or do not have much bandwidth to donate [<a href="https://2019.www.torproject.org/about/overview.html.en" title="Tor Project: How it works">13</a>].</p>
<h3><a class="header" href="#pitfalls-of-using-tor-anonymously---is-it-broken" id="pitfalls-of-using-tor-anonymously---is-it-broken">Pitfalls of Using Tor Anonymously - is it Broken?</a></h3>
<p>Although traffic between nodes on the Tor network is encrypted, this does not guarantee anonymity for users. There are a 
number of pitfalls of using Tor anonymously. </p>
<p>Internet browsers and operating systems, what might seem like a simple request to a URL, could deanonymize somebody.</p>
<p>Older Tor setups needed a user to know how to configure their proxy settings in their operating system and/or browser, 
in order to use Tor services. This was very easy to get wrong or incomplete, and some users' information or details 
could be leaked.</p>
<p>For example, Domain Name System (DNS) requests intended for the Tor network, i.e. <code>.onion</code> address, might be sent 
directly to the public DNS server, if the <code>network.proxy.socks_remote_dns</code> was not set to true in FireFox. These DNS 
requests could be used to track where a user might be surfing and thus deanonymize the user.</p>
<p>Tor is not broken if Tor services are correctly set up or if the Tor Browser is used correctly. It is very easy to do 
something that would deanonymize a user, such as use an older browser or tool that is not configured to proxy all 
traffic via Tor network services.</p>
<p>Another example is if the user logs into a remote service such as Facebook or Gmail, their anonymity at this site is 
lost. What many people do not know is that other sites use tracking techniques, such as cookies, which could deanonymize 
the user on other sites too. Further information about online tracking can be found in [<a href="https://robertheaton.com/2017/11/20/how-does-online-tracking-actually-work/" title="Robert Heaton: How does online 
tracking actually work?">25</a>]</p>
<p>However, recent releases of the Tor Browser notify users of updates and also work toward keeping each site isolated 
in their own Tab or session, addressing old and possibly insecure releases and user tracking via cookies.</p>
<p>Tor some has weaknesses, e.g. if a user is the only person using Tor on their home, office or school network, 
they could be deanonymized. Another is that a site knows when it has been accessed using Tor. These shortcomings 
might not be directly an issue with Tor or its encryption, but an expectation of a novice user, using Tor or 
one of the Tor tools and services.</p>
<p>For an interesting talk about some of the Tor attacks, refer to [<a href="https://www.youtube.com/watch?v=eQ2OZKitRwc" title="YouTube: DEF CON 22 - Adrian Crenshaw - 
Dropping Docs on Darknets: 
How People Got Caught">26</a>]. The following are two real instances where 
people using Tor were discovered:</p>
<ul>
<li>On 16 December 2013, Harvard University received a bomb threat that was tracked down to Eldo Kim, who was one of the 
few people using Tor on the campus network when the email had been sent. After questioning, Kim admitted he had sent 
the hoax bomb threat, as he wanted to get out of an exam [<a href="https://arstechnica.com/security/2013/12/use-of-tor-helped-fbi-finger-bomb-hoax-suspect/" title="Ars Technica: Use of Tor helped 
FBI ID suspect in bomb hoax case">27</a>].</li>
<li>Hector Xavier Monsegur (Sabu) normally used Tor for connecting to IRC, but was caught not using it once, and the FBI 
found his home IP. After being caught, he started to collaborate with the FBI. While Monsegur was chatting to Jeremy 
Hammond on IRC, Hammond let slip details of where he had been arrested before and other groups with which he had been 
involved. This helped reduce the number of suspects and the FBI was able to get a court order to monitor Internet 
access and to correlate when Hammond was using Tor [<a href="https://arstechnica.com/tech-policy/2012/03/stakeout-how-the-fbi-tracked-and-busted-a-chicago-anon/" title="Ars Technica: Stakeout: How the 
FBI tracked and busted a Chicago Anon">28</a>].</li>
</ul>
<h3><a class="header" href="#advantages-and-disadvantages" id="advantages-and-disadvantages">Advantages and Disadvantages</a></h3>
<p>Advantages of Tor:</p>
<ul>
<li>It is free and open source.</li>
<li>It supports Linux, OSX and Windows.</li>
<li>It is easy to install for supported operating systems.</li>
<li>It is not controlled by corporate or government agencies.</li>
</ul>
<p>Disadvantages of Tor:</p>
<ul>
<li>It can be slow.</li>
<li>It does not necessarily encrypt data leaving <code>Exit Node</code>. This data can be intercepted.</li>
<li>It does not stop somebody from deanonymizing themselves.</li>
<li>It does not stop interceptors from knowing you are using Tor.</li>
<li>Its network is not user-friendly, due to its secure and hidden nature.</li>
<li>Its nodes (relay/bridge) are run by volunteers, who can sometimes be unreliable.</li>
</ul>
<h2><a class="header" href="#differences-between-i2p-and-tor" id="differences-between-i2p-and-tor">Differences between I2P and Tor</a></h2>
<!-- <div align="center"><b>Table 1: Differences between I2P and Tor</b></div> -->
<table><thead><tr><th>I2P</th><th>Tor</th></tr></thead><tbody>
<tr><td>Fully peer to peer: self-organizing nodes</td><td>Fully peer to peer: volunteer relay nodes</td></tr>
<tr><td>Queries NetDB to find destination’s inbound tunnel gateway</td><td>Relays data to the closest relay</td></tr>
<tr><td>Limited to no exit nodes; internal communication only</td><td>Designed and optimized for exit traffic, with a large number of exit nodes</td></tr>
<tr><td>Designed primarily for file sharing</td><td>Designed for anonymous Internet access</td></tr>
<tr><td>Unidirectional tunnels</td><td>Rendezvous point</td></tr>
<tr><td>Significantly smaller user base</td><td>Generally bigger user base</td></tr>
</tbody></table>
<p><strong>Source:</strong> ([<a href="https://pdfs.semanticscholar.org/aa81/79d3da24b643a4d004c44ebe543000295d51.pdf" title="I2P Usability vs. 
Tor Usability - 
A Bandwidth and Latency 
Comparison">9</a>], [<a href="https://geti2p.net/en/comparison/tor" title="I2P Compared to Tor">10</a>], [<a href="http://www.geti2p.org/how_networkcomparisons.html" title="I2P Compared to Tor 
and Freenet">11</a>]).</p>
<h2><a class="header" href="#conclusion-1" id="conclusion-1">Conclusion</a></h2>
<p>In summary, Tor and I2P are two network types that anonymize and encrypt data transferred within them. Each network is 
uniquely designed for a respective function. The I2P network is designed for moving data in a peer-to-peer format, 
whereas the Tor network is designed for accessing the Internet privately. </p>
<p>Regarding Tor, the following should be kept in mind:</p>
<ul>
<li>Anonymity is not confidentiality; Tor by itself does not guarantee anonymity. Total anonymity has many obstacles, 
not only technology related, but also the human component.</li>
<li>Tor is not a Virtual Private Network (VPN).</li>
<li>Tor data leaving the Tor network can be intercepted.</li>
</ul>
<p>Extensive research exists and continues to find ways to improve the security of these networks in their respective 
operational designs. This research becomes especially important when control of a network may mean monetary loss, loss 
of privacy or denial of service.</p>
<h2><a class="header" href="#references-25" id="references-25">References</a></h2>
<p>[<a href="https://blokt.com/guides/what-is-i2p-vs-tor-browser#How_does_I2P_work" title="What Is I2P &amp; 
How Does It Compare vs. 
Tor Browser?">1</a>] B. Mann, &quot;What Is I2P &amp; How Does It Compare vs. Tor Browser?&quot; [Online.]
Available: <a href="https://blokt.com/guides/what-is-i2p-vs-tor-browser#How_does_I2P_work">https://blokt.com/guides/what-is-i2p-vs-tor-browser#How_does_I2P_work</a>. Date accessed: 2019‑06‑18.</p>
<p>[<a href="https://geti2p.net/en/docs/api/i2ptunnel" title="I2PTunnel">2</a>]: I2P: &quot;I2PTunnel&quot; [online]. Available: <a href="https://geti2p.net/en/docs/api/i2ptunnel">https://geti2p.net/en/docs/api/i2ptunnel</a>. Date accessed: 2019‑06‑18.</p>
<p>[<a href="https://sites.cs.ucsb.edu/%7Echris/research/doc/raid13_i2p.pdf" title="Practical Attacks Against
the I2P Network">3</a>]: C. Egger, J. Schlumberger, C. Kruegel and G. Vigna, &quot;Practical Attacks Against the I2P Network&quot; - Paper [online]. 
Available: <a href="https://sites.cs.ucsb.edu/%7Echris/research/doc/raid13_i2p.pdf">https://sites.cs.ucsb.edu/~chris/research/doc/raid13_i2p.pdf</a>. Date accessed: 2019‑06‑18.</p>
<p>[<a href="https://censorbib.nymity.ch/pdf/Hoang2018a.pdf" title="An Empirical Study 
of the I2P Anonymity 
Network and its
Censorship Resistance">4</a>] N. P. Hoang, P. Kintis, M. Antonakakis and M. Polychronakis, &quot;An Empirical Study of the I2P Anonymity Network and 
its Censorship Resistance&quot; [online]. Available: <a href="https://censorbib.nymity.ch/pdf/Hoang2018a.pdf">https://censorbib.nymity.ch/pdf/Hoang2018a.pdf</a>. Date accessed: 
2019‑06‑18.</p>
<p>[<a href="https://www.delaat.net/rp/2017-2018/p97/presentation.pdf" title="Mitigating Sybil Attacks 
on the I2P Network 
Using Blockchain">5</a>] K. Alachkar and D. Gaastra, &quot;Mitigating Sybil Attacks on the I2P Network Using Blockchain&quot; - Presentation [online]. 
Available: <a href="https://www.delaat.net/rp/2017-2018/p97/presentation.pdf">https://www.delaat.net/rp/2017-2018/p97/presentation.pdf</a>. Date accessed: 2019‑06‑20.</p>
<p>[<a href="https://delaat.net/rp/2017-2018/p97/report.pdf" title="Blockchain-based Sybil 
Attack Mitigation: 
A Case Study of the 
I2P Network">6</a>] K. Alachkar and D. Gaastra, &quot;Blockchain-based Sybil Attack Mitigation: A Case Study of the I2P Network&quot; - Report 
[online]. Available: <a href="https://delaat.net/rp/2017-2018/p97/report.pdf">https://delaat.net/rp/2017-2018/p97/report.pdf</a>. Date accessed: 2019‑06‑20.</p>
<p>[<a href="https://geti2p.net/en/docs/how/network-database" title="The Network Database">7</a>] I2P: &quot;The Network Database&quot; [online]. Available: <a href="https://geti2p.net/en/docs/how/network-database">https://geti2p.net/en/docs/how/network-database</a>. Date accessed: 
2019‑06‑20.</p>
<p>[<a href="http://ijsetr.org/wp-content/uploads/2015/05/IJSETR-VOL-4-ISSUE-5-1515-1518.pdf" title="Defending Eclipse Attack 
in I2P using Structured
Overlay Network">8</a>] H. Vhora and G. Khilari, &quot;Defending Eclipse Attack in I2P using Structured
Overlay Network&quot; [online]. Available: <a href="http://ijsetr.org/wp-content/uploads/2015/05/IJSETR-VOL-4-ISSUE-5-1515-1518.pdf">http://ijsetr.org/wp-content/uploads/2015/05/IJSETR-VOL-4-ISSUE-5-1515-1518.pdf</a>. 
Date accessed: 2019‑06‑20.</p>
<p>[<a href="https://pdfs.semanticscholar.org/aa81/79d3da24b643a4d004c44ebe543000295d51.pdf" title="I2P Usability vs. 
Tor Usability - 
A Bandwidth and Latency 
Comparison">9</a>] M. Ehlert, &quot;I2P Usability vs. Tor Usability - A Bandwidth and Latency Comparison&quot; [online]. 
Available: <a href="https://pdfs.semanticscholar.org/aa81/79d3da24b643a4d004c44ebe543000295d51.pdf">https://pdfs.semanticscholar.org/aa81/79d3da24b643a4d004c44ebe543000295d51.pdf</a>. Date accessed: 2019‑06‑20.</p>
<p>[<a href="https://geti2p.net/en/comparison/tor" title="I2P Compared to Tor">10</a>] I2P: &quot;I2P Compared to Tor&quot; [online]. Available: <a href="https://geti2p.net/en/comparison/tor">https://geti2p.net/en/comparison/tor</a>. Date accessed: 2019‑06‑20.</p>
<p>[<a href="http://www.geti2p.org/how_networkcomparisons.html" title="I2P Compared to Tor 
and Freenet">11</a>] I2P: &quot;I2P Compared to Tor and Freenet&quot; [online]. Available: <a href="http://www.geti2p.org/how_networkcomparisons.html">http://www.geti2p.org/how_networkcomparisons.html</a>. 
Date accessed: 2019‑06‑20.</p>
<p>[<a href="https://www.delaat.net/rp/2018-2019/p63/report.pdf" title="Invisible Internet Project - MSc Security and Network Engineering Research Project">12</a>] T. de Boer and V. Breider: &quot;Invisible Internet Project - MSc Security and Network Engineering Research Project.&quot; [online].
Available: <a href="https://www.delaat.net/rp/2018-2019/p63/report.pdf">https://www.delaat.net/rp/2018-2019/p63/report.pdf</a> Date accessed: 2019‑07‑10.</p>
<p>[<a href="https://2019.www.torproject.org/about/overview.html.en" title="Tor Project: How it works">13</a>] Tor, &quot;Tor Project: How it works&quot; [online].
Available: <a href="https://2019.www.torproject.org/about/overview.html.en">https://2019.www.torproject.org/about/overview.html.en</a> Date accessed: 2019‑08‑05.</p>
<p>[<a href="https://svn.torproject.org/svn/projects/design-paper/tor-design.html" title="Tor: The Second-Generation Onion Router">14</a>] R. Dingledine, N Mathewson and P. Syverson, &quot;Tor: The Second-Generation Onion Router&quot; [online]
Available: <a href="https://svn.torproject.org/svn/projects/design-paper/tor-design.html">https://svn.torproject.org/svn/projects/design-paper/tor-design.html</a> Date accessed: 2019‑08‑05.</p>
<p>[<a href="https://torstatus.blutmagie.de/" title="Tor Network Status">15</a>] Tor, &quot;Tor Network Status&quot; [online]<br />
Available: <a href="https://torstatus.blutmagie.de/">https://torstatus.blutmagie.de/</a> Date accessed: 2019‑08‑05.</p>
<p>[<a href="https://people.csail.mit.edu/devadas/pubs/circuit_finger.pdf" title="Circuit Fingerprinting Attacks: Passive Deanonymization of Tor Hidden Service">16</a>] A. Kwon, M. AlSabah, D. Lazar, M. Dacier and S. Devadas, &quot;Circuit Fingerprinting Attacks: Passive Deanonymization of Tor Hidden Service&quot; [online]
Available: <a href="https://people.csail.mit.edu/devadas/pubs/circuit_finger.pdf">https://people.csail.mit.edu/devadas/pubs/circuit_finger.pdf</a> Date accessed: 2019‑08‑05.</p>
<p>[<a href="https://www.torproject.org/" title="Tor Project: Download for Tor Browser">17</a>] Tor Project: &quot;Download for Tor Browser&quot; [online]. Available: <a href="https://www.torproject.org/">https://www.torproject.org/</a>. Date accessed: 2019‑05‑16.</p>
<p>[<a href="https://en.wikipedia.org/wiki/Tor_(anonymity_network)" title="Wikipedia: Tor (Anonymity Network)">18</a>] Wikipedia: &quot;Tor (Anonymity Network)&quot; [online]. Available: <a href="https://en.wikipedia.org/wiki/Tor_(anonymity_network)">https://en.wikipedia.org/wiki/Tor_(anonymity_network)</a>. 
Date accessed: 2019‑05‑16.</p>
<p>[<a href="https://3g2upl4pq6kufc4m.onion/" title="DuckDuckGo Search Engine - 
link will not work unless 
Tor or Tor Browser is used">19</a>] DuckDuckGo Search Engine inside Tor [online]. Available: <a href="https://3g2upl4pq6kufc4m.onion/">https://3g2upl4pq6kufc4m.onion/</a>. <strong>Note:</strong> This link 
will not work unless Tor or the Tor Browser is used. Date accessed: 2019‑05‑16.</p>
<p>[<a href="https://check.torproject.org/" title="Tor Project: Check - 
link will help user identify 
Tor or Tor Browser is been used">20</a>] Tor Project: &quot;Check&quot; [online]. Available: <a href="https://check.torproject.org/">https://check.torproject.org/</a>. <strong>Note:</strong> This link will help the user 
identify if Tor or the Tor Browser is been used. Date accessed: 2019‑05‑16</p>
<p>[<a href="https://2019.www.torproject.org/about/overview.html.en" title="Tor Project: Overview">21</a>] Tor Project: &quot;Overview&quot; [online]. Available: <a href="https://2019.www.torproject.org/about/overview.html.en">https://2019.www.torproject.org/about/overview.html.en</a>. 
Date accessed: 2019‑05‑16.</p>
<p>[<a href="https://trac.torproject.org/projects/tor/wiki/TorRelayGuide" title="Tor Project: The Tor Relay Guide">22</a>] Tor Project: &quot;The Tor Relay Guide&quot; [online]. Available: 
<a href="https://trac.torproject.org/projects/tor/wiki/TorRelayGuide">https://trac.torproject.org/projects/tor/wiki/TorRelayGuide</a>. Date accessed: 2019‑08‑14.</p>
<p>[<a href="https://en.wikipedia.org/wiki/.onion" title="Wikipedia: .onion">23</a>] Wikipedia: &quot;.onion&quot; [online]. Available: 
<a href="https://en.wikipedia.org/wiki/.onion">https://en.wikipedia.org/wiki/.onion</a>. Date accessed: 2019‑08‑22.</p>
<p>[<a href="https://2019.www.torproject.org/docs/faq#AccessOnionServices" title="Tor Project: How do I access onion services?">24</a>] Tor Project: &quot;How do I access onion services?&quot; [online]. Available: 
<a href="https://2019.www.torproject.org/docs/faq#AccessOnionServices">https://2019.www.torproject.org/docs/faq#AccessOnionServices</a>. Date accessed: 2019‑08‑22.</p>
<p>[<a href="https://robertheaton.com/2017/11/20/how-does-online-tracking-actually-work/" title="Robert Heaton: How does online 
tracking actually work?">25</a>] R. Heaton: &quot;How Does Online Tracking Actually Work?&quot; [online]. Available: 
<a href="https://robertheaton.com/2017/11/20/how-does-online-tracking-actually-work/">https://robertheaton.com/2017/11/20/how-does-online-tracking-actually-work/</a>. Date accessed: 2019‑07‑25.</p>
<p>[<a href="https://www.youtube.com/watch?v=eQ2OZKitRwc" title="YouTube: DEF CON 22 - Adrian Crenshaw - 
Dropping Docs on Darknets: 
How People Got Caught">26</a>] YouTube: &quot;DEF CON 22 - Adrian Crenshaw - Dropping Docs on Darknets: How People Got Caught&quot; [online]. Available: 
<a href="https://www.youtube.com/watch?v=eQ2OZKitRwc">https://www.youtube.com/watch?v=eQ2OZKitRwc</a>. Date accessed: 2019‑06‑18.</p>
<p>[<a href="https://arstechnica.com/security/2013/12/use-of-tor-helped-fbi-finger-bomb-hoax-suspect/" title="Ars Technica: Use of Tor helped 
FBI ID suspect in bomb hoax case">27</a>] Ars Technica: &quot;Use of Tor helped FBI ID suspect in bomb hoax case&quot; [online]. Available: 
<a href="https://arstechnica.com/security/2013/12/use-of-tor-helped-fbi-finger-bomb-hoax-suspect/">https://arstechnica.com/security/2013/12/use-of-tor-helped-fbi-finger-bomb-hoax-suspect/</a>. 
Date accessed: 2019‑07‑11.</p>
<p>[<a href="https://arstechnica.com/tech-policy/2012/03/stakeout-how-the-fbi-tracked-and-busted-a-chicago-anon/" title="Ars Technica: Stakeout: How the 
FBI tracked and busted a Chicago Anon">28</a>] Ars Technica: &quot;Stakeout: How the FBI tracked and busted a Chicago Anon&quot; [online]. Available: 
<a href="https://arstechnica.com/tech-policy/2012/03/stakeout-how-the-fbi-tracked-and-busted-a-chicago-anon/">https://arstechnica.com/tech-policy/2012/03/stakeout-how-the-fbi-tracked-and-busted-a-chicago-anon/</a>. 
Date accessed: 2019‑07‑11.</p>
<h2><a class="header" href="#appendices-8" id="appendices-8">Appendices</a></h2>
<h3><a class="header" href="#appendix-a-tor-further-investigation" id="appendix-a-tor-further-investigation">Appendix A: Tor Further Investigation</a></h3>
<p>Onion Services - Tor services that don’t leave the Tor network: <a href="https://2019.www.torproject.org/docs/onion-services.html.en">https://2019.www.torproject.org/docs/onion-services.html.en</a>.</p>
<h3><a class="header" href="#appendix-b-tor-links-of-interest" id="appendix-b-tor-links-of-interest">Appendix B: Tor Links of Interest</a></h3>
<ul>
<li><a href="https://www.le-vpn.com/what-is-tor-browser/">What is Tor Browser?</a></li>
<li><a href="https://www.vpnmentor.com/blog/tor-browser-work-relate-using-vpn/">The Ultimate Guide to Tor Browser (with Important Tips) 2019</a></li>
<li><a href="https://metrics.torproject.org">Metrics of the Tor Project</a></li>
<li><a href="https://onionshare.org">Sharing files using Tor</a></li>
<li><a href="https://blog.torproject.org/new-release-onionshare-2">Blog Post about OnionShare2 and its release</a></li>
<li><a href="https://2019.www.torproject.org/projects/projects.html.en">List of Tor Projects</a></li>
<li><a href="https://github.com/isislovecruft/talks/blob/master/2016-03-21-raboud/slides/2016-03-21-raboud-netsec-anonymity-handout.pdf">Isis Lovecruft's PDF covering Privacy and Anonymity</a></li>
</ul>
<h2><a class="header" href="#contributors-18" id="contributors-18">Contributors</a></h2>
<ul>
<li><a href="https://github.com/mhlangagc">https://github.com/mhlangagc</a> and <a href="https://github.com/leet4tari">https://github.com/leet4tari</a></li>
<li><a href="https://github.com/neonknight64">https://github.com/neonknight64</a></li>
<li><a href="https://github.com/SWvheerden">https://github.com/SWvheerden</a></li>
<li><a href="https://github.com/sdbondi">https://github.com/sdbondi</a></li>
<li><a href="https://github.com/anselld">https://github.com/anselld</a></li>
</ul>
<h1><a class="header" href="#distributed-hash-tables" id="distributed-hash-tables">Distributed Hash Tables</a></h1>
<ul>
<li><a href="protocols/dht/MainReport.html#introduction">Introduction</a></li>
<li><a href="protocols/dht/MainReport.html#characterization-of-dht-networks">Characterization of DHT Networks</a>
<ul>
<li><a href="protocols/dht/MainReport.html#peer-discovery">Peer Discovery</a></li>
<li><a href="protocols/dht/MainReport.html#scalability-and-fault-tolerance">Scalability and Fault-tolerance</a></li>
<li><a href="protocols/dht/MainReport.html#distributed-data-storage">Distributed Data Storage</a></li>
</ul>
</li>
<li><a href="protocols/dht/MainReport.html#dht-algorithms">DHT Algorithms</a>
<ul>
<li><a href="protocols/dht/MainReport.html#overview">Overview</a></li>
<li><a href="protocols/dht/MainReport.html#kademlia">Kademlia</a>
<ul>
<li><a href="protocols/dht/MainReport.html#node-id">Node ID</a></li>
<li><a href="protocols/dht/MainReport.html#bootstrapping-a-node">Bootstrapping a Node</a></li>
<li><a href="protocols/dht/MainReport.html#xor-metric">XOR Metric</a></li>
<li><a href="protocols/dht/MainReport.html#protocol">Protocol</a>
<ul>
<li><a href="protocols/dht/MainReport.html#lookup-procedure">Lookup Procedure</a></li>
<li><a href="protocols/dht/MainReport.html#data-storage-and-retrieval-procedure">Data Storage and Retrieval Procedure</a></li>
<li><a href="protocols/dht/MainReport.html#routing-table">Routing Table</a></li>
<li><a href="protocols/dht/MainReport.html#k-bucket-ordering">$k$-bucket Ordering</a></li>
</ul>
</li>
<li><a href="protocols/dht/MainReport.html#kademlia-attacks">Kademlia Attacks</a>
<ul>
<li><a href="protocols/dht/MainReport.html#node-insertion-attack">Node Insertion Attack</a></li>
<li><a href="protocols/dht/MainReport.html#eclipse-attack">Eclipse Attack</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="protocols/dht/MainReport.html#dht-vulnerabilities-and-attacks">DHT Vulnerabilities and Attacks</a>
<ul>
<li><a href="protocols/dht/MainReport.html#eclipse-attack">Eclipse Attack</a></li>
<li><a href="protocols/dht/MainReport.html#sybil-attack">Sybil Attack</a></li>
<li><a href="protocols/dht/MainReport.html#adaptive-join-leave-attack">Adaptive Join-Leave Attack</a></li>
</ul>
</li>
<li><a href="protocols/dht/MainReport.html#cuckoo-rule">Cuckoo Rule</a></li>
<li><a href="protocols/dht/MainReport.html#conclusion">Conclusion</a></li>
<li><a href="protocols/dht/MainReport.html#references">References</a></li>
<li><a href="protocols/dht/MainReport.html#contributors">Contributors</a></li>
</ul>
<h2><a class="header" href="#introduction-15" id="introduction-15">Introduction</a></h2>
<p>A hash table is a data structure that maps keys to values. A hashing function is used to compute keys that are inserted 
into a table from which values can later be retrieved. As the name suggests, a distributed hash table (DHT) is a hash 
table that is distributed across many linked nodes, which cooperate to form a single cohesive hash table service. Nodes 
are linked in what is called an <a href="https://en.wikipedia.org/wiki/Overlay_network">overlay network</a>.
An overlay network is simply a communication network built on top of another network. The Internet is an example, as it 
began as an overlay network on the public switched telephone network.</p>
<p>$\langle key, value \rangle$ pairs are stored on a subset of the network, usually by some notion of &quot;closeness&quot; to that 
key.</p>
<p>A DHT network design allows the network to tolerate nodes coming and going without failure, and allows the network size 
to increase indefinitely.</p>
<p><img src="protocols/dht/./assets/xkcd-network.png" alt="XKCD-Network" /></p>
<p>Image from <a href="https://xkcd.com/350/">XKCD #350 - Network</a> - <a href="https://xkcd.com/license.html">License</a></p>
<p>The need for DHTs arose from early file-sharing networks such as Gnutella, Napster, FreeNet and BitTorrent, which were 
able to make use of distributed resources across
the Internet to provide a single cohesive service [<a href="https://en.wikipedia.org/wiki/Distributed_hash_table." title="Wikipedia: Distributed Hash Table">1</a>].</p>
<p>These systems employed different methods of locating resources on the network:</p>
<ul>
<li>Gnutella searches were inefficient, because queries would result in messages flooding the network.</li>
<li>Napster used a central index server, which was a single point of failure and left it vulnerable to attacks.</li>
<li>FreeNet used a key-based routing. However, it was less structured than a DHT and did not guarantee that data could be found.</li>
</ul>
<p>In 2001, four DHT projects were introduced: CAN, Chord, Pastry and Tapestry. They aimed to have a lookup efficiency
($O(log(n))$) similar to that of a centralized index, while having the benefits of a decentralized network.</p>
<p>DHTs use varying techniques to achieve this, depending on the given algorithm. However, they have a number
of aspects in common:</p>
<ul>
<li>Each participant has some unique network identifier.</li>
<li>They perform peer lookup, data storage and retrieval services.</li>
<li>There is some implicit or explicit joining procedure.</li>
<li>Communication need only occur between neighbors that are decided on by some algorithm.</li>
</ul>
<p>In this report we'll go over some of the aspects common to all DHTs and dive deeper into a popular DHT implementation, 
called <a href="protocols/dht/MainReport.html#kademlia">Kademlia</a>.</p>
<h2><a class="header" href="#characterization-of-dht-networks" id="characterization-of-dht-networks">Characterization of DHT Networks</a></h2>
<h3><a class="header" href="#peer-discovery" id="peer-discovery">Peer Discovery</a></h3>
<p>Peer discovery is the process of locating nodes in a distributed network for data communication.
This is facilitated by every node maintaining a list of peers and sharing that list with other nodes
on the network. A new participant would seek to find their peers on the network by first contacting a
set of predefined bootstrap nodes. These nodes are normal network participants who happen to be part of
some dynamic or static list. It is the job of every node on the network to facilitate peer discovery.</p>
<p>As peers come and go, these lists are repeatedly updated to ensure network integrity.</p>
<h3><a class="header" href="#scalability-and-fault-tolerance" id="scalability-and-fault-tolerance">Scalability and Fault-tolerance</a></h3>
<p>A DHT network efficiently distributes responsibility for the replicated storage and retrieval of routing information
and data. This distribution allows nodes to join and leave with minimal or no disruption. The network can
have a massive number of nodes (in the case of BitTorrent, millions of nodes) without each node having to
know about every other participant in the network. In this way, DHTs are inherently more resilient against hostile 
attackers than a typical centralized system [<a href="https://en.wikipedia.org/wiki/Distributed_hash_table." title="Wikipedia: Distributed Hash Table">1</a>].</p>
<p>BitTorrent is one of the largest decentralized networks in existence, containing in the order of tens of millions
of concurrent users and hundreds of millions of active users. It is estimated that there are a quarter of a billion
distinct monthly users of the BitTorrent network [<a href="https://en.wikipedia.org/wiki/BitTorrent" title="BitTorrent">10</a>]. As of 2019, Tor has approximately 9,000 relay servers and
over 2 million users [<a href="https://en.wikipedia.org/wiki/BitTorrent" title="Servers - Tor Metrics">11</a>].</p>
<h3><a class="header" href="#distributed-data-storage" id="distributed-data-storage">Distributed Data Storage</a></h3>
<p>Arbitrary data may be stored and replicated by a subset of nodes for later retrieval. Data is hashed using a
consistent hashing function (such as SHA256) to produce a key for the data. That data is propagated and
eventually stored on the node or nodes whose node IDs are &quot;closer&quot; to the key for that data for some distance
function.</p>
<p>Partitioned data storage has limited usefulness to a typical blockchain, as each full node is required to keep a copy
of all transactions and blocks for verification.</p>
<h2><a class="header" href="#dht-algorithms" id="dht-algorithms">DHT Algorithms</a></h2>
<h3><a class="header" href="#overview-10" id="overview-10">Overview</a></h3>
<p>The following graph is replicated and simplified from [<a href="https://www.cs.helsinki.fi/webfm_send/1339" title="Overlay and P2P networks">8</a>]. Degree is the number of neighbors with which a node must 
maintain contact.</p>
<table><thead><tr><th>Parameter</th><th>CAN</th><th>CHORD</th><th>Kademlia</th><th>Koord</th><th>Pastry</th><th>Tapestry</th><th>Viceroy</th></tr></thead><tbody>
<tr><td>Foundation</td><td>d-dimensional torus</td><td>Circular space</td><td>XOR metric</td><td>de Bruijn graph</td><td>Plaxton-style mesh</td><td>Plaxton-style mesh</td><td>Butterfly network</td></tr>
<tr><td>Routing function</td><td>Map key-value pairs to coordinate space</td><td>Matching key to node ID</td><td>Matching key to node ID</td><td>Matching key to node ID</td><td>Matching key and prefix in node ID</td><td>Suffix matching</td><td>Levels of tree, vicinity search</td></tr>
<tr><td>Routing performance (network size $n$)</td><td>$O(dn^{(2/d)})$</td><td>$O(log(n))$</td><td>$O(log(n)) + c$ $c$ is small</td><td>Between $O(log(log(n)))$ and $O(log(n))$</td><td>$O(log(n))$</td><td>$O(log(n))$</td><td>$O(log(n))$</td></tr>
<tr><td>Degree</td><td>$2d$</td><td>$O(log(n))$</td><td>$O(log(n))$</td><td>Between constant to $log(n)$</td><td>$O(2log(n))$</td><td>$O(log(n))$</td><td>Constant</td></tr>
<tr><td>Join/Leaves</td><td>$2d$</td><td>$log(n)^2$</td><td>$O(log(n)) + c$ $c$ is small</td><td>$O(log(n))$</td><td>$O(log(n))$</td><td>$O(log(n))$</td><td>$O(log(n))$</td></tr>
<tr><td>Implementations</td><td>--</td><td>OpenChord, OverSIM</td><td>Ethereum [<a href="https://github.com/ethereum/wiki/wiki/Kademlia-Peer-Selection" title="Kademlia Peer Selection">3</a>], Mainline DHT (BitTorrent), I2P, Kad Network</td><td>--</td><td>FreePastry</td><td>OceanStore, Mnemosyne [<a href="https://www.wikiwand.com/en/Tapestry_(DHT)" title="Tapestry (DHT)">4</a>]</td><td>--</td></tr>
</tbody></table>
<p>The popularity of Kademlia over other DHTs is likely due to its relative simplicity and performance. The rest of this 
section dives deeper into Kademlia.</p>
<h3><a class="header" href="#kademlia" id="kademlia">Kademlia</a></h3>
<p>Kademlia is designed to be an efficient means for storing and finding content in a distributed peer-to-peer (P2P) network.
It has a number of core features that are not simultaneously offered by other DHTs [<a href="https://pdos.csail.mit.edu/%7Epetar/papers/maymounkov-kademlia-lncs.pdf" title="Original Kademlia paper">2</a>], such as:</p>
<ul>
<li>The number of messages necessary for nodes to learn about each other, is minimized.</li>
<li>Nodes have enough information to route traffic through low-latency paths.</li>
<li>Parallel and asynchronous queries are made to avoid timeout delays from failed nodes.</li>
<li>The node existence algorithm resists certain basic distributed denial-of-service (DDoS) attacks.</li>
</ul>
<h4><a class="header" href="#node-id" id="node-id">Node ID</a></h4>
<p>A node selects an $n$-bit ID, which is given to other nodes on the network. The network design relies on node IDs being 
uniformly distributed by some random procedure. A node's position is determined by the shortest unique prefix of its 
ID, which forms a tree structure with node IDs as leaves [<a href="https://pdos.csail.mit.edu/%7Epetar/papers/maymounkov-kademlia-lncs.pdf" title="Original Kademlia paper">2</a>]. This ID should be reused when the node rejoins the 
network. The following figure shows a binary tree structure in a three-bit key space:</p>
<div class="mermaid">
graph TD
AR[ ] --- |0| A0( )
AR --- |1| A1[ ]
A0 --- |0| A00[ ]
A0 --- |1| A01[ ]
A00 --- |0| N000[Node 000]
A00 --- |1| N001[Node 001]
A01 --- |0| N010[Node 010]
A01 --- |1| N011[Node 011]
A1 --- |0| A10[ ]
A1 --- |1| A11[ ]
A10 --- |0| A100[Node 100]
A10 --- |1| A101[Node 101]
A11 --- |0| A110[Node 110]
A11 --- |1| A111[Node 111]
</div>
The bit length of the node ID should be sufficiently large to make collisions extremely unlikely when using a uniformly
distributed random number generator [[2]].
<h4><a class="header" href="#bootstrapping-a-node" id="bootstrapping-a-node">Bootstrapping a Node</a></h4>
<p>A node wishing to join the network for the first time has no known contacts. In order for the node to establish
itself on the network, it must contact one, or more than one, bootstrap node. These nodes are not special in any way 
other than being listed in some predefined list. They simply serve as a first point of contact for the requesting node 
to become known to more of the network and to find its closest peers.</p>
<p>There are a number of ways that bootstrap nodes can be obtained, including adding addresses to a configuration and using 
<a href="https://bitcoin.org/en/glossary/dns-seed">DNS seeds</a>. The joining process is described as follows [<a href="https://pdos.csail.mit.edu/%7Epetar/papers/maymounkov-kademlia-lncs.pdf" title="Original Kademlia paper">2</a>]:</p>
<ol>
<li>A joining node generates a random ID.</li>
<li>It contacts a few nodes it knows about.</li>
<li>It sends a <code>FIND_NODE</code> lookup request of its newly generated node ID.</li>
<li>The contacted nodes return the closest nodes they know about. The newly discovered nodes are added to the joining 
node's routing table.</li>
<li>The joining node then contacts some of the new nodes it knows about. The process then continues iteratively until 
the joining node is unable to locate any closer nodes.</li>
</ol>
<p>This <em>self-lookup</em> has two effects: it allows the node to learn about nodes closer to itself; and it populates other 
nodes' routing tables with the node's ID [<a href="https://en.wikipedia.org/wiki/Distributed_hash_table." title="Wikipedia: Distributed Hash Table">1</a>].</p>
<h4><a class="header" href="#xor-metric" id="xor-metric">XOR Metric</a></h4>
<p>The Kademlia paper published in 2002 [<a href="https://pdos.csail.mit.edu/%7Epetar/papers/maymounkov-kademlia-lncs.pdf" title="Original Kademlia paper">2</a>] offered the novel idea of using the XOR ($\oplus​$) operator to determine the 
distance and therefore the arrangement of peers within the network. Defined as:</p>
<p>$$ distance(a, b) = a \oplus b$$</p>
<p>This works, because XOR exhibits the same mathematical properties as any distance function.</p>
<p>Specifically, [<a href="https://en.wikipedia.org/wiki/Distributed_hash_table." title="Wikipedia: Distributed Hash Table">1</a>]</p>
<ul>
<li>Identity: $a \oplus a = 0$</li>
<li>Non-negativity: $a \oplus b &gt; 0$ for $a \neq b$</li>
<li>Symmetry: $a \oplus b = b \oplus a$</li>
<li>Triangle inequality: $a \oplus b + b \oplus c \geq a \oplus c$</li>
</ul>
<p>The XOR metric implicitly captures a notion of distance in the preceding tree structure [<a href="https://pdos.csail.mit.edu/%7Epetar/papers/maymounkov-kademlia-lncs.pdf" title="Original Kademlia paper">2</a>].</p>
<h4><a class="header" href="#protocol" id="protocol">Protocol</a></h4>
<p>Kademlia is a relatively simple protocol consisting of only four remote procedure call (RPC) messages that facilitate 
two independent concerns: peer discovery and data storage/retrieval.</p>
<p>The following RPC messages are part of the Kademlia protocol:</p>
<ul>
<li>Peer discovery
<ul>
<li><code>PING</code>/<code>PONG</code> - used to determine liveness of a peer.</li>
<li><code>FIND_NODE</code> - returns a number of nodes which are closer to a given query value.</li>
</ul>
</li>
<li>Data storage and retrieval
<ul>
<li><code>STORE</code> - request to store a $\langle key, value \rangle$ pair.</li>
<li><code>FIND_VALUE</code> - behaves the same as <code>FIND_NODE</code> by returning closer nodes. If a node has the requested 
$\langle key, value \rangle​$ pair, it will instead return the stored value.</li>
</ul>
</li>
</ul>
<p>Notably, there is no <code>JOIN</code> message. This is because there is no explicit join in Kademlia. Each peer has a chance of 
being added to a routing table of another node whenever an RPC message is sent/received between them [<a href="https://pdos.csail.mit.edu/%7Epetar/papers/maymounkov-kademlia-lncs.pdf" title="Original Kademlia paper">2</a>]. In this 
way, the node becomes known to the network.</p>
<h5><a class="header" href="#lookup-procedure" id="lookup-procedure">Lookup Procedure</a></h5>
<p>The lookup procedure allows nodes to locate other nodes, given a node ID. The procedure begins by the initiator 
concurrently querying the closest $\alpha$ (concurrency parameter) nodes to the target node ID it knows about. The 
queried node returns the $k​$ closest nodes it knows about. The querying node then proceeds in rounds, querying closer 
and closer nodes until it has found the node. In the process, both the querying node and the intermediate nodes have 
learnt about each other.</p>
<h5><a class="header" href="#data-storage-and-retrieval-procedure" id="data-storage-and-retrieval-procedure">Data Storage and Retrieval Procedure</a></h5>
<p>The storage and retrieval procedure ensures that $\langle key, value \rangle$ pairs are reliably stored and able to be
retrieved by participants in the network:</p>
<ul>
<li>
<p>The storage procedure uses the <a href="protocols/dht/MainReport.html#lookup-procedure">lookup procedure</a> to locate the closest nodes to the key, at which
point it issues a <code>STORE</code> RPC message to those nodes. Each node republishes the $\langle key, value \rangle$ pairs to
increase the availability of the data. Depending on the implementation, the data may eventually expire (say 
24 hours). Therefore, the original publisher may be required to republish the data before that period expires.</p>
</li>
<li>
<p>The retrieval procedure follows the same logic as storage, except a <code>FIND_VALUE</code> RPC is issued and the data received.</p>
</li>
</ul>
<h5><a class="header" href="#routing-table" id="routing-table">Routing Table</a></h5>
<p>Each node organizes contacts into a list called a routing table. A routing table is a binary tree where the leaves are 
&quot;buckets&quot; that contain a maximum of $k​$ nodes. $k​$ is a network-wide parameter that should be large enough to ensure 
that lookups and data will be available with high probability. These buckets are aptly named $k​$-buckets, and contain 
nodes with some common node ID prefix.</p>
<p>It should be noted that this is captured by the <a href="protocols/dht/MainReport.html#xor-metric">XOR metric</a>. For instance, given node $A(1100)$ with peers 
$B(1110)$, $C(1101)$, $D(0111)$ and $E(0101)$, the distances from 
node $A$ would be:</p>
<ul>
<li>$A \oplus B = 0010 (2)$</li>
<li>$A \oplus C = 0001 (1)$</li>
<li>$A \oplus D = 1011 (11)$</li>
<li>$A \oplus E = 1001 (9)$</li>
</ul>
<p>$A$, $B$ and $C$ share the same prefix up to the first two most significant bits (MSBs). However, $A$, $C$ and $D$ share
no prefixed bits and are therefore further apart. In this example, $A$, $B$ and $C$ would be in the same bucket, and
$D$ and $E$ in their own bucket.</p>
<p>Initially, a node's routing table is not populated with $k​$-buckets, but may contain a single node in a single 
$k​$-bucket. As more nodes become known, they are added to the $k​$-bucket until it is full. At this point, the node 
splits the bucket in two: one for nodes that share the same prefix as itself and one for all the others.</p>
<p align="center"><img src="protocols/dht/assets/Kad-Evolution-Routing-Table.png" width="450" /></p>
<p>This guarantees that for bucket $j$, where $0 &lt;= j &lt; k$, there is at least one node $N$ in node $A$'s routing table for 
which $$ 2^j &lt;= distance(A, N) &lt; 2^{(j+1)} $$</p>
<h5><a class="header" href="#k-bucket-ordering" id="k-bucket-ordering">$k$-bucket Ordering</a></h5>
<p>Peers within $k$-buckets are sorted from least to most recently seen. Once a node receives a request or reply from a 
peer, it checks to see if the peer is contained in the appropriate $k$-bucket. Depending on whether or not the peer 
already exists, the entry is either moved or appended to the tail of the list (most recently seen). If a particular 
bucket is already size $k$, the node tries to <code>PING</code> the first peer in the list (least recently seen). If the peer does 
not respond, it is evicted and the new peer is appended to the bucket, otherwise the new peer is discarded. In this 
way, the algorithm is biased towards peers that are long-lived and highly available.</p>
<h4><a class="header" href="#kademlia-attacks" id="kademlia-attacks">Kademlia Attacks</a></h4>
<p>Some notable attacks in the Kademlia scheme:</p>
<h5><a class="header" href="#node-insertion-attack" id="node-insertion-attack">Node Insertion Attack</a></h5>
<p>Since there is no verification of a node's ID, an attacker can select their ID to occupy a particular keyspace in the 
network. Once an attacker has inserted themselves in this way, they may censor or manipulate content in that keyspace, 
or eclipse nodes [<a href="https://www.net.t-labs.tu-berlin.de/%7Estefan/icdcn10.pdf" title="Poisoning the Kad Network">9</a>].</p>
<h5><a class="header" href="#eclipse-attack" id="eclipse-attack">Eclipse Attack</a></h5>
<p>Kademlia is vulnerable to eclipse attacks. This is discussed in the following section.</p>
<h2><a class="header" href="#dht-vulnerabilities-and-attacks" id="dht-vulnerabilities-and-attacks">DHT Vulnerabilities and Attacks</a></h2>
<h3><a class="header" href="#eclipse-attack-1" id="eclipse-attack-1">Eclipse Attack</a></h3>
<p>An eclipse attack is an attack that allows adversarial nodes to isolate the victim from the rest of its peers and 
filter its view of the rest of the network. If the attacker is able to occupy all peer connections, the victim is 
eclipsed.</p>
<p>An attacker takes advantage of the fact that in practice, there are relatively few nodes in most parts of a 160-bit 
keyspace. An attacker injects themselves closer to the target than other peers and eventually could achieve a 
dominating position. This can be done cheaply if the network rules allow many peers to come from the same IP address.</p>
<p>The cost of executing an eclipse attack is highly dependent on the architecture of the network and can range from a 
small number of machines (e.g. with hundreds of node instances on a single machine) to requiring a full-fledged botnet. 
Reference [<a href="https://www.cs.bu.edu/%7Egoldbe/projects/eclipseEth.pdf" title="Low-Resource Eclipse Attacks on Ethereum’s Peer-to-Peer Network">6</a>] shows that an eclipse attack on Ethereum's Kademlia-based DHT can be executed using as few as two nodes.</p>
<p>Mitigations include:</p>
<ul>
<li>Identities must be obtained independently from some random oracle.</li>
<li>Nodes maintain contact with nodes outside of their current network placement.</li>
</ul>
<h3><a class="header" href="#sybil-attack" id="sybil-attack">Sybil Attack</a></h3>
<p>Sybil attacks are an attempt by colluding nodes to gain disproportionate control of a network and are often used as a 
vector for other attacks. Many, if not all, DHTs have been designed under the assumption that a low fraction of nodes 
are malicious. A sybil attack attempts to break this assumption by increasing the number of malicious nodes.</p>
<p>Mitigations include [<a href="https://www.researchgate.net/publication/220566526_A_survey_of_DHT_security_techniques" title="A Survey of DHT Security Techniques">12</a>]:</p>
<ul>
<li>Associating a cost with adding new identifiers to the network.</li>
<li>Reliably joining real-world identifiers (IP address, MAC address, etc.) to the node identifier, and rejecting a 
threshold of duplicates.</li>
<li>Having a trusted central authority or secure decentralized scheme that issues identities.</li>
<li>Using social information and trust relationships.</li>
</ul>
<h3><a class="header" href="#adaptive-join-leave-attack" id="adaptive-join-leave-attack">Adaptive Join-Leave Attack</a></h3>
<p>An adversary wants to populate a particular keyspace interval $I$ with bad nodes in order to prevent a particular file
from being shared. Let's suppose that we have a network with node IDs chosen completely at random through some random 
oracle. An adversary starts by executing join/leaves until it has nodes in that keyspace. After that they proceed in 
rounds, keeping the nodes that are in $I$ and rejoining the nodes that aren't, until control is gained over the 
interval ([<a href="http://www.cs.jhu.edu/%7Ebaruch/RESEARCH/Research_areas/Peer-to-Peer/2006_SPAA/virtual5.pdf" title="Towards a Scalable and Robust DHT">5</a>], [<a href="https://web.archive.org/web/20180729064433/http://sns.cs.princeton.edu/docs/ccuckoo-ladis11.pdf" title="Commensal Cuckoo: Secure Group Partitioning for Large-Scale Services">7</a>]).</p>
<p>It should be noted that if there is a large enough cost for rejoining the network, there is a disincentive for this 
attack. In the absence of this disincentive, the <a href="protocols/dht/MainReport.html#cuckoo-rule">cuckoo rule</a> [<a href="http://www.cs.jhu.edu/%7Ebaruch/RESEARCH/Research_areas/Peer-to-Peer/2006_SPAA/virtual5.pdf" title="Towards a Scalable and Robust DHT">5</a>] is proposed as a defence.</p>
<h2><a class="header" href="#cuckoo-rule" id="cuckoo-rule">Cuckoo Rule</a></h2>
<p>Given a network that is partitioned into groups or intervals, and in which nodes are positioned uniformly and randomly.
Adversaries may proceed in rounds, continuously rejoin nodes from the least faulty group until control is gained over
one or more groups as described in <a href="protocols/dht/MainReport.html#adaptive-join-leave-attack">Adaptive Join-Leave Attack</a>.</p>
<p>The cuckoo rule is a join rule that moves (cuckoos) nodes in the same group as the joining node to random locations
outside of the group. It is shown that this can prevent adaptive join-leave attacks with high probability,
i.e. a probability $1 - 1/N$, where $N$ is the size of the network.</p>
<p>Given:</p>
<ul>
<li>$I$ - keyspace group in $[0,1)$;</li>
<li>$n$ - number of honest nodes;</li>
<li>$ \epsilon n$ - number adversarial nodes for constant $\epsilon &lt; 1$;</li>
</ul>
<p>therefore, the network size $N$ is $n + \epsilon n$. Put another way, as $\epsilon$ approaches 1, bad nodes occupy less 
than half of the total network.</p>
<ul>
<li>$k$-region is a region in $[0,1)$ of size $k/n$;</li>
<li>$R_k(x)$ is a unique $k$-region containing $x$.</li>
</ul>
<p>And with the following two conditions:</p>
<ul>
<li>Balancing Condition - the interval $I​$ contains at least $O(log(n))​$ nodes.</li>
<li>Majority Condition - honest nodes are in the majority in $I$.</li>
</ul>
<p>The cuckoo rule states:</p>
<blockquote>
<p>If a new node $v​$ wants to join the system, pick a random $x \in [0, 1)​$. Place $v​$ into $x​$ and move
all nodes in $R_k(x)​$ to points in $[0, 1)​$ chosen uniformly and independently at random (without replacing any
further nodes) [<a href="http://www.cs.jhu.edu/%7Ebaruch/RESEARCH/Research_areas/Peer-to-Peer/2006_SPAA/virtual5.pdf" title="Towards a Scalable and Robust DHT">5</a>].</p>
</blockquote>
<p>It is concluded that for a constant fraction of adversarial peers, where $\epsilon &lt; 1 - 1/k$ for any constant, $k &gt; 1$
is sufficient to prevent adaptive join-leave attacks with high probability.</p>
<p>Sen, Freedman [<a href="https://web.archive.org/web/20180729064433/http://sns.cs.princeton.edu/docs/ccuckoo-ladis11.pdf" title="Commensal Cuckoo: Secure Group Partitioning for Large-Scale Services">7</a>] modelled and analysed the cuckoo rule and found that, in practice, it tolerates very few 
adversarial nodes.</p>
<table><thead><tr><th align="center"></th><th align="center"></th><th align="center"></th></tr></thead><tbody>
<tr><td align="center"><img src="protocols/dht/./assets/Commensal-Cuckoo-Figure1.png" alt="Commensal Cuckoo Figure1" /></td><td align="center"></td><td align="center"><img src="protocols/dht/./assets/Commensal-Cuckoo-Figure2.png" alt="Commensal Cuckoo Figure2" /></td></tr>
<tr><td align="center">(Cuckoo rule) Minimum group size <br>needed to tolerate different $\epsilon$ for 100,000 rounds.<br>Groups must be large (i.e. 100s to 1,000s of nodes) to guarantee correctness [<a href="https://web.archive.org/web/20180729064433/http://sns.cs.princeton.edu/docs/ccuckoo-ladis11.pdf" title="Commensal Cuckoo: Secure Group Partitioning for Large-Scale Services">7</a>]</td><td align="center"></td><td align="center">(Cuckoo rule) Number of rounds the system maintained correctness with an average group<br> size of 64 nodes, varied. Simulation was halted<br> after 100,000 rounds. Failure rates drop dramatically past a certain threshold for different N [<a href="https://web.archive.org/web/20180729064433/http://sns.cs.princeton.edu/docs/ccuckoo-ladis11.pdf" title="Commensal Cuckoo: Secure Group Partitioning for Large-Scale Services">7</a>]</td></tr>
</tbody></table>
<p>Notably, they show that rounds to failure (i.e. more than one-third of nodes in a given group are adversarial) decreases 
dramatically with an increasing but small global fraction of adversarial nodes. An amendment rule is proposed, which 
allows smaller group sizes while maintaining Byzantine correctness. Reference [<a href="https://web.archive.org/web/20180729064433/http://sns.cs.princeton.edu/docs/ccuckoo-ladis11.pdf" title="Commensal Cuckoo: Secure Group Partitioning for Large-Scale Services">7</a>] warrants more investigation, but is 
out of the scope of this report.</p>
<h2><a class="header" href="#conclusion-2" id="conclusion-2">Conclusion</a></h2>
<p>DHTs are a proven solution to distributed storage and discovery. Kademlia, in particular, has been successfully 
implemented and sustained in file-sharing and blockchain networks with participants in the millions. As with every 
network, it is not without its flaws, and careful network design is required to mitigate attacks.</p>
<p>Novel research exists, which proposes schemes for protecting networks against control from adversaries. This research 
becomes especially important when control of a network may mean monetary losses, loss of privacy or denial of service.</p>
<h2><a class="header" href="#references-26" id="references-26">References</a></h2>
<p>[<a href="https://en.wikipedia.org/wiki/Distributed_hash_table." title="Wikipedia: Distributed Hash Table">1</a>] Wikipedia: &quot;Distributed Hash Table&quot; [online]. Available: <a href="https://en.wikipedia.org/wiki/Distributed_hash_table">https://en.wikipedia.org/wiki/Distributed_hash_table</a>. 
Date accessed: 2019‑03‑08.</p>
<p>[<a href="https://pdos.csail.mit.edu/%7Epetar/papers/maymounkov-kademlia-lncs.pdf" title="Original Kademlia paper">2</a>] &quot;Kademlia: A Peer-to-Peer Information System&quot; [online]. Available: <a href="https://pdos.csail.mit.edu/%7Epetar/papers/maymounkov-kademlia-lncs.pdf">https://pdos.csail.mit.edu/~petar/papers/maymounkov-kademlia-lncs.pdf</a>. 
Date accessed: 2019‑03‑08.</p>
<p>[<a href="https://github.com/ethereum/wiki/wiki/Kademlia-Peer-Selection" title="Kademlia Peer Selection">3</a>] Ethereum/Wiki: &quot;Kademlia Peer Selection' [online]. Available: <a href="https://github.com/ethereum/wiki/wiki/Kademlia-Peer-Selection#lookup">https://github.com/ethereum/wiki/wiki/Kademlia-Peer-Selection#lookup</a>. 
Date accessed: 2019‑03‑12.</p>
<p>[<a href="https://www.wikiwand.com/en/Tapestry_(DHT)" title="Tapestry (DHT)">4</a>] Wikipedia: &quot;Tapestry (DHT)&quot; [online]. Available: <a href="https://www.wikiwand.com/en/Tapestry_(DHT)">https://www.wikiwand.com/en/Tapestry_(DHT)</a>. Date accessed: 
2019‑03‑12.</p>
<p>[<a href="http://www.cs.jhu.edu/%7Ebaruch/RESEARCH/Research_areas/Peer-to-Peer/2006_SPAA/virtual5.pdf" title="Towards a Scalable and Robust DHT">5</a>] &quot;Towards a Scalable and Robust DHT&quot; [online]. Available: <a href="http://www.cs.jhu.edu/%7Ebaruch/RESEARCH/Research_areas/Peer-to-Peer/2006_SPAA/virtual5.pdf">http://www.cs.jhu.edu/~baruch/RESEARCH/Research_areas/Peer-to-Peer/2006_SPAA/virtual5.pdf</a>. 
Date accessed: 2019‑03‑12.</p>
<p>[<a href="https://www.cs.bu.edu/%7Egoldbe/projects/eclipseEth.pdf" title="Low-Resource Eclipse Attacks on Ethereum’s Peer-to-Peer Network">6</a>] &quot;Low-resource Eclipse Attacks on Ethereum’s Peer-to-Peer Network&quot; [online]. Available: <a href="https://www.cs.bu.edu/%7Egoldbe/projects/eclipseEth.pdf">https://www.cs.bu.edu/~goldbe/projects/eclipseEth.pdf</a>. 
Date accessed: 2019‑03‑15.</p>
<p>[<a href="https://web.archive.org/web/20180729064433/http://sns.cs.princeton.edu/docs/ccuckoo-ladis11.pdf" title="Commensal Cuckoo: Secure Group Partitioning for Large-Scale Services">7</a>]: &quot;Commensal Cuckoo: Secure Group Partitioning for Large-scale Services&quot; [online]. Available: <a href="https://web.archive.org/web/20180729064433/http://sns.cs.princeton.edu/docs/ccuckoo-ladis11.pdf">https://web.archive.org/web/20180729064433/http://sns.cs.princeton.edu/docs/ccuckoo-ladis11.pdf</a>. Date accessed: 
2019‑03‑15.</p>
<p>[<a href="https://www.cs.helsinki.fi/webfm_send/1339" title="Overlay and P2P networks">8</a>]: &quot;Overlay and P2P Networks&quot; [online]. Available: <a href="https://www.cs.helsinki.fi/webfm_send/1339">https://www.cs.helsinki.fi/webfm_send/1339</a>. 
Date accessed: 2019‑04‑04.</p>
<p>[<a href="https://www.net.t-labs.tu-berlin.de/%7Estefan/icdcn10.pdf" title="Poisoning the Kad Network">9</a>]: &quot;Poisoning the Kad Network&quot; [online]. Available: <a href="https://www.net.t-labs.tu-berlin.de/%7Estefan/icdcn10.pdf">https://www.net.t-labs.tu-berlin.de/~stefan/icdcn10.pdf</a>. 
Date accessed: 2019‑04‑04.</p>
<p>[<a href="https://en.wikipedia.org/wiki/BitTorrent" title="BitTorrent">10</a>]: &quot;BitTorrent&quot; [online]. <a href="https://en.wikipedia.org/wiki/BitTorrent">https://en.wikipedia.org/wiki/BitTorrent</a>. Date accessed: 2019‑04‑04.</p>
<p>[<a href="https://en.wikipedia.org/wiki/BitTorrent" title="Servers - Tor Metrics">11</a>]: &quot;Servers - Tor Metrics&quot; [online]. <a href="https://metrics.torproject.org/networksize.html">https://metrics.torproject.org/networksize.html</a>. Date accessed: 
2019‑04‑29.</p>
<p>[<a href="https://www.researchgate.net/publication/220566526_A_survey_of_DHT_security_techniques" title="A Survey of DHT Security Techniques">12</a>]: &quot;A Survey of DHT Security Techniques&quot; [online]. <a href="https://www.researchgate.net/publication/220566526_A_survey_of_DHT_security_techniques">https://www.researchgate.net/publication/220566526_A_survey_of_DHT_security_techniques</a>. 
Date accessed: 2019‑04‑29.</p>
<h2><a class="header" href="#contributors-19" id="contributors-19">Contributors</a></h2>
<ul>
<li><a href="https://github.com/sdbondi">https://github.com/sdbondi</a></li>
<li><a href="https://github.com/neonknight64">https://github.com/neonknight64</a></li>
<li><a href="https://github.com/philipr-za">https://github.com/philipr-za</a></li>
<li><a href="https://github.com/anselld">https://github.com/anselld</a></li>
</ul>
<head>
<style>
div.mywrap {
  width: 95%; 
  word-wrap: break-word;
  background: #f1f1f1;
  font-size: 0.875em;
  font-family: "Source Code Pro", Consolas, "Ubuntu Mono", Menlo, "DejaVu Sans Mono", monospace, monospace;
  padding: 2.0em;
  color: #6e6b5e;
}
</style>
</head>
<h1><a class="header" href="#mimblewimble-multiparty-bulletproof-utxo" id="mimblewimble-multiparty-bulletproof-utxo">Mimblewimble Multiparty Bulletproof UTXO</a></h1>
<ul>
<li><a href="protocols/mimblewimble-mp-bp-utxo/MainReport.html#introduction">Introduction</a></li>
<li><a href="protocols/mimblewimble-mp-bp-utxo/MainReport.html#background">Background</a>
<ul>
<li><a href="protocols/mimblewimble-mp-bp-utxo/MainReport.html#bitcoin--mtext-of-n--multisig-in-a-nutshell">Bitcoin $ m\text{-of-}n $ Multisig in a Nutshell</a></li>
<li><a href="protocols/mimblewimble-mp-bp-utxo/MainReport.html#security-of-the-mimblewimble-blockchain">Security of the Mimblewimble Blockchain</a></li>
<li><a href="protocols/mimblewimble-mp-bp-utxo/MainReport.html#the-importance-of-range-proofs">The importance of Range Proofs</a></li>
<li><a href="protocols/mimblewimble-mp-bp-utxo/MainReport.html#secure-sharing-protocol">Secure Sharing Protocol</a></li>
</ul>
</li>
<li><a href="protocols/mimblewimble-mp-bp-utxo/MainReport.html#mimblewimble--ntext-of-n--multiparty-bulletproof-utxo">Mimblewimble $ n\text{-of-}n $ Multiparty Bulletproof UTXO</a>
<ul>
<li><a href="protocols/mimblewimble-mp-bp-utxo/MainReport.html#simple-sharing-protocol">Simple Sharing Protocol</a></li>
<li><a href="protocols/mimblewimble-mp-bp-utxo/MainReport.html#setting-up-the-multiparty-funding-transaction">Setting up the Multiparty Funding Transaction</a></li>
<li><a href="protocols/mimblewimble-mp-bp-utxo/MainReport.html#creating-the-multiparty-bulletproof-range-proof">Creating the Multiparty Bulletproof Range Proof</a>
<ul>
<li><a href="protocols/mimblewimble-mp-bp-utxo/MainReport.html#utilizing-bulletproofs-mpc-protocol">Utilizing Bulletproofs MPC Protocol</a></li>
<li><a href="protocols/mimblewimble-mp-bp-utxo/MainReport.html#utilizing-grins-shared-bulletproof-computation">Utilizing Grin's Shared Bulletproof Computation</a></li>
<li><a href="protocols/mimblewimble-mp-bp-utxo/MainReport.html#comparison-of-the-two-bulletproof-methods">Comparison of the two Bulletproof Methods</a></li>
</ul>
</li>
<li><a href="protocols/mimblewimble-mp-bp-utxo/MainReport.html#spending-the-multiparty-utxo">Spending the Multiparty UTXO</a></li>
</ul>
</li>
<li><a href="protocols/mimblewimble-mp-bp-utxo/MainReport.html#mimblewimble--mtext-of-n--multiparty-bulletproof-utxo">Mimblewimble $ m\text{-of-}n $ Multiparty Bulletproof UTXO</a>
<ul>
<li><a href="protocols/mimblewimble-mp-bp-utxo/MainReport.html#secret-sharing">Secret Sharing</a></li>
<li><a href="protocols/mimblewimble-mp-bp-utxo/MainReport.html#multiple-rounds-data">Multiple Rounds' Data</a></li>
<li><a href="protocols/mimblewimble-mp-bp-utxo/MainReport.html#how-it-works">How it Works</a></li>
<li><a href="protocols/mimblewimble-mp-bp-utxo/MainReport.html#spending-protocol">Spending Protocol</a></li>
</ul>
</li>
<li><a href="protocols/mimblewimble-mp-bp-utxo/MainReport.html#comparison-to-bitcoin">Comparison to Bitcoin</a></li>
<li><a href="protocols/mimblewimble-mp-bp-utxo/MainReport.html#conclusions-observations-and-recommendations">Conclusions, Observations and Recommendations</a></li>
<li><a href="protocols/mimblewimble-mp-bp-utxo/MainReport.html#references">References</a></li>
<li><a href="protocols/mimblewimble-mp-bp-utxo/MainReport.html#appendices">Appendices</a>
<ul>
<li><a href="protocols/mimblewimble-mp-bp-utxo/MainReport.html#appendix-a-notation-used">Appendix A: Notation Used</a></li>
<li><a href="protocols/mimblewimble-mp-bp-utxo/MainReport.html#appendix-b-definition-of-terms">Appendix B: Definition of Terms</a></li>
<li><a href="protocols/mimblewimble-mp-bp-utxo/MainReport.html#appendix-c-shamirs-secret-sharing-example">Appendix C: Shamir's Secret Sharing Example</a></li>
</ul>
</li>
<li><a href="protocols/mimblewimble-mp-bp-utxo/MainReport.html#contributors">Contributors</a></li>
</ul>
<h2><a class="header" href="#introduction-16" id="introduction-16">Introduction</a></h2>
<p>In <a href="protocols/mimblewimble-mp-bp-utxo/../mimblewimble-1/MainReport.html">Mimblewimble</a>, the concept of a Bitcoin-type multi-signature (multisig) applied to 
an Unspent Transaction Output (UTXO) does not really exist. </p>
<p>In Bitcoin, multisig payments are usually combined with Pay to Script Hash (P2SH) functionality as a means to send funds 
to a P2SH payment address, and then to manage its expenditure from there. The redeem script itself sets the conditions 
that must be fulfilled for the UTXOs linked to the P2SH payment address to be spent ([<a href="https://blockgeeks.com/guides/bitcoin-script-guide-part-2" title="The Best Step-by-Step Bitcoin Script Guide Part 2">1</a>], [<a href="https://en.bitcoin.it/wiki/Script" title="Script">2</a>]). </p>
<p>Unlike Bitcoin, Mimblewimble transactions do not involve payment addresses, as all transactions are confidential. The 
only requirement for a Mimblewimble UTXO to be spent is the ability to open (or unlock) the 
<a href="protocols/mimblewimble-mp-bp-utxo/../../cryptography/bulletproofs-protocols/MainReport.html#pedersen-commitments-and-elliptic-curve-pedersen-commitments">Pedersen Commitment</a> 
that contains the tokens; it does not require an &quot;owner&quot; signature. A typical Mimblewimble UTXO looks like this [<a href="https://grinexplorer.net/block/0000016c1ceb1cf588a45d0c167dbfb15d153c4d1d33a0fbfe0c55dbf7635410" title="GitHub: gavinandresen/TwoOfThree.sh">9</a>]:</p>
<div class="mywrap">08c15e94ddea81e6a0a31ed558ef5e0574e5369c4fcba92808fe992fbff68884cc</div>
<p>Another fundamental difference is that for any Mimblewimble transaction, all parties, i.e. all senders and all 
receivers, must interact to conclude the transaction.</p>
<h2><a class="header" href="#background-11" id="background-11">Background</a></h2>
<h3><a class="header" href="#bitcoin--mtext-of-n--multisig-in-a-nutshell" id="bitcoin--mtext-of-n--multisig-in-a-nutshell">Bitcoin $ m\text{-of-}n $ Multisig in a Nutshell</a></h3>
<p>Multiple use cases of $ m\text{-of-}n $ multisig applications exist, e.g. a $ 1\text{-of-}2 $ petty cash account, 
a $ 2\text{-of-}2 $ two-factor authentication wallet and a $ 2\text{-of-}3 $ board of directors account [<a href="https://en.bitcoin.it/wiki/Multisignature" title="Multisignature">3</a>]. 
A typical $ 2\text{-of-}3 $ Bitcoin P2SH multisig redeem script (where any two of the three predefined public keys must sign the 
transaction) has the following form:</p>
<pre><code class="language-Text">redeemScript     = &lt;OP_2&gt; &lt;A pubkey&gt; &lt;B pubkey&gt; &lt;C pubkey&gt; &lt;OP_3&gt; OP_CHECKMULTISIG
</code></pre>
<p>The P2SH payment address is the result of the redeem script double hashed with SHA-256 and RIPEMD-160 and then 
Base58Check encoded with a prefix of <code>0x05</code>:</p>
<pre><code class="language-Text">redeemScriptHash = RIPEMD160(SHA256(redeemScript))
P2SHAddress      = base58check.Encode(&quot;05&quot;, redeemScriptHash)
</code></pre>
<p>Multiple payments can now be sent to the P2SH payment address. A generic funding transaction's output script for the 
P2SH payment address has the following form, irrespective of the redeem script's contents:</p>
<pre><code class="language-Text">scriptPubKey      =     OP_HASH160 &lt;redeemScriptHash&gt; OP_EQUAL
</code></pre>
<p>with <code>OP_HASH160</code> being the combination of SHA-256 and RIPEMD-160. The $ 2\text{-of-}3 $ multisig redeem transaction's input script 
would have the following form:</p>
<pre><code class="language-Text">scriptSig         =  OP_0 &lt;A sig&gt; &lt;C sig&gt; &lt;redeemScript&gt;
</code></pre>
<p>and the combined spending and funding transaction script (validation script) would be</p>
<pre><code class="language-Text">validationScript    = OP_0 &lt;A sig&gt; &lt;C sig&gt; &lt;redeemScript&gt; OP_HASH160 &lt;redeemScriptHash&gt; OP_EQUAL
</code></pre>
<p>When <code>validationScript</code> is executed, all values are added to the execution stack in sequence. When opcode <code>OP_HASH160</code> 
is encountered, the preceding value <code>&lt;redeemScript&gt;</code> is hashed and added to the stack; and when opcode <code>OP_EQUAL</code> is 
encountered, the previous two values, hash of the <code>&lt;redeemScript&gt;</code> and <code>&lt;redeemScriptHash&gt;</code>, are compared and removed 
from the stack if equal. The top of the stack then contains <code>&lt;redeemScript&gt;</code>, which is evaluated with the two entries on 
top of that, <code>&lt;A sig&gt;</code> and <code>&lt;C sig&gt;</code>. The last value in the stack, <code>OP_0</code>, is needed for a glitch in the <code>OP_CHECKMULTISIG</code> 
opcode implementation, which makes it pop one more item than those that are available on the stack ([<a href="https://blockgeeks.com/guides/bitcoin-script-guide-part-2" title="The Best Step-by-Step Bitcoin Script Guide Part 2">1</a>], [<a href="https://www.soroushjp.com/2014/12/20/bitcoin-multisig-the-hard-way-understanding-raw-multisignature-bitcoin-transactions" title="Bitcoin Multisig the Hard Way: 
Understanding Raw P2SH Multisig Transactions">5</a>]).</p>
<p><em>What is signed?</em></p>
<p>Partial signatures are created in the same sequence in which the public keys are defined in <code>redeemScript</code>. A simplified 
serialized hexadecimal version of the transaction - consisting of the input transaction ID and UTXO index, amount to be 
paid, <code>scriptPubKey</code> and transaction locktime - is signed. Each consecutive partial signature includes a serialization 
of the previous partial signature with the simplified transaction data to be signed, creating multiple cross-references 
in the signed data. This, combined with the public keys, proves the transaction was created by the real owners of the 
bitcoins in question ([<a href="https://en.bitcoin.it/wiki/Transaction" title="Transaction">4</a>], [<a href="https://www.soroushjp.com/2014/12/20/bitcoin-multisig-the-hard-way-understanding-raw-multisignature-bitcoin-transactions" title="Bitcoin Multisig the Hard Way: 
Understanding Raw P2SH Multisig Transactions">5</a>], [<a href="https://gist.github.com/gavinandresen/3966071" title="GitHub: gavinandresen/TwoOfThree.sh">6</a>]).</p>
<p><em>How is change redirected to the multisig P2SH?</em></p>
<p>Bitcoin transactions can have multiple recipients, and one of the recipients of the funds from a P2SH multisig 
transaction can be the original <code>P2SHAddress</code>, thus sending change back to itself. Circular payments to the same 
addresses are allowed, but they will suffer from a lack of confidentiality. Another way to do this would be to create a 
new <code>redeemScript</code> with a new set of public keys every time a P2SH multisig transaction is done to collect the change, 
but this would be more complex to manage [<a href="https://en.bitcoin.it/wiki/Transaction" title="Transaction">4</a>].</p>
<h3><a class="header" href="#security-of-the-mimblewimble-blockchain" id="security-of-the-mimblewimble-blockchain">Security of the Mimblewimble Blockchain</a></h3>
<p>A <a href="protocols/mimblewimble-mp-bp-utxo/../mimblewimble-1/MainReport.html">Mimblewimble</a> blockchain relies on two complementary aspects to provide security: 
<a href="protocols/mimblewimble-mp-bp-utxo/../../cryptography/bulletproofs-protocols/MainReport.html#pedersen-commitments-and-elliptic-curve-pedersen-commitments">Pedersen Commitments</a> 
and range proofs (in the form of <a href="protocols/mimblewimble-mp-bp-utxo/../../cryptography/bulletproofs-and-mimblewimble/MainReport.html">Bulletproof range proofs</a>). 
Pedersen Commitments, e.g. $ C(v,k) = (vH + kG) $, provide perfectly hiding and computationally binding commitments. 
(Refer to <a href="protocols/mimblewimble-mp-bp-utxo/MainReport.html#appendix-a-notation-used">Appendix A</a> for all notation used.) </p>
<p>In Mimblewimble, this means that an adversary, with infinite computing power, can determine alternate pairs 
$ v ^\prime , k ^\prime $ such that $ C(v,k) = C(v ^\prime , k ^\prime) $ in a reasonable time, to open the commitment 
to another value when challenged (computationally binding). However, it will be impossible to determine the specific 
pair $ v, k $ used to create the commitment, because there are multiple pairs that can produce the same $ C $ (perfectly 
hiding).</p>
<p>In addition to range proofs assuring that all values are positive and not too large, strictly in the range 
$ [0,2^{64} - 1] $, it also prohibits third parties locking away one's funds, as demonstrated in the next section. Since 
Mimblewimble commitments are totally confidential and ownership cannot be proved, anyone can try to spend or mess with 
unspent coins embedded in those commitments. Fortunately, any new UTXO requires a range proof, and this is impossible to 
create if the input commitment cannot be opened.</p>
<h3><a class="header" href="#the-importance-of-range-proofs" id="the-importance-of-range-proofs">The importance of Range Proofs</a></h3>
<p>The role that Bulletproof range proofs play in securing the blockchain can be demonstrated as follows. Let 
$ C_a(v_1 , k_1) $ be the &quot;closed&quot; input UTXO commitment from Alice that a bad actor, Bob, is trying to lock away. 
Bob knows that all commitments in a Mimblewimble blockchain are additionally homomorphic. This means that he can 
theoretically use Alice's commitment as input and create a new opposing output in a transaction that sums to a 
commitment of the value $ 0 $, i.e. $ (\mathbf{0}) $. For this opposing output, Bob will attempt to add an additional 
blinding factor $ k_{x} $ to the commitment in such a way that the miners validating the transactions will not complain. </p>
<p>A valid Mimblewimble transaction would have the following form:</p>
<p>$$
\begin{aligned} 
C_\mathrm{locked}(v_1 , k_1 + k_x) - C_a(v_1 , k_1) - C_b(v_2 , k_2) + \mathrm{fee} \cdot H &amp;= (\mathbf{0}) \\
\\
(v_1 H + (k_1 + k_x) G) - (v_1 H + k_1 G) - (v_2 H + k_2 G) + \mathrm{fee} \cdot H &amp;= (\mathbf{0})
\end{aligned}
\tag{1}
$$</p>
<p>where the unspent-hiding-blinding commitment from Alice is $ (v_1 H + k_1 G) $ and the value of $ (v_2 H + k_2 G) $ 
is equal to $ \mathrm{fee} \cdot H $ to be paid to the miner. The newly created commitment 
$ (v_1 H + (k_1 + k_x) G) $ would be equally unspendable by Alice and Bob, because neither of them would know the 
total blinding factor $ k_1 + k_x $. Fortunately, in order to construct a Bulletproof range proof for the new output 
$ (v_1 H + (k_1 + k_x) G) $ as required by transaction validation rules, the values of $ v_1 $ and $ k_1 + k_x $ 
must be known, otherwise the prover (i.e. Bob) would not be able to convince an honest verifier (i.e. the miner) that 
$ v_1 $ is non-negative (i.e. in the range $ [0,2^n - 1] $).</p>
<p>If Bob can convince Alice that she must create a fund over which both of them have signing powers ($ 2\text{-of-}2 $ 
multisig), it would theoretically be possible to create the required Bulletproof range proof for relation (1) if they 
work together to create it.</p>
<h3><a class="header" href="#secure-sharing-protocol" id="secure-sharing-protocol">Secure Sharing Protocol</a></h3>
<p>Multiple parties working together to create a single transaction that involves multiple steps, need to share information 
in such a way that what they shared cannot work against them. Each step requires a proof, and it should not be possible 
to replay an individual step's proof in a different context. Merlin transcripts [<a href="https://doc-internal.dalek.rs/merlin/index.html" title="Merlin Transcripts">7</a>] is an excellent example of a 
protocol implementation that achieves this. For the purposes of this report, a simple information sharing protocol 
is proposed that can be implemented with Merlin transcripts [<a href="https://doc-internal.dalek.rs/merlin/index.html" title="Merlin Transcripts">7</a>]. </p>
<h2><a class="header" href="#mimblewimble--ntext-of-n--multiparty-bulletproof-utxo" id="mimblewimble--ntext-of-n--multiparty-bulletproof-utxo">Mimblewimble $ n\text{-of-}n $ Multiparty Bulletproof UTXO</a></h2>
<h3><a class="header" href="#simple-sharing-protocol" id="simple-sharing-protocol">Simple Sharing Protocol</a></h3>
<p>Alice, Bob and Carol agree to set up a multiparty $ 3\text{-of-}3 $ multisig fund that they can control together. They 
decide to use a sharing hash function $ val_H = \text{H}_{s}(arg) $ as a handshaking mechanism for all information 
they need to share. The first step is to calculate the hash $ val_H $ for the value $ arg $ they want to 
commit to in sharing, and to distribute it to all parties. They then wait until all other parties' commitments have been 
received. The second step is to send the actual value they committed to all parties, to then verify each 
value against its commitment. If everything matches up, they proceed; otherwise they stop and discard everything they 
have done. </p>
<p>This ensures that public values for each step are not exposed until all commitments have been received. They will apply 
this simple sharing protocol to all information they need to share with each other. This will be denoted by 
$ \text{share:} $.</p>
<h3><a class="header" href="#setting-up-the-multiparty-funding-transaction" id="setting-up-the-multiparty-funding-transaction">Setting up the Multiparty Funding Transaction</a></h3>
<p>In the transaction Alice, Bob and Carol want to set up, $ C_m $ is the multiparty shared commitment that contains the 
funds, and $ C_a $, $ C_b $ and $ C_c $ are their respective input contributions. This transaction looks as follows:</p>
<p>$$
\begin{aligned} 
C_m(v_1, \sum _{j=1}^3 k_jG) - C_a(v_a, k_a) - C_b(v_b, k_b) - C_c(v_c, k_c) + \mathrm{fee} \cdot H &amp;= (\mathbf{0}) \\
(v_1H + (k_1 + k_2 + k_3)G) - (v_aH + k_aG) - (v_bH + k_bG) - (v_cH + k_cG) + \mathrm{fee} \cdot H &amp;= (\mathbf{0})
\end{aligned}
\tag{2}
$$</p>
<p>In order for this scheme to work, they must be able to jointly sign the transaction with a Schnorr signature, while 
keeping their portion of the shared blinding factor secret. Each of them creates their own private blinding factor 
$ k_n $ for the multiparty shared commitment and shares the public blinding factor $ k_nG $ with the group:</p>
<p>$$
\text{share:} \mspace{9mu} \lbrace k_1G, k_2G, k_3G \rbrace
\tag{3}
$$</p>
<p>They proceed to calculate their own total excess blinding factors as 
$ x_{sn} = \sum k_{n(change)} - \sum k_{n(inputs)} - \phi_n $, with $ \phi_n\ $ being a random offset of their own 
choosing (in this example there is no change): </p>
<p>$$
\begin{aligned} 
x_{sa} &amp;= 0 - k_a - \phi_a \\
x_{sb} &amp;= 0 - k_b - \phi_b \\
x_{sc} &amp;= 0 - k_c - \phi_c
\end{aligned}
\tag{4}
$$</p>
<p>The offset $ \phi_n $ is introduced to prevent someone else linking this transaction's inputs and outputs when 
analyzing the Mimblewimble block, and will be used later on to balance the transaction. They consequently share the 
public value of the excess $ x_{sn}G $ with each other: </p>
<p>$$
\text{share:} \mspace{9mu} \lbrace x_{sa}G, x_{sb}G, x_{sc}G \rbrace
\tag{5}
$$</p>
<p>They now have enough information to calculate the aggregated public key for the signature:</p>
<p>$$
\begin{aligned} 
P_{agg} = (k_1G + x_{sa}G) + (k_2G + x_{sb}G) + (k_3G + x_{sc}G) \\
P_{agg} = (k_1G - (k_a + \phi_a)G) + (k_2G - (k_b + \phi_b)G) + (k_3G - (k_c + \phi_c)G)
\end{aligned}
\tag{6}
$$</p>
<p>Each party also selects a private nonce $ r_n $, shares the public value $ r_nG $ with the group,</p>
<p>$$
\text{share:} \mspace{9mu} \lbrace r_aG, r_bG, r_cG \rbrace
\tag{7}
$$</p>
<p>and calculates the aggregated public nonce for the signature:</p>
<p>$$
R_{agg} = r_aG + r_bG + r_cG
\tag{8}
$$</p>
<p>The signature challenge $ e $ can now be calculated:</p>
<p>$$
e = \text{Hash}(R_{agg} || P_{agg} || m) \mspace{18mu} \text{ with } \mspace{18mu} m = \mathrm{fee} \cdot H ||height
\tag{9}
$$</p>
<p>Each party now uses their private nonce $ r_n $, secret blinding factor $ k_n $ and excess $ x_{sn} $ to calculate a 
partial Schnorr signature $ s_n $:</p>
<p>$$
\begin{aligned} 
s_a &amp;= r_a + e \cdot (k_1 + x_{sa}) \\
s_b &amp;= r_b + e \cdot (k_2 + x_{sb}) \\
s_c &amp;= r_c + e \cdot (k_3 + x_{sc})
\end{aligned}
\tag{10}
$$</p>
<p>These partial signatures are then shared with the group to be aggregated:</p>
<p>$$
\text{share:} \mspace{9mu} \lbrace s_a, s_b, s_c \rbrace
\tag{11}
$$</p>
<p>The aggregated Schnorr signature for the transaction is then simply calculated as</p>
<p>$$
s_{agg} = s_a + s_b + s_c
\tag{12}
$$</p>
<p>The resulting signature for the transaction is the tuple $ (s_{agg},R_{agg}) $. To validate the signature, publicly 
shared aggregated values $ R_{agg} $ and $ P_{agg} $ will be needed:</p>
<p>$$
s_{agg}G \overset{?}{=} R_{agg} + e \cdot P_{agg}
\tag{13}
$$</p>
<p>To validate that no funds are created, the total offset must also be stored in the transaction kernel, so the parties 
also share their offset and calculate the total:</p>
<p>$$
\begin{aligned} 
\text{share:} \mspace{9mu} \lbrace \phi_a, \phi_b, \phi_c \rbrace \\
\phi_{tot} = \phi_a + \phi_b + \phi_c
\end{aligned}
\tag{14}
$$</p>
<p>The transaction balance can then be validated to be equal to a commitment to the value $ 0 $ as follows:</p>
<p>$$
(v_1H + (k_1 + k_2 + k_3)G) - (v_aH + k_aG) - (v_bH + k_bG) - (v_cH + k_cG) + \mathrm{fee} \cdot H \overset{?}{=} 
(0H + (P_{agg} + \phi_{tot}G))
\tag{15}
$$</p>
<h3><a class="header" href="#creating-the-multiparty-bulletproof-range-proof" id="creating-the-multiparty-bulletproof-range-proof">Creating the Multiparty Bulletproof Range Proof</a></h3>
<p>One crucial aspect in validating the transaction is still missing, i.e. each new UTXO must also include a Bulletproof 
range proof. Up to now, Alice, Bob and Carol could each keep their portion of the shared blinding factor $ k_n $ 
secret. The new combined commitment they created $ (v_1H + (k_1 + k_2 + k_3)G) $ cannot be used as is to calculate 
the Bulletproof range proof, otherwise the three parties would have to give up their portion of the shared blinding 
factor. Now they need to use a secure method to calculate their combined Bulletproof range proof.</p>
<h4><a class="header" href="#utilizing-bulletproofs-mpc-protocol" id="utilizing-bulletproofs-mpc-protocol">Utilizing Bulletproofs MPC Protocol</a></h4>
<p>This scheme involves coloring the UTXO to enable attachment of additional proof data, a flag to let the miners know that 
they must employ a different set of validation rules and a hash of the UTXO and all metadata. The 
<a href="protocols/mimblewimble-mp-bp-utxo/../../cryptography/bulletproofs-protocols/MainReport.html#mpc-protocol-for-bulletproofs">Bulletproofs Multiparty Computation</a> 
(MPC) protocol can be used in a special way to construct a range proof that can be validated by the miners. Aggregating 
the range proofs using this protocol provides a huge space saving; a single Bulletproof range proof consists of 
672 bytes, whereas aggregating 16 only consists of 928 bytes [<a href="https://cyber.stanford.edu/sites/default/files/bpase18.pptx" title="Bulletproofs: Short Proofs for Confidential Transactions and More (Slides)">11</a>]. For this scheme, the simple information 
sharing protocol will not be adequate; an efficient, robust and secure implementation of the Bulletproof MPC range proof 
such as that done by Dalek Cryptography [<a href="https://doc-internal.dalek.rs/bulletproofs/range_proof_mpc/index.html" title="Dalek Cryptography - Crate Bulletproofs
Module bulletproofs::range_proof_mpc">10</a>] is suggested. </p>
<p>This scheme works as follows. Alice, Bob and Carol proceed to calculate an aggregated MPC Bulletproof range proof for 
the combined multiparty funds, but with each using their own secret blinding factor in the commitment. They therefore 
construct fake commitments that will be used to calculate fake range proofs as follows:</p>
<p>$$
\begin{aligned} 
\text{Alice's fake commitment:} \mspace{18mu} C_1(\frac{v_1}3,k_1) &amp;= (\frac{v_1}3H + k_1G) \\
\text{Bob's fake commitment:} \mspace{18mu} C_2(\frac{v_1}3,k_2) &amp;= (\frac{v_1}3H + k_2G) \\
\text{Carol's fake commitment:} \mspace{18mu} C_3(\frac{v_1}3,k_3) &amp;= (\frac{v_1}3H + k_3G)
\end{aligned}
\tag{16}
$$</p>
<p>Notice that </p>
<p>$$
\begin{aligned} 
C_m(v_1, k_1 + k_2 + k_3) &amp;= C_1(\frac{v_1}3,k_1) + C_2(\frac{v_1}3,k_2) + C_3(\frac{v_1}3,k_3) \\
(v_1H + (k_1 + k_2 + k_3)G) &amp;= (\frac{v_1}3H + k_1G) + (\frac{v_1}3H + k_1G) + (\frac{v_1}3H + k_1G)
\end{aligned}
\tag{17}
$$</p>
<p>and that rounding implementation of $ ^{v_1} / _3 $ can ensure that adding these components for all parties will 
produce the original value $ v_1 $.</p>
<p>Running the Bulletproof MPC range proof will result in a proof share for each party for their fake commitments, which 
will be aggregated by the dealer according to the MPC protocol. Any one of the party members can be the dealer, as the 
objective here is just to create the aggregated range proof. Let the aggregated range proof for the set 
$ \lbrace C_1, C_2, C_3 \rbrace $ be depicted by $ RP_{agg} $. The UTXO will then consist of the tuple 
$ (C_m , RP_{agg}) $ and metadata $ \lbrace flag, C_1, C_2, C_3, hash_{C_{m}} \rbrace $. The hash that will secure 
the metadata is proposed as: </p>
<p>$$
hash_{C_m} = \text{Hash}(C_m || RP_{agg} || flag || C_1 || C_2 || C_3)
\tag{18}
$$</p>
<p>Range proof validation by miners will involve</p>
<p>$$
\begin{aligned} 
hash_{C_m} &amp;\overset{?}{=} \text{Hash}(C_m || RP_{agg} || flag || C_1 || C_2 || C_3) \\
C_m &amp;\overset{?}{=} C_1 + C_2 + C_3 \\
\text{verify: } &amp;RP_{agg} \text{ for set } \lbrace C_1, C_2, C_3 \rbrace 
\end{aligned}
\tag{19}
$$</p>
<p>instead of </p>
<p>$$
\text{verify: } RP_m \text{ for } C_m
\tag{20}
$$</p>
<h4><a class="header" href="#utilizing-grins-shared-bulletproof-computation" id="utilizing-grins-shared-bulletproof-computation">Utilizing Grin's Shared Bulletproof Computation</a></h4>
<p>Grin extended the 
<a href="protocols/mimblewimble-mp-bp-utxo/../../cryptography/bulletproofs-protocols/MainReport.html#inner-product-range-proof">Inner-product Range Proof</a> 
implementation to allow for multiple parties to jointly construct a single Bulletproof range proof $ RP_m $ for a known 
value $ v $, where each party can keep their partial blinding factor secret. The parties must share committed values 
deep within the inner-product range proof protocol ([<a href="https://i.imgur.com/s7exNSf.png" title="Grin Multiparty Bulletproof - jaspervdm">12</a>], [<a href="https://github.com/mimblewimble/secp256k1-zkp/pull/24" title="GitHub: Multi-party bulletproof PR#24">13</a>], [<a href="https://github.com/mimblewimble/secp256k1-zkp/blob/master/src/modules/bulletproofs/tests_impl.h" title="GitHub: secp256k1-zkp/src/modules/bulletproofs/tests_impl.h, 
test_multi_party_bulletproof">14</a>]). </p>
<p>In order to construct the shared Bulletproof range proof $ RP_m $, each party starts to calculate their own range proof 
for commitment $ C_m(v_1, \sum _{j=1}^3 k_jG) $ as follows:</p>
<p>$$
\begin{aligned} 
\text{Alice:} \mspace{18mu} C_1(v_1,k_1) &amp;= (v_1H + k_1G) \\
\text{Bob:} \mspace{18mu} C_2(0,k_2) &amp;= (0H + k_2G) \\
\text{Carol:} \mspace{18mu} C_3(0,k_3) &amp;= (0H + k_3G)
\end{aligned}
\tag{21}
$$</p>
<p>With this implementation, Alice needs to act as the dealer. When they get to <a href="protocols/mimblewimble-mp-bp-utxo/../../cryptography/bulletproofs-protocols/MainReport.html#inner-product-range-proof">steps (53) to (61) in Figure 5</a> of the inner-product range proof 
protocol, they introduce the following changes:</p>
<ol>
<li>Each party shares $ T_{1_j} $ and $ T_{2_j} $ with all other parties.</li>
<li>Each party calculates $ T_1 = \sum_{j=1}^k T_{1_j} $ and $ T_2 = \sum_{j=1}^k T_{2_j} $.</li>
<li>Each party calculates $ \tau_{x_j} $ based on $ T_1 $ and $ T_2 $.</li>
<li>Each party shares $ \tau_{x_j} $ with the dealer.</li>
<li>The dealer calculates $\tau_x = \sum_{j=1}^k \tau_{x_j} $.</li>
<li>The dealer completes the protocol, using their own private $ k_1 $, where a further blinding factor is required, and 
calculates $ RP_m $.</li>
</ol>
<p>Using this approach, the resulting shared commitment for Alice, Bob and Carol is</p>
<p>$$
C_m(v_1, \sum _{j=1}^3 k_jG) = (v_1H + \sum _{j=1}^3 k_jG) = (v_1H + (k_1 + k_2 + k_3)G)
\tag{22}
$$</p>
<p>with the UTXO tuple being $ (C_m , RP_m) $. Range proof validation by miners will involve verifying $ RP_m $ for 
$ C_m $.</p>
<h4><a class="header" href="#comparison-of-the-two-bulletproof-methods" id="comparison-of-the-two-bulletproof-methods">Comparison of the Two Bulletproof Methods</a></h4>
<table><thead><tr><th>Consideration</th><th>Using Dalek's Bulletproofs MPC Protocol</th><th>Using Grin's Multiparty Bulletproof</th></tr></thead><tbody>
<tr><td>Rounds of communication</td><td>Three</td><td>Two</td></tr>
<tr><td>Information sharing security</td><td>Use of Merlin transcripts, combined with the MPC protocol, makes this method more secure against replay attacks.</td><td>No specific sharing protocol suggested, but potentially easy to implement, as described <a href="protocols/mimblewimble-mp-bp-utxo/MainReport.html#simple-sharing-protocol">here</a>.</td></tr>
<tr><td>Guarantee of honest dealer</td><td>With the standard MPC protocol implementation, there is no guarantee that the dealer behaves honestly according to the protocol and generates challenges honestly, but this aspect could be improved <a href="protocols/mimblewimble-mp-bp-utxo/../../cryptography/bulletproofs-protocols/MainReport.html#mpc-protocol-security-discussion">as suggested</a> in that report.</td><td>Although each party independently computes challenges themselves, it isn't clear what the implications of a dishonest dealer would be in practice.</td></tr>
<tr><td>Size of the Bulletproof</td><td>Logarithmic Bulletproof range proof size, i.e. 672 bytes up to 928 bytes for 16 range proofs.</td><td>Single Bulletproof range proof size of 672 bytes.</td></tr>
<tr><td>Colored coin</td><td>Coins are colored, i.e. distinguishable from normal commitments in the blockchain due to additional metadata.</td><td>Coins do not need to be colored, i.e. it may look exactly like any other commitment.</td></tr>
<tr><td>Wallet reconstructability</td><td>Each individual range proof's data is accessible within the aggregated range proof. It is possible to identify the colored coin and then to reconstruct the wallet if the initial blinding factor seed is remembered in conjunction with <a href="protocols/mimblewimble-mp-bp-utxo/../../cryptography/bulletproofs-and-mimblewimble/MainReport.html#improved-implementation">Bulletproof range proof rewinding</a>.</td><td>The wallet cannot be reconstructed, as a single party's blinding factor cannot be distinguished from the combined range proof. Even if these coins were colored with a flag to make them identifiable, it would not help.</td></tr>
<tr><td>Hiding and binding commitment</td><td>The main commitment and additional commitments in the UTXO's metadata retain all hiding and binding security aspects of the Pederson Commitment.</td><td>The commitment retains all hiding and binding security aspects of the Pederson Commitment.</td></tr>
</tbody></table>
<h3><a class="header" href="#spending-the-multiparty-utxo" id="spending-the-multiparty-utxo">Spending the Multiparty UTXO</a></h3>
<p>Alice, Bob and Carol had a private bet going that Carol won, and they agree to spend the multiparty UTXO to pay Carol 
her winnings, with the change being used to set up a consecutive multiparty UTXO. This transaction looks as follows:</p>
<p>$$
\begin{aligned} 
C^{'}_c(v^{'}_c, k^{'}_c) + C^{'}_m(v^{'}_1, \sum _{j=1}^3 k^{'}_{j}G) - C_m(v_1, \sum _{j=1}^3 k_jG) + \mathrm{fee} \cdot H &amp;= (\mathbf{0}) \\
(v^{'}_cH + k^{'}_cG) + (v^{'}_1H + (k^{'}_1 + k^{'}_2 + k^{'}_3)G) - (v_1H + (k_1 + k_2 + k_3)G) + \mathrm{fee} \cdot H &amp;= (\mathbf{0})
\end{aligned}
\tag{23}
$$</p>
<p>Similar to the initial transaction, they each create their own private blinding factor $ k^{'}_n $ for the new 
multiparty UTXO and share the public blinding factor $ k^{'}_nG $ with the group. Carol also shares the public 
blinding factor $ k^{'}_cG $ for her winnings:</p>
<p>$$
\begin{aligned} 
\text{share:} \mspace{9mu} &amp;\lbrace k^{'}_1G, k^{'}_2G, k^{'}_3G \rbrace \\
\text{share:} \mspace{9mu} &amp;\lbrace k^{'}_cG \rbrace
\end{aligned}
\tag{24}
$$</p>
<p>As before, they calculate their own total excess blinding factors as 
$ x^{'}_{sn} = \sum k^{'}_{n(change)} - \sum k^{'}_{n(inputs)} - \phi^{'}_n $: </p>
<p>$$
\begin{aligned} 
x^{'}_{sa} &amp;= 0 - k_1 - \phi^{'}_a \\
x^{'}_{sb} &amp;= 0 - k_2 - \phi^{'}_b \\
x^{'}_{sc} &amp;= 0 - k_3 - \phi^{'}_c
\end{aligned}
\tag{25}
$$</p>
<p>They share the public value of the excess $ x^{'}_{sn}G $ with each other: </p>
<p>$$
\text{share:} \mspace{9mu} \lbrace x^{'}_{sa}G, x^{'}_{sb}G, x^{'}_{sc}G \rbrace
\tag{26}
$$</p>
<p>The aggregated public key for the signature can then be calculated as:</p>
<p>$$
P^{'}_{agg} = (k^{'}_1G + x^{'}_{sa}G) + (k^{'}_2G + x^{'}_{sb}G) + (k^{'}_3G + x^{'}_{sc}G + k^{'}_cG) \\
P^{'}_{agg} = (k^{'}_1G - (k_1 + \phi^{'}_a)G) + (k^{'}_2G - (k_2 + \phi^{'}_a)G) + (k^{'}_3G - (k_3 + \phi^{'}_a)G + k^{'}_cG)
\tag{27}
$$</p>
<p>Each party again selects a private nonce $ r^{'}_n $, shares the public value $ r^{'}_nG $ with the group,</p>
<p>$$
\text{share:} \mspace{9mu} \lbrace r^{'}_aG, r^{'}_bG, r^{'}_cG \rbrace
\tag{28}
$$</p>
<p>and calculates the aggregated public nonce for the signature:</p>
<p>$$
R^{'}_{agg} = r^{'}_aG + r^{'}_bG + r^{'}_cG
\tag{29}
$$</p>
<p>The new signature challenge $ e^{'} $ is then calculated as:</p>
<p>$$
e^{'} = \text{Hash}(R^{'}_{agg} || P^{'}_{agg} || m) \mspace{18mu} \text{ with } \mspace{18mu} m = \mathrm{fee} \cdot H ||height
\tag{30}
$$</p>
<p>Each party now calculates their partial Schnorr signature $ s^{'}_n $ as before, except that Carol also adds her 
winnings' blinding factor $ k^{'}_c $ to her signature:</p>
<p>$$
\begin{aligned} 
s^{'}_a &amp;= r^{'}_a + e^{'} \cdot (k^{'}_1 + x^{'}_{sa})\\
s^{'}_b &amp;= r^{'}_b + e^{'} \cdot (k^{'}_2 + x^{'}_{sa})\\
s^{'}_c &amp;= r^{'}_c + e^{'} \cdot (k^{'}_3 + x^{'}_{sa} + k^{'}_c)
\end{aligned}
\tag{31}
$$</p>
<p>These partial signatures are then shared with the group </p>
<p>$$
\text{share:} \mspace{9mu} \lbrace s^{'}_a, s^{'}_b, s^{'}_c \rbrace
\tag{32}
$$</p>
<p>to enable calculation of the aggregated Schnorr signature as</p>
<p>$$
s^{'}_{agg} = s^{'}_a + s^{'}_b + s^{'}_c
\tag{33}
$$</p>
<p>The resulting signature for the transaction is the tuple $ (s^{'}_{agg},R^{'}_{agg}) $. The signature is again 
validated as done previously, using the publicly shared aggregated values $ R^{'}_{agg} $ and $ P^{'}_{agg} $:</p>
<p>$$
s^{'}_{agg}G \overset{?}{=} R^{'}_{agg} + e^{'} \cdot P^{'}_{agg}
\tag{34}
$$</p>
<p>Again the parties also share their own personal offset so that the total offset can be calculated:</p>
<p>$$
\text{share:} \mspace{9mu} \lbrace \phi^{'}_a, \phi^{'}_b, \phi^{'}_c \rbrace \\
\phi^{'}_{tot} = \phi^{'}_a + \phi^{'}_b + \phi^{'}_c
\tag{35}
$$</p>
<p>Lastly, the transaction balance can be validated to be equal to a commitment to the value $ 0 $:</p>
<p>$$
(v^{'}_cH + k^{'}_cG) + (v^{'}_1H + (k^{'}_1 + k^{'}_2 + k^{'}_3)G) - (v_1H + (k_1 + k_2 + k_3)G) + \mathrm{fee} \cdot H \overset{?}{=} 
(0H + (P^{'}_{agg} + \phi^{'}_{tot}G))
\tag{36}
$$</p>
<h2><a class="header" href="#mimblewimble--mtext-of-n--multiparty-bulletproof-utxo" id="mimblewimble--mtext-of-n--multiparty-bulletproof-utxo">Mimblewimble $ m\text{-of-}n $ Multiparty Bulletproof UTXO</a></h2>
<p>As mentioned in the <a href="protocols/mimblewimble-mp-bp-utxo/MainReport.html#introduction">Introduction</a>, Mimblewimble transactions cannot utilize a smart/redeem script in the 
form of a P2SH, but similar functionality can be implemented in the users' wallets. For the $ m\text{-of-}n $ multiparty 
Bulletproof UTXO, <a href="protocols/mimblewimble-mp-bp-utxo/MainReport.html#ssss" title="Appendix B:
Shamir's Secret Sharing Scheme is an (m, n) 
threshold scheme for n parties to carry shares 
of a secret message such that any m of them 
can reconstruct the message.">Shamir's Secret Sharing Scheme</a> (SSSS) ([<a href="https://www.cs.cornell.edu/courses/cs754/2001fa/129.pdf" title="Non-interactive and Information-theoretic
Secure Verifiable Secret Sharing">8</a>], [<a href="http://iml.univ-mrs.fr/%7Ekohel/tch/MATH3024/Lectures/lectures_11.pdf" title="MATH3024 Elementary Cryptography and Protocols: 
Lecture 11, Secret Sharing">15</a>]) will be used to enable 
$ m\text{-of-}n $ parties to complete a transaction. The SSSS is a method for $ n $ parties to carry one shard (share) 
$ f(i) $ for $ i \in \lbrace 1 , \ldots , n \rbrace $ each of a secret $ s $, such that any $ m $ of them can 
reconstruct the message. The basic idea behind the SSSS is that it is possible to draw an infinite number of polynomials 
of degree $ m $ through $ m $ points, whereas $ m+1 $ points are required to define a unique polynomial of degree $ m $. 
A simplified illustration is shown in Figure 1; the SSSS uses polynomials over a finite field, which is not representable on a two-dimensional plane [<a href="https://en.wikipedia.org/wiki/Shamir%27s_Secret_Sharing" title="Wikipedia: Shamir's Secret Sharing">19</a>].</p>
<p align="center"><img src="protocols/mimblewimble-mp-bp-utxo/sources/shamir_simple.png" width="220" /></p>
<div align="center"><b>Figure&nbsp;1: Infinite Number of Polynomials of Degree 2 Possible through 2 Points</b></div>
<p>The shards will be distributed according to <a href="protocols/mimblewimble-mp-bp-utxo/MainReport.html#pvss" title="Appendix B:
The Pedersen Verifiable Secret Sharing scheme 
is a non-interactive (m, n) threshold scheme 
that combines Pedersen commitments and Shamir's 
Secret Sharing Scheme.">Pedersen’s Verifiable Secret Sharing</a> (VSS) scheme, which extends 
the SSSS, where the dealer commits to the secret $ s $ itself and the coefficients of the sharing polynomial $ f(x) $. 
This is broadcast to all parties, with each receiving a blinding factor shard $ g(i) $ corresponding to their 
secret shard $ f(i) $. This will enable each party to verify that their shard is correct.</p>
<h3><a class="header" href="#secret-sharing" id="secret-sharing">Secret Sharing</a></h3>
<p>Our friends Alice, Bob and Carol decide to set up a $ 2\text{-of-}3 $ scheme, whereby any two of them can authorize a 
spend of their multiparty UTXO. They also want to be able to set up the scheme such that they can perform three rounds 
of spending, with the last round being the closing round. Something they were all thinking about was how to share pieces 
of their blinding factor with each other in a secure and reconstructable fashion. They have heard of Pedersen's VSS scheme 
and decide to use that. </p>
<h3><a class="header" href="#multiple-rounds-data" id="multiple-rounds-data">Multiple Rounds' Data</a></h3>
<p>The parties will each pre-calculate $ three $ private blinding factors $ k_{n\text{-}i} $ and shard it according to 
<a href="protocols/mimblewimble-mp-bp-utxo/MainReport.html#pvss" title="Appendix B:
The Pedersen Verifiable Secret Sharing scheme 
is a non-interactive (m, n) threshold scheme 
that combines Pedersen commitments and Shamir's 
Secret Sharing Scheme.">Pedersen's VSS</a> scheme. The scheme requires $ three $ shard tuples 
$ (k_{n\text{-}party\text{-}i}, b_{n\text{-}party\text{-}i}) $ and $ three $ vectors of commitments 
$\mathbf{C}_{2}( k_{party\text{-}1})$ for each round. (<a href="protocols/mimblewimble-mp-bp-utxo/MainReport.html#appendix-c-shamirs-secret-sharing-example">Appendix C</a> 
shows an example of Alice's sharing shards for one private blinding factor.) Whenever a set of information for each 
blinding factor is shared, the parties immediately verify the correctness of the shards they received by following the 
verification step in Pedersen's VVS protocol. They continue to do this until they have all their information set up, 
ready and stored in their wallets.</p>
<table><thead><tr><th>Round</th><th>Blinding<br />Factor</th><th>Vectors of <br />Commitments</th><th>Alice's <br />Shards</th><th>Bob's <br />Shards</th><th>Carol's <br />Shards</th></tr></thead><tbody>
<tr><td>1</td><td>Alice: $ (k_{1\text{-}1}, b_{1\text{-}1}) $ <br />Bob:   $ (k_{2\text{-}1}, b_{2\text{-}1}) $ <br />Carol: $ (k_{3\text{-}1}, b_{3\text{-}1})$</td><td>$\mathbf{C_{2}}( k_{1\text{-}1})$ <br />$ \mathbf{C_{2}}( k_{2\text{-}1}) $ <br />$\mathbf{C_{2}}( k_{3\text{-}1}) $</td><td>$ (k_{1\text{-}a1}, b_{1\text{-}a1}) $ <br />$ (k_{2\text{-}a1}, b_{2\text{-}a1}) $ <br />$ (k_{3\text{-}a1}, b_{3\text{-}a1}) $</td><td>$ (k_{1\text{-}b1}, b_{1\text{-}b1}) $ <br />$ (k_{2\text{-}b1}, b_{2\text{-}b1}) $ <br />$ (k_{3\text{-}b1}, b_{3\text{-}b1}) $</td><td>$ (k_{1\text{-}c1}, b_{1\text{-}c1}) $ <br />$ (k_{2\text{-}c1}, b_{2\text{-}c1}) $ <br />$ (k_{3\text{-}c1}, b_{3\text{-}c1}) $</td></tr>
<tr><td>2</td><td>Alice: $ (k_{1\text{-}2}, b_{1\text{-}2}) $ <br />Bob:   $ (k_{2\text{-}2}, b_{2\text{-}2}) $ <br />Carol: $ (k_{3\text{-}2}, b_{3\text{-}2}) $</td><td>$ \mathbf{C_{2}}( k_{1\text{-}2}) $ <br />$ \mathbf{C_{2}}( k_{2\text{-}2}) $ <br />$ \mathbf{C_{2}}( k_{3\text{-}2}) $</td><td>$ (k_{1\text{-}a2}, b_{1\text{-}a2}) $ <br />$ (k_{2\text{-}a2}, b_{2\text{-}a2}) $ <br />$ (k_{3\text{-}a2}, b_{3\text{-}a2}) $</td><td>$ (k_{1\text{-}b2}, b_{1\text{-}b2}) $ <br />$ (k_{2\text{-}}b2, b_{2\text{-}b2}) $ <br />$ (k_{3\text{-}},b2 b_{3\text{-}b2}) $</td><td>$ (k_{1\text{-}c2}, b_{1\text{-}c2}) $ <br />$ (k_{2\text{-}}c2, b_{2\text{-}c2}) $ <br />$ (k_{3\text{-}},c2 b_{3\text{-}c2}) $</td></tr>
<tr><td>3</td><td>Alice: $ (k_{1\text{-}3}, b_{1\text{-}3}) $ <br />Bob:   $ (k_{2\text{-}3}, b_{2\text{-}3}) $ <br />Carol: $ (k_{3\text{-}3}, b_{3\text{-}3}) $</td><td>$ \mathbf{C_{2}}( k_{1\text{-}3}) $ <br />$ \mathbf{C_{2}}( k_{2\text{-}3}) $ <br />$ \mathbf{C_{2}}( k_{3\text{-}3}) $</td><td>$ (k_{1\text{-}a3}, b_{1\text{-}a3}) $ <br />$ (k_{2\text{-}a3}, b_{2\text{-}a3}) $ <br />$ (k_{3\text{-}a3}, b_{3\text{-}a3}) $</td><td>$ (k_{1\text{-}b3}, b_{1\text{-}b3}) $ <br />$ (k_{2\text{-}}b3, b_{2\text{-}b3}) $ <br />$ (k_{3\text{-}},b3 b_{3\text{-}b3}) $</td><td>$ (k_{1\text{-}c3}, b_{1\text{-}c3}) $ <br />$ (k_{2\text{-}}c3, b_{2\text{-}c3}) $ <br />$ (k_{3\text{-}},c3 b_{3\text{-}c3}) $</td></tr>
</tbody></table>
<h3><a class="header" href="#how-it-works" id="how-it-works">How it Works</a></h3>
<p>The three parties set up the initial multiparty <a href="protocols/mimblewimble-mp-bp-utxo/MainReport.html#setting-up-the-multiparty-funding-transaction">funding transaction</a> 
and <a href="protocols/mimblewimble-mp-bp-utxo/MainReport.html#creating-the-multiparty-bulletproof-range-proof">Bulletproof range proof</a> exactly the same as they did for the 
$ 3\text{-of-}3 $ case. For this, they use the private blinding factors they pre-calculated for round 1. Now, when 
they decide to spend the multiparty UTXO, only two of them need to be present.</p>
<p>Bob and Carol decide to spend funds, exactly <a href="protocols/mimblewimble-mp-bp-utxo/MainReport.html#spending-the-multiparty-utxo">like before</a>, and for this they need to 
reconstruct Alice's private blinding factor for round 1 and round 2. Because Alice did not win anything, she 
does not need to be present to set up a private blinding factor for an output UTXO the way Carol needs to do. Bob and 
Carol consequently share the shards Alice gave them: </p>
<p>$$
\text{share:} \mspace{9mu} \lbrace (k_{1\text{-}b1}, b_{1\text{-}b1}),  (k_{1\text{-}c1}, b_{1\text{-}c1}), 
(k_{1\text{-}b2}, b_{1\text{-}b2}) ,  (k_{1\text{-}c2}, b_{1\text{-}c2}) \rbrace
\tag{37}
$$</p>
<p>They are now able to reconstruct the blinding factors and verify the commitments to it. If the verification fails, they 
stop the protocol and schedule a meeting with Alice to have a word with her. With all three together, they will be able 
to identify the source of the misinformation.</p>
<p>$$
\begin{aligned} 
\text{reconstruct:} \mspace{9mu} (k_{1\text{-}1}, b_{1\text{-}1}), (k_{1\text{-}2}, b_{1\text{-}2}) \\
\text{verify:} \mspace{9mu} C(k_{1\text{-}1}, b_{1\text{-}1})_{shared} \overset{?}{=} (k_{1\text{-}1}H + b_{1\text{-}1}G) \\
\text{verify:} \mspace{9mu} C(k_{1\text{-}2}, b_{1\text{-}2})_{shared} \overset{?}{=} (k_{1\text{-}2}H + b_{1\text{-}2}G)
\end{aligned} 
\tag{38}
$$</p>
<p>For this round they choose Bob to play Alice's part when they set up and conclude the transaction. Bob is able to do 
this, because he now has Alice's private blinding factors $ k_{1\text{-}1} $ and $ k_{1\text{-}2} $. When constructing 
the signature on Alice's behalf, he chooses a private nonce $ r^{'}_n $ she does not know, as it will only be used to 
construct the signature and then never again. Bob and Carol conclude the transaction, let Alice know this and inform her 
that a consecutive multi-spend needs to start at round 2.</p>
<p>The next time two of our friends want to spend some or all of the remainder of their multiparty UTXO, they will just 
repeat these steps, starting at round 2. The only thing that will be different will be the person nominated to play 
the part of the party that is absent; they have to take turns at this.</p>
<h3><a class="header" href="#spending-protocol" id="spending-protocol">Spending Protocol</a></h3>
<p>Alice, Bob and Carol are now seasoned at setting up their $ 2\text{-of-}3 $ scheme and spending the UTXO until all funds 
are depleted. They have come to an agreement on a simple spending protocol, something to help keep all of them honest:</p>
<ul>
<li>
<p>All parties must always know who shared shards and who played the missing party's role for each round. Therefore, all 
parties must always be included in all sharing communication, even if they are offline. They can then receive those 
messages when they become available again.</p>
</li>
<li>
<p>The spend is aborted if any verification step does not complete successfully. To recommence, the parties have to 
cancel all unused shards, calculate new shards for the remainder and start again. For this, all parties need to be 
present.</p>
</li>
<li>
<p>No party may play the role of an absent party twice in a row. If Alice is absent, which usually happens, Bob and Carol 
must take turns.</p>
</li>
</ul>
<h2><a class="header" href="#conclusions-observations-and-recommendations-9" id="conclusions-observations-and-recommendations-9">Conclusions, Observations and Recommendations</a></h2>
<h3><a class="header" href="#comparison-to-bitcoin" id="comparison-to-bitcoin">Comparison to Bitcoin</a></h3>
<p>Given the basic differences between Bitcoin and Mimblewimble as mentioned in the <a href="protocols/mimblewimble-mp-bp-utxo/MainReport.html#introduction">Introduction</a>, and the 
multiparty payment scheme introduced here, the following observations can be made:</p>
<ol>
<li>
<p>Miner Validation</p>
<p>In Bitcoin, the P2SH multisig redeem script is validated by miners whenever a multisig payment is invoked. In 
addition, they also validate the public keys used in the transaction.</p>
<p>With Mimblewimble multiparty transactions, miners cannot validate who may be part of a multiparty transaction, only 
that the transaction itself complies with basic Mimblewimble rules and that all Bulletproof range proofs are valid. 
The onus is on the parties themselves to enforce basic spending protocol validation rules.</p>
</li>
<li>
<p>$ m\text{-of-}n $</p>
<p>In both Bitcoin and Mimblewimble, $ m\text{-of-}n $ transactions are possible. The difference is in where and how 
validation rules are applied.</p>
</li>
<li>
<p>Security</p>
<p>Bitcoin multiparty transactions are more secure due to the validation rules being enforced by the miners.</p>
</li>
<li>
<p>Complexity</p>
<p>Implementing $ m\text{-of-}n $ multiparty transactions in Mimblewimble will involve wallets to store more data and 
implement more functionality than when compared to Bitcoin, e.g. Pedersen's VSS scheme.</p>
</li>
</ol>
<h3><a class="header" href="#general-1" id="general-1">General</a></h3>
<ol>
<li>
<p>Bulletproof Range Proof</p>
<p>The choice between using Dalek's Bulletproofs MPC Protocol or Grin's multiparty Bulletproof to construct a multiparty 
range proof is important. Although using Dalek's method involves more rounds of communication, with a slightly larger 
proof size and the requirement to have the coins colored, it has definite advantages. It trumps on wallet 
reconstructability and information sharing security while executing the protocol, although the latter could easily be 
enhanced for the Grin implementation.</p>
</li>
<li>
<p>Practicality</p>
<p>The Mimblewimble multiparty Bulletproof UTXO as proposed can be practically implemented for both the 
$ n\text{-of-}n $ and $ m\text{-of-}n $ cases.</p>
</li>
<li>
<p>Information Sharing Protocol</p>
<p>The <a href="protocols/mimblewimble-mp-bp-utxo/MainReport.html#simple-sharing-protocol">Simple Sharing Protocol</a> as suggested here may need some more work to make it optimal.</p>
</li>
<li>
<p>Generalization</p>
<p>Although all examples presented here were for three parties, this could easily be generalized.</p>
</li>
</ol>
<h2><a class="header" href="#references-27" id="references-27">References</a></h2>
<p>[<a href="https://blockgeeks.com/guides/bitcoin-script-guide-part-2" title="The Best Step-by-Step Bitcoin Script Guide Part 2">1</a>] &quot;The Best Step-by-Step Bitcoin Script Guide Part 2&quot; [online]. Available: 
<a href="https://blockgeeks.com/guides/bitcoin-script-guide-part-2">https://blockgeeks.com/guides/bitcoin-script-guide-part-2</a>. Date accessed: 2019‑05‑02.</p>
<p>[<a href="https://en.bitcoin.it/wiki/Script" title="Script">2</a>] &quot;Script&quot; [online]. Available: <a href="https://en.bitcoin.it/wiki/Script">https://en.bitcoin.it/wiki/Script</a>. Date accessed: 2019‑05‑06.</p>
<p>[<a href="https://en.bitcoin.it/wiki/Multisignature" title="Multisignature">3</a>] &quot;Multisignature&quot; [online]. Available: <a href="https://en.bitcoin.it/wiki/Multisignature">https://en.bitcoin.it/wiki/Multisignature</a>. 
Date accessed: 2019‑05‑06.</p>
<p>[<a href="https://en.bitcoin.it/wiki/Transaction" title="Transaction">4</a>] &quot;Transaction&quot; [online]. Available: <a href="https://en.bitcoin.it/wiki/Transaction">https://en.bitcoin.it/wiki/Transaction</a>. Date accessed: 2019‑05‑06.</p>
<p>[<a href="https://www.soroushjp.com/2014/12/20/bitcoin-multisig-the-hard-way-understanding-raw-multisignature-bitcoin-transactions" title="Bitcoin Multisig the Hard Way: 
Understanding Raw P2SH Multisig Transactions">5</a>] S. Pour, &quot;Bitcoin Multisig the Hard Way: Understanding Raw P2SH Multisig Transactions&quot; [online]. Available: <a href="https://www.soroushjp.com/2014/12/20/bitcoin-multisig-the-hard-way-understanding-raw-multisignature-bitcoin-transactions">https://www.soroushjp.com/2014/12/20/bitcoin-multisig-the-hard-way-understanding-raw-multisignature-bitcoin-transactions</a>. 
Date accessed: 2019‑05‑06.</p>
<p>[<a href="https://gist.github.com/gavinandresen/3966071" title="GitHub: gavinandresen/TwoOfThree.sh">6</a>] GitHub: &quot;gavinandresen/TwoOfThree.sh&quot; [online]. Available: <a href="https://gist.github.com/gavinandresen/3966071">https://gist.github.com/gavinandresen/3966071</a>. 
Date accessed: 2019‑05‑06.</p>
<p>[<a href="https://doc-internal.dalek.rs/merlin/index.html" title="Merlin Transcripts">7</a>] H.de Valence, I. Lovecruft and O. Andreev, &quot;Merlin Transcripts&quot; [online]. Available: <a href="https://merlin.cool/index.html">https://merlin.cool/index.html</a> 
and <a href="https://doc-internal.dalek.rs/merlin/index.html">https://doc-internal.dalek.rs/merlin/index.html</a>. Date accessed: 2019‑05‑10.</p>
<p>[<a href="https://www.cs.cornell.edu/courses/cs754/2001fa/129.pdf" title="Non-interactive and Information-theoretic
Secure Verifiable Secret Sharing">8</a>] T. Pedersen, &quot;Non-interactive and Information-theoretic Secure Verifiable Secret Sharing&quot; 
[online]. Available: <a href="https://www.cs.cornell.edu/courses/cs754/2001fa/129.pdf">https://www.cs.cornell.edu/courses/cs754/2001fa/129.pdf</a>. 
Date accessed: 2019‑05‑10.</p>
<p>[<a href="https://grinexplorer.net/block/0000016c1ceb1cf588a45d0c167dbfb15d153c4d1d33a0fbfe0c55dbf7635410" title="GitHub: gavinandresen/TwoOfThree.sh">9</a>] &quot;GrinExplorer, Block 164,690&quot; [online]. Available: <a href="https://grinexplorer.net/block/0000016c1ceb1cf588a45d0c167dbfb15d153c4d1d33a0fbfe0c55dbf7635410">https://grinexplorer.net/block/0000016c1ceb1cf588a45d0c167dbfb15d153c4d1d33a0fbfe0c55dbf7635410</a>. 
Date accessed: 2019‑05‑10.</p>
<p>[<a href="https://doc-internal.dalek.rs/bulletproofs/range_proof_mpc/index.html" title="Dalek Cryptography - Crate Bulletproofs
Module bulletproofs::range_proof_mpc">10</a>] &quot;Dalek Cryptography - Crate Bulletproofs - Module bulletproofs::range_proof_mpc&quot; [online]. Available: 
<a href="https://doc-internal.dalek.rs/bulletproofs/range_proof_mpc/index.html">https://doc-internal.dalek.rs/bulletproofs/range_proof_mpc/index.html</a>. Date accessed: 2019‑05‑10.</p>
<p>[<a href="https://cyber.stanford.edu/sites/default/files/bpase18.pptx" title="Bulletproofs: Short Proofs for Confidential Transactions and More (Slides)">11</a>] B. Bünz, J. Bootle, D. Boneh, A. Poelstra, P. Wuille and G. Maxwell, &quot;Bulletproofs: Short Proofs for 
Confidential Transactions and More&quot; (Slides) [online]. Available: 
<a href="https://cyber.stanford.edu/sites/default/files/bpase18.pptx">https://cyber.stanford.edu/sites/default/files/bpase18.pptx</a>. Date accessed: 2019‑05‑11. </p>
<p>[<a href="https://i.imgur.com/s7exNSf.png" title="Grin Multiparty Bulletproof - jaspervdm">12</a>] &quot;Grin Multiparty Bulletproof - jaspervdm&quot; [online]. Available: <a href="https://i.imgur.com/s7exNSf.png">https://i.imgur.com/s7exNSf.png</a>. 
Date accessed: 2019‑05‑10.</p>
<p>[<a href="https://github.com/mimblewimble/secp256k1-zkp/pull/24" title="GitHub: Multi-party bulletproof PR#24">13</a>] GitHub: &quot;Multi-party bulletproof PR#24&quot; [online]. Available: <a href="https://github.com/mimblewimble/secp256k1-zkp/pull/24">https://github.com/mimblewimble/secp256k1-zkp/pull/24</a>. 
Date accessed: 2019‑05‑10.</p>
<p>[<a href="https://github.com/mimblewimble/secp256k1-zkp/blob/master/src/modules/bulletproofs/tests_impl.h" title="GitHub: secp256k1-zkp/src/modules/bulletproofs/tests_impl.h, 
test_multi_party_bulletproof">14</a>] GitHub: &quot;secp256k1-zkp/src/modules/bulletproofs/tests_impl.h, test_multi_party_bulletproof&quot; [online]. Available: 
<a href="https://github.com/mimblewimble/secp256k1-zkp/blob/master/src/modules/bulletproofs/tests_impl.h">https://github.com/mimblewimble/secp256k1-zkp/blob/master/src/modules/bulletproofs/tests_impl.h</a>. 
Date accessed: 2019‑05‑10.</p>
<p>[<a href="http://iml.univ-mrs.fr/%7Ekohel/tch/MATH3024/Lectures/lectures_11.pdf" title="MATH3024 Elementary Cryptography and Protocols: 
Lecture 11, Secret Sharing">15</a>] &quot;MATH3024 Elementary Cryptography and Protocols: Lecture 11, Secret Sharing&quot;, University of Sydney, School of 
Mathematics and Statistics [online]. Available: <a href="http://iml.univ-mrs.fr/%7Ekohel/tch/MATH3024/Lectures/lectures_11.pdf">http://iml.univ-mrs.fr/~kohel/tch/MATH3024/Lectures/lectures_11.pdf</a>. 
Date accessed: 2018‑09‑18.</p>
<p>[<a href="https://iancoleman.io/shamir" title="Online Tool: Shamir Secret Sharing Scheme">16</a>] I. Coleman, &quot;Online Tool: Shamir Secret Sharing Scheme&quot; [online]. Available: <a href="https://iancoleman.io/shamir">https://iancoleman.io/shamir</a>. 
Date accessed: 2019‑05‑27.</p>
<p>[<a href="https://research.cyber.ee/%7Epeeter/teaching/krprot07s/ss.pdf" title="Cryptographic Protocols (MTAT.07.005): Secret Sharing">17</a>] P. Laud, &quot;Cryptographic Protocols (MTAT.07.005): Secret Sharing&quot;, Cybernetica [online]. Available: <a href="https://research.cyber.ee/%7Epeeter/teaching/krprot07s/ss.pdf">https://research.cyber.ee/~peeter/teaching/krprot07s/ss.pdf</a>. 
Date accessed: 2019‑05‑29.</p>
<p>[<a href="https://doi.org/10.7146/dpb.v21i388.6621" title="Distributed Provers and Verifiable Secret Sharing 
Based on the Discrete Logarithm Problem">18</a>] T. Pedersen, &quot;Distributed Provers and Verifiable Secret Sharing Based on the Discrete Logarithm Problem&quot;, DPB, vol. 21, no. 388, Mar. 1992 [online]. Available: <a href="https://doi.org/10.7146/dpb.v21i388.6621">https://doi.org/10.7146/dpb.v21i388.6621</a>. 
Date accessed: 2019‑06‑03.</p>
<p>[<a href="https://en.wikipedia.org/wiki/Shamir%27s_Secret_Sharing" title="Wikipedia: Shamir's Secret Sharing">19</a>] Wikipedia: &quot;Shamir's Secret Sharing&quot; [online]. Available: <a href="https://en.wikipedia.org/wiki/Shamir%27s_Secret_Sharing">https://en.wikipedia.org/wiki/Shamir%27s_Secret_Sharing</a>. 
Date accessed: 2019‑05‑06.</p>
<h2><a class="header" href="#appendices-9" id="appendices-9">Appendices</a></h2>
<h3><a class="header" href="#appendix-a-notation-used-1" id="appendix-a-notation-used-1">Appendix A: Notation Used</a></h3>
<p>This section gives the general notation of mathematical expressions used. It provides important pre-knowledge for the 
remainder of the report.</p>
<ul>
<li>
<p>All Pedersen Commitments will be of the <a href="protocols/mimblewimble-mp-bp-utxo/(../../cryptography/bulletproofs-protocols/MainReport.html#pedersen-commitments-and-elliptic-curve-pedersen-commitments)">elliptic derivative</a> 
depicted by $ C(v,k) = (vH + kG) $ with $ v $ being the value committed to and $ k $ being the blinding factor.</p>
</li>
<li>
<p>Scalar multiplication will be depicted by &quot;$ \cdot $&quot;, e.g. $ e \cdot (vH + kG) = e \cdot vH + e \cdot kG $.</p>
</li>
<li>
<p>A Pedersen Commitment to the value of $ 0 $ will be depicted by $ C(0,k) = (0H + kG) = (kG) = (\mathbf{0}) $.</p>
</li>
<li>
<p>Let $ \text{H}_{s}(arg) $ be a collision-resistant hash function used in an information sharing protocol where 
$ arg $ is the value being committed to.</p>
</li>
<li>
<p>Let $ RP_n $ be Bulletproof range proof data for commitment $ C_n $.</p>
</li>
<li>
<p>Let $ RP_{agg} $ be aggregated Bulletproof range proof data for a set of commitments 
$ \lbrace C_1, C_2, ... , C_n \rbrace $.</p>
</li>
<li>
<p>Let $ \mathbf {C_{m}}(v) $ be a vector of commitments $ (C_0 , \ldots , C_{m-1}) $ for value $ v $.</p>
</li>
</ul>
<h3><a class="header" href="#appendix-b-definition-of-terms" id="appendix-b-definition-of-terms">Appendix B: Definition of Terms</a></h3>
<p>Definitions of terms presented here are high level and general in nature. Full mathematical definitions are available in 
the cited references.</p>
<ul>
<li>
<p><strong>Shamir's Secret Sharing Scheme:</strong><a name="ssss"> </a>A $ (m, n) $ threshold secret sharing scheme is a method for 
$ n $ parties to carry shards/shares of a secret message $ s $ such that any $ m $ of them can reconstruct the message. 
The threshold scheme is perfect if knowledge of $ m − 1 $ or fewer shards provides no information regarding $ s $. 
Shamir's Secret Sharing Scheme provides a perfect $ (m, n) $ threshold scheme using Lagrange interpolation 
([<a href="http://iml.univ-mrs.fr/%7Ekohel/tch/MATH3024/Lectures/lectures_11.pdf" title="MATH3024 Elementary Cryptography and Protocols: 
Lecture 11, Secret Sharing">15</a>], [<a href="https://research.cyber.ee/%7Epeeter/teaching/krprot07s/ss.pdf" title="Cryptographic Protocols (MTAT.07.005): Secret Sharing">17</a>, [<a href="https://en.wikipedia.org/wiki/Shamir%27s_Secret_Sharing" title="Wikipedia: Shamir's Secret Sharing">19</a>]). </p>
<ul>
<li>Given $ m $ distinct points $ (x_i, y_i) $ of the form $ (x_i, f(x_i)) $, where $ f(x) $ is a polynomial of 
degree less than $ m $, then according to the Lagrange interpolation formula $ f(x) $ and $ f(0) $ is determined by</li>
</ul>
<p>$$
f(x) = \sum _{i=1}^{m} y _{i} \prod _{1 \leq j \leq m \atop i \neq j} \frac{x - x _{j}}{x _{i} - x _{j}} \\
\tag{B1}
$$</p>
<p>$$
f(0) = \sum _{i=1}^{m} f(i) \prod _{j \in I \atop j \neq i} \frac{i}{j - i} 
\tag{B2}
$$</p>
<ul>
<li>Shamir’s scheme is defined for a secret message $ s \in \mathbb{Z}/p\mathbb{Z} $ with prime $ p $, by setting 
$ a_0 = f(0) = s$ for a polynomial $ f(x) $, and choosing the other coefficients $ a_1, \ldots , a_{m−1} $ at 
random in $ \mathbb{Z}/p\mathbb{Z} $. The trusted party computes $ f(i) $ for all $ 1 \leq i \leq n $, where</li>
</ul>
<p>$$
f(x) = \sum _{k=0}^{m - 1} a _{k} x^{k} = a_0x^0 + a_1x^1 + a_2x^2 + \ldots + a_{m-1}x^{m-1}
\tag{B3}
$$</p>
<ul>
<li>The shards $ (i, f(i)) $ are distributed to the $ n $ distinct parties. Since the secret is the constant term 
$ s = a_0 = f(0) $, it is recovered from any $ m $ shards $ (i, f(i)) $ for $ I \subset \lbrace 1, \ldots, n \rbrace $ 
by</li>
</ul>
<p>$$
s = \sum _{i \in I} f(i) \prod _{j \in I \atop j \neq i} \frac{i}{j - i} 
\tag{B4}
$$</p>
</li>
</ul>
<ul>
<li>
<p><strong>Pedersen Verifiable Secret Sharing:</strong><a name="pvss"> </a>The Pedersen Verifiable Secret Sharing scheme is a 
non-interactive $ (m, n) $ threshold VSS scheme that combines 
<a href="protocols/mimblewimble-mp-bp-utxo/../../cryptography/bulletproofs-protocols/MainReport.html#pedersen-commitments-and-elliptic-curve-pedersen-commitments">Pedersen Commitments</a> 
and <a href="protocols/mimblewimble-mp-bp-utxo/MainReport.html#ssss" title="Appendix B:
Shamir's Secret Sharing Scheme is an (m, n) 
threshold scheme for n parties to carry shares 
of a secret message such that any m of them 
can reconstruct the message.">Shamir's Secret Sharing Scheme</a> ([<a href="https://www.cs.cornell.edu/courses/cs754/2001fa/129.pdf" title="Non-interactive and Information-theoretic
Secure Verifiable Secret Sharing">8</a>], [<a href="https://research.cyber.ee/%7Epeeter/teaching/krprot07s/ss.pdf" title="Cryptographic Protocols (MTAT.07.005): Secret Sharing">17</a>], [<a href="https://doi.org/10.7146/dpb.v21i388.6621" title="Distributed Provers and Verifiable Secret Sharing 
Based on the Discrete Logarithm Problem">18</a>). This is to ensure the dealer gives consistent shares 
to all parties and that any party can know that the recovered secret is correct.</p>
<ul>
<li>
<p>The dealer creates a commitment to the secret $ s $ for a randomly chosen blinding factor $ r $ as 
$ C_0(s,r) = (sH + rG) $.</p>
</li>
<li>
<p>The dealer constructs the SSSS sharing polynomial $ f(x) $ as before by setting $ a_0 = s $, and randomly 
choosing $ a_1, \ldots , a_{m−1} $.</p>
</li>
<li>
<p>The dealer also constructs a blinding factor polynomial $ g(x) $, similar to the SSSS polynomial, by setting 
$ b_0 = r $, and randomly choosing $ b_1, \ldots , b_{m−1} $. </p>
</li>
<li>
<p>The dealer constructs commitments to the secret coefficients of $ f(x) $ as $ C_i(a_i,b_i) = (a_iH + b_iG) $ 
for $ i \in \lbrace 1, \ldots, m-1 \rbrace $.</p>
</li>
<li>
<p>The dealer broadcasts the vector of commitments $ \mathbf {C_{m}} = (C_0 , \ldots , C_{m-1}) $ to all parties.</p>
</li>
<li>
<p>The dealer calculates $ (f(i), g(i)) $ from polynomials $ f(x), g(x) $ for $ i \in \lbrace 1, \ldots, n \rbrace $ 
and distributes the individual shards $ (i, f(i), g(i)) $ to the $ n $ distinct parties.</p>
</li>
<li>
<p>Upon receipt of their shard $ (i, f(i), g(i)) $, each party calculates their own commitment $ (f(i)H + g(i)G) $ and 
verifies that:</p>
</li>
</ul>
<p>$$
\begin{aligned}
(f(i)H + g(i)G) &amp;\overset{?}{=} \sum _{j=0}^{m-1} C_j \cdot i^j \\
(a_0i^0 + a_1i^1 + \ldots + a_{m-1}i^{m-1})H + (b_0i^0 + b_1i^1 + \ldots + b_{m-1}i^{m-1})G &amp;\overset{?}{=} \\
\quad (a_0H + b_0G) \cdot i^0 + (a_1H + b_1G) \cdot i^1 + &amp;\ldots + (a_{m-1}H + b_{m-1}G) \cdot i^{m-1} 
\end{aligned}
\tag{B5}
$$</p>
<ul>
<li>
<p>The secret $ s $ is recovered as before as per the SSSS from any $ m $ shards.</p>
</li>
<li>
<p>In addition to reconstructing the secret $ s $, the following can be done:</p>
<ul>
<li>Since the blinding factor is the constant term $ r = b_0 = g(0) $, the blinding factor is recovered from any 
$ m $ shards $ (i, g(i)) $ for $ I \subset \lbrace 1, \ldots, n \rbrace $ by</li>
</ul>
<p>$$
r = \sum _{i \in I} g(i) \prod _{j \in I \atop j \neq i} \frac{i}{j - i}
\tag{B6}
$$</p>
<ul>
<li>Since $ C_0 $ is the first entry in the vector of commitments $ \mathbf {C_{m}} $, the parties can verify the 
correctness of the original secret $ s $ that was committed to in the first place when the shards have been shared 
among the parties as:</li>
</ul>
<p>$$
C_0(s,r) \overset{?}{=} (sH + rG)
\tag{B7}
$$</p>
</li>
</ul>
</li>
</ul>
<h3><a class="header" href="#appendix-c-shamirs-secret-sharing-example" id="appendix-c-shamirs-secret-sharing-example">Appendix C: Shamir's Secret Sharing Example</a></h3>
<p>One of the private blinding factors Alice calculated and wants to share with Bob and Carol is</p>
<div class="mywrap">29bb078b7b2b01e62dd684cd20742b510ece6175fa58d7a79cceeefe5297a804</div>
<p>Alice's shard:</p>
<div class="mywrap">
80168f0598f73bc29f90aaeb0d87caf44a8f6baaaeabcf15af20dd1d27e28f30b7afb6c889da2eefc6cca9a1505a92d8b65f968f554dede39a23b293aa7ddd4d50499d0fbfe86d60b4ff87938609cda5d3aecf37d7fc8ff54f777e26ad2dc4d1268a7a4ba0c94706a017e0a1e3fd969e7c2627e28dc3e8ecb7f73426ffe2c5b72467905d072528f060c29f9d221a93dfb213add323fee3373ff11cace1a87f0b095029b32f0fcf6735ce8611f823c9b697452b728a34f0dee13d2b2a5f30f70d096cd7ba6cf9f7b0431673373ffa1e358d9d8c02f9bec54b53f66ec76069499cd21d95099f826a91d92665a6709f607793c1b2548ccb1f6b46c3cbc0af6ed55b02a
</div>
<p>Bob's shard:</p>
<div class="mywrap">
802d0fdb203e66552ef14417dadf843884df16949c965ffb4f91abfb9fc50fb16f4ebd80d2759c1e5d889292a0a4f5a0bcaefd0f7a8a1a1725976527453a7b5b7082fbdebe111b1169eedf270c025a9ba74c5fbfafe8de3a8f3eed9d4b9a59a24d05355691835e0d402fc143c7eafd2d399c4fc50a57c018bfee684dee158b6e48ff256bdb4a44b0cbb52b6b9094f2ceb1d740864d4c1c9e64c2226819113587d7c0472645ee5a8e614cd8a3e467888d242a42c50029e49c17cb9d6575e1e4fbd6187a551dc23500834ce3ae6ba5f8bb0f9ad315e8ec5f47736cc9feca035838714affa2f424c1c3a69cc12ce44f1a8f22136ec90cd7fa8758878c31457c7e17d02
</div>
<p>Carol's shard:</p>
<div class="mywrap">
803b80deb8c95d97b161eefcd7584eccce507d3e323d90eee0b176e6b8278081d8e10b485bafb2f19b443b33f0fe67780af16b802fc7f7f4bfb4d7b4ef47a61620cb66d101f97671dd1158b48a0b973e74e29088781451cfc04993bbe6b79d736b8f4f1d314a190be03821e224176bb345ba6827879428f408195c6b11f74ed96c88b676df6f6fc0ad67b786b11e62310094eb0568d2f9f95d633894fe894cbcdd006de56cf1969952c25d321f14472bb50f6ae7896d1752f596b01f2ce115a6dc74aeff726bc490c37a93d9572fe58e812759571762994c231aa459ac2a17e4a07769cb6df6a8427cbaa2aa97f07cd8b2a2dabd839ce69c1d4441d1ec32a8dcd1a
</div>
<p>Using any two of these shards with the tool provided in [<a href="https://iancoleman.io/shamir" title="Online Tool: Shamir Secret Sharing Scheme">16</a>], Alice's original private blinding factor can be recreated. Try it out!</p>
<p><strong>Note:</strong> This example shows blinding factor shards created with the SSSS tool developed by Coleman [<a href="https://iancoleman.io/shamir" title="Online Tool: Shamir Secret Sharing Scheme">16</a>]. It was merely developed for demonstration purposes and does not make any claims to meet cryptographic security rules other than using secure randomness.</p>
<h2><a class="header" href="#contributors-20" id="contributors-20">Contributors</a></h2>
<ul>
<li><a href="https://github.com/hansieodendaal">https://github.com/hansieodendaal</a></li>
<li><a href="https://github.com/anselld">https://github.com/anselld</a></li>
<li><a href="https://github.com/SWvheerden">https://github.com/SWvheerden</a></li>
<li><a href="https://github.com/CjS77">https://github.com/CjS77</a></li>
</ul>
<h1><a class="header" href="#network-analysis" id="network-analysis">Network Analysis</a></h1>
<h2><a class="header" href="#purpose-6" id="purpose-6">Purpose</a></h2>
<p>As networks with large numbers of geographically distributed nodes evolve, issues such as processing delays and data 
transfers may 
arise, potentially creating an environment for adversarial attacks. Network models and methods of analysis of a networked ecosystem
need to be developed to capture the evolution and dynamics.</p>
<h2><a class="header" href="#definitions-6" id="definitions-6">Definitions</a></h2>
<ul>
<li>From <strong>Lexico:</strong> The mathematical analysis of complex working procedures in terms of a network of related activities [<a href="https://www.lexico.com/en/definition/network_analysis" title="Network Analysis">1</a>].</li>
<li>From <strong>Wikipedia:</strong>  Network analysis is the process of investigating social structures through the use of networks and 
graph theory. It characterizes networked structures in terms of <em>nodes</em> (individual actors, people, or things within 
the network) and the <em>ties</em>, <em>edges</em>, or <em>links</em> (relationships or interactions) that connect them [<a href="https://en.wikipedia.org/wiki/Social_network_analysis" title="Social Network Analysis">2</a>].</li>
</ul>
<h2><a class="header" href="#references-28" id="references-28">References</a></h2>
<p>[<a href="https://www.lexico.com/en/definition/network_analysis" title="Network Analysis">1</a>] Lexico: &quot;Network Analysis&quot; [online]. Available: <a href="https://www.lexico.com/en/definition/network_analysis">https://www.lexico.com/en/definition/network_analysis</a>. 
Date accessed: 2019‑10‑09.</p>
<p>[<a href="https://en.wikipedia.org/wiki/Social_network_analysis" title="Social Network Analysis">2</a>] Wikipedia: &quot;Social Network Analysis&quot; [online]. Available: <a href="https://en.wikipedia.org/wiki/Social_network_analysis">https://en.wikipedia.org/wiki/Social_network_analysis</a>. 
Date accessed: 2019‑10‑09.</p>
<style>
        div.wrap_bad {
            width: 95%; 
            word-wrap: break-word;
            background: #3D85C6;
            font-size: 1.0em;
            padding: 0.5em;
            color: #000000;
            }
        </style>
<style>
        div.wrap_good {
            width: 95%; 
            word-wrap: break-word;
            background: #6AA84F;
            font-size: 1.0em;
            padding: 0.5em;
            color: #000000;
            }
        </style>
<style>
        div.highlight {
            width: 95%; 
            word-wrap: break-word;
            background: #EA9999;
            font-size: 1.0em;
            padding: 0.5em;
            color: #000000;
            }
        </style>
<h1><a class="header" href="#probabilistic-attack-vector-analysis-building-blocks" id="probabilistic-attack-vector-analysis-building-blocks">Probabilistic Attack Vector Analysis Building Blocks</a></h1>
<ul>
<li><a href="network-analysis/probabilistic-attack/building_blocks.html#introduction">Introduction</a></li>
<li><a href="network-analysis/probabilistic-attack/building_blocks.html#types-of-distribution">Types of Distribution</a> 
<ul>
<li><a href="network-analysis/probabilistic-attack/building_blocks.html#continuous-distribution">Continuous Distribution</a></li>
<li><a href="network-analysis/probabilistic-attack/building_blocks.html#discrete-distribution">Discrete Distribution</a>
<ul>
<li><a href="network-analysis/probabilistic-attack/building_blocks.html#hypergeometric-distribution">Hypergeometric Distribution</a></li>
<li><a href="network-analysis/probabilistic-attack/building_blocks.html#binomial-distribution">Binomial Distribution</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="network-analysis/probabilistic-attack/building_blocks.html#monte-carlo-simulations">Monte Carlo Simulations</a> 
<ul>
<li><a href="network-analysis/probabilistic-attack/building_blocks.html#monte-carlo-fallacy">Monte Carlo Fallacy</a> </li>
<li><a href="network-analysis/probabilistic-attack/building_blocks.html#crude-monte-carlo">Crude Monte Carlo</a></li>
<li><a href="network-analysis/probabilistic-attack/building_blocks.html#law-of-large-numbers">Law of Large Numbers</a></li>
</ul>
</li>
<li><a href="network-analysis/probabilistic-attack/building_blocks.html#methodology">Methodology</a>
<ul>
<li><a href="network-analysis/probabilistic-attack/building_blocks.html#notation-used">Notation Used</a></li>
<li><a href="network-analysis/probabilistic-attack/building_blocks.html#crude-monte-carlo-simulation">Crude Monte Carlo Simulation</a>
<ul>
<li><a href="network-analysis/probabilistic-attack/building_blocks.html#programming-the-simulation">Programming the Simulation</a></li>
<li><a href="network-analysis/probabilistic-attack/building_blocks.html#use-of-random-numbers">Use of Random Numbers</a></li>
<li><a href="network-analysis/probabilistic-attack/building_blocks.html#computing-statistics">Computing Statistics</a>
<ul>
<li><a href="network-analysis/probabilistic-attack/building_blocks.html#mode-value">Mode Value</a></li>
<li><a href="network-analysis/probabilistic-attack/building_blocks.html#median-value">Median Value</a></li>
<li><a href="network-analysis/probabilistic-attack/building_blocks.html#mean-value">Mean Value</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="network-analysis/probabilistic-attack/building_blocks.html#statistical-calculation">Statistical Calculation</a>
<ul>
<li><a href="network-analysis/probabilistic-attack/building_blocks.html#binomial-distribution-formula">Binomial Distribution Formula</a></li>
<li><a href="network-analysis/probabilistic-attack/building_blocks.html#hypergeometric-distribution-formula">Hypergeometric Distribution Formula</a></li>
<li><a href="network-analysis/probabilistic-attack/building_blocks.html#summation-formula">Summation Formula</a> </li>
</ul>
</li>
</ul>
</li>
<li><a href="network-analysis/probabilistic-attack/building_blocks.html#references">References</a></li>
<li><a href="network-analysis/probabilistic-attack/building_blocks.html#appendices">Appendices</a>
<ul>
<li><a href="network-analysis/probabilistic-attack/building_blocks.html#appendix-a-definitions-of-terms">Appendix A: Definitions of Terms</a></li>
</ul>
</li>
<li><a href="network-analysis/probabilistic-attack/building_blocks.html#contributors">Contributors</a> </li>
</ul>
<h2><a class="header" href="#introduction-17" id="introduction-17">Introduction</a></h2>
<p>This report discusses building blocks to aid in answering questions regarding the Tari Network. In order to perform 
analysis and draw accurate conclusions, a set of skills and programs needs to be built and honed. Among these, is an 
understanding of statistics. The report focuses on types of distribution and the deriving of their formulae, and discusses the simulations, specifically the Monte Carlo Simulation. </p>
<h2><a class="header" href="#types-of-distribution" id="types-of-distribution">Types of Distribution</a></h2>
<p>There are a few high-level types of distribution, including continuous, discrete, mixed continuous/discrete, 
joint and non-numeric distribution.</p>
<p>When determining the probability of an attacker controlling the majority of nodes in the network, the various 
types of probability distribution of the specific circumstances and variables of the 
problem need to be analyzed. There are two categories of probability distribution: finite and infinite support [<a href="https://en.wikipedia.org/wiki/List_of_probability_distributions" title="List of Probability Distributions">1</a>]. 
All probability distributions can be classified either as discrete or continuous probability 
distribution, 
depending on whether they define probabilities associated with discrete or continuous variables [<a href="https://stattrek.com/probability-distributions/discrete-continuous.aspx" title="Probability Distributions">14</a>]. </p>
<h3><a class="header" href="#continuous-distribution" id="continuous-distribution">Continuous Distribution</a></h3>
<p>If a variable can take on any value between two specified values, it is called a continuous variable, and its probability 
distribution is called a discrete probability distribution [<a href="https://stattrek.com/probability-distributions/discrete-continuous.aspx" title="Probability Distributions">14</a>].</p>
<p>Probabilities of continuous random variables (<em>X</em>) are defined as the area under the curve of their Probability Density 
Function<sup><a href="network-analysis/probabilistic-attack/building_blocks.html#pdf" title=" A statistical expression that 
defines a...">def</a></sup> (PDF). Therefore only ranges of values can have a nonzero probability. The probability that 
a continuous random variable equals some value is always zero [<a href="https://support.minitab.com/en-us/minitab-express/1/help-and-how-to/basic-statistics/probability-distributions/supporting-topics/basics/continuous-and-discrete-probability-distributions/" title="Continuous and Discrete Probability Distributions">11</a>]. The following plot shows a typical continuous distribution
below (although specifically for a normal distribution).</p>
<p align="center"><img src="network-analysis/probabilistic-attack/assets/distribution_plot_normal_weight_shade_middle.png" width="700" /></p>
### Discrete Distribution 
<p>A discrete variable, as opposed to a continuous variable, can only take on a finite number of values. If a random 
variable is a discrete variable, its probability distribution is called a discrete probability distribution [<a href="https://stattrek.com/probability-distributions/discrete-continuous.aspx" title="Probability Distributions">14</a>]. A 
discrete 
distribution thus describes the probability of occurrence of each value of a discrete random variable [<a href="https://support.minitab.com/en-us/minitab-express/1/help-and-how-to/basic-statistics/probability-distributions/supporting-topics/basics/continuous-and-discrete-probability-distributions/" title="Continuous and Discrete Probability Distributions">11</a>].</p>
<p>With a discrete probability distribution, each possible value of the discrete random variable can be associated with a 
nonzero probability. Thus, the presentation of a discrete probability distribution is often in tabular form [<a href="https://support.minitab.com/en-us/minitab-express/1/help-and-how-to/basic-statistics/probability-distributions/supporting-topics/basics/continuous-and-discrete-probability-distributions/" title="Continuous and Discrete Probability Distributions">11</a>], or a 
bar graph.</p>
<p align="center"><img src="network-analysis/probabilistic-attack/assets/distribution_plot_poisson_shade_right_tail.png" width="700" /></p>
Here's an overview of the various distributions and how they are related [[15]]:
<p align="center"><img src="network-analysis/probabilistic-attack/assets/relationship_map.png" width="700" /></p>
Examples of discrete distribution with **finite** support <sup>[def][discrete_distribution_finite~]</sup>  include the 
following: 
<table><thead><tr><th>Type of Finite Discrete Distribution</th><th>Description   [<a href="https://en.wikipedia.org/wiki/List_of_probability_distributions" title="List of Probability Distributions">1</a>]</th></tr></thead><tbody>
<tr><td>Bernoulli Distribution</td><td>Takes value $1$ with probability $p$ and value $0$ with probability $q=1-p$.</td></tr>
<tr><td>Rademacher Distribution</td><td>Takes value $1$ with probability $\frac{1}{2}$ and value $-1$ with probability $\frac{1}{2}$.</td></tr>
<tr><td>Binomial Distribution</td><td>The number of successes in a series of independent Yes/No experiments, all with the same probability of success.</td></tr>
<tr><td>Beta-Binomial Distribution</td><td>The number of successes in a series of independent Yes/No experiments with heterogeneity in the success probability.</td></tr>
<tr><td>Degenerate Distribution</td><td>At $X0$, where $X$ is certain to take the value $X0$. This does not look random, but it satisfies the definition of a random variable. This is useful because it puts deterministic variables and random variables in the same formalism.</td></tr>
<tr><td>Discrete Uniform Distribution</td><td>Where all elements of a finite set are equally likely. This is the theoretical distribution model for a balanced coin, an unbiased die, a casino roulette, or the first card of a well-shuffled deck.</td></tr>
<tr><td>Hypergeometric Distribution</td><td>The number of successes in the first $m$ of a series of $n$ consecutive Yes/No experiments, if the total number of successes is known. This distribution arises where there is no replacement.</td></tr>
<tr><td>Poisson Binomial  Distribution</td><td>The number of successes in a series of independent Yes/No experiments with different success probabilities.</td></tr>
</tbody></table>
<p>Examples of discrete distribution with <strong>infinite</strong> support <sup><a href="network-analysis/probabilistic-attack/building_blocks.html#discrete_distribution_infinite" title="A discrete distribution with infinite... ">def</a></sup>  include the following: </p>
<table><thead><tr><th>Type of Infinite Discrete Distribution</th><th>Description [<a href="https://en.wikipedia.org/wiki/List_of_probability_distributions" title="List of Probability Distributions">1</a>]</th></tr></thead><tbody>
<tr><td>Boltzmann Distribution</td><td>A discrete distribution important in statistical physics, which describes the probabilities of the various discrete energy levels of a system in thermal equilibrium. It has a continuous analog.</td></tr>
<tr><td>Geometric Distribution</td><td>A discrete distribution that describes the number of attempts needed to get the first success in a series of independent Bernoulli trials or, alternatively, only the number of losses before the first success (i.e. one less).</td></tr>
<tr><td>Negative Binomial/Pascal Distribution</td><td>A generalization of the geometric distribution of the $nth$ success.</td></tr>
<tr><td>Poisson Distribution</td><td>A very large number of individually unlikely events that happen at a specific time interval. Related to this distribution are several other distributions: the displaced Poisson, the hyper-Poisson, the general Poisson binomial and the Poisson-type distributions.</td></tr>
<tr><td>Skellam Distribution</td><td>The distribution of the difference between two independent Poisson-distributed random variables.</td></tr>
<tr><td>Zeta Distribution</td><td>Has uses in applied statistics and statistical mechanics, and perhaps may be of interest to number theorists. It is the Zipf distribution for an infinite number of elements.</td></tr>
<tr><td>Zipf's Law</td><td>A discrete power-law distribution, the most famous example of which is the description of the frequency of words in the English language.</td></tr>
<tr><td>Zipf-Mandelbrot Law</td><td>A discrete power-law distribution, which is a generalization of the Zipf distribution.</td></tr>
</tbody></table>
<h4><a class="header" href="#hypergeometric-distribution" id="hypergeometric-distribution">Hypergeometric Distribution</a></h4>
<p>A hypergeometric distribution is a discrete probability distribution that describes the probability of $T$ successes 
(random 
draws for which the object drawn has a specified feature) in $n$ draws, <em>without</em> replacement, from a finite population 
of size $N$ that contains exactly $m$ objects with that feature, wherein each draw is either a success or a failure [<a href="https://en.wikipedia.org/wiki/Hypergeometric_distribution" title="Hypergeometric Distribution">3</a>]:</p>
<ul>
<li>A sample of size $n$ is randomly selected without replacement from a population of $N$ items.</li>
<li>In the population, $T$ items can be classified as successes and $N-T$ items can be classified as failures.</li>
<li>There are $m$ featuring objects. </li>
</ul>
<p>Given $m, N, n$ and $T$, the hypergeometric probability can be computed based on the following example: </p>
<p><strong>Example 1:</strong> Suppose a population consists of $N$ items, $T$ of which are successes; and a random sample drawn from that 
population consists of $n$ items. Then the hypergeometric probability is [<a href="https://stattrek.com/probability-distributions/hypergeometric.aspx" title="Hypergeometric Distribution">10</a>]:
$$
h(m; N, n, T)= {{T}\choose{m}}{{N-T}\choose{n-m}}{{N}\choose{n}}
$$
The hypergeometric distribution has the following properties:</p>
<ul>
<li>The mean of the distribution is equal to $n\cdot\frac{T}{N}$</li>
<li>The variance is $ n\cdot T \cdot(N-T)\cdot\frac{N-n}{N^2\cdot(N-1)}$</li>
</ul>
<h4><a class="header" href="#binomial-distribution" id="binomial-distribution">Binomial Distribution</a></h4>
<p>The binomial distribution with parameters $n$ and $p$ is the discrete probability distribution of the number of 
successes in a sequence of $n$ independent experiments, each asking a Yes/No question, and each with its own 
Boolean-valued outcome: success/yes/true/one (with probability $p$) or failure/no/false/zero (with probability $q=1- p$). 
A single success/failure experiment is also called a Bernoulli trial or Bernoulli experiment, and a sequence of outcomes 
is called a Bernoulli process. For a single trial, i.e. $n=1$, the binomial distribution is a Bernoulli distribution. 
The binomial distribution is the basis for the popular binomial test of statistical significance. </p>
<p>The binomial distribution is frequently used to model the number of successes in a sample of size $n$ drawn with 
replacement from a population of size $N$. If the sampling is carried out without replacement, the draws are not 
independent, and so the resulting distribution is hypergeometric, not binomial. However, for $n$ much larger than 
$n$, the binomial distribution remains a good approximation and is widely used. </p>
<p>Thus, in a binomial distribution, an object is selected with replacement [<a href="https://en.wikipedia.org/wiki/Binomial_distribution" title="Binomial Distribution">4</a>]. A binomial experiment requires that the 
probability of success be constant on every trial. </p>
<p><strong>Example 2:</strong> You have an urn containing $10$ marbles: $5$ red and $5$ green. You randomly select $2$ marbles with 
replacement, and the probability of success would not change. It would be $\frac{5}{10}$ on every trial [<a href="https://stattrek.com/probability-distributions/hypergeometric.aspx" title="Hypergeometric Distribution">10</a>]. </p>
<h2><a class="header" href="#monte-carlo-simulations" id="monte-carlo-simulations">Monte Carlo Simulations</a></h2>
<p>The Monte Carlo approach is a computer-based analytical method that was developed in the 1940s as part of the atomic 
program, by a scientist at the Los Alamos National Laboratory, who used it to 
model the random diffusion of neutrons. It was named after the city in Monaco, which has many casinos. </p>
<p>Monte Carlo analysis uses statistical tools to model a real-life system or process mathematically. It then estimates 
the probability of obtaining a successful outcome. The statistical distribution of the process to be modeled 
must be determined before the Monte Carlo simulation can be applied. </p>
<p>Monte Carlo methods are widely used, heuristic techniques that can solve a variety of common problems, including 
optimization and numerical integration problems. These algorithms work by cleverly sampling from distributions to 
simulate the workings of a system. Applications range from solving problems in theoretical physics to predicting trends 
in financial investments [<a href="https://towardsdatascience.com/monte-carlo-simulations-with-python-part-1-f5627b7d60b0" title="Monte Carlo Simulations with Python (Part 1)">6</a>]. </p>
<h3><a class="header" href="#monte-carlo-fallacy" id="monte-carlo-fallacy">Monte Carlo Fallacy</a></h3>
<p>The Monte Carlo Fallacy or gambler's fallacy is the inaccurate belief that if something happens more frequently than 
normal during a given period, it will happen less often in the future. In situations where the outcome being observed is 
truly random and consists of independent trials of a random process, this belief is false. The fallacy can arise in many 
situations, but is most strongly associated with gambling, where it is common among players [<a href="https://en.wikipedia.org/wiki/Gambler%27s_fallacy" title="Gambler's Fallacy">13</a>]. </p>
<p>The gambler's fallacy can be illustrated by considering the repeated toss of a fair coin. The outcomes in different 
tosses are statistically independent, and the probability of getting heads on a single toss is $\frac{1}{2}$. The 
probability of getting $2$ heads in $2$ tosses is $\frac{1}{4}$, and the probability of getting $3$ heads in $3$ 
tosses is $\frac{1}{8}$. If, after tossing four heads in a row, the next coin toss also came up heads, it would complete 
a run of five successive heads. Since the probability of a sequence of five consecutive heads is $\frac{1}{32}$, a 
person might believe that the next flip would more likely come up tails rather than heads again. This is incorrect 
and is an example of the gambler's fallacy. The events &quot;five heads in a row&quot; and &quot;first $4$ heads, then a tails&quot; 
are equally likely, each having a probability of $\frac{1}{32}$. Since the first four tosses turn up heads, the probability 
that the next toss is a head is $\frac{1}{2}$ . While a run of five heads has a probability of $\frac{1}{32} = 0.03125$, 
the misunderstanding lies in not realizing that this is the case only before the first coin is tossed. After the first 
four tosses, the results are no longer unknown, so the probability at that point is equal to $one$. The reasoning that 
it is more likely that a fifth toss is more likely to be tails because the previous four tosses were heads, with a run 
of luck in the past influencing the odds in the future, forms the basis of the fallacy [<a href="https://en.wikipedia.org/wiki/Gambler%27s_fallacy" title="Gambler's Fallacy">13</a>].</p>
<h3><a class="header" href="#crude-monte-carlo" id="crude-monte-carlo">Crude Monte Carlo</a></h3>
<p>The Monte Carlo technique is built upon this principle: instead of evaluating an indefinite integral, which can 
sometimes be impossible, the average of the integrand is estimated, and that is used to approximate the integral. If one 
needs to be more precise, the number of samples can be increased. </p>
<p>It is a widely used heuristic technique that can solve a variety of common problems, including optimization and numerical 
integration problems. These algorithms work by cleverly sampling from a distribution to simulate the workings of a system.<br />
Applications range from solving problems in theoretical physics to predicting trends in financial investments. </p>
<h3><a class="header" href="#law-of-large-numbers" id="law-of-large-numbers">Law of Large Numbers</a></h3>
<p>The Law of Large Numbers (LLN), in probability and statistics, states that as a sample size grows, its mean gets closer 
to the average of the whole population. In statistical analysis, the LLN can be applied to a variety of 
subjects. It may not be feasible to poll every individual within a given population to collect the required amount of 
data. However, every additional data point gathered has the potential to increase the likelihood that the outcome is an 
accurate measure of the mean [<a href="https://www.investopedia.com/terms/l/lawoflargenumbers.asp" title="Investopedia: Law of Large Numbers">7</a>]. </p>
<p>The LLN is crucial because it guarantees stable, long-term results for the averages of some random event [<a href="https://en.wikipedia.org/wiki/Law_of_large_numbers" title="Law of Large Numbers">8</a>]. </p>
<p align="center"><img src="network-analysis/probabilistic-attack/assets/law_of_large_numbers.png" width="650" /></p>
The preceding figure illustrates the LLN using a particular run of rolls of a single dice. As can be seen in the figure, 
as the number of rolls in this run increases, the average of the values of all the results approaches 3.5. While 
different runs would show a different shape over a small number of throws (on the left), over a large number of rolls 
(to the right), they would be extremely similar [[9]].
<h1><a class="header" href="#methodology" id="methodology">Methodology</a></h1>
<h2><a class="header" href="#notation-used-2" id="notation-used-2">Notation Used</a></h2>
<p>This section gives the general notation of statistical expressions when specifically referenced. This information 
is important knowledge for the remainder of the report. </p>
<ul>
<li>Let $N$ be the total number of nodes in the network. </li>
<li>Let $n$ be the committee size.</li>
<li>Let $m$ be the number of bad actors.</li>
<li>Let $T$ be the Byzantine Fault Tolerance (BFT) threshold.</li>
</ul>
<p>There is a pool with <em>N</em> nodes. The pool contains <em>m</em> malicious nodes or bad actors. From within the pool, a random 
selection of nodes, <em>n</em> is drawn. From this selection, the probability of drawing a threshold of bad actors, <em>T</em>, needs to 
be calculated.</p>
<h2><a class="header" href="#crude-monte-carlo-simulation" id="crude-monte-carlo-simulation">Crude Monte Carlo Simulation</a></h2>
<h3><a class="header" href="#programming-the-simulation" id="programming-the-simulation">Programming the Simulation</a></h3>
<p>It was initially thought that selecting a committee ($n$) from the total nodes ($N$) without replacing the selected nodes 
requires the removal of an element from the pool of total nodes when it is drawn. However, as the program is 
calling for many selections within many experiments, this logic could not be used. </p>
<p>The experiment is extended to ask the overarching question: <em>&quot;What is the probability of selecting the threshold worth of</em> 
<em>bad nodes or more from a pool of total nodes?&quot;</em> To this end, we perform a variable number of experiments and 
count how many times the threshold is met, in order to estimate the probability. </p>
<h3><a class="header" href="#use-of-random-numbers" id="use-of-random-numbers">Use of Random Numbers</a></h3>
<p>Some problems in science and technology are described by &quot;exact&quot; mathematics, leading to &quot;precise&quot; results, e.g. 
throwing a ball and oscillating a system. Some problems appear physically uncertain, e.g. rolling a die and molecular motion. 
Random numbers can be used to mimic the uncertainty of the experiment. </p>
<p>Random numbers make it possible to simulate physical systems with uncertainty, in input data or the process. </p>
<h3><a class="header" href="#computing-statistics" id="computing-statistics">Computing Statistics</a></h3>
<p>The mode, median and mean are the arithmetic average of a data set. This is found by adding the numbers in a data set and 
dividing by how many numbers there are. </p>
<h4><a class="header" href="#mode-value" id="mode-value">Mode Value</a></h4>
<p>The mode is the score or value that occurs most often in a data set.</p>
<h4><a class="header" href="#median-value" id="median-value">Median Value</a></h4>
<p>The median is the middle number in a data set with the numbers listed in either ascending or descending order.</p>
<p>If the total number of numbers (n) is an odd number, then the formula is:
$$
median =\biggl(\frac{n+1}{2}\biggr)^{th}term
$$
If the total number of numbers (n) is an even number, then the formula is:
$$
median= \frac{\biggl({\frac{n}{2}\biggr)^{th}term+\biggl({\frac{n}{2}+1\biggr)}^{th}term}}{2}
$$</p>
<h4><a class="header" href="#mean-value" id="mean-value">Mean Value</a></h4>
<p>$$
\bar{x}  = \frac{{\sum}x}{N}<br />
$$</p>
<p>Where:</p>
<ul>
<li>$\sum$ represents the summation </li>
<li>$x$ represents scores </li>
<li>$N$ represents number of scores </li>
</ul>
<p align="center"><img src="network-analysis/probabilistic-attack/assets/mode_median_mean.png" width="170" /></p>
## Statistical Calculation
<p>A single probability from the overarching question was used as a means to derive the formulae, as shown in the following 
example. </p>
<p><strong>Example 3</strong>: What is the probability of selecting a majority of bad nodes from a total of $5$ nodes if the committee 
size is $3$? There are $3$ bad nodes $(B1, B2, B3)$ and $2$ good nodes $(G1, G2)$.</p>
<p>The first step is to calculate the number of combinations where bad and good nodes can be chosen: </p>
<table><thead><tr><th align="center">  Draw 1st node  </th><th align="center">  Draw 2nd node  </th><th align="center">  Draw 3rd node  </th><th align="center">Are bad nodes <br /> in the majority?</th></tr></thead><tbody>
<tr><td align="center"><div class="wrap_bad">$B1$</div></td><td align="center"><div class="wrap_bad">$B2$</div></td><td align="center"><div class="wrap_bad">$B3$</div></td><td align="center">Yes</td></tr>
<tr><td align="center"><div class="wrap_bad">$B1$</div></td><td align="center"><div class="wrap_bad">$B2$</div></td><td align="center"><div class="wrap_good">$G1$</div></td><td align="center">Yes</td></tr>
<tr><td align="center"><div class="wrap_bad">$B1$</div></td><td align="center"><div class="wrap_bad">$B2$</div></td><td align="center"><div class="wrap_good">$G2$</div></td><td align="center">Yes</td></tr>
<tr><td align="center"><div class="wrap_bad">$B1$</div></td><td align="center"><div class="wrap_bad">$B3$</div></td><td align="center"><div class="wrap_good">$G1$</div></td><td align="center">Yes</td></tr>
<tr><td align="center"><div class="wrap_bad">$B1$</div></td><td align="center"><div class="wrap_bad">$B3$</div></td><td align="center"><div class="wrap_good">$G2$</div></td><td align="center">Yes</td></tr>
<tr><td align="center"><div class="wrap_bad">$B1$</div></td><td align="center"><div class="wrap_good">$G1$</div></td><td align="center"><div class="wrap_good">$G2$</div></td><td align="center">No</td></tr>
<tr><td align="center"><div class="wrap_bad">$B2$</div></td><td align="center"><div class="wrap_bad">$B3$</div></td><td align="center"><div class="wrap_good">$G1$</div></td><td align="center">Yes ​</td></tr>
<tr><td align="center"><div class="wrap_bad">$B2$</div></td><td align="center"><div class="wrap_bad">$B3$</div></td><td align="center"><div class="wrap_good">$G2$</div></td><td align="center">Yes ​</td></tr>
<tr><td align="center"><div class="wrap_bad">$B2$</div></td><td align="center"><div class="wrap_good">$G1$</div></td><td align="center"><div class="wrap_good">$G2$</div></td><td align="center">No</td></tr>
<tr><td align="center"><div class="wrap_bad">$B3$</div></td><td align="center"><div class="wrap_good">$G1$</div></td><td align="center"><div class="wrap_good">$G2$</div></td><td align="center">No</td></tr>
<tr><td align="center"></td><td align="center"></td><td align="center"><strong>Tally of Yes responses</strong></td><td align="center">$7$</td></tr>
</tbody></table>
<p>From this list, the number of combinations where $B$ is the majority can then be tallied. In this case, there are $7$
combinations where $B$ is the majority. Thus, from the $10$ combinations, there are $7$ combinations where there is a 
majority of bad nodes. Therefore, the quotient of $7$ and $10$ is the probability $0.7$. </p>
<p>This method is limited in calculating the probability where the variables are large. For example, if the same question 
was posed, 
but one had to calculate the probability of selecting a majority of bad nodes from a total of $100$ nodes, with a 
committee size of $60$, $60$ bad nodes and $40$ good nodes, the number of combinations where bad and good nodes can be 
chosen is $1.27E+28$.</p>
<h3><a class="header" href="#binomial-distribution-formula" id="binomial-distribution-formula">Binomial Distribution Formula</a></h3>
<p>With regard to binomial distribution, a committee of nodes is drawn from the total nodes with replacement, i.e. nodes 
are drawn, the intention of the node is distinguished and the node is returned to the total nodes. 
$$
P = {{n}\choose{T}}\cdot\biggl(\frac{m}{n}\biggr)^{T}\cdot\biggl(\frac{N-m}{n}\biggr)^{n-T}
$$</p>
<h3><a class="header" href="#hypergeometric-distribution-formula" id="hypergeometric-distribution-formula">Hypergeometric Distribution Formula</a></h3>
<p>With regard to hypergeometric distribution, a committee of nodes is drawn from the total nodes without replacement, 
i.e. nodes are drawn simultaneously, the intention of the node is distinguished and not returned to the total nodes. 
This closely mimics the events that would take place within the network. 
$$
P = \frac{{{m}\choose{T}}\cdot{{N-m}\choose{n-T}}}{{N}\choose{n}}
$$</p>
<h3><a class="header" href="#summation-formula" id="summation-formula">Summation Formula</a></h3>
<p>Referring to Example 3, the <strong>tally</strong> is the sum of all the combinations where the bad nodes are in a majority.</p>
<p>As a recap to the question, <em>what is the probability of selecting a majority of bad nodes from a total of $100$ nodes 
if the committee size is $10$</em>? This problem considers solving for the probability where there is a <strong>majority</strong> of bad 
nodes in the committee. This entails calculating the probabilities from the BFT threshold to the committee size. Thus, 
there needs to be a summation of individual probabilities in order to calculate the probability of selecting the 
majority of bad nodes. 
$$
P_{tot} = \sum_{i=T}^{n} P(N,m,n,i)
$$</p>
<p>The following table provides some visual insight into understanding this: </p>
<table><thead><tr><th align="center">  Committee Size  </th><th align="center">  BFT Threshold  </th><th align="center">  No. of Steps  </th></tr></thead><tbody>
<tr><td align="center">10</td><td align="center">7</td><td align="center">3</td></tr>
</tbody></table>
<h2><a class="header" href="#references-29" id="references-29">References</a></h2>
<p>[<a href="https://en.wikipedia.org/wiki/List_of_probability_distributions" title="List of Probability Distributions">1</a>] Wikipedia, “List of Probability Distributions” [online]. Available: <a href="https://en.wikipedia.org/wiki/List_of_probability_distributions">https://en.wikipedia.org/wiki/List_of_probability_distributions</a>. 
Date accessed: 2019‑05‑13.</p>
<p>[<a href="https://en.wikipedia.org/wiki/Support_(mathematics)" title="Support (Mathematics)">2</a>] Wikipedia, “Support (Mathematics)&quot; [online]. Available: <a href="https://en.wikipedia.org/wiki/Support_(mathematics)">https://en.wikipedia.org/wiki/Support_(mathematics)</a>. 
Date accessed: 2019‑05‑13.</p>
<p>[<a href="https://en.wikipedia.org/wiki/Hypergeometric_distribution" title="Hypergeometric Distribution">3</a>] Wikipedia, “Hypergeometric Distribution” [online]. Available: <a href="https://en.wikipedia.org/wiki/Hypergeometric_distribution">https://en.wikipedia.org/wiki/Hypergeometric_distribution</a>. 
Date accessed: 2019‑05‑13.</p>
<p>[<a href="https://en.wikipedia.org/wiki/Binomial_distribution" title="Binomial Distribution">4</a>] Wikipedia, “Binomial Distribution&quot; [online]. Available: <a href="https://en.wikipedia.org/wiki/Binomial_distribution">https://en.wikipedia.org/wiki/Binomial_distribution</a>. 
Date accessed: 2019‑05‑13.</p>
<p>[<a href="https://medium.com/poa-network/poa-network-honey-badger-bft-and-threshold-cryptography-c43e10fadd87" title="POA Network: HoneyBadger BFT and Threshold Cryptography">5</a>] POA Network Team, &quot;POA Network: Honey Badger BFT and Threshold Cryptography&quot; [online]. Available: 
<a href="https://medium.com/poa-network/poa-network-honey-badger-bft-and-threshold-cryptography-c43e10fadd87">https://medium.com/poa-network/poa-network-honey-badger-bft-and-threshold-cryptography-c43e10fadd87</a>. 
Date accessed: 2019‑06‑28.</p>
<p>[<a href="https://towardsdatascience.com/monte-carlo-simulations-with-python-part-1-f5627b7d60b0" title="Monte Carlo Simulations with Python (Part 1)">6</a>] P. Hanbury, &quot;Monte Carlo Simulations with Python (Part 1)&quot; [online]. Available: 
<a href="https://towardsdatascience.com/monte-carlo-simulations-with-python-part-1-f5627b7d60b0">https://towardsdatascience.com/monte-carlo-simulations-with-python-part-1-f5627b7d60b0</a>. Date accessed: 2019‑06‑28.</p>
<p>[<a href="https://www.investopedia.com/terms/l/lawoflargenumbers.asp" title="Investopedia: Law of Large Numbers">7</a>] W. Kenton, &quot;Law of Large Numbers&quot; [online]. Available: <a href="https://www.investopedia.com/terms/l/lawoflargenumbers.asp">https://www.investopedia.com/terms/l/lawoflargenumbers.asp</a>. 
Date accessed: 2019‑06‑28.</p>
<p>[<a href="https://en.wikipedia.org/wiki/Law_of_large_numbers" title="Law of Large Numbers">8</a>] Wikipedia, &quot;Law of Large Numbers&quot; [online]. Available: <a href="https://en.wikipedia.org/wiki/Law_of_large_numbers">https://en.wikipedia.org/wiki/Law_of_large_numbers</a>. 
Date accessed: 2019‑06‑28.</p>
<p>[<a href="https://commons.wikimedia.org/w/index.php?curid=58536069" title="Law of Large Numbers - Average Dice Roll by Number of Rolls">9</a>] Wikipedia, &quot;Law of Large Numbers - Average Dice Roll by Number of Rolls&quot; [online]. 
Available: <a href="https://commons.wikimedia.org/w/index.php?curid=58536069">https://commons.wikimedia.org/w/index.php?curid=58536069</a>. Date accessed: 2019‑06‑28.</p>
<p>[<a href="https://stattrek.com/probability-distributions/hypergeometric.aspx" title="Hypergeometric Distribution">10</a>] Stat Trek, &quot;Hypergeometric Distribution&quot; [online]. Available: <a href="https://stattrek.com/probability-distributions/hypergeometric.aspx">https://stattrek.com/probability-distributions/hypergeometric.aspx</a>. 
Date accessed: 2019‑06‑28.</p>
<p>[<a href="https://support.minitab.com/en-us/minitab-express/1/help-and-how-to/basic-statistics/probability-distributions/supporting-topics/basics/continuous-and-discrete-probability-distributions/" title="Continuous and Discrete Probability Distributions">11</a>] Minitab Express Support, &quot;Continuous and Discrete Probability Distributions&quot; [online]. Available: 
<a href="https://support.minitab.com/en-us/minitab-express/1/help-and-how-to/basic-statistics/probability-distributions/supporting-topics/basics/continuous-and-discrete-probability-distributions/">https://support.minitab.com/en-us/minitab-express/1/help-and-how-to/basic-statistics/probability-distributions/supporting-topics/basics/continuous-and-discrete-probability-distributions/</a>. 
Date accessed: 2019‑07‑18.</p>
<p>[<a href="https://en.wikipedia.org/wiki/Probability_density_function" title="Probability Density Function">12</a>] Wikipedia, &quot;Probability Density Function&quot; [online]. Available: <a href="https://en.wikipedia.org/wiki/Probability_density_function">https://en.wikipedia.org/wiki/Probability_density_function</a>. 
Date accessed: 2019‑07‑18.</p>
<p>[<a href="https://en.wikipedia.org/wiki/Gambler%27s_fallacy" title="Gambler's Fallacy">13</a>] Wikipedia, &quot;Gambler's Fallacy&quot; [online]. Available: <a href="https://en.wikipedia.org/wiki/Gambler%27s_fallacy">https://en.wikipedia.org/wiki/Gambler%27s_fallacy</a>. Date 
accessed: 2019‑07‑18.</p>
<p>[<a href="https://stattrek.com/probability-distributions/discrete-continuous.aspx" title="Probability Distributions">14</a>] Stat Trek, &quot;Probability Distributions: Discrete vs. Continuous&quot; [online]. Available: <a href="https://stattrek.com/probability-distributions/discrete-continuous.aspx">https://stattrek.com/probability-distributions/discrete-continuous.aspx</a>. Date 
accessed: 2019‒11‑18.</p>
<p>[<a href="https://medium.com/@srowen/common-probability-distributions-347e6b945ce4" title="Common Probability Distributions">15</a>] Medium, &quot;Common Probability Distributions: The Data Scientist’s Crib Sheet&quot; [online]. Available: <a href="https://medium.com/@srowen/common-probability-distributions-347e6b945ce4">https://medium.com/@srowen/common-probability-distributions-347e6b945ce4</a>. Date 
accessed: 2019‒11‑18.</p>
<h2><a class="header" href="#appendices-10" id="appendices-10">Appendices</a></h2>
<h3><a class="header" href="#appendix-a-definitions-of-terms" id="appendix-a-definitions-of-terms">Appendix A: Definitions of Terms</a></h3>
<p>Definitions of terms presented here are high level and general in nature. </p>
<ul>
<li><strong>Probability Density Function (PDF):</strong><a name="pdf"> </a> a statistical expression that defines a probability 
distribution 
for a continuous random variable instead of a discrete random variable ([<a href="https://support.minitab.com/en-us/minitab-express/1/help-and-how-to/basic-statistics/probability-distributions/supporting-topics/basics/continuous-and-discrete-probability-distributions/" title="Continuous and Discrete Probability Distributions">11</a>], [<a href="https://en.wikipedia.org/wiki/Probability_density_function" title="Probability Density Function">12</a>]).</li>
</ul>
<ul>
<li><strong>Discrete Distribution with finite support:</strong><a name="discrete distribution"> </a> a discrete distribution with 
finite support can have a finite number of possible realizations.</li>
</ul>
<ul>
<li><strong>Discrete Distribution with infinite support:</strong><a name="discrete distribution"> </a> a discrete distribution with 
infinite support can have an infinite number of possible realizations.</li>
</ul>
<h2><a class="header" href="#contributors-21" id="contributors-21">Contributors</a></h2>
<ul>
<li><a href="https://github.com/kevoulee">https://github.com/kevoulee</a></li>
<li><a href="https://github.com/anselld">https://github.com/anselld</a></li>
<li><a href="https://github.com/neonknight64">https://github.com/neonknight64</a> </li>
<li><a href="https://github.com/hansieodendaal">https://github.com/hansieodendaal</a> </li>
<li><a href="https://github.com/Empiech007">https://github.com/Empiech007</a> </li>
</ul>
<style>
        div.highlight {
            width: 95%; 
            word-wrap: break-word;
            background: #EA9999;
            font-size: 1.0em;
            padding: 0.5em;
            color: #000000;
            }
        </style>
<h1><a class="header" href="#probability-of-a-byzantine-takeover-of-the-digital-assets-network" id="probability-of-a-byzantine-takeover-of-the-digital-assets-network">Probability of a Byzantine Takeover of the Digital Assets Network</a></h1>
<ul>
<li><a href="network-analysis/probabilistic-attack/byzantine_takeover_of_the_DAN.html#introduction">Introduction</a></li>
<li><a href="network-analysis/probabilistic-attack/byzantine_takeover_of_the_DAN.html#tari-digital-assets-network">Tari Digital Assets Network</a> 
<ul>
<li><a href="network-analysis/probabilistic-attack/byzantine_takeover_of_the_DAN.html#kademlia">Kademlia</a></li>
<li><a href="network-analysis/probabilistic-attack/byzantine_takeover_of_the_DAN.html#node-id">Node ID</a>
<ul>
<li><a href="network-analysis/probabilistic-attack/byzantine_takeover_of_the_DAN.html#bootstrapping-a-node">Bootstrapping a Node</a></li>
<li><a href="network-analysis/probabilistic-attack/byzantine_takeover_of_the_DAN.html#xor-metric">XOR Metric</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="network-analysis/probabilistic-attack/byzantine_takeover_of_the_DAN.html#implementation">Implementation</a>
<ul>
<li><a href="network-analysis/probabilistic-attack/byzantine_takeover_of_the_DAN.html#crude-monte-carlo-simulation">Crude Monte Carlo Simulation</a>
<ul>
<li><a href="network-analysis/probabilistic-attack/byzantine_takeover_of_the_DAN.html#proving-the-law-of-large-numbers">Proving the Law of Large Numbers</a></li>
<li><a href="network-analysis/probabilistic-attack/byzantine_takeover_of_the_DAN.html#individual-probabilities">Individual Probabilities</a>
<ul>
<li><a href="network-analysis/probabilistic-attack/byzantine_takeover_of_the_DAN.html#uniform-distribution">Uniform Distribution</a></li>
<li><a href="network-analysis/probabilistic-attack/byzantine_takeover_of_the_DAN.html#poisson-distribution">Poisson Distribution</a></li>
<li><a href="network-analysis/probabilistic-attack/byzantine_takeover_of_the_DAN.html#normal-distribution">Normal Distribution</a></li>
</ul>
</li>
<li><a href="network-analysis/probabilistic-attack/byzantine_takeover_of_the_DAN.html#histogram-and-visualization-of-distribution">Histogram and Visualization of Distribution</a></li>
</ul>
</li>
<li><a href="network-analysis/probabilistic-attack/byzantine_takeover_of_the_DAN.html#statistical-calculation">Statistical Calculation</a>
<ul>
<li><a href="network-analysis/probabilistic-attack/byzantine_takeover_of_the_DAN.html#variation-of-total-nodes">Variation of Total Nodes</a></li>
<li><a href="network-analysis/probabilistic-attack/byzantine_takeover_of_the_DAN.html#variation-of-byzantine-fault-tolerance-threshold">Variation of Byzantine Fault-tolerance Threshold</a></li>
<li><a href="network-analysis/probabilistic-attack/byzantine_takeover_of_the_DAN.html#variation-of-total-number-of-nodes-with-committee-size-10">Variation of Total Number of Nodes with Committee Size 10</a></li>
<li><a href="network-analysis/probabilistic-attack/byzantine_takeover_of_the_DAN.html#variation-of-total-number-of-nodes-with-committee-size-100">Variation of Total Number of Nodes with Committee Size 100</a></li>
<li><a href="network-analysis/probabilistic-attack/byzantine_takeover_of_the_DAN.html#variation-of-bad-nodes-with-committee-size-10-and-100">Variation of Bad Nodes with Committee Size 10 and 100</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="network-analysis/probabilistic-attack/byzantine_takeover_of_the_DAN.html#conclusions-and-remarks">Conclusions and Remarks</a></li>
<li><a href="network-analysis/probabilistic-attack/byzantine_takeover_of_the_DAN.html#references">References</a></li>
<li><a href="network-analysis/probabilistic-attack/byzantine_takeover_of_the_DAN.html#appendices">Appendices</a>
<ul>
<li><a href="network-analysis/probabilistic-attack/byzantine_takeover_of_the_DAN.html#appendix-a-definitions-of-terms">Appendix A: Definitions of Terms</a></li>
</ul>
</li>
<li><a href="network-analysis/probabilistic-attack/byzantine_takeover_of_the_DAN.html#contributors">Contributors</a> </li>
</ul>
<h2><a class="header" href="#introduction-18" id="introduction-18">Introduction</a></h2>
<p>This investigation aims to provide answers to questions posed about the workings of the Tari Digital Assets Network (DAN) 
environment. It covers probabilistic attack vector with regard to the total nodes, compromised nodes, committee size and 
Byzantine Fault-tolerance (BFT) threshold. </p>
<p>The investigation attempts to answer the following question:
<em>What is the percentage chance of controlling the majority of nodes in a random sample with varying quantities of the total 
number of nodes, committee size, bad nodes and BFT threshold?</em></p>
<h2><a class="header" href="#tari-digital-assets-network" id="tari-digital-assets-network">Tari Digital Assets Network</a></h2>
<p>The Tari Digital Assets Network (DAN) forms part of the Tari second layer, where the management of all digital 
asset interactions takes place. </p>
<p>These interactions are processed and validated by committees of special nodes, called Validator Nodes<sup><a href="network-analysis/probabilistic-attack/byzantine_takeover_of_the_DAN.html#vn" title=" Validator nodes make up 
the Tari second layer...">def</a></sup>
(VNs). Management 
of Digital Assets (DAs) involves state changes and ensures enforcement of the rules that govern assets contracts. 
Thus, all actions on this network are due to the interactions of the VNs. 
The registration of VNs occurs on the base layer. To prevent Sybil attacks, they commit collateral. If 
proved that the VN engaged in malicious behavior, the VN will lose its collateral. </p>
<p>An Asset Issuer <sup><a href="network-analysis/probabilistic-attack/byzantine_takeover_of_the_DAN.html#ai" title=" An entity that creates
digital assets...">def</a></sup> (AI) would then issue DAs and draw up a contract. The AI will dictate the size of 
the committee of VNs for a particular DA. The AI will also have the ability to nominate a trusted node to 
form part of the VN committee for the DA [<a href="https://rfc.tari.com/RFC-0300_DAN.html" title="Tari RFC">1</a>].</p>
<h3><a class="header" href="#kademlia-1" id="kademlia-1">Kademlia</a></h3>
<p>Kademlia was designed by Petar Maymounkov and David Mazières in 2002 [<a href="https://pdos.csail.mit.edu/%7Epetar/papers/maymounkov-kademlia-lncs.pdf" title="Kademlia">2</a>]. It is a distributed hash table, used for 
decentralized, peer-to-peer computer networks. </p>
<h3><a class="header" href="#node-id-1" id="node-id-1">Node ID</a></h3>
<p>A node selects an $n$-bit ID, given to nodes on the network. Node IDs have uniformly distributed numbers. 
A node's position is determined by a unique prefix of its ID, which forms a tree structure, with node IDs as leaves. </p>
<p>The bit length of the node ID should be sufficiently large to make collisions unlikely when using a uniformly 
distributed random number generator [<a href="https://tlu.tarilabs.com/protocols/dht/MainReport.html" title="Distributed Hash Tables">3</a>].</p>
<h4><a class="header" href="#bootstrapping-a-node-1" id="bootstrapping-a-node-1">Bootstrapping a Node</a></h4>
<p>A bootstrap node is a node listed on a predetermined list, and serves as the first point of contact for a new node. The 
node bootstrapping process is as follows:</p>
<ul>
<li>To establish itself on the network without any known contacts, a node needs to contact at least one bootstrap node, 
requesting an introduction to the network.</li>
<li>A node ID is generated for the joining node.</li>
<li>The new node contacts other nodes of which it is aware.</li>
<li>The new node sends a lookup request with its newly generated node ID.</li>
<li>The contacted nodes return the nodes they know about that are closest.</li>
<li>The new nodes are added to the routing table, and contacting begins.</li>
<li>The process continues until the joining node is unable to locate any closer nodes.</li>
</ul>
<p>This 
<em>self-lookup</em> has two effects:</p>
<ul>
<li>it allows the node to learn about nodes closer to itself; and</li>
<li>it populates other nodes' 
routing tables with the node's ID [<a href="https://tlu.tarilabs.com/protocols/dht/MainReport.html" title="Distributed Hash Tables">3</a>].</li>
</ul>
<h4><a class="header" href="#xor-metric-1" id="xor-metric-1">XOR Metric</a></h4>
<p>The Kademlia paper, published in 2002 [<a href="https://pdos.csail.mit.edu/%7Epetar/papers/maymounkov-kademlia-lncs.pdf" title="Kademlia">2</a>], contained the novel idea of using the XOR operator to determine the 
distance and therefore the arrangement of peers within the network. </p>
<p>Through the XOR metric, a distance is captured. The lookup procedure allows nodes to locate other nodes, 
given a node ID [<a href="https://tlu.tarilabs.com/protocols/dht/MainReport.html" title="Distributed Hash Tables">3</a>].</p>
<h2><a class="header" href="#implementation" id="implementation">Implementation</a></h2>
<p>The following calculations were done using the <a href="https://github.com/tari-labs/modelling">Tari Labs Modelling Repository</a>. </p>
<h3><a class="header" href="#crude-monte-carlo-simulation-1" id="crude-monte-carlo-simulation-1">Crude Monte Carlo Simulation</a></h3>
<h4><a class="header" href="#proving-the-law-of-large-numbers" id="proving-the-law-of-large-numbers">Proving the Law of Large Numbers</a></h4>
<p>With the Crude Monte Carlo technique, to gain precision, the number of samples can be increased. Thus, before 
calculating the probability and drawing comparisons, the sample size, number of draws within an experiment, and the 
number of experiments can be varied to find an optimal amount. </p>
<p>Below is the input data inserted into the <a href="https://github.com/tari-labs/modelling/blob/master/scenarios/crude_monte_carlo_simulation.py">python programme</a> 
with dependencies <a href="https://github.com/tari-labs/modelling/blob/master/utils/network_setup.py">network setup</a> and <a href="https://github.com/tari-labs/modelling/blob/master/utils/rand_dist.py">random distribution</a>, where the number of draws within an experiment is $10​$, and the number of experiments is $10​$:</p>
<pre><code class="language-Text">What is the total amount of nodes? 100
What is the amount of bad nodes? 60
How many nodes are to be drawn? 3
What is the BFT threshold within the committee? 2
What is the number of draws within an experiment? 10
How many experiments? 10
Do you know the theoretical mean? Y|N: Y
What is the theoretical mean? 0.649474335188621
</code></pre>
<p align="center"><img src="network-analysis/probabilistic-attack/assets/small_no_exp_convergence.png" width="700" /></p>
<p>Below is the input data inserted into the python programme, where the number of draws within an experiment is $1,000​$ 
and the number of experiments is $1,000​$:</p>
<pre><code class="language-Text">What is the total amount of nodes? 100
What is the amount of bad nodes? 60
How many nodes are to be drawn? 3
What is the BFT threshold within the committee? 2
What is the number of draws within an experiment? 1,000
How many experiments? 1,000
Do you know the theoretical mean? Y|N: Y
What is the theoretical mean? 0.649474335188621
</code></pre>
<p align="center"><img src="network-analysis/probabilistic-attack/assets/convergence.png" width="700" /></p>
<p>In each graph, the cumulative probabilities calculated for normal, uniform, Poisson and hypergeometric distribution are 
plotted against the number of experiments. The bold blue line represents the mean calculated from theoretical data. </p>
<p>In the first graph, where the experiments and draws are equal to $10$, there is weak convergence. In the second graph, where the 
experiments and draws are equal to $1,000$, the  Law of Large Numbers (LLN) is proved; as the sample size grows, convergence 
with the statistical mean is achieved. </p>
<h4><a class="header" href="#individual-probabilities" id="individual-probabilities">Individual Probabilities</a></h4>
<p>The following graph highlights the varying probabilities of each experiment conducted for the hypergeometric distribution. 
The mean of this distribution provides us with the average of the probabilities, which can then be compared to the calculated 
theoretical mean. </p>
<p>From a comparison of the mean probability of each distribution with the theoretical mean, it can be seen that the 
distribution type that closely mimics the theoretical result is hypergeometric. </p>
<p>Hypergeometric distribution is where there is no replacement, i.e. nodes are drawn simultaneously, distinguished and 
not returned to the pool of total nodes. </p>
<p align="center"><img src="network-analysis/probabilistic-attack/assets/individual_probability_hypergeometric.png" width="700" /></p>
<h5><a class="header" href="#uniform-distribution" id="uniform-distribution">Uniform Distribution</a></h5>
<table><thead><tr><th>Statistical Information</th><th></th><th>Comparison with <br />Theoretical Mean</th><th>  Difference  Calculated</th></tr></thead><tbody>
<tr><td>Intercept</td><td>0.6497887492507493</td><td>0.649474335188621</td><td>3.14414E-4</td></tr>
<tr><td>Standard Deviation</td><td>0.015438728229013219</td><td></td><td></td></tr>
</tbody></table>
<h5><a class="header" href="#hypergeometric-distribution-1" id="hypergeometric-distribution-1">Hypergeometric Distribution</a></h5>
<table><thead><tr><th>Statistical Information</th><th></th><th>Comparison with <br />Theoretical Mean</th><th>  Difference Calculated</th></tr></thead><tbody>
<tr><td>Intercept</td><td>0.6495665834165834</td><td>0.649474335188621</td><td>9.22482E-5</td></tr>
<tr><td>Standard Deviation</td><td>0.014812123075035204</td><td></td><td></td></tr>
</tbody></table>
<h5><a class="header" href="#poisson-distribution" id="poisson-distribution">Poisson Distribution</a></h5>
<table><thead><tr><th>Statistical Information</th><th></th><th>Comparison with <br />Theoretical Mean</th><th>  Difference Calculated</th></tr></thead><tbody>
<tr><td>Intercept</td><td>0.6501259280719281</td><td>0.649474335188621</td><td>6.51592E-4</td></tr>
<tr><td>Standard Deviation</td><td>0.015233575444419514</td><td></td><td></td></tr>
</tbody></table>
<h5><a class="header" href="#normal-distribution" id="normal-distribution">Normal Distribution</a></h5>
<table><thead><tr><th>Statistical Information</th><th></th><th>Comparison with <br />Theoretical Mean</th><th>  Difference Calculated</th></tr></thead><tbody>
<tr><td>Intercept</td><td>0.6482901778221778</td><td>0.649474335188621</td><td>1.18416E-3</td></tr>
<tr><td>Standard Deviation</td><td>0.01507612979811762</td><td></td><td></td></tr>
</tbody></table>
<h4><a class="header" href="#histogram-and-visualization-of-distribution" id="histogram-and-visualization-of-distribution">Histogram and Visualization of Distribution</a></h4>
<p>The histogram of randomness highlights the distribution of good and bad nodes selected in each experiment, highlighting 
the random nature of the experiment. </p>
<p align="center"><img src="network-analysis/probabilistic-attack/assets/histogram_of_randomness.png" width="700" /></p>
<table><thead><tr><th>Statistical Information</th><th></th></tr></thead><tbody>
<tr><td>Mean</td><td>120,000.0</td></tr>
<tr><td>Median</td><td>119,991.0</td></tr>
<tr><td>Mode</td><td>-</td></tr>
<tr><td>Standard Deviation</td><td>346.4313595341606</td></tr>
</tbody></table>
<h3><a class="header" href="#statistical-calculation" id="statistical-calculation">Statistical Calculation</a></h3>
<p>Literature about <a href="network-analysis/probabilistic-attack/../../consensus-mechanisms/BFT-consensus-mechanisms-applications/MainReport.html">BFT threshold</a> advises 
the number of good nodes to be at least $\frac{2}{3} \cdot n+1​$, where $n​$ is the number of nodes. In the calculations 
that follow, BFT threshold of, for example, $67​$% of N, is implemented with rounding up to ensure that at least that 
fraction is obtained. In this sense, $67​$% of N simulates $\frac{2}{3} \cdot n+1​$.</p>
<h4><a class="header" href="#variation-of-total-nodes" id="variation-of-total-nodes">Variation of Total Nodes</a></h4>
<p>The variables and results are below: </p>
<ul>
<li>N (total number of nodes in the network) = $100, 300, 500, 1000$</li>
<li>m (number of bad actors) = $60$% of N</li>
<li>T (BFT threshold) = $67$% of N</li>
<li>n (committee size) = ranging from $1$ to $1,000$ </li>
</ul>
<p>The above graph was calculated using Python (<a href="https://github.com/tari-labs/modelling/blob/master/scenarios/N_variations.py">variations of N</a> with dependencies <a href="https://github.com/tari-labs/modelling/blob/master/utils/hyper_dist_prob.py">hypergeometric distribution</a>). Below is a sample of the data where there is a total of 100. The highlighted data was previously used in the Crude Monte Carlo Simulation when supplying the theoretical mean.</p>
<table><thead><tr><th align="center">  Total Nodes  </th><th align="center">  Bad Nodes  </th><th align="center">  Committee Size  </th><th align="center">  BFT Threshold  </th><th>  Probability  </th></tr></thead><tbody>
<tr><td align="center">100</td><td align="center">60</td><td align="center">1</td><td align="center">1</td><td>0.6</td></tr>
<tr><td align="center">100</td><td align="center">60</td><td align="center">2</td><td align="center">2</td><td>0.3575757575757576</td></tr>
<tr><td align="center"><div class="highlight">100</div></td><td align="center"><div class="highlight">60</div></td><td align="center"><div class="highlight">3</div></td><td align="center"><div class="highlight">2</div></td><td><div class="highlight">0.649474335188621</div></td></tr>
<tr><td align="center">100</td><td align="center">60</td><td align="center">4</td><td align="center">3</td><td>0.47343240951488375</td></tr>
<tr><td align="center">100</td><td align="center">60</td><td align="center">5</td><td align="center">4</td><td>0.33162085827770661</td></tr>
<tr><td align="center">100</td><td align="center">60</td><td align="center">6</td><td align="center">4</td><td>0.5443381851334722</td></tr>
<tr><td align="center">100</td><td align="center">60</td><td align="center">7</td><td align="center">5</td><td>0.4153500188485931</td></tr>
<tr><td align="center">100</td><td align="center">60</td><td align="center">8</td><td align="center">6</td><td>0.30661160770090995</td></tr>
<tr><td align="center">100</td><td align="center">60</td><td align="center">9</td><td align="center">6</td><td>0.47996269793634677</td></tr>
<tr><td align="center">100</td><td align="center">60</td><td align="center">10</td><td align="center">7</td><td>0.37423758246308586</td></tr>
<tr><td align="center">100</td><td align="center">60</td><td align="center">11</td><td align="center">8</td><td>0.28361605491457653</td></tr>
<tr><td align="center">100</td><td align="center">60</td><td align="center">12</td><td align="center">8</td><td>0.4320215340178938</td></tr>
<tr><td align="center">100</td><td align="center">60</td><td align="center">13</td><td align="center">9</td><td>0.3409545354772218</td></tr>
<tr><td align="center">100</td><td align="center">60</td><td align="center">14</td><td align="center">10</td><td>0.2623321970180976</td></tr>
<tr><td align="center">100</td><td align="center">60</td><td align="center">15</td><td align="center">10</td><td>0.39288184738975973</td></tr>
</tbody></table>
<p align="center"><img src="network-analysis/probabilistic-attack/assets/variation_of_total_nodes .png" width="700" /></p>
From a plot of committee size versus probability with a change in $N$, the total number of nodes, it can be seen that 
the probability is lower with respect to the committee size when $N$ is smaller. 
<h4><a class="header" href="#variation-of-byzantine-fault-tolerance-threshold" id="variation-of-byzantine-fault-tolerance-threshold">Variation of Byzantine Fault-tolerance Threshold</a></h4>
<p>The variables and results are below: </p>
<ul>
<li>N (total number of nodes in the network) = $100$</li>
<li>m (number of bad actors) = $60$% of N</li>
<li>T (BFT threshold) = $50$%, $55$%, $60$%, $67$% of N</li>
<li>n (committee size) = ranging from $1$ to $100$ </li>
</ul>
<p align="center"><img src="network-analysis/probabilistic-attack/assets/variation_of_bft_threshold.png" width="700" /></p>
<p>The above graph was calculated using Python 
(<a href="https://github.com/tari-labs/modelling/blob/master/scenarios/T_variations.py">variations of BFT</a> with dependencies 
<a href="https://github.com/tari-labs/modelling/blob/master/utils/hyper_dist_prob.py">hypergeometric distribution</a>). From a plot 
of committee size versus probability where the number of nodes remains at $100$ with a change in $T$, the BFT 
threshold, ranging from $50$% to $67$%, it can be seen that When the BFT threshold is $50$% and $55$%, the probability 
is low when the committee size is small; as the committee size increases, the probability increases, and tends to $1$. 
The probability is higher for the case where the BFT threshold is $50$% than when the probability is $55$%. </p>
<p>When the BFT threshold is $60$%, the probability decreases from $0.63$ to approximately $0.59$, where it remains constant. </p>
<p>When the BFT threshold is $65$% and $67$%, the probability decreases from $0.38$ and tends to zero. This confirms the 
BFT threshold of $\frac{2}{3} \cdot n+1$ as per literature.</p>
<h4><a class="header" href="#variation-of-total-number-of-nodes-with-committee-size-10" id="variation-of-total-number-of-nodes-with-committee-size-10">Variation of Total Number of Nodes with Committee Size 10</a></h4>
<p>The variables and results are below: </p>
<ul>
<li>N (total number of nodes in the network) = ranging from $10$ to $350$</li>
<li>m (number of bad actors) = $60$% of N</li>
<li>T (BFT threshold) = $67$% of N</li>
<li>n (committee size) = $10$</li>
</ul>
<p align="center"><img src="network-analysis/probabilistic-attack/assets/committee_size_10.png" width="900" /></p>
<p>The above graph was calculated using Excel 
(<a href="https://github.com/tari-labs/modelling/blob/master/other/variation_of_N_n_fixed.xlsx">variations of N with n fixed</a>). For the 
graph showing varying probabilities with respect to the total number of network nodes, where the committee size is $10$, 
the probability dramatically increases when the total nodes is $3$ times more than the committee size and onwards. The 
probability plateaus at $0.35$. </p>
<h4><a class="header" href="#variation-of-total-number-of-nodes-with-committee-size-100" id="variation-of-total-number-of-nodes-with-committee-size-100">Variation of Total Number of Nodes with Committee Size 100</a></h4>
<p>The variables and results are below: </p>
<ul>
<li>N (total number of nodes in the network) = ranging from $100$ to $1,300$</li>
<li>m (number of bad actors) = $60$% of N</li>
<li>T (BFT threshold) = $67​$% of N</li>
<li>n (committee size) = $100$</li>
</ul>
<p align="center"><img src="network-analysis/probabilistic-attack/assets/committee_size_100.png" width="900" /></p>
<p>The above graph was calculated using Excel 
(<a href="https://github.com/tari-labs/modelling/blob/master/other/variation_of_N_n_fixed.xlsx">variations of N with n fixed</a>). 
From this and the previous graph, it can be seen that probabilities are significantly lower when the committee size is 
$100$ compared to when it is $10$. There is an increase in probability up to a network size of $700$, albeit, not as steep as the 
change when the committee size is $10$. The probability plateaus at $0.08$.</p>
<p>The larger the committee size, the fewer dramatic changes there are in the probability. </p>
<h4><a class="header" href="#variation-of-bad-nodes-with-committee-size-10-and-100" id="variation-of-bad-nodes-with-committee-size-10-and-100">Variation of Bad Nodes with Committee Size 10 and 100</a></h4>
<p>The variables and results are below: </p>
<ul>
<li>N (total number of nodes in the network) = ranging from $10$ and $100$ to $50,000$</li>
<li>m (number of bad actors) = $10$%, $20$%, $30$%, $40$%, $50$%, $60$%, $70$%, $80$% and $90$% of N</li>
<li>T (BFT threshold) = $67$% of N</li>
<li>n (committee size) = $10$ and $100$</li>
</ul>
<p align="center"><img src="network-analysis/probabilistic-attack/assets/probability_when_committee_100_20.png" width="900" /></p>
<p align="center"><img src="network-analysis/probabilistic-attack/assets/probability_when_committee_100_40.png" width="900" /></p>
<p align="center"><img src="network-analysis/probabilistic-attack/assets/probability_when_committee_100_60.png" width="900" /></p>
<p align="center"><img src="network-analysis/probabilistic-attack/assets/probability_when_committee_100_90.png" width="900" /></p>
<p>The above graphs were calculated using Excel 
(<a href="https://github.com/tari-labs/modelling/blob/master/other/bad_nodes_variation_10_10.xlsx">bad node variation where n is 100</a>). These 
graphs show varying probabilities when the percentage of bad nodes is $20$, $40$, $60$ and $90$. The value when the 
probability plateaus is used to construct the following graph for both committee sizes $10$ and $100$. </p>
<p align="center"><img src="network-analysis/probabilistic-attack/assets/probability_bad_nodes_10_100.png" width="850" /></p>
<p>The above graph was calculated using Excel 
(<a href="https://github.com/tari-labs/modelling/blob/master/other/bad_node_percentage_10_100.xlsx">bad node percentage at 10 and 100</a>). The 
graph shows changes in the probability due to changes in percentage of bad nodes when the committee size is $10$ and $100$.  When 
the committee size is $10$, there is a change in probability when the bad node percentage is between $30$ and $80$.<br />
When the committee size is $100$, there is a steep increase in the probability when the bad node percentage is between 
$50$ and $80$. When the committee size is $100$, the probability remains lower as the bad node percentage increases and 
has a steeper gradient when the change in probability occurs. Whereas, when the committee size is $10$, the probability 
begins to increase at a lower percentage of bad nodes. </p>
<h2><a class="header" href="#conclusions-and-remarks" id="conclusions-and-remarks">Conclusions and Remarks</a></h2>
<p>With regard to the Crude Monte Carlo Simulation, at this building block stage, probabilities were calculated and 
distributions of nodes within the network illustrated.</p>
<p>With regard to the statistical calculation, comments can be made for each of the varied parameters. </p>
<ul>
<li>Total nodes in the network: The smaller the pool of total nodes in the network, the lower the probability of bad 
actors controlling the network. However, the probability difference is near negligible if the committee size is large. 
This parameter will also be difficult to control, and the network will be ever-increasing. This can be seen in the 
graph in <a href="network-analysis/probabilistic-attack/byzantine_takeover_of_the_DAN.html#variation-of-total-nodes">Variation of Total Nodes</a>. </li>
<li>BFT threshold: This threshold should be at least  $\frac{2}{3} \cdot n+1$ as per literature. This can be seen in the 
graph in <a href="network-analysis/probabilistic-attack/byzantine_takeover_of_the_DAN.html#variation-of-byzantine-fault-tolerance-threshold">Variation of Byzantine Fault-tolerance Threshold</a>.</li>
<li>Committee size: The larger the committee size, the lower the probability of bad actors controlling the network. This can 
be seen in the graph in 
<a href="network-analysis/probabilistic-attack/byzantine_takeover_of_the_DAN.html#variation-of-total-number-of-nodes-with-committee-size-10">Variation of Total Number of Nodes with Committee Size 10</a> 
and <a href="network-analysis/probabilistic-attack/byzantine_takeover_of_the_DAN.html#variation-of-total-number-of-nodes-with-committee-size-100">Variation of Total Number of Nodes with Committee Size 100</a>.</li>
<li>Bad nodes: While this variable cannot be controlled, the probability of bad actors controlling the network can remain 
low, as the percentage of bad nodes increases if the committee size is approximately $100$ or larger. This can be seen in the 
graphs in <a href="network-analysis/probabilistic-attack/byzantine_takeover_of_the_DAN.html#variation-of-bad-nodes-with-committee-size-10-and-100">Variation of Bad Nodes with Committee Size 10 and 100</a></li>
</ul>
<h2><a class="header" href="#references-30" id="references-30">References</a></h2>
<p>[<a href="https://rfc.tari.com/RFC-0300_DAN.html" title="Tari RFC">1</a>] C. Sharrock [online]. Available: <a href="https://rfc.tari.com/RFC-0300_DAN.html">https://rfc.tari.com/RFC-0300_DAN.html</a>. 
Date accessed: 2019‑07‑18.</p>
<p>[<a href="https://pdos.csail.mit.edu/%7Epetar/papers/maymounkov-kademlia-lncs.pdf" title="Kademlia">2</a>] P. Maymounkov and D. Mazières, &quot;Kademlia: A Peer-to-peer Information System Based on the XOR Metric&quot; [online]. 
Available: <a href="https://pdos.csail.mit.edu/%7Epetar/papers/maymounkov-kademlia-lncs.pdf">https://pdos.csail.mit.edu/~petar/papers/maymounkov-kademlia-lncs.pdf</a>. Date accessed: 2019‑07‑18.</p>
<p>[<a href="https://tlu.tarilabs.com/protocols/dht/MainReport.html" title="Distributed Hash Tables">3</a>] S. Bondi, &quot;Distributed Hash Tables&quot; [online]. Available: <a href="https://tlu.tarilabs.com/protocols/dht/MainReport.html">https://tlu.tarilabs.com/protocols/dht/MainReport.html</a>. 
Date accessed: 2019‑07‑18.</p>
<h2><a class="header" href="#appendices-11" id="appendices-11">Appendices</a></h2>
<h3><a class="header" href="#appendix-a-definitions-of-terms-1" id="appendix-a-definitions-of-terms-1">Appendix A: Definitions of Terms</a></h3>
<p>Definitions of terms presented here are high level and general in nature. </p>
<ul>
<li><strong>Asset Issuer (AI):</strong><a name="ai"> </a> An entity that creates digital assets on the Tari Digital Asset Network (DAN). The Asset Issuer will 
specify the parameters of the contract template that defines the rules that govern the asset and the number and nature 
of its constituent tokens on issuance. The AI will, generally, be the initial owner of the tokens [<a href="https://rfc.tari.com/RFC-0300_DAN.html" title="Tari RFC">1</a>].</li>
</ul>
<ul>
<li><strong>Validator Node (VN):</strong><a name="vn"> </a>Validator nodes make up the Tari second layer, or Digital Asset Network (DAN). VNs 
are responsible for creating and updating digital asset living on the Tari network [<a href="https://rfc.tari.com/RFC-0300_DAN.html" title="Tari RFC">1</a>].</li>
</ul>
<h2><a class="header" href="#contributors-22" id="contributors-22">Contributors</a></h2>
<ul>
<li><a href="https://github.com/kevoulee">https://github.com/kevoulee</a></li>
<li><a href="https://github.com/anselld">https://github.com/anselld</a> </li>
<li><a href="https://github.com/neonknight64">https://github.com/neonknight64</a> </li>
<li><a href="https://github.com/hansieodendaal">https://github.com/hansieodendaal</a> </li>
</ul>
<h1><a class="header" href="#tlu-labs" id="tlu-labs">TLU Labs</a></h1>
<h2><a class="header" href="#purpose-7" id="purpose-7">Purpose</a></h2>
<p>This chapter contains various new features and demos that we're thinking of adding to make the TLU experience better. Since this is experimental, things might not work 100% here.</p>
<h1><a class="header" href="#mermaid-demo" id="mermaid-demo">Mermaid Demo</a></h1>
<p>TLU can now support mermaid diagrams! Flowcharts, sequence diagrams and more!</p>
<h3><a class="header" href="#how-to-write-mermaid-diagrams" id="how-to-write-mermaid-diagrams">How to write mermaid diagrams.</a></h3>
<ol>
<li><a href="https://mermaidjs.github.io">RTFM</a>.</li>
<li>Wrap your mermaid code in <code>&lt;div&gt;</code> tags. Add the <code>class=mermaid</code> attribute to the tag. So your code will look like</li>
</ol>
<pre><code class="language-html">&lt;div class=&quot;mermaid&quot;&gt;
graph LR
...
&lt;/div&gt;
</code></pre>
<ol start="3">
<li><strong>Note:</strong> You can't have blank lines in your diagrams, unfortunately, because the markdown renderer will interpret
this as a new paragraph and break your diagram. However, you can <em>sort of</em> workaround this by putting a <code>#</code> as a 
spacer (see first example).</li>
</ol>
<h2><a class="header" href="#sequence-diagram-example" id="sequence-diagram-example">Sequence diagram example</a></h2>
<pre><code class="language-html">&lt;div  class=mermaid&gt;
sequenceDiagram
    Alice -&gt;&gt; Bob: Hello Bob, how are you?
    Bob--&gt;&gt;John: How about you John?
    Bob--x Alice: I am good thanks!
    Bob-x John: I am good thanks!
 #
    Note right of John: Bob thinks a long&lt;br/&gt;long time, so long&lt;br/&gt;that the text does&lt;br/&gt;not fit on a row.
    Bob--&gt;Alice: Checking with John...
    Alice-&gt;John: Yes... John, how are you?
&lt;/div&gt;
</code></pre>
<div class=mermaid>
sequenceDiagram
    Alice ->> Bob: Hello Bob, how are you?
    Bob-->>John: How about you John?
    Bob--x Alice: I am good thanks!
    Bob-x John: I am good thanks!
#
    Note right of John: Bob thinks a long<br/>long time, so long<br/>that the text does<br/>not fit on a row.
    Bob-->Alice: Checking with John...
    Alice->John: Yes... John, how are you?
</div>
<h2><a class="header" href="#flowchart-example" id="flowchart-example">Flowchart example</a></h2>
<pre><code class="language-html">&lt;div  class=mermaid&gt;
graph LR
    A[Hard edge] --&gt;|Link text| B(Round edge)
    B --&gt; C{Decision}
    C --&gt;|One| D[Result one]
    C --&gt;|Two| E[Result two]
&lt;/div&gt;
</code></pre>
<div  class=mermaid>    
graph LR
    A[Hard edge] -->|Link text| B(Round edge)
    B --> C{Decision}
    C -->|One| D[Result one]
    C -->|Two| E[Result two]    
</div>
<h2><a class="header" href="#gantt-chart-example" id="gantt-chart-example">Gantt Chart example</a></h2>
<pre><code class="language-html">&lt;div class=&quot;mermaid&quot;&gt;
gantt
       dateFormat  YYYY-MM-DD
       title Adding GANTT diagram functionality to mermaid
       section A section
       Completed task            :done,    des1, 2014-01-06,2014-01-08
       Active task               :active,  des2, 2014-01-09, 3d
       Future task               :         des3, after des2, 5d
       Future task2              :         des4, after des3, 5d
       section Critical tasks
       Completed task in the critical line :crit, done, 2014-01-06,24h
       Implement parser and jison          :crit, done, after des1, 2d
       Create tests for parser             :crit, active, 3d
       Future task in critical line        :crit, 5d
       Create tests for renderer           :2d
       Add to mermaid                      :1d
       section Documentation
       Describe gantt syntax               :active, a1, after des1, 3d
       Add gantt diagram to demo page      :after a1  , 20h
       Add another diagram to demo page    :doc1, after a1  , 48h
       section Last section
       Describe gantt syntax               :after doc1, 3d
       Add gantt diagram to demo page      :20h
       Add another diagram to demo page    :48h
&lt;/div&gt;
</code></pre>
<div class="mermaid">
gantt
       dateFormat  YYYY-MM-DD
       title Adding GANTT diagram functionality to mermaid
       section A section
       Completed task            :done,    des1, 2014-01-06,2014-01-08
       Active task               :active,  des2, 2014-01-09, 3d
       Future task               :         des3, after des2, 5d
       Future task2              :         des4, after des3, 5d
       section Critical tasks
       Completed task in the critical line :crit, done, 2014-01-06,24h
       Implement parser and jison          :crit, done, after des1, 2d
       Create tests for parser             :crit, active, 3d
       Future task in critical line        :crit, 5d
       Create tests for renderer           :2d
       Add to mermaid                      :1d
       section Documentation
       Describe gantt syntax               :active, a1, after des1, 3d
       Add gantt diagram to demo page      :after a1  , 20h
       Add another diagram to demo page    :doc1, after a1  , 48h
       section Last section
       Describe gantt syntax               :after doc1, 3d
       Add gantt diagram to demo page      :20h
       Add another diagram to demo page    :48h
</div>       <h2><a class="header" href="#notes" id="notes">Notes</a></h2>
<pre><code class="language-html">&lt;div class=&quot;note&quot;&gt;
  Give your reports a bit of pizazz with Notes!
&lt;/div&gt;
</code></pre>
<div class="note">
Give your reports a bit of pizazz with Notes!
</div>
<h2><a class="header" href="#info-boxes" id="info-boxes">Info boxes</a></h2>
<pre><code class="language-html">&lt;div class=&quot;note info&quot;&gt;
  Highlight interesting information and asides in an info box.
&lt;/div&gt;
</code></pre>
<div class="note info">
  Highlight interesting information and asides in an info box.
</div>
<h2><a class="header" href="#warnings" id="warnings">Warnings</a></h2>
<pre><code class="language-html">&lt;div class=&quot;note warning&quot;&gt;
  A highly visual and high contrast warning box will really get your message out there!
&lt;/div&gt;
</code></pre>
<div class="note warning">
  A highly visual and high contrast warning box will really get your message out there!
</div><h1><a class="header" href="#style-guide" id="style-guide">Style Guide</a></h1>
<ul>
<li><a href="preface/style-guide.html#purpose">Purpose</a></li>
<li><a href="preface/style-guide.html#standards-for-content">Standards for Content</a>
<ul>
<li><a href="preface/style-guide.html#spelling">Spelling</a></li>
<li><a href="preface/style-guide.html#quotation-marks">Quotation Marks</a></li>
<li><a href="preface/style-guide.html#punctuation">Punctuation</a></li>
<li><a href="preface/style-guide.html#units-of-measure">Units of Measure</a></li>
<li><a href="preface/style-guide.html#date-and-time">Date and Time</a></li>
<li><a href="preface/style-guide.html#abbreviations">Abbreviations</a></li>
<li><a href="preface/style-guide.html#spacing">Spacing</a></li>
<li><a href="preface/style-guide.html#decimals-and-numbers">Decimals and Numbers</a></li>
<li><a href="preface/style-guide.html#list-types">List Types</a></li>
<li><a href="preface/style-guide.html#list-punctuation">List Punctuation</a></li>
<li><a href="preface/style-guide.html#cross-referencing">Cross-referencing</a></li>
<li><a href="preface/style-guide.html#case-formatting">Case Formatting</a></li>
<li><a href="preface/style-guide.html#terminology">Terminology</a></li>
</ul>
</li>
<li><a href="preface/style-guide.html#standards-for-layout">Standards for Layout</a>
<ul>
<li><a href="preface/style-guide.html#proposed-layout">Proposed Layout</a></li>
<li><a href="preface/style-guide.html#line-widths">Line Widths</a></li>
<li><a href="preface/style-guide.html#bulleted-list-of-contents">Bulleted List of Contents</a></li>
<li><a href="preface/style-guide.html#headings">Headings</a></li>
<li><a href="preface/style-guide.html#figures-and-tables">Figures and Tables</a></li>
<li><a href="preface/style-guide.html#equations">Equations</a></li>
<li><a href="preface/style-guide.html#referencing-of-source-material">Referencing of Source Material</a>
<ul>
<li><a href="preface/style-guide.html#referencing-standard">Referencing Standard</a></li>
<li><a href="preface/style-guide.html#markdown-links">Markdown Links</a></li>
</ul>
</li>
<li><a href="preface/style-guide.html#list-of-contributors">List of Contributors</a></li>
</ul>
</li>
<li><a href="preface/style-guide.html#references">References</a></li>
<li><a href="preface/style-guide.html#appendices">Appendices</a>
<ul>
<li><a href="preface/style-guide.html#appendix-a-lower-case-words-used-in-title-case-formatting">Appendix A: Lower-case Words used in Title Case Formatting</a></li>
<li><a href="preface/style-guide.html#appendix-b-tari-labs-university-terminology-conventions">Appendix B: Tari Labs University Terminology Conventions</a></li>
</ul>
</li>
<li><a href="preface/style-guide.html#contributors">Contributors</a></li>
</ul>
<h2><a class="header" href="#purpose-8" id="purpose-8">Purpose</a></h2>
<p>The purpose of this Style Guide is to provide contributors to the Tari Labs University (TLU) reports with standards for 
content and layout. The intention is to improve communication and provide a high-quality learning resource for users. 
Use of this Style Guide can assist in ensuring consistency in the content and layout of TLU reports.</p>
<p>TLU content is created in <a href="https://www.markdownguide.org/">Markdown</a> format and is rendered using 
<a href="https://github.com/rust-lang-nursery/mdBook">mdBook</a>.</p>
<h2><a class="header" href="#standards-for-content" id="standards-for-content">Standards for Content</a></h2>
<h3><a class="header" href="#spelling" id="spelling">Spelling</a></h3>
<p>As per the United States (US) spelling standard. The applicable dictionary is Merriam-Webster Online [<a href="https://www.merriam-webster.com" title="Merriam-Webster Online Dictionary">1</a>]. </p>
<h3><a class="header" href="#quotation-marks" id="quotation-marks">Quotation Marks</a></h3>
<p>As per the American style. Use double quotation marks for a first quotation and single quotation marks for a quotation 
within a quotation.</p>
<h3><a class="header" href="#punctuation" id="punctuation">Punctuation</a></h3>
<p>As per the United Kingdom (UK) punctuation standard. Place commas and full stops outside the closing quotation marks as 
advised in [<a href="http://www.eng-lang.co.uk/ogs.htm" title="The Oxford Guide to Style">4</a>]. </p>
<h3><a class="header" href="#units-of-measure" id="units-of-measure">Units of Measure</a></h3>
<p>Use the internationally agreed ISO standards [<a href="https://physics.nist.gov/cuu/pdf/sp811.pdf" title="Guide for the Use of the International System of Units (SI)">3</a>] for expressing units of measure.</p>
<p><em>Example</em></p>
<p>min = minute, s = second, h = hour, g = gram. </p>
<h3><a class="header" href="#date-and-time" id="date-and-time">Date and Time</a></h3>
<ul>
<li>Date format: yyyy-mm-dd (year-month-date).</li>
<li>Date format when written in text: &quot;The document was submitted for approval on 10 March 2019&quot;.</li>
<li>Time format (international): 11:00; 15:00.</li>
</ul>
<h3><a class="header" href="#abbreviations" id="abbreviations">Abbreviations</a></h3>
<ul>
<li>
<p>If it is necessary to use abbreviations in a report, write the abbreviation out in full at its first occurrence in 
the text, followed by the abbreviation in brackets. Thereafter, use the abbreviation only.</p>
<p><em>Example</em></p>
<p>Tari Labs University (TLU), graphical user interface (GUI).</p>
</li>
<li>
<p>Abbreviations of units should be consistent and not changed in the plural.</p>
<p><em>Example</em></p>
<p>10h and not 10hrs; 5min and not 5mins.</p>
</li>
</ul>
<h3><a class="header" href="#spacing" id="spacing">Spacing</a></h3>
<p><strong>Note:</strong> Due to limitations in Markdown, we deviate from the ISO convention, which requires a space between numbers 
and units of measure, and also as a thousands separator.</p>
<ul>
<li>
<p>Use of a non-breaking space (<code>&amp;nbsp;</code>) can improve readability in the rendered mdbook where required.</p>
</li>
<li>
<p>Indicate clearly to which unit a number belongs:</p>
<p><em>Incorrect</em></p>
<p>11 x 11 x 11mm</p>
<p><em>Correct</em></p>
<p>11mm x 11mm x 11mm</p>
</li>
<li>
<p>Use 'to' rather than a dash to indicate a range of values:</p>
<p><em>Incorrect</em>
1 - 10cm</p>
<p><em>Correct</em></p>
<p>1cm to 10cm</p>
</li>
<li>
<p>Use a comma to indicate thousands.</p>
<p><em>Example</em></p>
<p>1,000; 20,000,000; 250,000.</p>
</li>
</ul>
<p>Mathematical operators should usually be wrapped inside <a href="preface/style-guide.html#equations">equation tags</a>. In plain text, leave a space on 
either side of signs such as + (plus), - (minus), = (equal to), &gt; (greater than) and &lt; (less than).</p>
<h3><a class="header" href="#decimals-and-numbers" id="decimals-and-numbers">Decimals and Numbers</a></h3>
<ul>
<li>Use the decimal point and not the decimal comma.</li>
<li>Write out numbers from one to nine in full in text; use Arabic numerals for 10 onwards.</li>
</ul>
<h3><a class="header" href="#list-types" id="list-types">List Types</a></h3>
<p>TLU uses unordered lists (refer to the first example under <a href="preface/style-guide.html#list-punctuation">List Punctuation</a>) and ordered lists 
(refer to the second example under <a href="preface/style-guide.html#list-punctuation">List Punctuation</a>.</p>
<h3><a class="header" href="#list-punctuation" id="list-punctuation">List Punctuation</a></h3>
<p>Where a list is a continuation of the preceding text, which is followed by a colon, use a semicolon between each 
bullet point and end the list with a full stop.</p>
<p><em>Example</em></p>
<p>Their primary motivations for selecting a static emission rate are:</p>
<ul>
<li>there will be no upper limit on the amount of coins that can be created;</li>
<li>the percentage of newly created coins compared to the total coins in circulation will tend toward zero;</li>
<li>it will mitigate the effect of orphaned and lost coins;</li>
<li>it will encourage spending rather than holding of coins.</li>
</ul>
<p>Where a list contains complete sentences, each item in the list is followed by a full stop.</p>
<p><em>Example</em></p>
<p>According to the proposed solution, one of three conditions will be true to the SPV client when using erasure codes:</p>
<ol>
<li>The entire extended data is available, the erasure code is constructed correctly and the block is valid.</li>
<li>The entire extended data is available, the erasure code is constructed correctly, but the block is invalid.</li>
<li>The entire extended data is available, but the erasure code is constructed incorrectly.</li>
</ol>
<p>Where a list is not a sentence and does not complete a preceding part of a sentence, use no punctuation.</p>
<p><em>Example</em></p>
<p>Refer to the list of contents at the start of this Style Guide.</p>
<h3><a class="header" href="#cross-referencing" id="cross-referencing">Cross-referencing</a></h3>
<ul>
<li>Insert cross-references between the referenced information in the text and the list of references.</li>
<li>Text references appear in square brackets in the text and are listed under &quot;References&quot; at the end of each chapter.</li>
<li>If a text reference appears at the end of a paragraph, it appears after the full stop at the end of the paragraph.</li>
<li>Please be specific when referring to figures, tables and sections of text. For clarity, if using figure and table 
numbering, avoid referring to &quot;below&quot; or &quot;above&quot;. Rather give a specific figure or table number. In the case of text 
references, include a link. For more information, please refer to the <a href="preface/style-guide.html#markdown-links">Markdown Links</a> section in this 
Style Guide.</li>
</ul>
<h3><a class="header" href="#case-formatting" id="case-formatting">Case Formatting</a></h3>
<p><a href="preface/style-guide.html#appendix-a-lower-case-words-used-in-title-case-formatting">Appendix A</a> contains a list of lower-case words used in 
title case formatting in headings and captions (if used).</p>
<h3><a class="header" href="#terminology" id="terminology">Terminology</a></h3>
<p>With new concepts being formed daily and words changing over time, it is useful to establish terminology conventions. Different conventions (upper-case, lower-case, one word, two words, etc.) are used by different sources. <a href="preface/style-guide.html#appendix-b-tari-labs-university-terminology-conventions">Appendix B</a> contains suggested terminology for use in TLU reports.</p>
<h2><a class="header" href="#standards-for-layout" id="standards-for-layout">Standards for Layout</a></h2>
<h3><a class="header" href="#proposed-layout" id="proposed-layout">Proposed Layout</a></h3>
<p>This section gives the proposed layout for TLU reports. The following headings are provided as a guide to heading 
levels and content:</p>
<ul>
<li><strong>Title (as heading level 1)</strong>
Contents List (as embedded links).
<ul>
<li>
<p><strong>Introduction/Purpose/Background/Overview (as heading level 2)</strong></p>
<p>This section explains the aim of the report and prepares the reader for the content.</p>
</li>
<li>
<p><strong>Other headings as appropriate (as heading level 2 and lower)</strong></p>
<p>Structure the body of your report by using headings and subheadings. Ordering these headings logically helps you 
to present your information effectively. Headings make it easier for 
readers to find specific information.</p>
<ul>
<li>
<p><strong>Numbered Lists:</strong> Use numbered lists when the order of the items in the list is important, such as in procedures.</p>
</li>
<li>
<p><strong>Bulleted Lists:</strong> Use bulleted lists when the order of the items in the list is not important.</p>
</li>
</ul>
</li>
<li>
<p><strong>Conclusions, Observations, Recommendations (as heading level 2)</strong></p>
<p>The conclusion complements the purpose of the report. It concisely summarizes the findings of the report and 
gives a future strategy, if required.</p>
</li>
<li>
<p><strong>References (as heading level 2)</strong></p>
<p>References acknowledge the work of others and help readers to find sources. Refer to 
<a href="preface/style-guide.html#referencing-of-source-material">Referencing of Source Material</a>.</p>
</li>
<li>
<p><strong>Appendices (as heading level 2)</strong></p>
<p>Appendices contain supplementary information that supports the main report. </p>
<ul>
<li>
<p><strong>Appendix A: Name (as heading level 3)</strong></p>
<p>Rather than inserting an entire supporting document into an appendix, provide a text reference and list the 
reference in the references section.</p>
</li>
<li>
<p><strong>Appendix B: Name  (as heading level 3)</strong></p>
<p>If figure and table numbers are used in the report, the figure and table numbering in the appendices follows on
from the figure and table numbers used in the report.</p>
</li>
</ul>
</li>
<li>
<p><strong>Contributors (as heading level 2)</strong></p>
<p>Refer to <a href="preface/style-guide.html#list-of-contributors">List of Contributors</a>.</p>
</li>
</ul>
</li>
</ul>
<h3><a class="header" href="#line-widths" id="line-widths">Line Widths</a></h3>
<p>Try to keep line widths to a maximum of 120 characters for ease of GitHub reviews. 
In Markdown, a single line break does not constitute the start of a new paragraph.</p>
<p><em>Example</em></p>
<p>This text, which is split over four lines:</p>
<p><code>Probatum fuit hujusmodi Testamentum apud London decimo Octavo die mensis Septembris Anno Domini Millesimo</code><br />
<code>Septingentesimo vicesimo tertio Coram venerabili viro Gulielmo Strahan. In cuius rei testimonium sigillum nostrum</code><br />
<code>presentibus apposuimus ad duos anni terminos videlicet ad festa Sancti Michaelis Archangeli et Annunciationis beate</code><br />
<code>Marie virginis.</code> </p>
<p>will look like a single paragraph, as follows:</p>
<p>Probatum fuit hujusmodi Testamentum apud London decimo Octavo die mensis Septembris Anno Domini Millesimo 
Septingentesimo vicesimo tertio Coram venerabili viro Gulielmo Strahan. In cuius rei testimonium sigillum nostrum 
presentibus apposuimus ad duos anni terminos videlicet ad festa Sancti Michaelis Archangeli et Annunciationis beate 
Marie virginis.</p>
<h3><a class="header" href="#bulleted-list-of-contents" id="bulleted-list-of-contents">Bulleted List of Contents</a></h3>
<p>Every chapter in a TLU report should start with a bulleted list of all the headings in that chapter (with embedded 
links), for quick reference and consistency. This is optional for chapters that have five or fewer lower-level headings.</p>
<p><em>Example</em></p>
<p>Refer to the contents listed at the start of this <a href="preface/style-guide.html#style-guide">Style Guide</a>. The heading &quot;Contents&quot; is not inserted 
before this list. </p>
<h3><a class="header" href="#headings" id="headings">Headings</a></h3>
<ul>
<li>Do not include paragraph numbers in headings.</li>
<li>For consistency, upper and lower-case (title case) letters are used for headings at all levels.</li>
</ul>
<p><em>Incorrect</em></p>
<p>## 2. OVERVIEW</p>
<p><em>Correct</em></p>
<p>## Overview</p>
<p>Also refer to <a href="preface/style-guide.html#appendix-a-lower-case-words-used-in-title-case-formatting">Appendix A</a>.</p>
<h3><a class="header" href="#figures-and-tables" id="figures-and-tables">Figures and Tables</a></h3>
<p>The use of captions, as well as figure and table numbering, is optional. If you choose to use numbering and captions, 
these guidelines will help to promote consistency in TLU layout:</p>
<ul>
<li>Number figures and tables in each section sequentially, with the table caption above the table and the figure caption
below the figure.</li>
<li>Type figure and table captions in upper and lower-case (title case).</li>
<li>Type Figure x: or Table X: before the caption, as applicable.</li>
<li>Center figures and tables on the page.</li>
<li>Place figures and tables as soon as possible after they are first referred to in the text. The text reference, if 
figure and table numbering is not used, would then be &quot;the following figure...&quot; or &quot;the following table...&quot;. This helps 
to avoid confusion.</li>
</ul>
<h3><a class="header" href="#equations" id="equations">Equations</a></h3>
<p>mdBook has optional support for math 
<a href="https://github.com/rust-lang-nursery/mdBook/blob/master/book-example/src/format/mathjax.md">equations</a> 
through MathJax. In addition to the delimiters <code>\[</code> and <code>\[</code>, TLU also supports delimiters <code>$</code> and <code>$$</code>.</p>
<p><em>Examples</em></p>
<ul>
<li>
<p>Example of an inline equation: $ h \in \mathbb G $ </p>
</li>
<li>
<p>Example of a display equation:</p>
</li>
</ul>
<p>$$
\mathbb s = \prod _{i=0}^n s(i)
$$</p>
<p><strong>Note:</strong> MathJax rendering in mdBook has some caveats to take note of:</p>
<ul>
<li>
<p>Subscripts</p>
<ul>
<li>
<p>When using two or more subscripts in inline or display equations, stipulated by a preceding underscore (<code>_</code>), the 
equation rendering does not work as expected. This is due to <code>_</code> being a special character for Markdown indicating 
text in italics. The way around this is to escape each underscore used in the equation as follows: (<code>\_</code>). An 
example of this is:</p>
<ul>
<li>
<p><em>Rendering correctly</em> </p>
<p>$ \mathbf a _{[:l]} = ( a_1 , ... , a_n ) \in \mathbb F ^ n \mspace{12mu} \text{and} 
\mspace{12mu} \mathbf a _{[l:]} = ( a_{1+1} , ... , a_n ) \in \mathbb F ^ {n-l} $ </p>
<p>as </p>
<p><code>$  \mathbf a \_{[:l]} = ( a_1 , ... , a_n ) \in \mathbb F ^ n \mspace{12mu} \text{and} \mspace{12mu}  \mathbf a _{[l:]} = ( a_{1+1} , ... , a_n ) \in \mathbb F ^ {n-l}  $</code></p>
</li>
<li>
<p><em>Rendering incorrectly</em> </p>
<p>$  \mathbf a _{[:l]} = ( a_1 , ... , a_n ) \in \mathbb F ^ n \mspace{12mu} \text{and} \mspace{12mu}<br />
\mathbf a <em>{[l:]} = ( a</em>{1+1}  , ... , a_n ) \in \mathbb F ^ {n-l} $ </p>
<p>as </p>
<p><code>$  \mathbf a _{[:l]} = ( a_1 , ... , a_n ) \in \mathbb F ^ n \mspace{12mu} \text{and} \mspace{12mu}  \mathbf a _{[l:]} = ( a_{1+1}  , ... , a_n ) \in \mathbb F ^ {n-l} $</code></p>
<p>Notice that this part of the (failed) formula, <code>_{[l:]} = ( a_</code>, is rendered in italics.</p>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Superscripts and subscripts order</p>
<ul>
<li>
<p>Sometimes swapping the order in which an expression's superscript text and subscript text appear may fix 
rendering issues, for example: </p>
<ul>
<li>
<p><code>$ s_i = \prod ^{\log _2 (n)} _{j=1} x ^{b(i,j)} _j $</code> </p>
<p>vs. </p>
<p><code>$ s_i = \prod _{j=1} ^{\log _2 (n)} x _j ^{b(i,j)} $</code></p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3><a class="header" href="#referencing-of-source-material" id="referencing-of-source-material">Referencing of Source Material</a></h3>
<h4><a class="header" href="#referencing-standard" id="referencing-standard">Referencing Standard</a></h4>
<p>TLU uses the IEEE standard [<a href="https://guides.lib.monash.edu/citing-referencing/ieee" title="Citing and Referencing: IEEE">2</a>] as a guide for referencing publications.</p>
<p>List references in the following order, as applicable:</p>
<ol>
<li>Author(s) initials or first name and surname (note punctuation in the following example).</li>
<li>Title of the report, between double quotation marks. If it is an online report, state this in square brackets, as 
shown in the following example.</li>
<li>Title of journal, in italics (if applicable).</li>
<li>Publication information (volume, number, etc.).</li>
<li>Page range (if applicable).</li>
<li>URL address if an online publication. Provide this information as shown in the following example: &quot;Available: ..&quot;.</li>
<li>Date you accessed the article if it is an online publication (yyyy-mm-dd), as shown in the following example.</li>
</ol>
<p><em>Example</em> </p>
<p>[1] M. Abe, M. Ohkubo and K. Suzuki, &quot;1-out-of-n Signatures from a Variety of Keys&quot; [online].
Available: https://www.iacr.org/cryptodb/archive/2002/ASIACRYPT/50/50.pdf. Date accessed: 2018-12-18.</p>
<p>Please note the use of punctuation and full stops in the example. </p>
<h4><a class="header" href="#markdown-links" id="markdown-links">Markdown Links</a></h4>
<p>There are two types of Markdown links: <strong>inline links</strong> and <strong>reference links</strong>.</p>
<p>The <strong>inline link</strong> under the <a href="preface/style-guide.html#Equations">Equations</a> heading was created as follows:</p>
<ol>
<li>Insert identifying link text within a set of square brackets (refer to the following example).</li>
<li>Create an inline link by placing a set of parentheses (round brackets) immediately after the closing square bracket 
of the link text (refer to the following example).</li>
<li>Insert the relevant URL link inside the parentheses (round brackets) (refer to the following example).</li>
</ol>
<p>mdBook has optional support for math 
<a href="https://github.com/rust-lang-nursery/mdBook/blob/master/book-example/src/format/mathjax.md">equations</a> through MathJax.</p>
<p><em>Example</em></p>
<p>A <strong>reference link</strong> has two parts. The first part of a reference link has two sets of square brackets. Inside the inner 
(second) set of square brackets, insert a label to identify the link.</p>
<p><em>Example</em> </p>
<p>Under the heading <a href="preface/style-guide.html#spelling">Spelling</a>, the text reference is &quot;The applicable dictionary is Merriam-Webster Online [<a href="https://www.merriam-webster.com" title="Merriam-Webster Online Dictionary">1</a>]&quot;. 
In the markdown text, note the double square brackets and the label 1. The rendered text shows <a href="https://www.merriam-webster.com" title="Merriam-Webster Online Dictionary">1</a>.</p>
<p>The second part of a reference link is inserted under the heading <a href="preface/style-guide.html#references">References</a>, and appears as follows:</p>
<p>[<a href="https://www.merriam-webster.com" title="Merriam-Webster Online Dictionary">1</a>] Merriam-Webster Online Dictionary [online]. 
Available: https://www.merriam-webster.com/. Date accessed: 2019-02-01.</p>
<p>The full online reference is inserted after <code>[[1]]</code>; and the pop-up text link (which can be seen by hovering your cursor
over the text reference in <a href="preface/style-guide.html#spelling">Spelling</a>) is inserted after <code>[1]:</code>. </p>
<p>For assistance with the layout of references, refer to <a href="preface/style-guide.html#referencing-standard">Referencing Standard</a>.</p>
<h3><a class="header" href="#list-of-contributors" id="list-of-contributors">List of Contributors</a></h3>
<p>The contributors are listed in a bulleted list via their GitHub account URLs. The author is listed first, followed by 
any reviewers or people who contributed via pull requests.
Refer to <a href="preface/style-guide.html#contributors">Contributors</a> for an example.</p>
<h2><a class="header" href="#references-31" id="references-31">References</a></h2>
<p>[<a href="https://www.merriam-webster.com" title="Merriam-Webster Online Dictionary">1</a>] Merriam-Webster Online Dictionary [online]. 
Available: https://www.merriam-webster.com/. Date accessed: 2019-02-01.</p>
<p>[<a href="https://guides.lib.monash.edu/citing-referencing/ieee" title="Citing and Referencing: IEEE">2</a>] Citing and Referencing: IEEE [online].
Available: https://guides.lib.monash.edu/citing-referencing/ieee. Date accessed: 2019-02-01.</p>
<p>[<a href="https://physics.nist.gov/cuu/pdf/sp811.pdf" title="Guide for the Use of the International System of Units (SI)">3</a>] A. Thompson and B. N. Taylor, &quot; Guide for the Use of the International System of Units (SI)&quot;, (1995) – NIST Special 
Publication 811 - 2008 Edition [online]. Available: https://physics.nist.gov/cuu/pdf/sp811.pdf. Date accessed: 2019-02-04.</p>
<p>[<a href="http://www.eng-lang.co.uk/ogs.htm" title="The Oxford Guide to Style">4</a>] The Oxford Guide to Style [online]. 
Available: http://www.eng-lang.co.uk/ogs.htm. Date accessed: 2019-02-04.</p>
<h2><a class="header" href="#appendices-12" id="appendices-12">Appendices</a></h2>
<h3><a class="header" href="#appendix-a-lower-case-words-used-in-title-case-formatting" id="appendix-a-lower-case-words-used-in-title-case-formatting">Appendix A: Lower-case Words used in Title Case Formatting</a></h3>
<table><thead><tr><th>Case Word</th><th>Case Word</th><th>Case Word</th><th>Case Word</th></tr></thead><tbody>
<tr><td>a</td><td>each</td><td>less</td><td>therefore</td></tr>
<tr><td>about</td><td>either</td><td>lesser</td><td>these</td></tr>
<tr><td>above</td><td>equal</td><td>low</td><td>they</td></tr>
<tr><td>after</td><td>ever</td><td>made</td><td>this</td></tr>
<tr><td>against</td><td>every</td><td>make</td><td>those</td></tr>
<tr><td>ahead</td><td>exclude</td><td>means</td><td>through</td></tr>
<tr><td>am</td><td>excluding</td><td>more</td><td>throughout</td></tr>
<tr><td>an</td><td>follow</td><td>most</td><td>thus</td></tr>
<tr><td>and</td><td>following</td><td>neither</td><td>to</td></tr>
<tr><td>any</td><td>follows</td><td>next</td><td>top</td></tr>
<tr><td>are</td><td>for</td><td>no</td><td>towards</td></tr>
<tr><td>as</td><td>from</td><td>nor</td><td>under</td></tr>
<tr><td>at</td><td>further</td><td>not</td><td>up</td></tr>
<tr><td>be</td><td>give</td><td>of</td><td>upper</td></tr>
<tr><td>been</td><td>given</td><td>on</td><td>use</td></tr>
<tr><td>before</td><td>go</td><td>only</td><td>use</td></tr>
<tr><td>behind</td><td>good</td><td>or</td><td>used</td></tr>
<tr><td>below</td><td>greater</td><td>order</td><td>used</td></tr>
<tr><td>beside</td><td>had</td><td>our</td><td>using</td></tr>
<tr><td>besides</td><td>has</td><td>out</td><td>versus</td></tr>
<tr><td>best</td><td>have</td><td>outer</td><td>very</td></tr>
<tr><td>better</td><td>how</td><td>outside</td><td>via</td></tr>
<tr><td>between</td><td>however</td><td>over</td><td>were</td></tr>
<tr><td>bottom</td><td>i.e.</td><td>provide</td><td>what</td></tr>
<tr><td>but</td><td>in</td><td>regard</td><td>when</td></tr>
<tr><td>by</td><td>include</td><td>since</td><td>where</td></tr>
<tr><td>can</td><td>including</td><td>such</td><td>which</td></tr>
<tr><td>consist</td><td>inner</td><td>than</td><td>while</td></tr>
<tr><td>consistent</td><td>inside</td><td>that</td><td>who</td></tr>
<tr><td>consistently</td><td>instead</td><td>the</td><td>with</td></tr>
<tr><td>consists</td><td>is</td><td>their</td><td>within</td></tr>
<tr><td>does</td><td>it</td><td>them</td><td>without</td></tr>
<tr><td>down</td><td>its</td><td>then</td><td>worst</td></tr>
<tr><td>e.g.</td><td>least</td><td>there</td><td></td></tr>
</tbody></table>
<h3><a class="header" href="#appendix-b-tari-labs-university-terminology-conventions" id="appendix-b-tari-labs-university-terminology-conventions">Appendix B: Tari Labs University Terminology Conventions</a></h3>
<p>With new concepts being formed daily and words changing over time, it is useful to establish terminology conventions. 
Different conventions (upper-case, lower-case, one word, two words, etc.) are used by different sources. This appendix 
contains suggested terminology for use in TLU reports. </p>
<ul>
<li>blockchain</li>
<li>Mimblewimble</li>
</ul>
<h2><a class="header" href="#contributors-23" id="contributors-23">Contributors</a></h2>
<ul>
<li><a href="https://github.com/anselld">https://github.com/anselld</a></li>
<li><a href="https://github.com/hansieodendaal">https://github.com/hansieodendaal</a></li>
<li><a href="https://github.com/CjS77">https://github.com/CjS77</a></li>
<li><a href="https://github.com/kevoulee">https://github.com/kevoulee</a></li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        

                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                

                
            </nav>

        </div>

        

        
        <!-- Google Analytics Tag -->
        <script type="text/javascript">
            var localAddrs = ["localhost", "127.0.0.1", ""];

            // make sure we don't activate google analytics if the developer is
            // inspecting the book locally...
            if (localAddrs.indexOf(document.location.hostname) === -1) {
                (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

                ga('create', 'UA-115476091-2', 'auto');
                ga('send', 'pageview');
            }
        </script>
        

        
        <script src="ace.js" type="text/javascript" charset="utf-8"></script>
        <script src="editor.js" type="text/javascript" charset="utf-8"></script>
        <script src="mode-rust.js" type="text/javascript" charset="utf-8"></script>
        <script src="theme-dawn.js" type="text/javascript" charset="utf-8"></script>
        <script src="theme-tomorrow_night.js" type="text/javascript" charset="utf-8"></script>
        

        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Initialize mermaid -->
        <script src="theme/js/mermaid.min.js" type="text/javascript" charset="utf-8"></script>
        <script>mermaid.initialize({startOnLoad:true});</script>

        <!-- Custom JS scripts -->
        

        
        
        <script type="text/javascript">
        window.addEventListener('load', function() {
            MathJax.Hub.Register.StartupHook('End', function() {
                window.setTimeout(window.print, 100);
            });
        });
        </script>
        
        

    </body>
</html>
